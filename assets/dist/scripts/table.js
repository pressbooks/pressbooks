!function(){var e={},t=function(t){for(var n=e[t],o=n.deps,i=n.defn,a=o.length,u=new Array(a),s=0;s<a;++s)u[s]=r(o[s]);var c=i.apply(null,u);if(void 0===c)throw"module ["+t+"] returned undefined";n.instance=c},n=function(t,n,r){if("string"!=typeof t)throw"module id must be a string";if(void 0===n)throw"no dependencies for "+t;if(void 0===r)throw"no definition function for "+t;e[t]={deps:n,defn:r,instance:void 0}},r=function(n){var r=e[n];if(void 0===r)throw"module ["+n+"] was undefined";return void 0===r.instance&&t(n),r.instance},o=function(e,t){for(var n=e.length,o=new Array(n),i=0;i<n;++i)o[i]=r(e[i]);t.apply(null,o)};({}).bolt={module:{api:{define:n,require:o,demand:r}}};var i=n,a=function(e,t){i(e,[],function(){return t})};a("global!tinymce.util.Tools.resolve",tinymce.util.Tools.resolve),i("tinymce.core.PluginManager",["global!tinymce.util.Tools.resolve"],function(e){return e("tinymce.PluginManager")}),a("global!Array",Array),a("global!Error",Error),i("ephox.katamari.api.Fun",["global!Array","global!Error"],function(e,t){var n=function(){},r=function(e){return function(){return e()}},o=function(e,t){return function(){return e(t.apply(null,arguments))}},i=function(e){return function(){return e}};return{noop:n,noarg:r,compose:o,constant:i,identity:function(e){return e},tripleEquals:function(e,t){return e===t},curry:function(t){for(var n=new e(arguments.length-1),r=1;r<arguments.length;r++)n[r-1]=arguments[r];return function(){for(var r=new e(arguments.length),o=0;o<r.length;o++)r[o]=arguments[o];var i=n.concat(r);return t.apply(null,i)}},not:function(e){return function(){return!e.apply(null,arguments)}},die:function(e){return function(){throw new t(e)}},apply:function(e){return e()},call:function(e){e()},never:i(!1),always:i(!0)}}),a("global!Object",Object),i("ephox.katamari.api.Option",["ephox.katamari.api.Fun","global!Object"],function(e,t){var n=e.never,r=e.always,o=function(){return i},i=function(){var i=function(e){return e.isNone()},a=function(e){return e()},u=function(e){return e},s=function(){},c={fold:function(e,t){return e()},is:n,isSome:n,isNone:r,getOr:u,getOrThunk:a,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},or:u,orThunk:a,map:o,ap:o,each:s,bind:o,flatten:o,exists:n,forall:r,filter:o,equals:i,equals_:i,toArray:function(){return[]},toString:e.constant("none()")};return t.freeze&&t.freeze(c),c}(),a=function(e){var t=function(){return e},u=function(){return l},s=function(t){return a(t(e))},c=function(t){return t(e)},l={fold:function(t,n){return n(e)},is:function(t){return e===t},isSome:r,isNone:n,getOr:t,getOrThunk:t,getOrDie:t,or:u,orThunk:u,map:s,ap:function(t){return t.fold(o,function(t){return a(t(e))})},each:function(t){t(e)},bind:c,flatten:t,exists:c,forall:c,filter:function(t){return t(e)?l:i},equals:function(t){return t.is(e)},equals_:function(t,r){return t.fold(n,function(t){return r(e,t)})},toArray:function(){return[e]},toString:function(){return"some("+e+")"}};return l};return{some:a,none:o,from:function(e){return null===e||void 0===e?i:a(e)}}}),a("global!String",String),i("ephox.katamari.api.Arr",["ephox.katamari.api.Option","global!Array","global!Error","global!String"],function(e,t,n,r){var o=function(){var e=t.prototype.indexOf,n=function(t,n){return e.call(t,n)},r=function(e,t){return w(e,t)};return void 0===e?r:n}(),i=function(t,n){var r=o(t,n);return-1===r?e.none():e.some(r)},a=function(e,t){return o(e,t)>-1},u=function(e,t){return b(e,t).isSome()},s=function(e,t){for(var n=[],r=0;r<e;r++)n.push(t(r));return n},c=function(e,t){for(var n=[],r=0;r<e.length;r+=t){var o=e.slice(r,r+t);n.push(o)}return n},l=function(e,n){for(var r=e.length,o=new t(r),i=0;i<r;i++){var a=e[i];o[i]=n(a,i,e)}return o},p=function(e,t){for(var n=0,r=e.length;n<r;n++){t(e[n],n,e)}},f=function(e,t){for(var n=e.length-1;n>=0;n--){t(e[n],n,e)}},d=function(e,t){for(var n=[],r=[],o=0,i=e.length;o<i;o++){var a=e[o];(t(a,o,e)?n:r).push(a)}return{pass:n,fail:r}},m=function(e,t){for(var n=[],r=0,o=e.length;r<o;r++){var i=e[r];t(i,r,e)&&n.push(i)}return n},h=function(e,t){if(0===e.length)return[];for(var n=t(e[0]),r=[],o=[],i=0,a=e.length;i<a;i++){var u=e[i],s=t(u);s!==n&&(r.push(o),o=[]),n=s,o.push(u)}return 0!==o.length&&r.push(o),r},g=function(e,t,n){return f(e,function(e){n=t(n,e)}),n},x=function(e,t,n){return p(e,function(e){n=t(n,e)}),n},v=function(t,n){for(var r=0,o=t.length;r<o;r++){var i=t[r];if(n(i,r,t))return e.some(i)}return e.none()},b=function(t,n){for(var r=0,o=t.length;r<o;r++){if(n(t[r],r,t))return e.some(r)}return e.none()},w=function(e,t){for(var n=0,r=e.length;n<r;++n)if(e[n]===t)return n;return-1},y=t.prototype.push,k=function(e){for(var r=[],o=0,i=e.length;o<i;++o){if(!t.prototype.isPrototypeOf(e[o]))throw new n("Arr.flatten item "+o+" was not an array, input: "+e);y.apply(r,e[o])}return r},S=function(e,t){var n=l(e,t);return k(n)},C=function(e,t){for(var n=0,r=e.length;n<r;++n){if(!0!==t(e[n],n,e))return!1}return!0},T=function(e,t){return e.length===t.length&&C(e,function(e,n){return e===t[n]})},R=t.prototype.slice;return{map:l,each:p,eachr:f,partition:d,filter:m,groupBy:h,indexOf:i,foldr:g,foldl:x,find:v,findIndex:b,flatten:k,bind:S,forall:C,exists:u,contains:a,equal:T,reverse:function(e){var t=R.call(e,0);return t.reverse(),t},chunk:c,difference:function(e,t){return m(e,function(e){return!a(t,e)})},mapToObject:function(e,t){for(var n={},o=0,i=e.length;o<i;o++){var a=e[o];n[r(a)]=t(a,o)}return n},pure:function(e){return[e]},sort:function(e,t){var n=R.call(e,0);return n.sort(t),n},range:s,head:function(t){return 0===t.length?e.none():e.some(t[0])},last:function(t){return 0===t.length?e.none():e.some(t[t.length-1])}}}),i("ephox.katamari.api.Obj",["ephox.katamari.api.Option","global!Object"],function(e,t){var n=function(){var e=t.keys,n=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t};return void 0===e?n:e}(),r=function(e,t){for(var r=n(e),o=0,i=r.length;o<i;o++){var a=r[o];t(e[a],a,e)}},o=function(e,t){return i(e,function(e,n,r){return{k:n,v:t(e,n,r)}})},i=function(e,t){var n={};return r(e,function(r,o){var i=t(r,o,e);n[i.k]=i.v}),n},a=function(e,t){var n={},o={};return r(e,function(e,r){(t(e,r)?n:o)[r]=e}),{t:n,f:o}},u=function(e,t){var n=[];return r(e,function(e,r){n.push(t(e,r))}),n},s=function(t,r){for(var o=n(t),i=0,a=o.length;i<a;i++){var u=o[i],s=t[u];if(r(s,u,t))return e.some(s)}return e.none()},c=function(e){return u(e,function(e){return e})};return{bifilter:a,each:r,map:o,mapToArray:u,tupleMap:i,find:s,keys:n,values:c,size:function(e){return c(e).length}}}),i("ephox.katamari.data.Immutable",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","global!Array","global!Error"],function(e,t,n,r){return function(){var o=arguments;return function(){for(var i=new n(arguments.length),a=0;a<i.length;a++)i[a]=arguments[a];if(o.length!==i.length)throw new r('Wrong number of arguments to struct. Expected "['+o.length+']", got '+i.length+" arguments");var u={};return e.each(o,function(e,n){u[e]=t.constant(i[n])}),u}}}),i("ephox.katamari.api.Type",["global!Array","global!String"],function(e,t){var n=function(n){if(null===n)return"null";var r=typeof n;return"object"===r&&e.prototype.isPrototypeOf(n)?"array":"object"===r&&t.prototype.isPrototypeOf(n)?"string":r},r=function(e){return function(t){return n(t)===e}};return{isString:r("string"),isObject:r("object"),isArray:r("array"),isNull:r("null"),isBoolean:r("boolean"),isUndefined:r("undefined"),isFunction:r("function"),isNumber:r("number")}}),i("ephox.katamari.util.BagUtils",["ephox.katamari.api.Arr","ephox.katamari.api.Type","global!Error"],function(e,t,n){var r=function(e){return e.slice(0).sort()};return{sort:r,reqMessage:function(e,t){throw new n("All required keys ("+r(e).join(", ")+") were not specified. Specified keys were: "+r(t).join(", ")+".")},unsuppMessage:function(e){throw new n("Unsupported keys for object: "+r(e).join(", "))},validateStrArr:function(r,o){if(!t.isArray(o))throw new n("The "+r+" fields must be an array. Was: "+o+".");e.each(o,function(e){if(!t.isString(e))throw new n("The value "+e+" in the "+r+" fields was not a string.")})},invalidTypeMessage:function(e,t){throw new n("All values need to be of type: "+t+". Keys ("+r(e).join(", ")+") were not.")},checkDupes:function(t){var o=r(t);e.find(o,function(e,t){return t<o.length-1&&e===o[t+1]}).each(function(e){throw new n("The field: "+e+" occurs more than once in the combined fields: ["+o.join(", ")+"].")})}}}),i("ephox.katamari.data.MixedBag",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Obj","ephox.katamari.api.Option","ephox.katamari.util.BagUtils","global!Error","global!Object"],function(e,t,n,r,o,i,a){return function(u,s){var c=u.concat(s);if(0===c.length)throw new i("You must specify at least one required or optional field.");return o.validateStrArr("required",u),o.validateStrArr("optional",s),o.checkDupes(c),function(i){var l=n.keys(i);e.forall(u,function(t){return e.contains(l,t)})||o.reqMessage(u,l);var p=e.filter(l,function(t){return!e.contains(c,t)});p.length>0&&o.unsuppMessage(p);var f={};return e.each(u,function(e){f[e]=t.constant(i[e])}),e.each(s,function(e){f[e]=t.constant(a.prototype.hasOwnProperty.call(i,e)?r.some(i[e]):r.none())}),f}}}),i("ephox.katamari.api.Struct",["ephox.katamari.data.Immutable","ephox.katamari.data.MixedBag"],function(e,t){return{immutable:e,immutableBag:t}}),i("ephox.snooker.api.Structs",["ephox.katamari.api.Struct"],function(e){var t=e.immutable("width","height"),n=e.immutable("rows","columns"),r=e.immutable("row","column"),o=e.immutable("x","y"),i=e.immutable("element","rowspan","colspan"),a=e.immutable("element","rowspan","colspan","isNew");return{dimensions:t,grid:n,address:r,coords:o,extended:e.immutable("element","rowspan","colspan","row","column"),detail:i,detailnew:a,rowdata:e.immutable("element","cells","section"),elementnew:e.immutable("element","isNew"),rowdatanew:e.immutable("element","cells","section","isNew"),rowcells:e.immutable("cells","section"),rowdetails:e.immutable("details","section"),bounds:e.immutable("startRow","startCol","finishRow","finishCol")}}),i("global!console",[],function(){return"undefined"==typeof console&&(console={log:function(){}}),console}),a("global!document",document),i("ephox.sugar.api.node.Element",["ephox.katamari.api.Fun","ephox.katamari.api.Option","global!Error","global!console","global!document"],function(e,t,n,r,o){var i=function(e,t){var n=t||o,i=n.createElement("div");if(i.innerHTML=e,!i.hasChildNodes()||i.childNodes.length>1)throw r.error("HTML does not have a single root node",e),"HTML must have a single root node";return s(i.childNodes[0])},a=function(e,t){var n=t||o,r=n.createElement(e);return s(r)},u=function(e,t){var n=t||o,r=n.createTextNode(e);return s(r)},s=function(t){if(null===t||void 0===t)throw new n("Node cannot be null or undefined");return{dom:e.constant(t)}};return{fromHtml:i,fromTag:a,fromText:u,fromDom:s,fromPoint:function(e,n,r){return t.from(e.dom().elementFromPoint(n,r)).map(s)}}}),i("ephox.sugar.api.node.NodeTypes",[],function(){return{ATTRIBUTE:2,CDATA_SECTION:4,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,ELEMENT:1,TEXT:3,PROCESSING_INSTRUCTION:7,ENTITY_REFERENCE:5,ENTITY:6,NOTATION:12}}),i("ephox.sugar.api.search.Selectors",["ephox.katamari.api.Arr","ephox.katamari.api.Option","ephox.sugar.api.node.Element","ephox.sugar.api.node.NodeTypes","global!Error","global!document"],function(e,t,n,r,o,i){var a=r.ELEMENT,u=r.DOCUMENT,s=function(e,t){var n=e.dom();if(n.nodeType!==a)return!1;if(void 0!==n.matches)return n.matches(t);if(void 0!==n.msMatchesSelector)return n.msMatchesSelector(t);if(void 0!==n.webkitMatchesSelector)return n.webkitMatchesSelector(t);if(void 0!==n.mozMatchesSelector)return n.mozMatchesSelector(t);throw new o("Browser lacks native selectors")},c=function(e){return e.nodeType!==a&&e.nodeType!==u||0===e.childElementCount};return{all:function(t,r){var o=void 0===r?i:r.dom();return c(o)?[]:e.map(o.querySelectorAll(t),n.fromDom)},is:s,one:function(e,r){var o=void 0===r?i:r.dom();return c(o)?t.none():t.from(o.querySelector(e)).map(n.fromDom)}}}),i("ephox.sugar.alien.Recurse",[],function(){return{toArray:function(e,t){var n=[],r=function(e){return n.push(e),t(e)},o=t(e);do{o=o.bind(r)}while(o.isSome());return n}}}),i("ephox.katamari.api.Global",[],function(){return"undefined"!=typeof window?window:Function("return this;")()}),i("ephox.katamari.api.Resolve",["ephox.katamari.api.Global"],function(e){var t=function(t,n){for(var r=void 0!==n?n:e,o=0;o<t.length&&void 0!==r&&null!==r;++o)r=r[t[o]];return r},n=function(e,n){var r=e.split(".");return t(r,n)},r=function(e,t){return void 0!==e[t]&&null!==e[t]||(e[t]={}),e[t]},o=function(t,n){for(var o=void 0!==n?n:e,i=0;i<t.length;++i)o=r(o,t[i]);return o};return{path:t,resolve:n,forge:o,namespace:function(e,t){var n=e.split(".");return o(n,t)}}}),i("ephox.sand.util.Global",["ephox.katamari.api.Resolve"],function(e){var t=function(t,n){return e.resolve(t,n)};return{getOrDie:function(e,n){var r=t(e,n);if(void 0===r)throw e+" not available on this browser";return r}}}),i("ephox.sand.api.Node",["ephox.sand.util.Global"],function(e){var t=function(){return e.getOrDie("Node")},n=function(e,t,n){return 0!=(e.compareDocumentPosition(t)&n)};return{documentPositionPreceding:function(e,r){return n(e,r,t().DOCUMENT_POSITION_PRECEDING)},documentPositionContainedBy:function(e,r){return n(e,r,t().DOCUMENT_POSITION_CONTAINED_BY)}}}),i("ephox.katamari.api.Thunk",[],function(){return{cached:function(e){var t,n=!1;return function(){return n||(n=!0,t=e.apply(null,arguments)),t}}}}),a("global!Number",Number),i("ephox.sand.detect.Version",["ephox.katamari.api.Arr","global!Number","global!String"],function(e,t,n){var r=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.test(t))return r}},o=function(e,n){var o=r(e,n);if(!o)return{major:0,minor:0};var i=function(e){return t(n.replace(o,"$"+e))};return u(i(1),i(2))},i=function(e,t){var r=n(t).toLowerCase();return 0===e.length?a():o(e,r)},a=function(){return u(0,0)},u=function(e,t){return{major:e,minor:t}};return{nu:u,detect:i,unknown:a}}),i("ephox.sand.core.Browser",["ephox.katamari.api.Fun","ephox.sand.detect.Version"],function(e,t){var n=function(e,t){return function(){return t===e}},r=function(){return o({current:void 0,version:t.unknown()})},o=function(e){var t=e.current;return{current:t,version:e.version,isEdge:n("Edge",t),isChrome:n("Chrome",t),isIE:n("IE",t),isOpera:n("Opera",t),isFirefox:n("Firefox",t),isSafari:n("Safari",t)}};return{unknown:r,nu:o,edge:e.constant("Edge"),chrome:e.constant("Chrome"),ie:e.constant("IE"),opera:e.constant("Opera"),firefox:e.constant("Firefox"),safari:e.constant("Safari")}}),i("ephox.sand.core.OperatingSystem",["ephox.katamari.api.Fun","ephox.sand.detect.Version"],function(e,t){var n=function(e,t){return function(){return t===e}},r=function(){return o({current:void 0,version:t.unknown()})},o=function(e){var t=e.current;return{current:t,version:e.version,isWindows:n("Windows",t),isiOS:n("iOS",t),isAndroid:n("Android",t),isOSX:n("OSX",t),isLinux:n("Linux",t),isSolaris:n("Solaris",t),isFreeBSD:n("FreeBSD",t)}};return{unknown:r,nu:o,windows:e.constant("Windows"),ios:e.constant("iOS"),android:e.constant("Android"),linux:e.constant("Linux"),osx:e.constant("OSX"),solaris:e.constant("Solaris"),freebsd:e.constant("FreeBSD")}}),i("ephox.sand.detect.DeviceType",["ephox.katamari.api.Fun"],function(e){return function(t,n,r){var o=t.isiOS()&&!0===/ipad/i.test(r),i=t.isiOS()&&!o,a=t.isAndroid()&&3===t.version.major,u=t.isAndroid()&&4===t.version.major,s=o||a||u&&!0===/mobile/i.test(r),c=t.isiOS()||t.isAndroid(),l=c&&!s,p=n.isSafari()&&t.isiOS()&&!1===/safari/i.test(r);return{isiPad:e.constant(o),isiPhone:e.constant(i),isTablet:e.constant(s),isPhone:e.constant(l),isTouch:e.constant(c),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:e.constant(p)}}}),i("ephox.sand.detect.UaString",["ephox.katamari.api.Arr","ephox.sand.detect.Version","global!String"],function(e,t,n){var r=function(t,r){var o=n(r).toLowerCase();return e.find(t,function(e){return e.search(o)})};return{detectBrowser:function(e,n){return r(e,n).map(function(e){var r=t.detect(e.versionRegexes,n);return{current:e.name,version:r}})},detectOs:function(e,n){return r(e,n).map(function(e){var r=t.detect(e.versionRegexes,n);return{current:e.name,version:r}})}}}),i("ephox.katamari.str.StrAppend",[],function(){return{addToStart:function(e,t){return t+e},addToEnd:function(e,t){return e+t},removeFromStart:function(e,t){return e.substring(t)},removeFromEnd:function(e,t){return e.substring(0,e.length-t)}}}),i("ephox.katamari.str.StringParts",["ephox.katamari.api.Option","global!Error"],function(e,t){return{first:function(e,t){return e.substr(0,t)},last:function(e,t){return e.substr(e.length-t,e.length)},head:function(t){return""===t?e.none():e.some(t.substr(0,1))},tail:function(t){return""===t?e.none():e.some(t.substring(1))}}}),i("ephox.katamari.api.Strings",["ephox.katamari.str.StrAppend","ephox.katamari.str.StringParts","global!Error"],function(e,t,n){var r=function(e,t,n){return""===t||!(e.length<t.length)&&e.substr(n,n+t.length)===t},o=function(e,t){var n=function(e){var t=typeof e;return"string"===t||"number"===t};return e.replace(/\${([^{}]*)}/g,function(e,r){var o=t[r];return n(o)?o:e})},i=function(t,n){return p(t,n)?e.removeFromStart(t,n.length):t},a=function(t,n){return f(t,n)?e.removeFromEnd(t,n.length):t},u=function(t,n){return p(t,n)?t:e.addToStart(t,n)},s=function(t,n){return f(t,n)?t:e.addToEnd(t,n)},c=function(e,t){return-1!==e.indexOf(t)},l=function(e){return t.head(e).bind(function(n){return t.tail(e).map(function(e){return n.toUpperCase()+e})}).getOr(e)},p=function(e,t){return r(e,t,0)},f=function(e,t){return r(e,t,e.length-t.length)};return{supplant:o,startsWith:p,removeLeading:i,removeTrailing:a,ensureLeading:u,ensureTrailing:s,endsWith:f,contains:c,trim:function(e){return e.replace(/^\s+|\s+$/g,"")},lTrim:function(e){return e.replace(/^\s+/g,"")},rTrim:function(e){return e.replace(/\s+$/g,"")},capitalize:l}}),i("ephox.sand.info.PlatformInfo",["ephox.katamari.api.Fun","ephox.katamari.api.Strings"],function(e,t){var n=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,r=function(e){return function(n){return t.contains(n,e)}},o=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return t.contains(e,"edge/")&&t.contains(e,"chrome")&&t.contains(e,"safari")&&t.contains(e,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,n],search:function(e){return t.contains(e,"chrome")&&!t.contains(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return t.contains(e,"msie")||t.contains(e,"trident")}},{name:"Opera",versionRegexes:[n,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:r("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:r("firefox")},{name:"Safari",versionRegexes:[n,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(t.contains(e,"safari")||t.contains(e,"mobile/"))&&t.contains(e,"applewebkit")}}],i=[{name:"Windows",search:r("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return t.contains(e,"iphone")||t.contains(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:r("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:r("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:r("linux"),versionRegexes:[]},{name:"Solaris",search:r("sunos"),versionRegexes:[]},{name:"FreeBSD",search:r("freebsd"),versionRegexes:[]}];return{browsers:e.constant(o),oses:e.constant(i)}}),i("ephox.sand.core.PlatformDetection",["ephox.sand.core.Browser","ephox.sand.core.OperatingSystem","ephox.sand.detect.DeviceType","ephox.sand.detect.UaString","ephox.sand.info.PlatformInfo"],function(e,t,n,r,o){return{detect:function(i){var a=o.browsers(),u=o.oses(),s=r.detectBrowser(a,i).fold(e.unknown,e.nu),c=r.detectOs(u,i).fold(t.unknown,t.nu);return{browser:s,os:c,deviceType:n(c,s,i)}}}}),a("global!navigator",navigator),i("ephox.sand.api.PlatformDetection",["ephox.katamari.api.Thunk","ephox.sand.core.PlatformDetection","global!navigator"],function(e,t,n){return{detect:e.cached(function(){var e=n.userAgent;return t.detect(e)})}}),i("ephox.sugar.api.dom.Compare",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.sand.api.Node","ephox.sand.api.PlatformDetection","ephox.sugar.api.search.Selectors"],function(e,t,n,r,o){var i=function(e,t){return e.dom()===t.dom()},a=function(e,t){return e.dom().isEqualNode(t.dom())},u=function(n,r){return e.exists(r,t.curry(i,n))},s=function(e,t){var n=e.dom(),r=t.dom();return n!==r&&n.contains(r)},c=function(e,t){return n.documentPositionContainedBy(e.dom(),t.dom())},l=r.detect().browser,p=l.isIE()?c:s;return{eq:i,isEqualNode:a,member:u,contains:p,is:o.is}}),i("ephox.sugar.api.search.Traverse",["ephox.katamari.api.Type","ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.katamari.api.Struct","ephox.sugar.alien.Recurse","ephox.sugar.api.dom.Compare","ephox.sugar.api.node.Element"],function(e,t,n,r,o,i,a,u){var s=function(e){return u.fromDom(e.dom().ownerDocument)},c=function(e){var t=s(e);return u.fromDom(t.dom().documentElement)},l=function(e){var t=e.dom(),n=t.ownerDocument.defaultView;return u.fromDom(n)},p=function(e){var t=e.dom();return r.from(t.parentNode).map(u.fromDom)},f=function(e){return p(e).bind(function(n){var r=w(n);return t.findIndex(r,function(t){return a.eq(e,t)})})},d=function(t,r){for(var o=e.isFunction(r)?r:n.constant(!1),i=t.dom(),a=[];null!==i.parentNode&&void 0!==i.parentNode;){var s=i.parentNode,c=u.fromDom(s);if(a.push(c),!0===o(c))break;i=s}return a},m=function(e){var n=function(n){return t.filter(n,function(t){return!a.eq(e,t)})};return p(e).map(w).map(n).getOr([])},h=function(e){var t=e.dom();return r.from(t.offsetParent).map(u.fromDom)},g=function(e){var t=e.dom();return r.from(t.previousSibling).map(u.fromDom)},x=function(e){var t=e.dom();return r.from(t.nextSibling).map(u.fromDom)},v=function(e){return t.reverse(i.toArray(e,g))},b=function(e){return i.toArray(e,x)},w=function(e){var n=e.dom();return t.map(n.childNodes,u.fromDom)},y=function(e,t){var n=e.dom().childNodes;return r.from(n[t]).map(u.fromDom)},k=function(e){return y(e,0)},S=function(e){return y(e,e.dom().childNodes.length-1)},C=function(e){return e.dom().childNodes.length},T=function(e){return e.dom().hasChildNodes()},R=o.immutable("element","offset");return{owner:s,defaultView:l,documentElement:c,parent:p,findIndex:f,parents:d,siblings:m,prevSibling:g,offsetParent:h,prevSiblings:v,nextSibling:x,nextSiblings:b,children:w,child:y,firstChild:k,lastChild:S,childNodesCount:C,hasChildNodes:T,leaf:function(e,t){var n=w(e);return n.length>0&&t<n.length?R(n[t],0):R(e,t)}}}),i("ephox.snooker.util.LayerSelector",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.sugar.api.search.Selectors","ephox.sugar.api.search.Traverse"],function(e,t,n,r){var o=function(e,n){return i(e,n,t.constant(!0))},i=function(t,o,a){return e.bind(r.children(t),function(e){return n.is(e,o)?a(e)?[e]:[]:i(e,o,a)})};return{firstLayer:o,filterFirstLayer:i}}),i("ephox.sugar.api.node.Node",["ephox.sugar.api.node.NodeTypes"],function(e){var t=function(e){return e.dom().nodeName.toLowerCase()},n=function(e){return e.dom().nodeType},r=function(e){return e.dom().nodeValue},o=function(e){return function(t){return n(t)===e}},i=function(r){return n(r)===e.COMMENT||"#comment"===t(r)},a=o(e.ELEMENT),u=o(e.TEXT),s=o(e.DOCUMENT);return{name:t,type:n,value:r,isElement:a,isText:u,isDocument:s,isComment:i}}),i("ephox.sugar.api.properties.Attr",["ephox.katamari.api.Type","ephox.katamari.api.Arr","ephox.katamari.api.Obj","ephox.sugar.api.node.Node","global!Error","global!console"],function(e,t,n,r,o,i){var a=function(t,n,r){if(!(e.isString(r)||e.isBoolean(r)||e.isNumber(r)))throw i.error("Invalid call to Attr.set. Key ",n,":: Value ",r,":: Element ",t),new o("Attribute value was not simple");t.setAttribute(n,r+"")},u=function(e,t,n){a(e.dom(),t,n)},s=function(e,t){var r=e.dom();n.each(t,function(e,t){a(r,t,e)})},c=function(e,t){var n=e.dom().getAttribute(t);return null===n?void 0:n},l=function(e,t){var n=e.dom();return!(!n||!n.hasAttribute)&&n.hasAttribute(t)},p=function(e,t){e.dom().removeAttribute(t)},f=function(e){var t=e.dom().attributes;return void 0===t||null===t||0===t.length},d=function(e,t,n){l(e,n)&&!l(t,n)&&u(t,n,c(e,n))};return{clone:function(e){return t.foldl(e.dom().attributes,function(e,t){return e[t.name]=t.value,e},{})},set:u,setAll:s,get:c,has:l,remove:p,hasNone:f,transfer:function(e,n,o){r.isElement(e)&&r.isElement(n)&&t.each(o,function(t){d(e,n,t)})}}}),i("ephox.sugar.api.node.Body",["ephox.katamari.api.Thunk","ephox.sugar.api.node.Element","ephox.sugar.api.node.Node","global!document"],function(e,t,n,r){var o=function(e){var t=n.isText(e)?e.dom().parentNode:e.dom();return void 0!==t&&null!==t&&t.ownerDocument.body.contains(t)},i=e.cached(function(){return a(t.fromDom(r))}),a=function(e){var n=e.dom().body;if(null===n||void 0===n)throw"Body is not available yet";return t.fromDom(n)};return{body:i,getBody:a,inBody:o}}),i("ephox.sugar.api.search.PredicateFilter",["ephox.katamari.api.Arr","ephox.sugar.api.node.Body","ephox.sugar.api.search.Traverse"],function(e,t,n){var r=function(e){return u(t.body(),e)},o=function(t,r,o){return e.filter(n.parents(t,o),r)},i=function(t,r){return e.filter(n.siblings(t),r)},a=function(t,r){return e.filter(n.children(t),r)},u=function(t,r){var o=[];return e.each(n.children(t),function(e){r(e)&&(o=o.concat([e])),o=o.concat(u(e,r))}),o};return{all:r,ancestors:o,siblings:i,children:a,descendants:u}}),i("ephox.sugar.api.search.SelectorFilter",["ephox.sugar.api.search.PredicateFilter","ephox.sugar.api.search.Selectors"],function(e,t){return{all:function(e){return t.all(e)},ancestors:function(n,r,o){return e.ancestors(n,function(e){return t.is(e,r)},o)},siblings:function(n,r){return e.siblings(n,function(e){return t.is(e,r)})},children:function(n,r){return e.children(n,function(e){return t.is(e,r)})},descendants:function(e,n){return t.all(n,e)}}}),i("ephox.sugar.impl.ClosestOrAncestor",["ephox.katamari.api.Type","ephox.katamari.api.Option"],function(e,t){return function(n,r,o,i,a){return n(o,i)?t.some(o):e.isFunction(a)&&a(o)?t.none():r(o,i,a)}}),i("ephox.sugar.api.search.PredicateFind",["ephox.katamari.api.Type","ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.sugar.api.node.Body","ephox.sugar.api.dom.Compare","ephox.sugar.api.node.Element","ephox.sugar.impl.ClosestOrAncestor"],function(e,t,n,r,o,i,a,u){var s=function(e){return d(o.body(),e)},c=function(t,o,i){for(var u=t.dom(),s=e.isFunction(i)?i:n.constant(!1);u.parentNode;){u=u.parentNode;var c=a.fromDom(u);if(o(c))return r.some(c);if(s(c))break}return r.none()},l=function(e,t,n){return u(function(e){return t(e)},c,e,t,n)},p=function(e,t){var n=e.dom();return n.parentNode?f(a.fromDom(n.parentNode),function(n){return!i.eq(e,n)&&t(n)}):r.none()},f=function(e,r){return t.find(e.dom().childNodes,n.compose(r,a.fromDom)).map(a.fromDom)},d=function(e,t){var n=function(e){for(var o=0;o<e.childNodes.length;o++){if(t(a.fromDom(e.childNodes[o])))return r.some(a.fromDom(e.childNodes[o]));var i=n(e.childNodes[o]);if(i.isSome())return i}return r.none()};return n(e.dom())};return{first:s,ancestor:c,closest:l,sibling:p,child:f,descendant:d}}),i("ephox.sugar.api.search.SelectorFind",["ephox.sugar.api.search.PredicateFind","ephox.sugar.api.search.Selectors","ephox.sugar.impl.ClosestOrAncestor"],function(e,t,n){var r=function(e){return t.one(e)},o=function(n,r,o){return e.ancestor(n,function(e){return t.is(e,r)},o)};return{first:r,ancestor:o,sibling:function(n,r){return e.sibling(n,function(e){return t.is(e,r)})},child:function(n,r){return e.child(n,function(e){return t.is(e,r)})},descendant:function(e,n){return t.one(n,e)},closest:function(e,r,i){return n(t.is,o,e,r,i)}}}),a("global!parseInt",parseInt),i("ephox.snooker.api.TableLookup",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.snooker.api.Structs","ephox.snooker.util.LayerSelector","ephox.sugar.api.properties.Attr","ephox.sugar.api.node.Node","ephox.sugar.api.search.SelectorFilter","ephox.sugar.api.search.SelectorFind","ephox.sugar.api.search.Selectors","ephox.sugar.api.search.Traverse","global!parseInt"],function(e,t,n,r,o,i,a,u,s,c,l,p){var f=function(r,o,i){var u=void 0!==i?i:t.constant(!1);if(u(o))return n.none();if(e.contains(r,a.name(o)))return n.some(o);var l=function(e){return c.is(e,"table")||u(e)};return s.ancestor(o,r.join(","),l)},d=function(e,t){return f(["td","th"],e,t)},m=function(e){return o.firstLayer(e,"th,td")},h=function(e,t){return f(["caption","tr","tbody","tfoot","thead"],e,t)},g=function(e,t){return l.parent(t).map(function(t){return u.children(t,e)})},x=t.curry(g,"th,td"),v=t.curry(g,"tr"),b=function(e){return s.descendant(e,"th,td")},w=function(e,t){return s.closest(e,"table",t)},y=function(e,t){return f(["tr"],e,t)},k=function(e){return o.firstLayer(e,"tr")},S=function(e,t){return p(i.get(e,t),10)};return{cell:d,firstCell:b,cells:m,neighbourCells:x,table:w,row:y,rows:k,notCell:h,neighbourRows:v,attr:S,grid:function(e,t,n){var o=S(e,t),i=S(e,n);return r.grid(o,i)}}}),i("ephox.snooker.model.DetailsList",["ephox.katamari.api.Arr","ephox.snooker.api.Structs","ephox.snooker.api.TableLookup","ephox.sugar.api.properties.Attr","ephox.sugar.api.node.Node","ephox.sugar.api.search.Traverse"],function(e,t,n,r,o,i){return{fromTable:function(a){var u=n.rows(a);return e.map(u,function(a){var u=a,s=i.parent(u),c=s.bind(function(e){var t=o.name(e);return"tfoot"===t||"thead"===t||"tbody"===t?t:"tbody"}),l=e.map(n.cells(a),function(e){var n=r.has(e,"rowspan")?parseInt(r.get(e,"rowspan"),10):1,o=r.has(e,"colspan")?parseInt(r.get(e,"colspan"),10):1;return t.detail(e,n,o)});return t.rowdata(u,l,c)})},fromPastedRows:function(o,i){return e.map(o,function(o){var a=e.map(n.cells(o),function(e){var n=r.has(e,"rowspan")?parseInt(r.get(e,"rowspan"),10):1,o=r.has(e,"colspan")?parseInt(r.get(e,"colspan"),10):1;return t.detail(e,n,o)});return t.rowdata(o,a,i.section())})}}}),a("global!Math",Math),i("ephox.snooker.model.Warehouse",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.snooker.api.Structs","global!Math"],function(e,t,n,r,o){var i=function(e,t){return e+","+t},a=function(e,t,r){var o=e.access()[i(t,r)];return void 0!==o?n.some(o):n.none()},u=function(e,t,r){var o=s(e,function(e){return r(t,e.element())});return o.length>0?n.some(o[0]):n.none()},s=function(t,n){var r=e.bind(t.all(),function(e){return e.cells()});return e.filter(r,n)};return{generate:function(n){var a={},u=[],s=n.length,c=0;e.each(n,function(t,n){var s=[];e.each(t.cells(),function(e,t){for(var u=0;void 0!==a[i(n,u)];)u++;for(var l=r.extended(e.element(),e.rowspan(),e.colspan(),n,u),p=0;p<e.colspan();p++)for(var f=0;f<e.rowspan();f++){var d=n+f,m=u+p,h=i(d,m);a[h]=l,c=o.max(c,m+1)}s.push(l)}),u.push(r.rowdata(t.element(),s,t.section()))});var l=r.grid(s,c);return{grid:t.constant(l),access:t.constant(a),all:t.constant(u)}},getAt:a,findItem:u,filterItems:s,justCells:function(t){var n=e.map(t.all(),function(e){return e.cells()});return e.flatten(n)}}}),i("ephox.sugar.impl.Style",[],function(){return{isSupported:function(e){return void 0!==e.style}}}),a("global!window",window),
i("ephox.sugar.api.properties.Css",["ephox.katamari.api.Type","ephox.katamari.api.Arr","ephox.katamari.api.Obj","ephox.katamari.api.Option","ephox.sugar.api.properties.Attr","ephox.sugar.api.node.Body","ephox.sugar.api.node.Element","ephox.sugar.api.node.Node","ephox.sugar.impl.Style","ephox.katamari.api.Strings","global!Error","global!console","global!window"],function(e,t,n,r,o,i,a,u,s,c,l,p,f){var d=function(t,n,r){if(!e.isString(r))throw p.error("Invalid call to CSS.set. Property ",n,":: Value ",r,":: Element ",t),new l("CSS value must be a string: "+r);s.isSupported(t)&&t.style.setProperty(n,r)},m=function(e,t){s.isSupported(e)&&e.style.removeProperty(t)},h=function(e,t,n){var r=e.dom();d(r,t,n)},g=function(e,t){var r=e.dom();n.each(t,function(e,t){d(r,t,e)})},x=function(e,t){var r=e.dom();n.each(t,function(e,t){e.fold(function(){m(r,t)},function(e){d(r,t,e)})})},v=function(e,t){var n=e.dom(),r=f.getComputedStyle(n),o=r.getPropertyValue(t),a=""!==o||i.inBody(e)?o:b(n,t);return null===a?void 0:a},b=function(e,t){return s.isSupported(e)?e.style.getPropertyValue(t):""},w=function(e,t){var n=e.dom(),o=b(n,t);return r.from(o).filter(function(e){return e.length>0})},y=function(e){var t={},n=e.dom();if(s.isSupported(n))for(var r=0;r<n.style.length;r++){var o=n.style.item(r);t[o]=n.style[o]}return t},k=function(e,t,n){var r=a.fromTag(e);return h(r,t,n),w(r,t).isSome()},S=function(e,t){var n=e.dom();m(n,t),o.has(e,"style")&&""===c.trim(o.get(e,"style"))&&o.remove(e,"style")},C=function(e,t){var n=o.get(e,"style"),r=t(e);return(void 0===n?o.remove:o.set)(e,"style",n),r},T=function(e,t,n){w(e,n).each(function(e){w(t,n).isNone()&&h(t,n,e)})};return{copy:function(e,t){var n=e.dom(),r=t.dom();s.isSupported(n)&&s.isSupported(r)&&(r.style.cssText=n.style.cssText)},set:h,preserve:C,setAll:g,setOptions:x,remove:S,get:v,getRaw:w,getAllRaw:y,isValidValue:k,reflow:function(e){return e.dom().offsetWidth},transfer:function(e,n,r){u.isElement(e)&&u.isElement(n)&&t.each(r,function(t){T(e,n,t)})}}}),i("ephox.sugar.api.dom.Insert",["ephox.sugar.api.search.Traverse"],function(e){var t=function(t,n){e.parent(t).each(function(e){e.dom().insertBefore(n.dom(),t.dom())})},n=function(n,r){e.nextSibling(n).fold(function(){e.parent(n).each(function(e){o(e,r)})},function(e){t(e,r)})},r=function(t,n){e.firstChild(t).fold(function(){o(t,n)},function(e){t.dom().insertBefore(n.dom(),e.dom())})},o=function(e,t){e.dom().appendChild(t.dom())};return{before:t,after:n,prepend:r,append:o,appendAt:function(n,r,i){e.child(n,i).fold(function(){o(n,r)},function(e){t(e,r)})},wrap:function(e,n){t(e,n),o(n,e)}}}),i("ephox.sugar.api.dom.InsertAll",["ephox.katamari.api.Arr","ephox.sugar.api.dom.Insert"],function(e,t){return{before:function(n,r){e.each(r,function(e){t.before(n,e)})},after:function(n,r){e.each(r,function(e,o){var i=0===o?n:r[o-1];t.after(i,e)})},prepend:function(n,r){e.each(r.slice().reverse(),function(e){t.prepend(n,e)})},append:function(n,r){e.each(r,function(e){t.append(n,e)})}}}),i("ephox.sugar.api.dom.Remove",["ephox.katamari.api.Arr","ephox.sugar.api.dom.InsertAll","ephox.sugar.api.search.Traverse"],function(e,t,n){var r=function(t){t.dom().textContent="",e.each(n.children(t),function(e){o(e)})},o=function(e){var t=e.dom();null!==t.parentNode&&t.parentNode.removeChild(t)};return{empty:r,remove:o,unwrap:function(e){var r=n.children(e);r.length>0&&t.before(e,r),o(e)}}}),i("ephox.snooker.api.CopySelected",["ephox.katamari.api.Arr","ephox.katamari.api.Obj","ephox.katamari.api.Struct","ephox.snooker.model.DetailsList","ephox.snooker.model.Warehouse","ephox.snooker.util.LayerSelector","ephox.sugar.api.properties.Attr","ephox.sugar.api.properties.Css","ephox.sugar.api.node.Element","ephox.sugar.api.dom.Insert","ephox.sugar.api.dom.Remove","ephox.sugar.api.search.Selectors"],function(e,t,n,r,o,i,a,u,s,c,l,p){var f=n.immutable("minRow","minCol","maxRow","maxCol"),d=function(e,n){var r=e.grid().columns(),o=e.grid().rows(),i=o,a=r,u=0,s=0;return t.each(e.access(),function(e){if(n(e)){var t=e.row(),r=t+e.rowspan()-1,o=e.column(),c=o+e.colspan()-1;t<i?i=t:r>u&&(u=r),o<a?a=o:c>s&&(s=c)}}),f(i,a,u,s)},m=function(e,t,n){var r=e[n].element(),o=s.fromTag("td");c.append(o,s.fromTag("br")),(t?c.append:c.prepend)(r,o)},h=function(e,t,n,r){for(var i=t.grid().columns(),a=t.grid().rows(),u=0;u<a;u++)for(var s=!1,c=0;c<i;c++)if(!(u<n.minRow()||u>n.maxRow()||c<n.minCol()||c>n.maxCol())){var l=o.getAt(t,u,c).filter(r).isNone();l?m(e,s,u):s=!0}},g=function(t,n){var r=e.filter(i.firstLayer(t,"tr"),function(e){return 0===e.dom().childElementCount});e.each(r,l.remove),n.minCol()!==n.maxCol()&&n.minRow()!==n.maxRow()||e.each(i.firstLayer(t,"th,td"),function(e){a.remove(e,"rowspan"),a.remove(e,"colspan")}),a.remove(t,"width"),a.remove(t,"height"),u.remove(t,"width"),u.remove(t,"height")};return{extract:function(t,n){var a=function(e){return p.is(e.element(),n)},u=r.fromTable(t),s=o.generate(u),c=d(s,a),f="th:not("+n+"),td:not("+n+")",m=i.filterFirstLayer(t,"th,td",function(e){return p.is(e,f)});return e.each(m,l.remove),h(u,s,c,a),g(t,c),t}}}),i("ephox.sugar.api.dom.Replication",["ephox.sugar.api.properties.Attr","ephox.sugar.api.node.Element","ephox.sugar.api.dom.Insert","ephox.sugar.api.dom.InsertAll","ephox.sugar.api.dom.Remove","ephox.sugar.api.search.Traverse"],function(e,t,n,r,o,i){var a=function(e,n){return t.fromDom(e.dom().cloneNode(n))},u=function(e){return a(e,!1)},s=function(e){return a(e,!0)},c=function(n,r){var o=t.fromTag(r),i=e.clone(n);return e.setAll(o,i),o};return{shallow:u,shallowAs:c,deep:s,copy:function(e,t){var n=c(e,t),o=i.children(s(e));return r.append(n,o),n},mutate:function(e,t){var a=c(e,t);n.before(e,a);var u=i.children(e);return r.append(a,u),o.remove(e),a}}}),i("ephox.sugar.impl.NodeValue",["ephox.sand.api.PlatformDetection","ephox.katamari.api.Option","global!Error"],function(e,t,n){return function(r,o){var i=function(e){if(!r(e))throw new n("Can only get "+o+" value of a "+o+" node");return c(e).getOr("")},a=function(e){try{return u(e)}catch(e){return t.none()}},u=function(e){return r(e)?t.from(e.dom().nodeValue):t.none()},s=e.detect().browser,c=s.isIE()&&10===s.version.major?a:u;return{get:i,getOption:c,set:function(e,t){if(!r(e))throw new n("Can only set raw "+o+" value of a "+o+" node");e.dom().nodeValue=t}}}}),i("ephox.sugar.api.node.Text",["ephox.sugar.api.node.Node","ephox.sugar.impl.NodeValue"],function(e,t){var n=t(e.isText,"text");return{get:function(e){return n.get(e)},getOption:function(e){return n.getOption(e)},set:function(e,t){n.set(e,t)}}}),i("ephox.sugar.api.selection.Awareness",["ephox.katamari.api.Arr","ephox.sugar.api.node.Node","ephox.sugar.api.node.Text","ephox.sugar.api.search.Traverse"],function(e,t,n,r){var o=function(e){return"img"===t.name(e)?1:n.getOption(e).fold(function(){return r.children(e).length},function(e){return e.length})},i=function(e){return n.getOption(e).filter(function(e){return 0!==e.trim().length||e.indexOf(" ")>-1}).isSome()},a=["img","br"];return{getEnd:o,isEnd:function(e,t){return o(e)===t},isStart:function(e,t){return 0===t},isCursorPosition:function(n){return i(n)||e.contains(a,t.name(n))}}}),i("ephox.sugar.api.selection.CursorPosition",["ephox.katamari.api.Option","ephox.sugar.api.search.PredicateFind","ephox.sugar.api.search.Traverse","ephox.sugar.api.selection.Awareness"],function(e,t,n,r){var o=function(t,r){var o=function(t){for(var i=n.children(t),a=i.length-1;a>=0;a--){var u=i[a];if(r(u))return e.some(u);var s=o(u);if(s.isSome())return s}return e.none()};return o(t)};return{first:function(e){return t.descendant(e,r.isCursorPosition)},last:function(e){return o(e,r.isCursorPosition)}}}),i("ephox.snooker.api.TableFill",["ephox.katamari.api.Arr","ephox.katamari.api.Obj","ephox.sugar.api.dom.Compare","ephox.sugar.api.dom.Insert","ephox.sugar.api.dom.Replication","ephox.sugar.api.node.Element","ephox.sugar.api.node.Node","ephox.sugar.api.properties.Attr","ephox.sugar.api.properties.Css","ephox.sugar.api.search.SelectorFilter","ephox.sugar.api.search.Traverse","ephox.sugar.api.selection.CursorPosition"],function(e,t,n,r,o,i,a,u,s,c,l,p){var f=function(){var e=i.fromTag("td");return r.append(e,i.fromTag("br")),e},d=function(e,n,r){var i=o.copy(e,n);return t.each(r,function(e,t){null===e?u.remove(i,t):u.set(i,t,e)}),i},m=function(e){return e},h=function(e){return function(){return i.fromTag("tr",e.dom())}},g=function(t,i,a){return p.first(t).map(function(u){var s=a.join(","),l=c.ancestors(u,s,function(e){return n.eq(e,t)});return e.foldr(l,function(e,t){var n=o.shallow(t);return r.append(e,n),n},i)}).getOr(i)};return{cellOperations:function(e,t,n){var o=function(t){var o=l.owner(t.element()),u=i.fromTag(a.name(t.element()),o.dom()),c=n.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),p=c.length>0?g(t.element(),u,c):u;return r.append(p,i.fromTag("br")),s.copy(t.element(),u),s.remove(u,"height"),1!==t.colspan()&&s.remove(t.element(),"width"),e(t.element(),u),u};return{row:h(t),cell:o,replace:d,gap:f}},paste:function(e){return{row:h(e),cell:f,replace:m,gap:f}}}}),i("ephox.sugar.api.node.Elements",["ephox.katamari.api.Arr","ephox.sugar.api.node.Element","ephox.sugar.api.search.Traverse","global!document"],function(e,t,n,r){return{fromHtml:function(e,o){var i=o||r,a=i.createElement("div");return a.innerHTML=e,n.children(t.fromDom(a))},fromTags:function(n,r){return e.map(n,function(e){return t.fromTag(e,r)})},fromText:function(n,r){return e.map(n,function(e){return t.fromText(e,r)})},fromDom:function(n){return e.map(n,t.fromDom)}}}),i("ephox.boss.common.TagBoundaries",[],function(){return["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"]}),i("ephox.boss.api.DomUniverse",["ephox.boss.common.TagBoundaries","ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.sugar.api.properties.Attr","ephox.sugar.api.dom.Compare","ephox.sugar.api.properties.Css","ephox.sugar.api.node.Element","ephox.sugar.api.dom.Insert","ephox.sugar.api.dom.InsertAll","ephox.sugar.api.node.Node","ephox.sugar.api.search.PredicateFilter","ephox.sugar.api.search.PredicateFind","ephox.sugar.api.dom.Remove","ephox.sugar.api.search.SelectorFilter","ephox.sugar.api.search.SelectorFind","ephox.sugar.api.node.Text","ephox.sugar.api.search.Traverse"],function(e,t,n,r,o,i,a,u,s,c,l,p,f,d,m,h,g){return function(){var x=function(e){return a.fromDom(e.dom().cloneNode(!1))},v=function(n){return!!c.isElement(n)&&("body"===c.name(n)||t.contains(e,c.name(n)))},b=function(e){return!!c.isElement(e)&&t.contains(["br","img","hr","input"],c.name(e))},w=function(e,t){return e.dom().compareDocumentPosition(t.dom())},y=function(e,t){var n=r.clone(e);r.setAll(t,n)};return{up:n.constant({selector:m.ancestor,closest:m.closest,predicate:p.ancestor,all:g.parents}),down:n.constant({selector:d.descendants,predicate:l.descendants}),styles:n.constant({get:i.get,getRaw:i.getRaw,set:i.set,remove:i.remove}),attrs:n.constant({get:r.get,set:r.set,remove:r.remove,copyTo:y}),insert:n.constant({before:u.before,after:u.after,afterAll:s.after,append:u.append,appendAll:s.append,prepend:u.prepend,wrap:u.wrap}),remove:n.constant({unwrap:f.unwrap,remove:f.remove}),create:n.constant({nu:a.fromTag,clone:x,text:a.fromText}),query:n.constant({comparePosition:w,prevSibling:g.prevSibling,nextSibling:g.nextSibling}),property:n.constant({children:g.children,name:c.name,parent:g.parent,isText:c.isText,isComment:c.isComment,isElement:c.isElement,getText:h.get,setText:h.set,isBoundary:v,isEmptyTag:b}),eq:o.eq,is:o.is}}}),i("ephox.robin.parent.Breaker",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.katamari.api.Struct"],function(e,t,n,r){var o=r.immutable("left","right"),i=function(n,r,o){var i=n.property().children(r);return e.findIndex(i,t.curry(n.eq,o)).map(function(e){return{before:t.constant(i.slice(0,e)),after:t.constant(i.slice(e+1))}})},a=function(e,t,n){return i(e,t,n).map(function(n){var r=e.create().clone(t);return e.insert().appendAll(r,n.after()),e.insert().after(t,r),o(t,r)})};return{breakToLeft:function(e,t,n){return i(e,t,n).map(function(r){var i=e.create().clone(t);return e.insert().appendAll(i,r.before().concat([n])),e.insert().appendAll(t,r.after()),e.insert().before(t,i),o(i,t)})},breakToRight:a,breakPath:function(e,t,o,i){var a=r.immutable("first","second","splits"),u=function(t,r,s){var c=a(t,n.none(),s);return o(t)?a(t,r,s):e.property().parent(t).bind(function(r){return i(e,r,t).map(function(e){var t=[{first:e.left,second:e.right}],i=o(r)?r:e.left();return u(i,n.some(e.right()),s.concat(t))}).getOr(c)})};return u(t,n.none(),[])}}}),i("ephox.robin.parent.Shared",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option"],function(e,t,n){var r=function(e,t,n,r){return r(e,t,n[0],n.slice(1))},o=function(t,n,r,o){var a=n(t,r);return e.foldr(o,function(e,r){var o=n(t,r);return i(t,e,o)},a)},i=function(e,n,r){return n.bind(function(n){return r.filter(t.curry(e.eq,n))})};return{oneAll:function(e,t,i){return i.length>0?r(e,t,i,o):n.none()}}}),i("ephox.robin.parent.Subset",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option","global!Math"],function(e,t,n,r){var o=function(e,n){return t.curry(e.eq,n)},i=function(t,i,a,u){var s=t.property().children(i);if(t.eq(i,a[0]))return n.some([a[0]]);if(t.eq(i,u[0]))return n.some([u[0]]);var c=function(n){var r=e.reverse(n),a=e.findIndex(r,o(t,i)).getOr(-1),u=a<r.length-1?r[a+1]:r[a];return e.findIndex(s,o(t,u))},l=c(a),p=c(u);return l.bind(function(e){return p.map(function(t){var n=r.min(e,t),o=r.max(e,t);return s.slice(n,o+1)})})},a=function(n,r,i,a){var u=void 0!==a?a:t.constant(!1),s=[r].concat(n.up().all(r)),c=[i].concat(n.up().all(i)),l=function(t){return e.findIndex(t,u).fold(function(){return t},function(e){return t.slice(0,e+1)})},p=l(s),f=l(c),d=e.find(p,function(t){return e.exists(f,o(n,t))});return{firstpath:t.constant(p),secondpath:t.constant(f),shared:t.constant(d)}};return{subset:function(e,t,n){var r=a(e,t,n);return r.shared().bind(function(t){return i(e,t,r.firstpath(),r.secondpath())})},ancestors:a}}),i("ephox.robin.api.general.Parent",["ephox.robin.parent.Breaker","ephox.robin.parent.Shared","ephox.robin.parent.Subset"],function(e,t,n){return{sharedOne:function(e,n,r){return t.oneAll(e,n,r)},subset:function(e,t,r){return n.subset(e,t,r)},ancestors:function(e,t,r,o){return n.ancestors(e,t,r,o)},breakToLeft:function(t,n,r){return e.breakToLeft(t,n,r)},breakToRight:function(t,n,r){return e.breakToRight(t,n,r)},breakPath:function(t,n,r,o){return e.breakPath(t,n,r,o)}}}),i("ephox.robin.api.dom.DomParent",["ephox.boss.api.DomUniverse","ephox.robin.api.general.Parent"],function(e,t){var n=e();return{sharedOne:function(e,r){return t.sharedOne(n,function(t,n){return e(n)},r)},subset:function(e,r){return t.subset(n,e,r)},ancestors:function(e,r,o){return t.ancestors(n,e,r,o)},breakToLeft:function(e,r){return t.breakToLeft(n,e,r)},breakToRight:function(e,r){return t.breakToRight(n,e,r)},breakPath:function(e,r,o){return t.breakPath(n,e,r,function(e,t,n){return o(t,n)})}}}),i("ephox.snooker.selection.CellBounds",["ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.snooker.model.Warehouse"],function(e,t,n){var r=function(e,t){var n=t.column(),r=t.column()+t.colspan()-1,o=t.row(),i=t.row()+t.rowspan()-1;return n<=e.finishCol()&&r>=e.startCol()&&o<=e.finishRow()&&i>=e.startRow()},o=function(e,t){return t.column()>=e.startCol()&&t.column()+t.colspan()-1<=e.finishCol()&&t.row()>=e.startRow()&&t.row()+t.rowspan()-1<=e.finishRow()};return{inSelection:r,isWithin:o,isRectangular:function(r,i){for(var a=!0,u=e.curry(o,i),s=i.startRow();s<=i.finishRow();s++)for(var c=i.startCol();c<=i.finishCol();c++)a=a&&n.getAt(r,s,c).exists(u);return a?t.some(i):t.none()}}}),i("ephox.snooker.selection.CellGroup",["ephox.snooker.api.Structs","ephox.snooker.model.Warehouse","ephox.snooker.selection.CellBounds","ephox.sugar.api.dom.Compare","global!Math"],function(e,t,n,r,o){var i=function(t,n){return e.bounds(o.min(t.row(),n.row()),o.min(t.column(),n.column()),o.max(t.row()+t.rowspan()-1,n.row()+n.rowspan()-1),o.max(t.column()+t.colspan()-1,n.column()+n.colspan()-1))},a=function(e,n,o){var a=t.findItem(e,n,r.eq),u=t.findItem(e,o,r.eq);return a.bind(function(e){return u.map(function(t){return i(e,t)})})};return{getAnyBox:a,getBox:function(e,t,r){return a(e,t,r).bind(function(t){return n.isRectangular(e,t)})}}}),i("ephox.snooker.selection.CellFinder",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.snooker.model.Warehouse","ephox.snooker.selection.CellBounds","ephox.snooker.selection.CellGroup","ephox.sugar.api.dom.Compare"],function(e,t,n,r,o,i){return{moveBy:function(e,t,r,o){return n.findItem(e,t,i.eq).bind(function(t){var i=r>0?t.row()+t.rowspan()-1:t.row(),a=o>0?t.column()+t.colspan()-1:t.column();return n.getAt(e,i+r,a+o).map(function(e){return e.element()})})},intercepts:function(i,a,u){return o.getAnyBox(i,a,u).map(function(o){var a=n.filterItems(i,t.curry(r.inSelection,o));return e.map(a,function(e){return e.element()})})},parentCell:function(e,t){var r=function(e,t){return i.contains(t,e)};return n.findItem(e,t,r).bind(function(e){return e.element()})}}}),i("ephox.snooker.api.TablePositions",["ephox.snooker.api.TableLookup","ephox.snooker.model.DetailsList","ephox.snooker.model.Warehouse","ephox.snooker.selection.CellFinder","ephox.snooker.selection.CellGroup","ephox.sugar.api.dom.Compare"],function(e,t,n,r,o,i){var a=function(t,n,o){return e.table(t).bind(function(e){var i=l(e);return r.moveBy(i,t,n,o)})},u=function(e,t,n){var o=l(e);return r.intercepts(o,t,n)},s=function(e,t,n,o,a){var u=l(e),s=i.eq(e,n)?t:r.parentCell(u,t),c=i.eq(e,a)?o:r.parentCell(u,o);return r.intercepts(u,s,c)},c=function(e,t,n){var r=l(e);return o.getBox(r,t,n)},l=function(e){var r=t.fromTable(e);return n.generate(r)};return{moveBy:a,intercepts:u,nestedIntercepts:s,getBox:c}}),i("ephox.darwin.selection.CellSelection",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.robin.api.dom.DomParent","ephox.snooker.api.TablePositions","ephox.sugar.api.dom.Compare","ephox.sugar.api.search.SelectorFilter","ephox.sugar.api.search.SelectorFind","ephox.sugar.api.search.Selectors"],function(e,t,n,r,o,i,a,u,s){var c=function(e,t){return u.ancestor(e,"table")},l=function(e,t,a){return i.eq(e,t)?n.some([e]):c(e).bind(function(n){return c(t).bind(function(s){return i.eq(n,s)?o.intercepts(n,e,t):i.contains(n,s)?o.nestedIntercepts(n,e,n,t,s):i.contains(s,n)?o.nestedIntercepts(s,e,n,t,s):r.ancestors(e,t).shared().bind(function(r){return u.closest(r,"table",a).bind(function(r){return o.nestedIntercepts(r,e,n,t,s)})})})})},p=function(e,t){var r=a.descendants(e,t);return r.length>0?n.some(r):n.none()},f=function(t,n){return e.find(t,function(e){return s.is(e,n)})},d=function(e,n,o){return u.descendant(e,n).bind(function(n){return u.descendant(e,o).bind(function(e){return r.sharedOne(c,[n,e]).map(function(r){return{first:t.constant(n),last:t.constant(e),table:t.constant(r)}})})})},m=function(e,n){return u.ancestor(e,"table").bind(function(r){return u.descendant(r,n).bind(function(n){return l(n,e).map(function(r){return{boxes:t.constant(r),start:t.constant(n),finish:t.constant(e)}})})})};return{identify:l,retrieve:p,shiftSelection:function(e,t,n,r,i){return f(e,i).bind(function(e){return o.moveBy(e,t,n).bind(function(e){return m(e,r)})})},getEdges:d}}),i("ephox.darwin.api.TableSelection",["ephox.darwin.selection.CellSelection","ephox.katamari.api.Option","ephox.snooker.api.TablePositions","ephox.sugar.api.dom.Compare","ephox.sugar.api.search.SelectorFind"],function(e,t,n,r,o){return{retrieve:function(t,n){return e.retrieve(t,n)},retrieveBox:function(i,a,u){return e.getEdges(i,a,u).bind(function(e){var a=function(e){return r.eq(i,e)},u=o.ancestor(e.first(),"thead,tfoot,tbody,table",a),s=o.ancestor(e.last(),"thead,tfoot,tbody,table",a);return u.bind(function(o){return s.bind(function(i){return r.eq(o,i)?n.getBox(e.table(),e.first(),e.last()):t.none()})})})}}}),i("tinymce.plugins.table.selection.Ephemera",["ephox.katamari.api.Fun"],function(e){var t="data-mce-selected";return{selected:e.constant(t),selectedSelector:e.constant("td[data-mce-selected],th[data-mce-selected]"),attributeSelector:e.constant("[data-mce-selected]"),firstSelected:e.constant("data-mce-first-selected"),firstSelectedSelector:e.constant("td[data-mce-first-selected],th[data-mce-first-selected]"),lastSelected:e.constant("data-mce-last-selected"),lastSelectedSelector:e.constant("td[data-mce-last-selected],th[data-mce-last-selected]")}}),i("ephox.katamari.api.Adt",["ephox.katamari.api.Arr","ephox.katamari.api.Obj","ephox.katamari.api.Type","global!Array","global!Error","global!console"],function(e,t,n,r,o,i){return{generate:function(a){if(!n.isArray(a))throw new o("cases must be an array");if(0===a.length)throw new o("there must be at least one case");var u=[],s={};return e.each(a,function(c,l){var p=t.keys(c);if(1!==p.length)throw new o("one and only one name per case");var f=p[0],d=c[f];if(void 0!==s[f])throw new o("duplicate key detected:"+f);if("cata"===f)throw new o("cannot have a case named cata (sorry)");if(!n.isArray(d))throw new o("case arguments must be an array");u.push(f),s[f]=function(){var n=arguments.length;if(n!==d.length)throw new o("Wrong number of arguments to case "+f+". Expected "+d.length+" ("+d+"), got "+n);for(var s=new r(n),c=0;c<s.length;c++)s[c]=arguments[c];var p=function(n){var r=t.keys(n);if(u.length!==r.length)throw new o("Wrong number of arguments to match. Expected: "+u.join(",")+"\nActual: "+r.join(","));if(!e.forall(u,function(t){return e.contains(r,t)}))throw new o("Not all branches were specified when using match. Specified: "+r.join(", ")+"\nRequired: "+u.join(", "));return n[f].apply(null,s)};return{fold:function(){if(arguments.length!==a.length)throw new o("Wrong number of arguments to fold. Expected "+a.length+", got "+arguments.length);return arguments[l].apply(null,s)},match:p,log:function(e){i.log(e,{constructors:u,constructor:f,params:s})}}}}),s}}}),i("tinymce.plugins.table.selection.SelectionTypes",["ephox.katamari.api.Adt"],function(e){var t=e.generate([{none:[]},{multiple:["elements"]},{single:["selection"]}]);return{cata:function(e,t,n,r){return e.fold(t,n,r)},none:t.none,multiple:t.multiple,single:t.single}}),i("tinymce.plugins.table.queries.CellOperations",["ephox.darwin.api.TableSelection","ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.sugar.api.properties.Attr","tinymce.plugins.table.selection.Ephemera","tinymce.plugins.table.selection.SelectionTypes"],function(e,t,n,r,o,i,a){var u=function(e,t){return a.cata(t.get(),n.constant([]),n.identity,n.constant([e]))},s=function(e,n){var i=function(e){return o.has(e,"rowspan")&&parseInt(o.get(e,"rowspan"),10)>1||o.has(e,"colspan")&&parseInt(o.get(e,"colspan"),10)>1},a=u(e,n);return a.length>0&&t.forall(a,i)?r.some(a):r.none()};return{mergable:function(t,o){return a.cata(o.get(),r.none,function(o,a){return 0===o.length?r.none():e.retrieveBox(t,i.firstSelectedSelector(),i.lastSelectedSelector()).bind(function(e){return o.length>1?r.some({bounds:n.constant(e),cells:n.constant(o)}):r.none()})},r.none)},unmergable:s,selection:u}}),i("tinymce.plugins.table.queries.TableTargets",["ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.katamari.api.Struct","tinymce.plugins.table.queries.CellOperations"],function(e,t,n,r){var o=function(n){return{element:e.constant(n),mergable:t.none,unmergable:t.none,selection:e.constant([n])}},i=function(t,n,o){return{element:e.constant(o),mergable:e.constant(r.mergable(n,t)),unmergable:e.constant(r.unmergable(o,t)),selection:e.constant(r.selection(o,t))}},a=function(e){return o(e)},u=n.immutable("element","clipboard","generators");return{noMenu:o,forMenu:i,notCell:a,paste:u,pasteRows:function(n,o,i,a,u){return{element:e.constant(i),mergable:t.none,unmergable:t.none,selection:e.constant(r.selection(i,n)),clipboard:e.constant(a),generators:e.constant(u)}}}}),i("tinymce.plugins.table.actions.Clipboard",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.snooker.api.CopySelected","ephox.snooker.api.TableFill","ephox.snooker.api.TableLookup","ephox.sugar.api.dom.Replication","ephox.sugar.api.node.Element","ephox.sugar.api.node.Elements","ephox.sugar.api.node.Node","tinymce.plugins.table.queries.TableTargets","tinymce.plugins.table.selection.Ephemera","tinymce.plugins.table.selection.SelectionTypes"],function(e,t,n,r,o,i,a,u,s,c,l,p,f){var d=function(e){return i.table(e[0]).map(a.deep).map(function(e){return[r.extract(e,p.attributeSelector())]})},m=function(e,t){return e.selection.serializer.serialize(t.dom(),{})};return{registerEvents:function(r,a,p,h){r.on("BeforeGetContent",function(n){var o=function(t){n.preventDefault(),d(t).each(function(t){n.content=e.map(t,function(e){return m(r,e)}).join("")})};!0===n.selection&&f.cata(a.get(),t.noop,o,t.noop)}),r.on("BeforeSetContent",function(t){if(!0===t.selection&&!0===t.paste){n.from(r.dom.getParent(r.selection.getStart(),"th,td")).each(function(n){var a=u.fromDom(n);i.table(a).bind(function(n){var i=e.filter(s.fromHtml(t.content),function(e){return"meta"!==c.name(e)});if(1===i.length&&"table"===c.name(i[0])){t.preventDefault();var f=u.fromDom(r.getDoc()),d=o.paste(f),m=l.paste(a,i[0],d);p.pasteCells(n,m).each(function(e){r.selection.setRng(e),r.focus(),h.clear(n)})}})})}})}}}),i("ephox.snooker.operate.Render",["ephox.sugar.api.properties.Attr","ephox.sugar.api.properties.Css","ephox.sugar.api.node.Element","ephox.sugar.api.dom.Insert","ephox.sugar.api.dom.InsertAll"],function(e,t,n,r,o){var i=function(){return n.fromTag("table")},a=function(){return n.fromTag("tbody")},u=function(){return n.fromTag("tr")},s=function(){return n.fromTag("th")},c=function(){return n.fromTag("td")};return{render:function(l,p,f,d){var m=i();t.setAll(m,{"border-collapse":"collapse",width:"100%"}),e.set(m,"border","1");var h=a();r.append(m,h);for(var g=[],x=0;x<l;x++){for(var v=u(),b=0;b<p;b++){var w=x<f||b<d?s():c();b<d&&e.set(w,"scope","row"),x<f&&e.set(w,"scope","col"),r.append(w,n.fromTag("br")),t.set(w,"width",100/p+"%"),r.append(v,w)}g.push(v)}return o.append(h,g),m}}}),i("ephox.snooker.api.TableRender",["ephox.snooker.operate.Render"],function(e){return{render:e.render}}),i("ephox.sugar.api.properties.Html",["ephox.sugar.api.node.Element","ephox.sugar.api.node.Elements","ephox.sugar.api.dom.Insert","ephox.sugar.api.dom.InsertAll","ephox.sugar.api.dom.Remove","ephox.sugar.api.search.Traverse"],function(e,t,n,r,o,i){var a=function(e){return e.dom().innerHTML};return{get:a,set:function(a,u){var s=i.owner(a),c=s.dom(),l=e.fromDom(c.createDocumentFragment()),p=t.fromHtml(u,c);r.append(l,p),o.empty(a),n.append(a,l)},getOuter:function(t){var r=e.fromTag("div"),o=e.fromDom(t.dom().cloneNode(!0));return n.append(r,o),a(r)}}}),i("tinymce.plugins.table.actions.InsertTable",["ephox.katamari.api.Fun","ephox.snooker.api.TableRender","ephox.sugar.api.node.Element","ephox.sugar.api.properties.Attr","ephox.sugar.api.properties.Html","ephox.sugar.api.search.SelectorFind"],function(e,t,n,r,o,i){var a=function(e,t){e.selection.select(t.dom(),!0),e.selection.collapse(!0)},u=function(t,n){i.descendant(n,"td,th").each(e.curry(a,t))};return{insert:function(e,i,a){var s,c=t.render(a,i,0,0);r.set(c,"id","__mce");var l=o.getOuter(c);return e.insertContent(l),s=e.dom.get("__mce"),e.dom.setAttrib(s,"id",null),e.$("tr",s).each(function(t,n){e.fire("newrow",{node:n}),e.$("th,td",n).each(function(t,n){e.fire("newcell",{node:n})})}),e.dom.setAttribs(s,e.settings.table_default_attributes||{}),e.dom.setStyles(s,e.settings.table_default_styles||{}),u(e,n.fromDom(s)),s}}}),i("ephox.sugar.impl.Dimension",["ephox.katamari.api.Type","ephox.katamari.api.Arr","ephox.sugar.api.properties.Css","ephox.sugar.impl.Style"],function(e,t,n,r){return function(o,i){var a=function(t,n){if(!e.isNumber(n)&&!n.match(/^[0-9]+$/))throw o+".set accepts only positive integer values. Value was "+n;var i=t.dom();r.isSupported(i)&&(i.style[o]=n+"px")},u=function(e){var t=i(e);if(t<=0||null===t){var r=n.get(e,o);return parseFloat(r)||0}return t},s=u,c=function(e,r){return t.foldl(r,function(t,r){var o=n.get(e,r),i=void 0===o?0:parseInt(o,10);return isNaN(i)?t:t+i},0)};return{set:a,get:u,getOuter:s,aggregate:c,max:function(e,t,n){var r=c(e,n);return t>r?t-r:0}}}}),i("ephox.sugar.api.view.Height",["ephox.sugar.api.node.Body","ephox.sugar.api.properties.Css","ephox.sugar.impl.Dimension"],function(e,t,n){var r=n("height",function(t){return e.inBody(t)?t.dom().getBoundingClientRect().height:t.dom().offsetHeight});return{set:function(e,t){r.set(e,t)},get:function(e){return r.get(e)},getOuter:function(e){return r.getOuter(e)},setMax:function(e,n){var o=["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"],i=r.max(e,n,o);t.set(e,"max-height",i+"px")}}}),i("ephox.sugar.api.view.Width",["ephox.sugar.api.properties.Css","ephox.sugar.impl.Dimension"],function(e,t){var n=t("width",function(e){return e.dom().offsetWidth});return{set:function(e,t){n.set(e,t)},get:function(e){return n.get(e)},getOuter:function(e){return n.getOuter(e)},setMax:function(t,r){var o=["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"],i=n.max(t,r,o);e.set(t,"max-width",i+"px")}}}),i("ephox.snooker.resize.RuntimeSize",["ephox.sand.api.PlatformDetection","ephox.sugar.api.properties.Css","ephox.sugar.api.view.Height","ephox.sugar.api.view.Width"],function(e,t,n,r){var o=e.detect(),i=function(){return o.browser.isIE()||o.browser.isEdge()},a=function(e,t){var n=parseFloat(e);return isNaN(n)?t:n},u=function(e,n,r){return a(t.get(e,n),r)},s=function(e){var n=u(e,"padding-top",0),r=u(e,"padding-bottom",0),o=u(e,"border-top-width",0),i=u(e,"border-bottom-width",0),a=e.dom().getBoundingClientRect().height,s=t.get(e,"box-sizing"),c=o+i;return"border-box"===s?a:a-n-r-c};return{getWidth:function(e){return u(e,"width",r.get(e))},getHeight:function(e){return i()?s(e):u(e,"height",n.get(e))}}}),i("ephox.snooker.resize.Sizes",["ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.katamari.api.Strings","ephox.snooker.api.TableLookup","ephox.snooker.resize.RuntimeSize","ephox.sugar.api.node.Node","ephox.sugar.api.properties.Attr","ephox.sugar.api.properties.Css","ephox.sugar.api.view.Height","ephox.sugar.api.view.Width","global!Math","global!parseInt"],function(e,t,n,r,o,i,a,u,s,c,l,p){var f=/(\d+(\.\d+)?)(\w|%)*/,d=/(\d+(\.\d+)?)%/,m=/(\d+(\.\d+)?)px|em/,h=function(e,t){u.set(e,"width",t+"px")},g=function(e,t){u.set(e,"width",t+"%")},x=function(e,t){u.set(e,"height",t+"px")},v=function(e){return u.getRaw(e,"height").getOrThunk(function(){return o.getHeight(e)+"px"})},b=function(e,t,n,o){var i=r.table(e).map(function(e){var r=n(e);return l.floor(t/100*r)}).getOr(t);return o(e,i),i},w=function(e,t,r,o){var a=p(e,10);return n.endsWith(e,"%")&&"table"!==i.name(t)?b(t,a,r,o):a},y=function(e){var t=v(e);return t?w(t,e,s.get,x):s.get(e)},k=function(e,t,n){return n(e)/S(e,t)},S=function(e,t){return a.has(e,t)?p(a.get(e,t),10):1},C=function(e){return u.getRaw(e,"width").fold(function(){return t.from(a.get(e,"width"))},function(e){return t.some(e)})},T=function(e,t){return e/t.pixelWidth()*100},R=function(e,t,n){if(d.test(t)){var r=d.exec(t);return parseFloat(r[1],10)}var o=c.get(e),i=p(o,10);return T(i,n)},A=function(e,t){return C(e).fold(function(){var n=c.get(e),r=p(n,10);return T(r,t)},function(n){return R(e,n,t)})},D=function(e,t){return e/100*t.pixelWidth()},O=function(e,t,n){if(m.test(t)){var r=m.exec(t);return p(r[1],10)}if(d.test(t)){var o=d.exec(t),i=parseFloat(o[1],10);return D(i,n)}var a=c.get(e);return p(a,10)},E=function(e,t){return C(e).fold(function(){
var t=c.get(e);return p(t,10)},function(n){return O(e,n,t)})},N=function(e){return k(e,"rowspan",y)},B=function(n){return C(n).bind(function(n){if(f.test(n)){var r=f.exec(n);return t.some({width:e.constant(r[1]),unit:e.constant(r[3])})}return t.none()})},F=function(e,t,n){u.set(e,"width",t+n)};return{percentageBasedSizeRegex:e.constant(d),pixelBasedSizeRegex:e.constant(m),setPixelWidth:h,setPercentageWidth:g,setHeight:x,getPixelWidth:E,getPercentageWidth:A,getGenericWidth:B,setGenericWidth:F,getHeight:N,getRawWidth:C}}),i("ephox.snooker.api.CellMutations",["ephox.snooker.resize.Sizes"],function(e){return{halve:function(t,n){e.getGenericWidth(t).each(function(r){var o=r.width()/2;e.setGenericWidth(t,o,r.unit()),e.setGenericWidth(n,o,r.unit())})}}}),i("ephox.sugar.api.view.Position",["ephox.katamari.api.Fun"],function(e){var t=function(n,r){var o=function(e,o){return t(n+e,r+o)};return{left:e.constant(n),top:e.constant(r),translate:o}};return t}),i("ephox.sugar.api.dom.Dom",["ephox.katamari.api.Fun","ephox.sugar.api.dom.Compare","ephox.sugar.api.node.Element","ephox.sugar.api.node.Node","ephox.sugar.api.search.PredicateFind","global!document"],function(e,t,n,r,o,i){return{attached:function(r,a){var u=a||n.fromDom(i.documentElement);return o.ancestor(r,e.curry(t.eq,u)).isSome()},windowOf:function(e){var t=e.dom();return t===t.window?e:r.isDocument(e)?t.defaultView||t.parentWindow:null}}}),i("ephox.sugar.api.view.Location",["ephox.sugar.api.view.Position","ephox.sugar.api.dom.Dom","ephox.sugar.api.node.Element"],function(e,t,n){var r=function(t){var n=t.getBoundingClientRect();return e(n.left,n.top)},o=function(e,t){return void 0!==e?e:void 0!==t?t:0},i=function(e){var r=e.dom().ownerDocument,i=r.body,a=t.windowOf(n.fromDom(r)),s=r.documentElement,c=o(a.pageYOffset,s.scrollTop),l=o(a.pageXOffset,s.scrollLeft),p=o(s.clientTop,i.clientTop),f=o(s.clientLeft,i.clientLeft);return u(e).translate(l-f,c-p)},a=function(t){var n=t.dom();return e(n.offsetLeft,n.offsetTop)},u=function(o){var i=o.dom(),a=i.ownerDocument,u=a.body,s=n.fromDom(a.documentElement);return u===i?e(u.offsetLeft,u.offsetTop):t.attached(o,s)?r(i):e(0,0)};return{absolute:i,relative:a,viewport:u}}),i("ephox.snooker.resize.BarPositions",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Struct","ephox.sugar.api.view.Height","ephox.sugar.api.view.Location","ephox.sugar.api.view.Width"],function(e,t,n,r,o,i){var a=n.immutable("row","y"),u=n.immutable("col","x"),s=function(e){return o.absolute(e).left()+i.getOuter(e)},c=function(e){return o.absolute(e).left()},l=function(e,t){return u(e,c(t))},p=function(e,t){return u(e,s(t))},f=function(e){return o.absolute(e).top()},d=function(e,t){return a(e,f(t))},m=function(e,t){return a(e,f(t)+r.getOuter(t))},h=function(t,n,r){if(0===r.length)return[];var o=e.map(r.slice(1),function(e,n){return e.map(function(e){return t(n,e)})}),i=r[r.length-1].map(function(e){return n(r.length-1,e)});return o.concat([i])},g=function(e,t){return-e},x={delta:t.identity,positions:t.curry(h,d,m),edge:f},v={delta:t.identity,edge:c,positions:t.curry(h,l,p)};return{height:x,rtl:{delta:g,edge:s,positions:t.curry(h,p,l)},ltr:v}}),i("ephox.snooker.api.ResizeDirection",["ephox.snooker.resize.BarPositions"],function(e){return{ltr:e.ltr,rtl:e.rtl}}),i("ephox.snooker.api.TableDirection",["ephox.snooker.api.ResizeDirection"],function(e){return function(t){var n=function(n){return t(n).isRtl()?e.rtl:e.ltr},r=function(e,t){return n(t).delta(e,t)},o=function(e,t){return n(t).positions(e,t)};return{delta:r,edge:function(e){return n(e).edge(e)},positions:o}}}),i("ephox.snooker.api.TableGridSize",["ephox.snooker.model.DetailsList","ephox.snooker.model.Warehouse"],function(e,t){return{getGridSize:function(n){var r=e.fromTable(n);return t.generate(r).grid()}}}),i("ephox.katamari.api.Cell",[],function(){var e=function(t){var n=t,r=function(){return n};return{get:r,set:function(e){n=e},clone:function(){return e(r())}}};return e}),i("ephox.katamari.api.Contracts",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Obj","ephox.katamari.api.Type","ephox.katamari.util.BagUtils","global!Error"],function(e,t,n,r,o,i){var a=function(e,t){return u(e,t,{validate:r.isFunction,label:"function"})},u=function(t,r,a){if(0===r.length)throw new i("You must specify at least one required field.");return o.validateStrArr("required",r),o.checkDupes(r),function(i){var u=n.keys(i);e.forall(r,function(t){return e.contains(u,t)})||o.reqMessage(r,u),t(r,u);var s=e.filter(r,function(e){return!a.validate(i[e],e)});return s.length>0&&o.invalidTypeMessage(s,a.label),i}},s=function(t,n){var r=e.filter(n,function(n){return!e.contains(t,n)});r.length>0&&o.unsuppMessage(r)},c=t.noop;return{exactly:t.curry(a,s),ensure:t.curry(a,c),ensureWith:t.curry(u,c)}}),i("ephox.snooker.api.Generators",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.katamari.api.Cell","ephox.katamari.api.Contracts","ephox.sugar.api.properties.Attr","ephox.sugar.api.properties.Css","global!parseInt"],function(e,t,n,r,o,i,a,u){var s=function(e){var n=i.has(e,"colspan")?u(i.get(e,"colspan"),10):1,r=i.has(e,"rowspan")?u(i.get(e,"rowspan"),10):1;return{element:t.constant(e),colspan:t.constant(n),rowspan:t.constant(r)}},c=function(e,t){f(e);var o=r(n.none()),i=void 0!==t?t:s,a=function(t){return e.cell(t)},u=function(e){var t=i(e);return a(t)},c=function(e){var t=u(e);return o.get().isNone()&&o.set(n.some(t)),l=n.some({item:e,replacement:t}),t},l=n.none();return{getOrInit:function(e,t){return l.fold(function(){return c(e)},function(n){return t(e,n.item)?n.replacement:c(e)})},cursor:o.get}},l=function(t,o){return function(i){var a=r(n.none());f(i);var u=[],s=function(t,n){return e.find(u,function(e){return n(e.item,t)})},c=function(e){var r=i.replace(e,o,{scope:t});return u.push({item:e,sub:r}),a.get().isNone()&&a.set(n.some(r)),r};return{replaceOrInit:function(e,t){return s(e,t).fold(function(){return c(e)},function(n){return t(e,n.item)?n.sub:c(e)})},cursor:a.get}}},p=function(e){f(e);var o=r(n.none());return{combine:function(r){return o.get().isNone()&&o.set(n.some(r)),function(){var n=e.cell({element:t.constant(r),colspan:t.constant(1),rowspan:t.constant(1)});return a.remove(n,"width"),a.remove(r,"width"),n}},cursor:o.get}},f=o.exactly(["cell","row","replace","gap"]);return{modification:c,transform:l,merging:p}}),i("ephox.robin.api.general.Structure",["ephox.katamari.api.Arr"],function(e){var t=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],n=function(t,n){var r=t.property().name(n);return e.contains(["ol","ul"],r)},r=function(n,r){var o=n.property().name(r);return e.contains(t,o)},o=function(t,n){var r=t.property().name(n);return e.contains(["address","pre","p","h1","h2","h3","h4","h5","h6"],r)},i=function(t,n){var r=t.property().name(n);return e.contains(["h1","h2","h3","h4","h5","h6"],r)},a=function(t,n){return e.contains(["div","li","td","th","blockquote","body","caption"],t.property().name(n))},u=function(t,n){return e.contains(["br","img","hr","input"],t.property().name(n))};return{isBlock:r,isList:n,isFormatting:o,isHeading:i,isContainer:a,isEmptyTag:u,isFrame:function(e,t){return"iframe"===e.property().name(t)},isInline:function(e,t){return!(r(e,t)||u(e,t))&&"li"!==e.property().name(t)}}}),i("ephox.robin.api.dom.DomStructure",["ephox.boss.api.DomUniverse","ephox.robin.api.general.Structure"],function(e,t){var n=e();return{isBlock:function(e){return t.isBlock(n,e)},isList:function(e){return t.isList(n,e)},isFormatting:function(e){return t.isFormatting(n,e)},isHeading:function(e){return t.isHeading(n,e)},isContainer:function(e){return t.isContainer(n,e)},isEmptyTag:function(e){return t.isEmptyTag(n,e)},isFrame:function(e){return t.isFrame(n,e)},isInline:function(e){return t.isInline(n,e)}}}),i("ephox.snooker.api.TableContent",["ephox.katamari.api.Arr","ephox.robin.api.dom.DomStructure","ephox.sugar.api.dom.Compare","ephox.sugar.api.dom.InsertAll","ephox.sugar.api.dom.Remove","ephox.sugar.api.node.Element","ephox.sugar.api.node.Node","ephox.sugar.api.node.Text","ephox.sugar.api.search.PredicateFind","ephox.sugar.api.search.Traverse","ephox.sugar.api.selection.CursorPosition"],function(e,t,n,r,o,i,a,u,s,c,l){return{merge:function(p){var f=function(e){return"br"===a.name(e)},d=function(t){return e.forall(t,function(e){return f(e)||a.isText(e)&&0===u.get(e).trim().length})},m=function(e){return"li"===a.name(e)||s.ancestor(e,t.isList).isSome()},h=function(e){return c.nextSibling(e).map(function(e){return!!t.isBlock(e)||(t.isEmptyTag(e)?"img"!==a.name(e):void 0)}).getOr(!1)},g=function(e){return l.last(e).bind(function(r){var o=h(r);return c.parent(r).map(function(a){return!0===o||m(a)||f(r)||t.isBlock(a)&&!n.eq(e,a)?[]:[i.fromTag("br")]})}).getOr([])},x=function(){var t=e.bind(p,function(e){var t=c.children(e);return d(t)?[]:t.concat(g(e))});return 0===t.length?[i.fromTag("br")]:t}();o.empty(p[0]),r.append(p[0],x)}}}),i("ephox.snooker.model.GridRow",["ephox.katamari.api.Arr","ephox.snooker.api.Structs"],function(e,t){var n=function(e,t,n){var r=e.cells(),i=r.slice(0,t),a=r.slice(t),u=i.concat([n]).concat(a);return o(e,u)},r=function(e,t,n){e.cells()[t]=n},o=function(e,n){return t.rowcells(n,e.section())},i=function(n,r){var o=n.cells(),i=e.map(o,r);return t.rowcells(i,n.section())},a=function(e,t){return e.cells()[t]};return{addCell:n,setCells:o,mutateCell:r,getCell:a,getCellElement:function(e,t){return a(e,t).element()},mapCells:i,cellLength:function(e){return e.cells().length}}}),i("ephox.katamari.api.Merger",["ephox.katamari.api.Type","global!Array","global!Error"],function(e,t,n){var r=function(e,t){return t},o=function(t,n){return e.isObject(t)&&e.isObject(n)?a(t,n):n},i=function(e){return function(){for(var r=new t(arguments.length),o=0;o<r.length;o++)r[o]=arguments[o];if(0===r.length)throw new n("Can't merge zero objects");for(var i={},a=0;a<r.length;a++){var u=r[a];for(var s in u)u.hasOwnProperty(s)&&(i[s]=e(i[s],u[s]))}return i}},a=i(o),u=i(r);return{deepMerge:a,merge:u}}),i("ephox.katamari.api.Options",["ephox.katamari.api.Option"],function(e){return{cat:function(e){for(var t=[],n=function(e){t.push(e)},r=0;r<e.length;r++)e[r].each(n);return t},findMap:function(t,n){for(var r=0;r<t.length;r++){var o=n(t[r],r);if(o.isSome())return o}return e.none()},liftN:function(t,n){for(var r=[],o=0;o<t.length;o++){var i=t[o];if(!i.isSome())return e.none();r.push(i.getOrDie())}return e.some(n.apply(null,r))}}}),i("ephox.snooker.model.TableGrid",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.snooker.model.GridRow"],function(e,t,n){var r=function(t,r){return e.map(t,function(e){return n.getCell(e,r)})},o=function(e,t){return e[t]},i=function(t,n){if(0===t.length)return 0;var r=t[0];return e.findIndex(t,function(e){return!n(r.element(),e.element())}).fold(function(){return t.length},function(e){return e})};return{subgrid:function(e,n,a,u){var s=o(e,n).cells().slice(a),c=i(s,u),l=r(e,a).slice(n),p=i(l,u);return{colspan:t.constant(c),rowspan:t.constant(p)}}}}),i("ephox.snooker.model.Transitions",["ephox.katamari.api.Arr","ephox.snooker.api.Structs","ephox.snooker.model.TableGrid","ephox.snooker.model.Warehouse"],function(e,t,n,r){return{toDetails:function(r,o){var i=e.map(r,function(t,n){return e.map(t.cells(),function(e,t){return!1})}),a=function(e,t,n,r){for(var o=e;o<e+n;o++)for(var a=t;a<t+r;a++)i[o][a]=!0};return e.map(r,function(u,s){var c=e.bind(u.cells(),function(e,u){if(!1===i[s][u]){var c=n.subgrid(r,s,u,o);return a(s,u,c.rowspan(),c.colspan()),[t.detailnew(e.element(),c.rowspan(),c.colspan(),e.isNew())]}return[]});return t.rowdetails(c,u.section())})},toGrid:function(e,n,o){for(var i=[],a=0;a<e.grid().rows();a++){for(var u=[],s=0;s<e.grid().columns();s++){var c=r.getAt(e,a,s).map(function(e){return t.elementnew(e.element(),o)}).getOrThunk(function(){return t.elementnew(n.gap(),!0)});u.push(c)}var l=t.rowcells(u,e.all()[a].section());i.push(l)}return i}}}),i("ephox.snooker.operate.Redraw",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.sugar.api.properties.Attr","ephox.sugar.api.node.Element","ephox.sugar.api.dom.Insert","ephox.sugar.api.dom.InsertAll","ephox.sugar.api.dom.Remove","ephox.sugar.api.dom.Replication","ephox.sugar.api.search.SelectorFind","ephox.sugar.api.search.Traverse"],function(e,t,n,r,o,i,a,u,s,c){var l=function(e,t,r,o){r===o?n.remove(e,t):n.set(e,t,r)};return{render:function(n,u){var p=[],f=[],d=function(t,u){var d=s.child(n,u).getOrThunk(function(){var e=r.fromTag(u,c.owner(n).dom());return o.append(n,e),e});a.empty(d);var m=e.map(t,function(t){t.isNew()&&p.push(t.element());var n=t.element();return a.empty(n),e.each(t.cells(),function(e){e.isNew()&&f.push(e.element()),l(e.element(),"colspan",e.colspan(),1),l(e.element(),"rowspan",e.rowspan(),1),o.append(n,e.element())}),n});i.append(d,m)},m=function(e){s.child(n,e).bind(a.remove)},h=function(e,t){e.length>0?d(e,t):m(t)},g=[],x=[],v=[];return e.each(u,function(e){switch(e.section()){case"thead":g.push(e);break;case"tbody":x.push(e);break;case"tfoot":v.push(e)}}),h(g,"thead"),h(x,"tbody"),h(v,"tfoot"),{newRows:t.constant(p),newCells:t.constant(f)}},copy:function(t){return e.map(t,function(t){var n=u.shallow(t.element());return e.each(t.cells(),function(e){var t=u.deep(e.element());l(t,"colspan",e.colspan(),1),l(t,"rowspan",e.rowspan(),1),o.append(n,t)}),n})}}}),i("ephox.snooker.util.Util",["ephox.katamari.api.Arr","ephox.katamari.api.Option","ephox.katamari.api.Options","global!Math"],function(e,t,n,r){return{repeat:function(e,t){for(var n=[],r=0;r<e;r++)n.push(t(r));return n},range:function(e,t){for(var n=[],r=e;r<t;r++)n.push(r);return n},unique:function(t,n){var r=[];return e.each(t,function(e,o){o<t.length-1&&!n(e,t[o+1])?r.push(e):o===t.length-1&&r.push(e)}),r},deduce:function(o,i){if(i<0||i>=o.length-1)return t.none();var a=o[i].fold(function(){var t=e.reverse(o.slice(0,i));return n.findMap(t,function(e,t){return e.map(function(e){return{value:e,delta:t+1}})})},function(e){return t.some({value:e,delta:0})}),u=o[i+1].fold(function(){var e=o.slice(i+1);return n.findMap(e,function(e,t){return e.map(function(e){return{value:e,delta:t+1}})})},function(e){return t.some({value:e,delta:1})});return a.bind(function(e){return u.map(function(t){var n=t.delta+e.delta;return r.abs(t.value-e.value)/n})})}}}),i("ephox.snooker.lookup.Blocks",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.snooker.model.Warehouse","ephox.snooker.util.Util"],function(e,t,n,r,o){var i=function(n){var i=n.grid(),u=o.range(0,i.columns()),s=o.range(0,i.rows());return e.map(u,function(o){return a(function(){return e.bind(s,function(e){return r.getAt(n,e,o).filter(function(e){return e.column()===o}).fold(t.constant([]),function(e){return[e]})})},function(e){return 1===e.colspan()},function(){return r.getAt(n,0,o)})})},a=function(t,r,o){var i=t();return e.find(i,r).orThunk(function(){return n.from(i[0]).orThunk(o)}).map(function(e){return e.element()})};return{columns:i,rows:function(n){var i=n.grid(),u=o.range(0,i.rows()),s=o.range(0,i.columns());return e.map(u,function(o){return a(function(){return e.bind(s,function(e){return r.getAt(n,o,e).filter(function(e){return e.row()===o}).fold(t.constant([]),function(e){return[e]})})},function(e){return 1===e.rowspan()},function(){return r.getAt(n,o,0)})})}}}),i("ephox.snooker.resize.Bar",["ephox.sugar.api.properties.Attr","ephox.sugar.api.properties.Css","ephox.sugar.api.node.Element"],function(e,t,n){return{col:function(r,o,i,a,u){var s=n.fromTag("div");return t.setAll(s,{position:"absolute",left:o-a/2+"px",top:i+"px",height:u+"px",width:a+"px"}),e.set(s,"data-column",r),s},row:function(r,o,i,a,u){var s=n.fromTag("div");return t.setAll(s,{position:"absolute",left:o+"px",top:i-u/2+"px",height:u+"px",width:a+"px"}),e.set(s,"data-row",r),s}}}),i("ephox.katamari.api.Namespace",[],function(){return{css:function(e){var t=e.replace(/\./g,"-");return{resolve:function(e){return t+"-"+e}}}}}),i("ephox.snooker.style.Styles",["ephox.katamari.api.Namespace"],function(e){return{resolve:e.css("ephox-snooker").resolve}}),i("ephox.sugar.api.properties.Toggler",[],function(){return function(e,t,n){var r=n||!1,o=function(){t(),r=!0},i=function(){e(),r=!1};return{on:o,off:i,toggle:function(){(r?i:o)()},isOn:function(){return r}}}}),i("ephox.sugar.api.properties.AttrList",["ephox.katamari.api.Arr","ephox.sugar.api.properties.Attr"],function(e,t){var n=function(e,n){var r=t.get(e,n);return void 0===r||""===r?[]:r.split(" ")};return{read:n,add:function(e,r,o){var i=n(e,r),a=i.concat([o]);t.set(e,r,a.join(" "))},remove:function(r,o,i){var a=e.filter(n(r,o),function(e){return e!==i});a.length>0?t.set(r,o,a.join(" ")):t.remove(r,o)}}}),i("ephox.sugar.impl.ClassList",["ephox.katamari.api.Arr","ephox.sugar.api.properties.AttrList"],function(e,t){var n=function(e){return void 0!==e.dom().classList},r=function(e){return t.read(e,"class")},o=function(e,n){return t.add(e,"class",n)},i=function(e,n){return t.remove(e,"class",n)};return{get:r,add:o,remove:i,toggle:function(t,n){e.contains(r(t),n)?i(t,n):o(t,n)},supports:n}}),i("ephox.sugar.api.properties.Class",["ephox.sugar.api.properties.Toggler","ephox.sugar.api.properties.Attr","ephox.sugar.impl.ClassList"],function(e,t,n){var r=function(e,t){n.supports(e)?e.dom().classList.add(t):n.add(e,t)},o=function(e){0===(n.supports(e)?e.dom().classList:n.get(e)).length&&t.remove(e,"class")},i=function(e,t){if(n.supports(e)){e.dom().classList.remove(t)}else n.remove(e,t);o(e)},a=function(e,t){return n.supports(e)?e.dom().classList.toggle(t):n.toggle(e,t)},u=function(t,r){var o=n.supports(t),i=t.dom().classList;return e(function(){o?i.remove(r):n.remove(t,r)},function(){o?i.add(r):n.add(t,r)},s(t,r))},s=function(e,t){return n.supports(e)&&e.dom().classList.contains(t)};return{add:r,remove:i,toggle:a,toggler:u,has:s}}),i("ephox.snooker.resize.Bars",["ephox.katamari.api.Arr","ephox.snooker.lookup.Blocks","ephox.snooker.model.DetailsList","ephox.snooker.model.Warehouse","ephox.snooker.resize.Bar","ephox.snooker.style.Styles","ephox.sugar.api.dom.Insert","ephox.sugar.api.dom.Remove","ephox.sugar.api.properties.Class","ephox.sugar.api.properties.Css","ephox.sugar.api.search.SelectorFilter","ephox.sugar.api.view.Height","ephox.sugar.api.view.Location","ephox.sugar.api.view.Width"],function(e,t,n,r,o,i,a,u,s,c,l,p,f,d){var m=i.resolve("resizer-bar"),h=i.resolve("resizer-rows"),g=i.resolve("resizer-cols"),x=function(t){var n=l.descendants(t.parent(),"."+m);e.each(n,u.remove)},v=function(t,n,r){var o=t.origin();e.each(n,function(e,n){e.each(function(e){var n=r(o,e);s.add(n,m),a.append(t.parent(),n)})})},b=function(e,t,n,r){v(e,t,function(e,t){var i=o.col(t.col(),t.x()-e.left(),n.top()-e.top(),7,r);return s.add(i,g),i})},w=function(e,t,n,r){v(e,t,function(e,t){var i=o.row(t.row(),n.left()-e.left(),t.y()-e.top(),r,7);return s.add(i,h),i})},y=function(e,t,n,r,o,i){var a=f.absolute(t),u=n.length>0?o.positions(n,t):[];w(e,u,a,d.getOuter(t));var s=r.length>0?i.positions(r,t):[];b(e,s,a,p.getOuter(t))},k=function(e,o,i,a){x(e);var u=n.fromTable(o),s=r.generate(u),c=t.rows(s),l=t.columns(s);y(e,o,c,l,i,a)},S=function(t,n){var r=l.descendants(t.parent(),"."+m);e.each(r,n)};return{refresh:k,hide:function(e){S(e,function(e){c.set(e,"display","none")})},show:function(e){S(e,function(e){c.set(e,"display","block")})},destroy:x,isRowBar:function(e){return s.has(e,h)},isColBar:function(e){return s.has(e,g)}}}),i("ephox.snooker.model.RunOperation",["ephox.katamari.api.Arr","ephox.katamari.api.Merger","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.katamari.api.Options","ephox.snooker.api.Structs","ephox.snooker.api.TableLookup","ephox.snooker.model.DetailsList","ephox.snooker.model.Transitions","ephox.snooker.model.Warehouse","ephox.snooker.operate.Redraw","ephox.snooker.resize.BarPositions","ephox.snooker.resize.Bars","ephox.sugar.api.dom.Compare","ephox.sugar.api.search.Traverse"],function(e,t,n,r,o,i,a,u,s,c,l,p,f,d,m){var h=function(e,t){return s.toGrid(e,t,!1)},g=function(t,n){var r=function(e){return o.findMap(e,function(e){return m.parent(e.element()).map(function(e){var t=m.parent(e).isNone();return i.elementnew(e,t)})}).getOrThunk(function(){return i.elementnew(n.row(),!0)})};return e.map(t,function(e){var t=r(e.details());return i.rowdatanew(t.element(),e.details(),e.section(),t.isNew())})},x=function(e,t){var n=s.toDetails(e,d.eq);return g(n,t)},v=function(t,n){var r=e.flatten(e.map(t.all(),function(e){return e.cells()}));return e.find(r,function(e){return d.eq(n,e.element())})},b=function(e,t,o,i,a){return function(s,m,g,v,b){var w=u.fromTable(m),y=c.generate(w);return t(y,g).map(function(t){var r=h(y,v),o=e(r,t,d.eq,a(v)),i=x(o.grid(),v);return{grid:n.constant(i),cursor:o.cursor}}).fold(function(){return r.none()},function(e){var t=l.render(m,e.grid());return o(m,e.grid(),b),i(m),f.refresh(s,m,p.height,b),r.some({cursor:e.cursor,newRows:t.newRows,newCells:t.newCells})})}},w=function(e,t){return a.cell(t.element()).bind(function(t){return v(e,t)})},y=function(e,n){return a.cell(n.element()).bind(function(r){return v(e,r).map(function(e){return t.merge(e,{generators:n.generators,clipboard:n.clipboard})})})},k=function(n,i){var u=e.map(i.selection(),function(e){return a.cell(e).bind(function(e){return v(n,e)})}),s=o.cat(u);return s.length>0?r.some(t.merge({cells:s},{generators:i.generators,clipboard:i.clipboard})):r.none()},S=function(e,t){return t.mergable()},C=function(e,t){return t.unmergable()};return{run:b,toDetailList:x,onCell:w,onCells:function(t,n){var i=e.map(n.selection(),function(e){return a.cell(e).bind(function(e){return v(t,e)})}),u=o.cat(i);return u.length>0?r.some(u):r.none()},onPaste:y,onPasteRows:k,onMergable:S,onUnmergable:C}}),i("ephox.katamari.api.Result",["ephox.katamari.api.Fun","ephox.katamari.api.Option"],function(e,t){var n=function(r){var o=function(e){return r===e},i=function(e){return n(r)},a=function(e){return n(r)},u=function(e){return n(e(r))},s=function(e){e(r)},c=function(e){return e(r)},l=function(e,t){return t(r)},p=function(e){return e(r)},f=function(e){return e(r)},d=function(){return t.some(r)};return{is:o,isValue:e.constant(!0),isError:e.constant(!1),getOr:e.constant(r),getOrThunk:e.constant(r),getOrDie:e.constant(r),or:i,orThunk:a,fold:l,map:u,each:s,bind:c,exists:p,forall:f,toOption:d}},r=function(n){var o=function(e){return e()},i=function(){return e.die(n)()},a=function(e){return e},u=function(e){return e()},s=function(e){return r(n)},c=function(e){return r(n)},l=function(e,t){return e(n)};return{is:e.constant(!1),isValue:e.constant(!1),isError:e.constant(!0),getOr:e.identity,getOrThunk:o,getOrDie:i,or:a,orThunk:u,fold:l,map:s,each:e.noop,bind:c,exists:e.constant(!1),forall:e.constant(!0),toOption:t.none}};return{value:n,error:r}}),i("ephox.snooker.model.Fitment",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Result","ephox.snooker.api.Structs","ephox.snooker.model.GridRow","ephox.snooker.util.Util","global!Array","global!Error","global!Math"],function(e,t,n,r,o,i,a,u,s){var c=function(e,r,i){if(e.row()>=r.length||e.column()>o.cellLength(r[0]))return n.error("invalid start address out of table bounds, row: "+e.row()+", column: "+e.column());var a=r.slice(e.row()),u=a[0].cells().slice(e.column()),s=o.cellLength(i[0]),c=i.length;return n.value({rowDelta:t.constant(a.length-c),colDelta:t.constant(u.length-s)})},l=function(e,n){var r=o.cellLength(e[0]),i=o.cellLength(n[0]);return{rowDelta:t.constant(0),colDelta:t.constant(r-i)}},p=function(t,n){return e.map(t,function(){return r.elementnew(n.cell(),!0)})},f=function(e,t,n){return e.concat(i.repeat(t,function(t){return o.setCells(e[e.length-1],p(e[e.length-1].cells(),n))}))},d=function(t,n,r){return e.map(t,function(e){return o.setCells(e,e.cells().concat(p(i.range(0,n),r)))})};return{measure:c,measureWidth:l,tailor:function(e,n,r){var o=n.colDelta()<0?d:t.identity;return(n.rowDelta()<0?f:t.identity)(o(e,s.abs(n.colDelta()),r),s.abs(n.rowDelta()),r)}}}),i("ephox.snooker.operate.MergingOperations",["ephox.katamari.api.Arr","ephox.katamari.api.Option","ephox.snooker.api.Structs","ephox.snooker.model.GridRow"],function(e,t,n,r){var o=function(t,n){return e.foldl(t,function(t,r){return e.exists(t,function(e){return n(e.element(),r.element())})?t:t.concat([r])},[])};return{merge:function(e,t,o,i){if(0===e.length)return e;for(var a=t.startRow();a<=t.finishRow();a++)for(var u=t.startCol();u<=t.finishCol();u++)r.mutateCell(e[a],u,n.elementnew(i(),!1));return e},unmerge:function(e,t,o,i){for(var a=!0,u=0;u<e.length;u++)for(var s=0;s<r.cellLength(e[0]);s++){var c=r.getCellElement(e[u],s),l=o(c,t);!0===l&&!1===a?r.mutateCell(e[u],s,n.elementnew(i(),!0)):!0===l&&(a=!1)}return e},splitRows:function(i,a,u,s){if(a>0&&a<i.length){var c=i[a-1].cells(),l=o(c,u);e.each(l,function(e){for(var o=t.none(),c=a;c<i.length;c++)for(var l=0;l<r.cellLength(i[0]);l++){var p=i[c].cells()[l],f=u(p.element(),e.element());f&&(o.isNone()&&(o=t.some(s())),o.each(function(e){r.mutateCell(i[c],l,n.elementnew(e,!0))}))}})}return i}}}),i("ephox.snooker.model.TableMerge",["ephox.katamari.api.Fun","ephox.snooker.api.Structs","ephox.snooker.model.Fitment","ephox.snooker.model.GridRow","ephox.snooker.operate.MergingOperations"],function(e,t,n,r,o){var i=function(t,n,o,i){var a=r.getCell(t[n],o),u=e.curry(i,a.element()),s=t[n];return t.length>1&&r.cellLength(s)>1&&(o>0&&u(r.getCellElement(s,o-1))||o<s.length-1&&u(r.getCellElement(s,o+1))||n>0&&u(r.getCellElement(t[n-1],o))||n<t.length-1&&u(r.getCellElement(t[n+1],o)))},a=function(e,n,a,u,s){for(var c=e.row(),l=e.column(),p=a.length,f=r.cellLength(a[0]),d=c+p,m=l+f,h=c;h<d;h++)for(var g=l;g<m;g++){i(n,h,g,s)&&o.unmerge(n,r.getCellElement(n[h],g),s,u.cell);var x=r.getCellElement(a[h-c],g-l),v=u.replace(x);r.mutateCell(n[h],g,t.elementnew(v,!0))}return n};return{merge:function(e,t,r,o,i){return n.measure(e,t,r).map(function(u){var s=n.tailor(t,u,o);return a(e,s,r,o,i)})},insert:function(e,t,r,i,a){o.splitRows(t,e,a,i.cell);var u=n.measureWidth(r,t),s=n.tailor(r,u,i),c=n.measureWidth(t,s),l=n.tailor(t,c,i);return l.slice(0,e).concat(s).concat(l.slice(e,l.length))}}}),i("ephox.snooker.operate.ModificationOperations",["ephox.katamari.api.Arr","ephox.snooker.api.Structs","ephox.snooker.model.GridRow"],function(e,t,n){var r=function(e,r,o,i,a){var u=e.slice(0,r),s=e.slice(r),c=n.mapCells(e[o],function(o,u){return r>0&&r<e.length&&i(n.getCellElement(e[r-1],u),n.getCellElement(e[r],u))?n.getCell(e[r],u):t.elementnew(a(o.element(),i),!0)});return u.concat([c]).concat(s)},o=function(r,o,i,a,u){return e.map(r,function(e){var r=o>0&&o<n.cellLength(e)&&a(n.getCellElement(e,o-1),n.getCellElement(e,o)),s=r?n.getCell(e,o):t.elementnew(u(n.getCellElement(e,i),a),!0);return n.addCell(e,o,s)})},i=function(r,o,i,a,u){var s=i+1;return e.map(r,function(e,r){var c=r===o,l=c?t.elementnew(u(n.getCellElement(e,i),a),!0):n.getCell(e,i);return n.addCell(e,s,l)})},a=function(e,r,o,i,a){var u=r+1,s=e.slice(0,u),c=e.slice(u),l=n.mapCells(e[r],function(e,n){return n===o?t.elementnew(a(e.element(),i),!0):e});return s.concat([l]).concat(c)},u=function(n,r,o){var i=e.map(n,function(e){var n=e.cells().slice(0,r).concat(e.cells().slice(o+1));return t.rowcells(n,e.section())});return e.filter(i,function(e){return e.cells().length>0})};return{insertRowAt:r,insertColumnAt:o,splitCellIntoColumns:i,splitCellIntoRows:a,deleteRowsAt:function(e,t,n){return e.slice(0,t).concat(e.slice(n+1))},deleteColumnsAt:u}}),i("ephox.snooker.operate.TransformOperations",["ephox.katamari.api.Arr","ephox.snooker.api.Structs","ephox.snooker.model.GridRow"],function(e,t,n){var r=function(r,o,i,a){var u=function(t){return e.exists(o,function(e){return i(t.element(),e.element())})};return e.map(r,function(e){return n.mapCells(e,function(e){return u(e)?t.elementnew(a(e.element(),i),!0):e})})},o=function(e,t,r,o){return void 0!==n.getCellElement(e[t],r)&&t>0&&o(n.getCellElement(e[t-1],r),n.getCellElement(e[t],r))},i=function(e,t,r){return t>0&&r(n.getCellElement(e,t-1),n.getCellElement(e,t))};return{replaceColumn:function(t,a,u,s){var c=e.bind(t,function(e,r){return o(t,r,a,u)||i(e,a,u)?[]:[n.getCell(e,a)]});return r(t,c,u,s)},replaceRow:function(t,n,a,u){var s=t[n],c=e.bind(s.cells(),function(e,r){return o(t,n,r,a)||i(s,r,a)?[]:[e]});return r(t,c,a,u)}}}),i("ephox.snooker.calc.ColumnContext",[],function(){var e=function(){return i(function(e,t,n,r,o){return e()})},t=function(e){return i(function(t,n,r,o,i){return n(e)})},n=function(e,t){return i(function(n,r,o,i,a){return o(e,t)})},r=function(e,t,n){return i(function(r,o,i,a,u){return a(e,t,n)})},o=function(e,t){return i(function(n,r,o,i,a){return a(e,t)})},i=function(e){return{fold:e}};return{none:e,only:t,left:n,middle:r,right:o}}),i("ephox.snooker.calc.Deltas",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.snooker.calc.ColumnContext","global!Math"],function(e,t,n,r){var o=function(e,t){return 0===e.length?n.none():1===e.length?n.only(0):0===t?n.left(0,1):t===e.length-1?n.right(t-1,t):t>0&&t<e.length-1?n.middle(t-1,t,t+1):n.none()};return{determine:function(n,i,a,u){var s=n.slice(0),c=o(n,i),l=function(n){return e.map(n,t.constant(0))},p=t.constant(l(s)),f=function(e){return u.singleColumnWidth(s[e],a)},d=function(e,t){if(a>=0){var n=r.max(u.minCellWidth(),s[t]-a);return l(s.slice(0,e)).concat([a,n-s[t]]).concat(l(s.slice(t+1)))}var o=r.max(u.minCellWidth(),s[e]+a),i=s[e]-o;return l(s.slice(0,e)).concat([o-s[e],i]).concat(l(s.slice(t+1)))},m=d,h=function(e,t,n){return d(t,n)},g=function(e,t){if(a>=0)return l(s.slice(0,t)).concat([a]);var n=r.max(u.minCellWidth(),s[t]+a);return l(s.slice(0,t)).concat([n-s[t]])};return c.fold(p,f,m,h,g)}}}),i("ephox.snooker.util.CellUtils",["ephox.katamari.api.Fun","ephox.sugar.api.properties.Attr","ephox.sugar.api.properties.Css","global!parseInt"],function(e,t,n,r){var o=function(e,n){return t.has(e,n)&&r(t.get(e,n),10)>1},i=function(e){return o(e,"colspan")},a=function(e){return o(e,"rowspan")},u=function(e,t){return r(n.get(e,t),10)};return{hasColspan:i,hasRowspan:a,minWidth:e.constant(10),minHeight:e.constant(10),getInt:u}}),i("ephox.snooker.resize.ColumnSizes",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.snooker.lookup.Blocks","ephox.snooker.resize.Sizes","ephox.snooker.util.CellUtils","ephox.snooker.util.Util","ephox.sugar.api.properties.Css"],function(e,t,n,r,o,i,a){var u=function(e,t,n){return a.getRaw(e,t).fold(function(){return n(e)+"px"},function(e){return e})},s=function(e){return u(e,"width",r.getPixelWidth)},c=function(e){return u(e,"height",r.getHeight)},l=function(r,a,u,s,c){var l=n.columns(r),p=e.map(l,function(e){return e.map(a.edge)});return e.map(l,function(e,n){return e.filter(t.not(o.hasColspan)).fold(function(){var e=i.deduce(p,n);return s(e)},function(e){return u(e,c)})})},p=function(e){return e.map(function(e){return e+"px"}).getOr("")},f=function(e,t){return l(e,t,s,p)},d=function(e,t,n){return l(e,t,r.getPercentageWidth,function(e){return e.fold(function(){return n.minCellWidth()},function(e){return e/n.pixelWidth()*100})},n)},m=function(e,t,n){return l(e,t,r.getPixelWidth,function(e){return e.getOrThunk(n.minCellWidth)},n)},h=function(r,a,u,s){var c=n.rows(r),l=e.map(c,function(e){return e.map(a.edge)});return e.map(c,function(e,n){return e.filter(t.not(o.hasRowspan)).fold(function(){var e=i.deduce(l,n);return s(e)},function(e){return u(e)})})};return{getRawWidths:f,getPixelWidths:m,getPercentageWidths:d,getPixelHeights:function(e,t){return h(e,t,r.getHeight,function(e){return e.getOrThunk(o.minHeight)})},getRawHeights:function(e,t){return h(e,t,c,p)}}}),i("ephox.snooker.resize.Recalculations",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.snooker.model.Warehouse","global!parseInt"],function(e,t,n,r){
var o=function(e,t,n){for(var r=0,o=e;o<t;o++)r+=void 0!==n[o]?n[o]:0;return r};return{recalculateWidth:function(r,i){var a=n.justCells(r);return e.map(a,function(e){var n=o(e.column(),e.column()+e.colspan(),i);return{element:e.element,width:t.constant(n),colspan:e.colspan}})},recalculateHeight:function(r,i){var a=n.justCells(r);return e.map(a,function(e){var n=o(e.row(),e.row()+e.rowspan(),i);return{element:e.element,height:t.constant(n),rowspan:e.rowspan}})},matchRowHeight:function(n,r){return e.map(n.all(),function(e,n){return{element:e.element,height:t.constant(r[n])}})}}}),i("ephox.snooker.resize.TableSize",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.snooker.resize.ColumnSizes","ephox.snooker.resize.Sizes","ephox.snooker.util.CellUtils","ephox.sugar.api.view.Width","global!Math"],function(e,t,n,r,o,i,a){var u=function(e,a){var u=parseFloat(e,10),s=i.get(a),c=function(e){return e/s*100},l=function(e,t){return[100-e]},p=function(){return o.minWidth()/s*100},f=function(e,t,n){var o=u+n;r.setPercentageWidth(e,o)};return{width:t.constant(u),pixelWidth:t.constant(s),getWidths:n.getPercentageWidths,getCellDelta:c,singleColumnWidth:l,minCellWidth:p,setElementWidth:r.setPercentageWidth,setTableWidth:f}},s=function(i){var u=parseInt(i,10),s=t.identity,c=function(e,t){return[a.max(o.minWidth(),e+t)-e]},l=function(t,n,o){var i=e.foldr(n,function(e,t){return e+t},0);r.setPixelWidth(t,i)};return{width:t.constant(u),pixelWidth:t.constant(u),getWidths:n.getPixelWidths,getCellDelta:s,singleColumnWidth:c,minCellWidth:o.minWidth,setElementWidth:r.setPixelWidth,setTableWidth:l}},c=function(e,t){if(r.percentageBasedSizeRegex().test(t)){var n=r.percentageBasedSizeRegex().exec(t);return u(n[1],e)}if(r.pixelBasedSizeRegex().test(t)){var o=r.pixelBasedSizeRegex().exec(t);return s(o[1])}var a=i.get(e);return s(a)};return{getTableSize:function(e){return r.getRawWidth(e).fold(function(){var t=i.get(e);return s(t)},function(t){return c(e,t)})}}}),i("ephox.snooker.resize.Adjustments",["ephox.katamari.api.Arr","ephox.snooker.calc.Deltas","ephox.snooker.model.DetailsList","ephox.snooker.model.Warehouse","ephox.snooker.resize.ColumnSizes","ephox.snooker.resize.Recalculations","ephox.snooker.resize.Sizes","ephox.snooker.resize.TableSize","ephox.snooker.util.CellUtils","global!Math"],function(e,t,n,r,o,i,a,u,s,c){var l=function(e){return r.generate(e)},p=function(t){return e.foldr(t,function(e,t){return e+t},0)},f=function(e){var t=n.fromTable(e);return l(t)};return{adjustWidth:function(n,r,o,a){var s=u.getTableSize(n),c=s.getCellDelta(r),l=f(n),p=s.getWidths(l,a,s),d=t.determine(p,o,c,s),m=e.map(d,function(e,t){return e+p[t]}),h=i.recalculateWidth(l,m);e.each(h,function(e){s.setElementWidth(e.element(),e.width())}),o===l.grid().columns()-1&&s.setTableWidth(n,m,c)},adjustHeight:function(t,n,r,u){var l=f(t),d=o.getPixelHeights(l,u),m=e.map(d,function(e,t){return r===t?c.max(n+e,s.minHeight()):e}),h=i.recalculateHeight(l,m),g=i.matchRowHeight(l,m);e.each(g,function(e){a.setHeight(e.element(),e.height())}),e.each(h,function(e){a.setHeight(e.element(),e.height())});var x=p(m);a.setHeight(t,x)},adjustWidthTo:function(t,n,r){var o=u.getTableSize(t),a=l(n),s=o.getWidths(a,r,o),c=i.recalculateWidth(a,s);e.each(c,function(e){o.setElementWidth(e.element(),e.width())});var p=e.foldr(s,function(e,t){return t+e},0);c.length>0&&o.setElementWidth(t,p)}}}),i("ephox.snooker.api.TableOperations",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.katamari.api.Struct","ephox.snooker.api.Generators","ephox.snooker.api.Structs","ephox.snooker.api.TableContent","ephox.snooker.api.TableLookup","ephox.snooker.model.DetailsList","ephox.snooker.model.GridRow","ephox.snooker.model.RunOperation","ephox.snooker.model.TableMerge","ephox.snooker.model.Transitions","ephox.snooker.model.Warehouse","ephox.snooker.operate.MergingOperations","ephox.snooker.operate.ModificationOperations","ephox.snooker.operate.TransformOperations","ephox.snooker.resize.Adjustments","ephox.sugar.api.dom.Remove"],function(e,t,n,r,o,i,a,u,s,c,l,p,f,d,m,h,g,x,v){var b=function(e){0===u.cells(e).length&&v.remove(e)},w=r.immutable("grid","cursor"),y=function(e,t,n){return k(e,t,n).orThunk(function(){return k(e,0,0)})},k=function(e,t,r){return n.from(e[t]).bind(function(e){return n.from(e.cells()[r]).bind(function(e){return n.from(e.element())})})},S=function(e,t,n){return w(e,k(e,t,n))},C=function(t){return e.foldl(t,function(t,n){return e.exists(t,function(e){return e.row()===n.row()})?t:t.concat([n])},[]).sort(function(e,t){return e.row()-t.row()})},T=function(t){return e.foldl(t,function(t,n){return e.exists(t,function(e){return e.column()===n.column()})?t:t.concat([n])},[]).sort(function(e,t){return e.column()-t.column()})},R=function(e,t,n,r){var o=t.row(),i=t.row(),a=h.insertRowAt(e,i,o,n,r.getOrInit);return S(a,i,t.column())},A=function(t,n,r,o){var i=n[0].row(),a=n[0].row(),u=C(n),s=e.foldl(u,function(e,t){return h.insertRowAt(e,a,i,r,o.getOrInit)},t);return S(s,a,n[0].column())},D=function(e,t,n,r){var o=t.row(),i=t.row()+t.rowspan(),a=h.insertRowAt(e,i,o,n,r.getOrInit);return S(a,i,t.column())},O=function(t,n,r,o){var i=C(n),a=i[i.length-1].row(),u=i[i.length-1].row()+i[i.length-1].rowspan(),s=e.foldl(i,function(e,t){return h.insertRowAt(e,u,a,r,o.getOrInit)},t);return S(s,u,n[0].column())},E=function(e,t,n,r){var o=t.column(),i=t.column(),a=h.insertColumnAt(e,i,o,n,r.getOrInit);return S(a,t.row(),i)},N=function(t,n,r,o){var i=T(n),a=i[0].column(),u=i[0].column(),s=e.foldl(i,function(e,t){return h.insertColumnAt(e,u,a,r,o.getOrInit)},t);return S(s,n[0].row(),u)},B=function(e,t,n,r){var o=t.column(),i=t.column()+t.colspan(),a=h.insertColumnAt(e,i,o,n,r.getOrInit);return S(a,t.row(),i)},F=function(t,n,r,o){var i=n[n.length-1].column(),a=n[n.length-1].column()+n[n.length-1].colspan(),u=T(n),s=e.foldl(u,function(e,t){return h.insertColumnAt(e,a,i,r,o.getOrInit)},t);return S(s,n[0].row(),a)},P=function(e,t,n,r){var o=g.replaceRow(e,t.row(),n,r.replaceOrInit);return S(o,t.row(),t.column())},I=function(e,t,n,r){var o=g.replaceColumn(e,t.column(),n,r.replaceOrInit);return S(o,t.row(),t.column())},W=function(e,t,n,r){var o=g.replaceRow(e,t.row(),n,r.replaceOrInit);return S(o,t.row(),t.column())},M=function(e,t,n,r){var o=g.replaceColumn(e,t.column(),n,r.replaceOrInit);return S(o,t.row(),t.column())},L=function(e,t,n,r){var o=h.splitCellIntoColumns(e,t.row(),t.column(),n,r.getOrInit);return S(o,t.row(),t.column())},z=function(e,t,n,r){var o=h.splitCellIntoRows(e,t.row(),t.column(),n,r.getOrInit);return S(o,t.row(),t.column())},q=function(e,t,n,r){var o=T(t),i=h.deleteColumnsAt(e,o[0].column(),o[o.length-1].column()),a=y(i,t[0].row(),t[0].column());return w(i,a)},_=function(e,t,n,r){var o=C(t),i=h.deleteRowsAt(e,o[0].row(),o[o.length-1].row()),a=y(i,t[0].row(),t[0].column());return w(i,a)},H=function(e,r,o,i){var u=r.cells();a.merge(u);var s=m.merge(e,r.bounds(),o,t.constant(u[0]));return w(s,n.from(u[0]))},j=function(t,r,o,i){var a=e.foldr(r,function(e,t){return m.unmerge(e,t,o,i.combine(t))},t);return w(a,n.from(r[0]))},U=function(e,t,r,o){var a=function(e,t){var n=s.fromTable(e),r=d.generate(n);return f.toGrid(r,t,!0)}(t.clipboard(),t.generators()),u=i.address(t.row(),t.column());return p.merge(u,e,a,t.generators(),r).fold(function(){return w(e,n.some(t.element()))},function(e){var n=y(e,t.row(),t.column());return w(e,n)})},G=function(e,t,n){var r=s.fromPastedRows(e,n),o=d.generate(r);return f.toGrid(o,t,!0)},V=function(e,t,n,r){var o=e[t.cells[0].row()],i=t.cells[0].row(),a=G(t.clipboard(),t.generators(),o),u=p.insert(i,e,a,t.generators(),n),s=y(u,t.cells[0].row(),t.cells[0].column());return w(u,s)},K=function(e,t,n,r){var o=e[t.cells[0].row()],i=t.cells[t.cells.length-1].row()+t.cells[t.cells.length-1].rowspan(),a=G(t.clipboard(),t.generators(),o),u=p.insert(i,e,a,t.generators(),n),s=y(u,t.cells[0].row(),t.cells[0].column());return w(u,s)},Y=x.adjustWidthTo;return{insertRowBefore:l.run(R,l.onCell,t.noop,t.noop,o.modification),insertRowsBefore:l.run(A,l.onCells,t.noop,t.noop,o.modification),insertRowAfter:l.run(D,l.onCell,t.noop,t.noop,o.modification),insertRowsAfter:l.run(O,l.onCells,t.noop,t.noop,o.modification),insertColumnBefore:l.run(E,l.onCell,Y,t.noop,o.modification),insertColumnsBefore:l.run(N,l.onCells,Y,t.noop,o.modification),insertColumnAfter:l.run(B,l.onCell,Y,t.noop,o.modification),insertColumnsAfter:l.run(F,l.onCells,Y,t.noop,o.modification),splitCellIntoColumns:l.run(L,l.onCell,Y,t.noop,o.modification),splitCellIntoRows:l.run(z,l.onCell,t.noop,t.noop,o.modification),eraseColumns:l.run(q,l.onCells,Y,b,o.modification),eraseRows:l.run(_,l.onCells,t.noop,b,o.modification),makeColumnHeader:l.run(I,l.onCell,t.noop,t.noop,o.transform("row","th")),unmakeColumnHeader:l.run(M,l.onCell,t.noop,t.noop,o.transform(null,"td")),makeRowHeader:l.run(P,l.onCell,t.noop,t.noop,o.transform("col","th")),unmakeRowHeader:l.run(W,l.onCell,t.noop,t.noop,o.transform(null,"td")),mergeCells:l.run(H,l.onMergable,t.noop,t.noop,o.merging),unmergeCells:l.run(j,l.onUnmergable,Y,t.noop,o.merging),pasteCells:l.run(U,l.onPaste,Y,t.noop,o.modification),pasteRowsBefore:l.run(V,l.onPasteRows,t.noop,t.noop,o.modification),pasteRowsAfter:l.run(K,l.onPasteRows,t.noop,t.noop,o.modification)}}),i("tinymce.plugins.table.alien.Util",["ephox.sugar.api.dom.Compare","ephox.sugar.api.node.Element"],function(e,t){var n=function(e){return t.fromDom(e.getBody())},r=function(t){return function(r){return e.eq(r,n(t))}},o=function(e){return e?e.replace(/px$/,""):""};return{getBody:n,getIsRoot:r,addSizeSuffix:function(e){return/^[0-9]+$/.test(e)&&(e+="px"),e},removePxSuffix:o}}),i("ephox.sugar.api.properties.Direction",["ephox.sugar.api.properties.Css"],function(e){var t=function(e,t){return function(r){return"rtl"===n(r)?t:e}},n=function(t){return"rtl"===e.get(t,"direction")?"rtl":"ltr"};return{onDirection:t,getDirection:n}}),i("tinymce.plugins.table.queries.Direction",["ephox.katamari.api.Fun","ephox.sugar.api.properties.Direction"],function(e,t){var n={isRtl:e.constant(!1)},r={isRtl:e.constant(!0)};return{directionAt:function(e){return"rtl"===t.getDirection(e)?r:n}}}),i("tinymce.plugins.table.actions.TableActions",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.snooker.api.CellMutations","ephox.snooker.api.TableDirection","ephox.snooker.api.TableFill","ephox.snooker.api.TableGridSize","ephox.snooker.api.TableOperations","ephox.sugar.api.node.Element","ephox.sugar.api.node.Node","ephox.sugar.api.properties.Attr","ephox.sugar.api.search.SelectorFilter","tinymce.plugins.table.alien.Util","tinymce.plugins.table.queries.Direction"],function(e,t,n,r,o,i,a,u,s,c,l,p,f,d){return function(m,h){var g,x=function(e){return"table"===c.name(f.getBody(e))},v=function(e){var t=a.getGridSize(e);return!1===x(m)||t.rows()>1},b=function(e){var t=a.getGridSize(e);return!1===x(m)||t.columns()>1},w=function(e){return m.fire("newrow",{node:e.dom()}),e.dom()},y=function(e){return m.fire("newcell",{node:e.dom()}),e.dom()};!1!==m.settings.table_clone_elements&&("string"==typeof m.settings.table_clone_elements?g=m.settings.table_clone_elements.split(/[ ,]/):Array.isArray(m.settings.table_clone_elements)&&(g=m.settings.table_clone_elements));var k=n.from(g),S=function(t,r,a,u){return function(c,f){var h=p.descendants(c,"td[data-mce-style],th[data-mce-style]");e.each(h,function(e){l.remove(e,"data-mce-style")});var g=u(),x=s.fromDom(m.getDoc()),v=o(d.directionAt),b=i.cellOperations(a,x,k);return r(c)?t(g,c,f,b,v).bind(function(t){return e.each(t.newRows(),function(e){w(e)}),e.each(t.newCells(),function(e){y(e)}),t.cursor().map(function(e){var t=m.dom.createRng();return t.setStart(e.dom(),0),t.setEnd(e.dom(),0),t})}):n.none()}};return{deleteRow:S(u.eraseRows,v,t.noop,h),deleteColumn:S(u.eraseColumns,b,t.noop,h),insertRowsBefore:S(u.insertRowsBefore,t.always,t.noop,h),insertRowsAfter:S(u.insertRowsAfter,t.always,t.noop,h),insertColumnsBefore:S(u.insertColumnsBefore,t.always,r.halve,h),insertColumnsAfter:S(u.insertColumnsAfter,t.always,r.halve,h),mergeCells:S(u.mergeCells,t.always,t.noop,h),unmergeCells:S(u.unmergeCells,t.always,t.noop,h),pasteRowsBefore:S(u.pasteRowsBefore,t.always,t.noop,h),pasteRowsAfter:S(u.pasteRowsAfter,t.always,t.noop,h),pasteCells:S(u.pasteCells,t.always,t.noop,h)}}}),i("ephox.snooker.api.CopyRows",["ephox.snooker.model.DetailsList","ephox.snooker.model.RunOperation","ephox.snooker.model.Transitions","ephox.snooker.model.Warehouse","ephox.snooker.operate.Redraw"],function(e,t,n,r,o){return{copyRows:function(i,a,u){var s=e.fromTable(i),c=r.generate(s);return t.onCells(c,a).map(function(e){var r=n.toGrid(c,u,!1),i=r.slice(e[0].row(),e[e.length-1].row()+e[e.length-1].rowspan()),a=t.toDetailList(i,u);return o.copy(a)})}}}),i("tinymce.core.util.Tools",["global!tinymce.util.Tools.resolve"],function(e){return e("tinymce.util.Tools")}),i("tinymce.core.Env",["global!tinymce.util.Tools.resolve"],function(e){return e("tinymce.Env")}),i("tinymce.plugins.table.actions.Styles",["tinymce.core.util.Tools"],function(e){var t=function(e,t,n){var r,o=e.select("td,th",t);return r=function(t,r){for(var o=0;o<r.length;o++){var i=e.getStyle(r[o],n);if(void 0===t&&(t=i),t!=i)return""}return t}(r,o)};return{applyAlign:function(e,t,n){n&&e.formatter.apply("align"+n,{},t)},applyVAlign:function(e,t,n){n&&e.formatter.apply("valign"+n,{},t)},unApplyAlign:function(t,n){e.each("left center right".split(" "),function(e){t.formatter.remove("align"+e,{},n)})},unApplyVAlign:function(t,n){e.each("top middle bottom".split(" "),function(e){t.formatter.remove("valign"+e,{},n)})},getTDTHOverallStyle:t}}),i("tinymce.plugins.table.ui.Helpers",["ephox.katamari.api.Fun","tinymce.core.util.Tools","tinymce.plugins.table.alien.Util"],function(e,t,n){var r=function(e,n,r){var o=function(e,r){return r=r||[],t.each(e,function(e){var t={text:e.text||e.title};e.menu?t.menu=o(e.menu):(t.value=e.value,n&&n(t)),r.push(t)}),r};return o(e,r||[])},o=function(e,t){var r=e.dom,o=t.control.rootControl,i=o.toJSON(),a=r.parseStyle(i.style);"style"===t.control.name()?(o.find("#borderStyle").value(a["border-style"]||"")[0].fire("select"),o.find("#borderColor").value(a["border-color"]||"")[0].fire("change"),o.find("#backgroundColor").value(a["background-color"]||"")[0].fire("change"),o.find("#width").value(a.width||"").fire("change"),o.find("#height").value(a.height||"").fire("change")):(a["border-style"]=i.borderStyle,a["border-color"]=i.borderColor,a["background-color"]=i.backgroundColor,a.width=i.width?n.addSizeSuffix(i.width):"",a.height=i.height?n.addSizeSuffix(i.height):""),o.find("#style").value(r.serializeStyle(r.parseStyle(r.serializeStyle(a))))},i=function(e,t){var n=e.parseStyle(e.getAttrib(t,"style")),r={};return n["border-style"]&&(r.borderStyle=n["border-style"]),n["border-color"]&&(r.borderColor=n["border-color"]),n["background-color"]&&(r.backgroundColor=n["background-color"]),r.style=e.serializeStyle(n),r};return{createStyleForm:function(t){var n=function(){var e=t.settings.color_picker_callback;if(e)return function(n){return e.call(t,function(e){n.control.value(e).fire("change")},n.control.value())}};return{title:"Advanced",type:"form",defaults:{onchange:e.curry(o,t)},items:[{label:"Style",name:"style",type:"textbox"},{type:"form",padding:0,formItemDefaults:{layout:"grid",alignH:["start","right"]},defaults:{size:7},items:[{label:"Border style",type:"listbox",name:"borderStyle",width:90,onselect:e.curry(o,t),values:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{label:"Border color",type:"colorbox",name:"borderColor",onaction:n()},{label:"Background color",type:"colorbox",name:"backgroundColor",onaction:n()}]}]}},buildListItems:r,updateStyleField:o,extractAdvancedStyles:i}}),i("tinymce.plugins.table.ui.TableDialog",["ephox.katamari.api.Fun","tinymce.core.Env","tinymce.core.util.Tools","tinymce.plugins.table.actions.InsertTable","tinymce.plugins.table.actions.Styles","tinymce.plugins.table.alien.Util","tinymce.plugins.table.ui.Helpers"],function(e,t,n,r,o,i,a){function u(e,t,n,r){if("TD"===t.tagName||"TH"===t.tagName)e.setStyle(t,n,r);else if(t.children)for(var o=0;o<t.children.length;o++)u(e,t.children[o],n,r)}var s=function(e,t){var r=e.dom,i={width:r.getStyle(t,"width")||r.getAttrib(t,"width"),height:r.getStyle(t,"height")||r.getAttrib(t,"height"),cellspacing:r.getStyle(t,"border-spacing")||r.getAttrib(t,"cellspacing"),cellpadding:r.getAttrib(t,"data-mce-cell-padding")||r.getAttrib(t,"cellpadding")||o.getTDTHOverallStyle(e.dom,t,"padding"),border:r.getAttrib(t,"data-mce-border")||r.getAttrib(t,"border")||o.getTDTHOverallStyle(e.dom,t,"border"),borderColor:r.getAttrib(t,"data-mce-border-color"),caption:!!r.select("caption",t)[0],class:r.getAttrib(t,"class")};return n.each("left center right".split(" "),function(n){e.formatter.matchNode(t,"align"+n)&&(i.align=n)}),!1!==e.settings.table_advtab&&n.extend(i,a.extractAdvancedStyles(r,t)),i},c=function(e,t,r){var o=e.dom,a={},s={};if(a.class=r.class,s.height=i.addSizeSuffix(r.height),o.getAttrib(t,"width")&&!e.settings.table_style_by_css?a.width=i.removePxSuffix(r.width):s.width=i.addSizeSuffix(r.width),e.settings.table_style_by_css?(s["border-width"]=i.addSizeSuffix(r.border),s["border-spacing"]=i.addSizeSuffix(r.cellspacing),n.extend(a,{"data-mce-border-color":r.borderColor,"data-mce-cell-padding":r.cellpadding,"data-mce-border":r.border})):n.extend(a,{border:r.border,cellpadding:r.cellpadding,cellspacing:r.cellspacing}),e.settings.table_style_by_css&&t.children)for(var c=0;c<t.children.length;c++)u(o,t.children[c],{"border-width":i.addSizeSuffix(r.border),"border-color":r.borderColor,padding:i.addSizeSuffix(r.cellpadding)});r.style?n.extend(s,o.parseStyle(r.style)):s=n.extend({},o.parseStyle(o.getAttrib(t,"style")),s),a.style=o.serializeStyle(s),o.setAttribs(t,a)},l=function(e,n,i){var u,s,l=e.dom;a.updateStyleField(e,i),s=i.control.rootControl.toJSON(),!1===s.class&&delete s.class,e.undoManager.transact(function(){n||(n=r.insert(e,s.cols||1,s.rows||1)),c(e,n,s),u=l.select("caption",n)[0],u&&!s.caption&&l.remove(u),!u&&s.caption&&(u=l.create("caption"),u.innerHTML=t.ie?" ":'<br data-mce-bogus="1"/>',n.insertBefore(u,n.firstChild)),o.unApplyAlign(e,n),s.align&&o.applyAlign(e,n,s.align),e.focus(),e.addVisual()})};return{open:function(t,n){var r,o,i,u,c,p=t.dom,f={};!0===n?(r=p.getParent(t.selection.getStart(),"table"))&&(f=s(t,r)):(o={label:"Cols",name:"cols"},i={label:"Rows",name:"rows"}),t.settings.table_class_list&&(f.class&&(f.class=f.class.replace(/\s*mce\-item\-table\s*/g,"")),u={name:"class",type:"listbox",label:"Class",values:a.buildListItems(t.settings.table_class_list,function(e){e.value&&(e.textStyle=function(){return t.formatter.getCssText({block:"table",classes:[e.value]})})})}),c={type:"form",layout:"flex",direction:"column",labelGapCalc:"children",padding:0,items:[{type:"form",labelGapCalc:!1,padding:0,layout:"grid",columns:2,defaults:{type:"textbox",maxWidth:50},items:!1!==t.settings.table_appearance_options?[o,i,{label:"Width",name:"width",onchange:e.curry(a.updateStyleField,t)},{label:"Height",name:"height",onchange:e.curry(a.updateStyleField,t)},{label:"Cell spacing",name:"cellspacing"},{label:"Cell padding",name:"cellpadding"},{label:"Border",name:"border"},{label:"Caption",name:"caption",type:"checkbox"}]:[o,i,{label:"Width",name:"width",onchange:e.curry(a.updateStyleField,t)},{label:"Height",name:"height",onchange:e.curry(a.updateStyleField,t)}]},{label:"Alignment",name:"align",type:"listbox",text:"None",values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},u]},!1!==t.settings.table_advtab?t.windowManager.open({title:"Table properties",data:f,bodyType:"tabpanel",body:[{title:"General",type:"form",items:c},a.createStyleForm(t)],onsubmit:e.curry(l,t,r)}):t.windowManager.open({title:"Table properties",data:f,body:c,onsubmit:e.curry(l,t,r)})}}}),i("tinymce.plugins.table.ui.RowDialog",["ephox.katamari.api.Fun","tinymce.core.util.Tools","tinymce.plugins.table.actions.Styles","tinymce.plugins.table.alien.Util","tinymce.plugins.table.ui.Helpers"],function(e,t,n,r,o){function i(e,i,a){function s(e,t,n){n&&p.setAttrib(e,t,n)}function c(e,t,n){n&&p.setStyle(e,t,n)}var l,p=e.dom;o.updateStyleField(e,a),l=a.control.rootControl.toJSON(),e.undoManager.transact(function(){t.each(i,function(t){s(t,"scope",l.scope),s(t,"style",l.style),s(t,"class",l.class),c(t,"height",r.addSizeSuffix(l.height)),l.type!==t.parentNode.nodeName.toLowerCase()&&u(e.dom,t,l.type),1===i.length&&n.unApplyAlign(e,t),l.align&&n.applyAlign(e,t,l.align)}),e.focus()})}var a=function(e,n){var r=e.dom,i={height:r.getStyle(n,"height")||r.getAttrib(n,"height"),scope:r.getAttrib(n,"scope"),class:r.getAttrib(n,"class")};return i.type=n.parentNode.nodeName.toLowerCase(),t.each("left center right".split(" "),function(t){e.formatter.matchNode(n,"align"+t)&&(i.align=t)}),!1!==e.settings.table_row_advtab&&t.extend(i,o.extractAdvancedStyles(r,n)),i},u=function(e,t,n){var r=e.getParent(t,"table"),o=t.parentNode,i=e.select(n,r)[0];i||(i=e.create(n),r.firstChild?"CAPTION"===r.firstChild.nodeName?e.insertAfter(i,r.firstChild):r.insertBefore(i,r.firstChild):r.appendChild(i)),i.appendChild(t),o.hasChildNodes()||e.remove(o)};return{open:function(n){var r,u,s,c,l,p,f=n.dom,d=[];r=n.dom.getParent(n.selection.getStart(),"table"),u=n.dom.getParent(n.selection.getStart(),"td,th"),t.each(r.rows,function(e){t.each(e.cells,function(t){if(f.getAttrib(t,"data-mce-selected")||t==u)return d.push(e),!1})}),(s=d[0])&&(l=d.length>1?{height:"",scope:"",class:"",align:"",type:s.parentNode.nodeName.toLowerCase()}:a(n,s),n.settings.table_row_class_list&&(c={name:"class",type:"listbox",label:"Class",values:o.buildListItems(n.settings.table_row_class_list,function(e){e.value&&(e.textStyle=function(){return n.formatter.getCssText({block:"tr",classes:[e.value]})})})}),p={type:"form",columns:2,padding:0,defaults:{type:"textbox"},items:[{type:"listbox",name:"type",label:"Row type",text:"Header",maxWidth:null,values:[{text:"Header",value:"thead"},{text:"Body",value:"tbody"},{text:"Footer",value:"tfoot"}]},{type:"listbox",name:"align",label:"Alignment",text:"None",maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height"},c]},!1!==n.settings.table_row_advtab?n.windowManager.open({title:"Row properties",data:l,bodyType:"tabpanel",body:[{title:"General",type:"form",items:p},o.createStyleForm(f)],onsubmit:e.curry(i,n,d)}):n.windowManager.open({title:"Row properties",data:l,body:p,onsubmit:e.curry(i,n,d)}))}}}),i("tinymce.plugins.table.ui.CellDialog",["ephox.katamari.api.Fun","tinymce.core.util.Tools","tinymce.plugins.table.actions.Styles","tinymce.plugins.table.alien.Util","tinymce.plugins.table.ui.Helpers"],function(e,t,n,r,o){var i=function(e,t){e.style.cssText+=";"+t},a=function(e,n){var r=e.dom,i={width:r.getStyle(n,"width")||r.getAttrib(n,"width"),height:r.getStyle(n,"height")||r.getAttrib(n,"height"),scope:r.getAttrib(n,"scope"),class:r.getAttrib(n,"class")};return i.type=n.nodeName.toLowerCase(),t.each("left center right".split(" "),function(t){e.formatter.matchNode(n,"align"+t)&&(i.align=t)}),t.each("top middle bottom".split(" "),function(t){e.formatter.matchNode(n,"valign"+t)&&(i.valign=t)}),!1!==e.settings.table_cell_advtab&&t.extend(i,o.extractAdvancedStyles(r,n)),i},u=function(e,a,u){function s(e,t,n){n&&p.setAttrib(e,t,n)}function c(e,t,n){n&&p.setStyle(e,t,n)}var l,p=e.dom;o.updateStyleField(e,u),l=u.control.rootControl.toJSON(),e.undoManager.transact(function(){t.each(a,function(t){s(t,"scope",l.scope),1===a.length?s(t,"style",l.style):i(t,l.style),s(t,"class",l.class),c(t,"width",r.addSizeSuffix(l.width)),c(t,"height",r.addSizeSuffix(l.height)),l.type&&t.nodeName.toLowerCase()!==l.type&&(t=p.rename(t,l.type)),1===a.length&&(n.unApplyAlign(e,t),n.unApplyVAlign(e,t)),l.align&&n.applyAlign(e,t,l.align),l.valign&&n.applyVAlign(e,t,l.valign)}),e.focus()})};return{open:function(t){var n,r,i,s=[];if(s=t.dom.select("td[data-mce-selected],th[data-mce-selected]"),n=t.dom.getParent(t.selection.getStart(),"td,th"),!s.length&&n&&s.push(n),n=n||s[0]){r=s.length>1?{width:"",height:"",scope:"",class:"",align:"",style:"",type:n.nodeName.toLowerCase()}:a(t,n),t.settings.table_cell_class_list&&(i={name:"class",type:"listbox",label:"Class",values:o.buildListItems(t.settings.table_cell_class_list,function(e){e.value&&(e.textStyle=function(){return t.formatter.getCssText({block:"td",classes:[e.value]})})})});var c={type:"form",layout:"flex",direction:"column",labelGapCalc:"children",padding:0,items:[{type:"form",layout:"grid",columns:2,labelGapCalc:!1,padding:0,defaults:{type:"textbox",maxWidth:50},items:[{label:"Width",name:"width",onchange:e.curry(o.updateStyleField,t)},{label:"Height",name:"height",onchange:e.curry(o.updateStyleField,t)},{label:"Cell type",name:"type",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{label:"Scope",name:"scope",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{label:"H Align",name:"align",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"V Align",name:"valign",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}]},i]};!1!==t.settings.table_cell_advtab?t.windowManager.open({title:"Cell properties",bodyType:"tabpanel",data:r,body:[{title:"General",type:"form",items:c},o.createStyleForm(t)],onsubmit:e.curry(u,t,s)}):t.windowManager.open({title:"Cell properties",data:r,body:c,onsubmit:e.curry(u,t,s)})}}}}),i("tinymce.plugins.table.actions.TableCommands",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.snooker.api.CopyRows","ephox.snooker.api.TableFill","ephox.snooker.api.TableLookup","ephox.sugar.api.dom.Insert","ephox.sugar.api.dom.Remove","ephox.sugar.api.dom.Replication","ephox.sugar.api.node.Element","tinymce.core.util.Tools","tinymce.plugins.table.alien.Util","tinymce.plugins.table.queries.TableTargets","tinymce.plugins.table.ui.TableDialog","tinymce.plugins.table.ui.RowDialog","tinymce.plugins.table.ui.CellDialog"],function(e,t,n,r,o,i,a,u,s,c,l,p,f,d,m,h){var g=l.each,x=n.none(),v=function(){return x.fold(function(){},function(t){return e.map(t,function(e){return e.dom()})})},b=function(t){var r=e.map(t,c.fromDom);x=n.from(r)};return{registerCommands:function(l,v,b,w){var y=p.getIsRoot(l),k=function(){var e=c.fromDom(l.dom.getParent(l.selection.getStart(),"th,td"));i.table(e,y).filter(t.not(y)).each(function(e){var t=c.fromText("");a.after(e,t),u.remove(e);var n=l.dom.createRng();n.setStart(t.dom(),0),n.setEnd(t.dom(),0),l.selection.setRng(n)})},S=function(){return c.fromDom(l.dom.getParent(l.selection.getStart(),"th,td"))},C=function(e){return i.table(e,y)},T=function(e){var t=S();C(t).each(function(n){var r=f.forMenu(w,n,t);e(n,r).each(function(e){l.selection.setRng(e),l.focus(),b.clear(n)})})},R=function(e){var i=S();return C(i).bind(function(e){var a=c.fromDom(l.getDoc()),u=f.forMenu(w,e,i),s=o.cellOperations(t.noop,a,n.none());return r.copyRows(e,u,s)})},A=function(t){x.each(function(n){var r=e.map(n,function(e){return s.deep(e)}),i=S();C(i).bind(function(e){var n=c.fromDom(l.getDoc()),a=o.paste(n),u=f.pasteRows(w,e,i,r,a);t(e,u).each(function(t){l.selection.setRng(t),l.focus(),b.clear(e)})})})};g({mceTableSplitCells:function(){T(v.unmergeCells)},mceTableMergeCells:function(){T(v.mergeCells)},mceTableInsertRowBefore:function(){T(v.insertRowsBefore)},mceTableInsertRowAfter:function(){T(v.insertRowsAfter)},mceTableInsertColBefore:function(){T(v.insertColumnsBefore)},mceTableInsertColAfter:function(){T(v.insertColumnsAfter)},mceTableDeleteCol:function(){T(v.deleteColumn)},mceTableDeleteRow:function(){T(v.deleteRow)},mceTableCutRow:function(e){x=R(),T(v.deleteRow)},mceTableCopyRow:function(e){x=R()},mceTablePasteRowBefore:function(e){A(v.pasteRowsBefore)},mceTablePasteRowAfter:function(e){A(v.pasteRowsAfter)},mceTableDelete:k},function(e,t){l.addCommand(t,e)}),g({mceInsertTable:t.curry(d.open,l),mceTableProps:t.curry(d.open,l,!0),mceTableRowProps:t.curry(m.open,l),mceTableCellProps:t.curry(h.open,l)},function(e,t){l.addCommand(t,function(t,n){e(n)})})},getClipboardRows:v,setClipboardRows:b}}),i("ephox.snooker.api.ResizeWire",["ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.sugar.api.node.Element","ephox.sugar.api.view.Location","ephox.sugar.api.view.Position"],function(e,t,n,r,o){return{only:function(r){var i=t.from(r.dom().documentElement).map(n.fromDom).getOr(r);return{parent:e.constant(i),view:e.constant(r),origin:e.constant(o(0,0))}},detached:function(t,n){var o=e.curry(r.absolute,n);return{parent:e.constant(n),view:e.constant(t),origin:o}},body:function(t,n){return{parent:e.constant(n),view:e.constant(t),origin:e.constant(o(0,0))}}}}),i("ephox.porkbun.Event",["ephox.katamari.api.Arr","ephox.katamari.api.Struct"],function(e,t){return function(n){var r=t.immutable.apply(null,n),o=[];return{bind:function(e){if(void 0===e)throw"Event bind error: undefined handler";o.push(e)},unbind:function(t){o=e.filter(o,function(e){return e!==t})},trigger:function(){var t=r.apply(null,arguments);e.each(o,function(e){e(t)})}}}}),i("ephox.porkbun.Events",["ephox.katamari.api.Obj"],function(e){return{create:function(t){return{registry:e.map(t,function(e){return{bind:e.bind,unbind:e.unbind}}),trigger:e.map(t,function(e){return e.trigger})}}}}),i("ephox.dragster.api.DragApis",["ephox.katamari.api.Contracts"],function(e){return{mode:e.exactly(["compare","extract","mutate","sink"]),sink:e.exactly(["element","start","stop","destroy"]),api:e.exactly(["forceDrop","drop","move","delayDrop"])}}),i("ephox.dragster.style.Styles",["ephox.katamari.api.Namespace"],function(e){return{resolve:e.css("ephox-dragster").resolve}}),i("ephox.dragster.detect.Blocker",["ephox.dragster.style.Styles","ephox.katamari.api.Merger","ephox.sugar.api.properties.Class","ephox.sugar.api.properties.Css","ephox.sugar.api.node.Element","ephox.sugar.api.dom.Remove"],function(e,t,n,r,o,i){return function(a){var u=t.merge({layerClass:e.resolve("blocker")},a),s=o.fromTag("div");return r.setAll(s,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),n.add(s,e.resolve("blocker")),n.add(s,u.layerClass),{element:function(){return s},destroy:function(){i.remove(s)}}}}),i("ephox.sugar.impl.FilteredEvent",["ephox.katamari.api.Fun","ephox.sugar.api.node.Element"],function(e,t){var n=function(t,n,r,o,i,a,u){return{target:e.constant(t),x:e.constant(n),y:e.constant(r),stop:o,prevent:i,kill:a,raw:e.constant(u)}},r=function(r,o){return function(i){if(r(i)){var a=t.fromDom(i.target),u=function(){i.stopPropagation()},s=function(){i.preventDefault()},c=e.compose(s,u),l=n(a,i.clientX,i.clientY,u,s,c,i);o(l)}}},o=function(t,n,o,a,u){var s=r(o,a);return t.dom().addEventListener(n,s,u),{unbind:e.curry(i,t,n,s,u)}},i=function(e,t,n,r){e.dom().removeEventListener(t,n,r)};return{bind:function(e,t,n,r){return o(e,t,n,r,!1)},capture:function(e,t,n,r){return o(e,t,n,r,!0)}}}),i("ephox.sugar.api.events.DomEvent",["ephox.katamari.api.Fun","ephox.sugar.impl.FilteredEvent"],function(e,t){var n=e.constant(!0);return{bind:function(e,r,o){return t.bind(e,r,n,o)},
capture:function(e,r,o){return t.capture(e,r,n,o)}}}),i("ephox.dragster.api.MouseDrag",["ephox.dragster.api.DragApis","ephox.dragster.detect.Blocker","ephox.katamari.api.Option","ephox.sugar.api.view.Position","ephox.sugar.api.events.DomEvent","ephox.sugar.api.dom.Insert","ephox.sugar.api.dom.Remove"],function(e,t,n,r,o,i,a){var u=function(e,t){return r(t.left()-e.left(),t.top()-e.top())},s=function(e){return n.some(r(e.x(),e.y()))},c=function(e,t){e.mutate(t.left(),t.top())},l=function(n,r){var u=t(r),s=o.bind(u.element(),"mousedown",n.forceDrop),c=o.bind(u.element(),"mouseup",n.drop),l=o.bind(u.element(),"mousemove",n.move),p=o.bind(u.element(),"mouseout",n.delayDrop),f=function(){u.destroy(),c.unbind(),l.unbind(),p.unbind(),s.unbind()},d=function(e){i.append(e,u.element())},m=function(){a.remove(u.element())};return e.sink({element:u.element,start:d,stop:m,destroy:f})};return e.mode({compare:u,extract:s,sink:l,mutate:c})}),i("ephox.dragster.detect.InDrag",["ephox.katamari.api.Option","ephox.porkbun.Event","ephox.porkbun.Events"],function(e,t,n){return function(){var r=e.none(),o=function(){r=e.none()},i=function(t,n){var o=r.map(function(e){return t.compare(e,n)});return r=e.some(n),o},a=function(e,t){t.extract(e).each(function(e){i(t,e).each(function(e){u.trigger.move(e)})})},u=n.create({move:t(["info"])});return{onEvent:a,reset:o,events:u.registry}}}),i("ephox.dragster.detect.NoDrag",["ephox.katamari.api.Fun"],function(e){return function(t){return{onEvent:function(e,t){},reset:e.noop}}}),i("ephox.dragster.detect.Movement",["ephox.dragster.detect.InDrag","ephox.dragster.detect.NoDrag"],function(e,t){return function(){var n=t(),r=e(),o=n,i=function(){o.reset(),o=r},a=function(){o.reset(),o=n},u=function(e,t){o.onEvent(e,t)};return{on:i,off:a,isOn:function(){return o===r},onEvent:u,events:r.events}}}),a("global!clearTimeout",clearTimeout),a("global!setTimeout",setTimeout),i("ephox.katamari.api.Throttler",["global!clearTimeout","global!setTimeout"],function(e,t){return{adaptable:function(n,r){var o=null,i=null;return{cancel:function(){null!==o&&(e(o),o=null,i=null)},throttle:function(){i=arguments,null===o&&(o=t(function(){n.apply(null,i),o=null,i=null},r))}}},first:function(n,r){var o=null;return{cancel:function(){null!==o&&(e(o),o=null)},throttle:function(){var e=arguments;null===o&&(o=t(function(){n.apply(null,e),o=null,e=null},r))}}},last:function(n,r){var o=null;return{cancel:function(){null!==o&&(e(o),o=null)},throttle:function(){var i=arguments;null!==o&&e(o),o=t(function(){n.apply(null,i),o=null,i=null},r)}}}}}),i("ephox.dragster.core.Dragging",["ephox.dragster.api.DragApis","ephox.dragster.detect.Movement","ephox.katamari.api.Throttler","ephox.porkbun.Event","ephox.porkbun.Events","global!Array"],function(e,t,n,r,o,i){return{setup:function(a,u,s){var c=!1,l=o.create({start:r([]),stop:r([])}),p=t(),f=function(){b.stop(),p.isOn()&&(p.off(),l.trigger.stop())},d=n.last(f,200),m=function(e){b.start(e),p.on(),l.trigger.start()},h=function(e,t){d.cancel(),p.onEvent(e,u)};p.events.move.bind(function(e){u.mutate(a,e.info())});var g=function(){c=!0},x=function(){c=!1},v=function(e){return function(){var t=i.prototype.slice.call(arguments,0);if(c)return e.apply(null,t)}},b=u.sink(e.api({forceDrop:f,drop:v(f),move:v(h),delayDrop:v(d.throttle)}),s),w=function(){b.destroy()};return{element:b.element,go:m,on:g,off:x,destroy:w,events:l.registry}}}}),i("ephox.dragster.api.Dragger",["ephox.dragster.api.MouseDrag","ephox.dragster.core.Dragging","global!Array"],function(e,t,n){return{transform:function(n,r){var o=void 0!==r?r:{},i=void 0!==o.mode?o.mode:e;return t.setup(n,i,r)}}}),i("ephox.snooker.resize.Mutation",["ephox.porkbun.Event","ephox.porkbun.Events"],function(e,t){return function(){var n=t.create({drag:e(["xDelta","yDelta"])});return{mutate:function(e,t){n.trigger.drag(e,t)},events:n.registry}}}),i("ephox.snooker.resize.BarMutation",["ephox.katamari.api.Option","ephox.porkbun.Event","ephox.porkbun.Events","ephox.snooker.resize.Mutation"],function(e,t,n,r){return function(){var o=n.create({drag:t(["xDelta","yDelta","target"])}),i=e.none(),a=r();return a.events.drag.bind(function(e){i.each(function(t){o.trigger.drag(e.xDelta(),e.yDelta(),t)})}),{assign:function(t){i=e.some(t)},get:function(){return i},mutate:a.mutate,events:o.registry}}}),i("ephox.sugar.api.search.SelectorExists",["ephox.sugar.api.search.SelectorFind"],function(e){return{any:function(t){return e.first(t).isSome()},ancestor:function(t,n,r){return e.ancestor(t,n,r).isSome()},sibling:function(t,n){return e.sibling(t,n).isSome()},child:function(t,n){return e.child(t,n).isSome()},descendant:function(t,n){return e.descendant(t,n).isSome()},closest:function(t,n,r){return e.closest(t,n,r).isSome()}}}),i("ephox.snooker.resize.BarManager",["ephox.dragster.api.Dragger","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.porkbun.Event","ephox.porkbun.Events","ephox.snooker.resize.BarMutation","ephox.snooker.resize.Bars","ephox.snooker.style.Styles","ephox.snooker.util.CellUtils","ephox.sugar.api.dom.Compare","ephox.sugar.api.events.DomEvent","ephox.sugar.api.node.Body","ephox.sugar.api.node.Node","ephox.sugar.api.properties.Attr","ephox.sugar.api.properties.Class","ephox.sugar.api.properties.Css","ephox.sugar.api.search.SelectorExists","ephox.sugar.api.search.SelectorFind","global!parseInt"],function(e,t,n,r,o,i,a,u,s,c,l,p,f,d,m,h,g,x,v){var b=u.resolve("resizer-bar-dragging");return function(u,w,y){var k=i(),S=e.transform(k,{}),C=n.none(),T=function(e,t){return n.from(d.get(e,t))};k.events.drag.bind(function(e){T(e.target(),"data-row").each(function(t){var n=s.getInt(e.target(),"top");h.set(e.target(),"top",n+e.yDelta()+"px")}),T(e.target(),"data-column").each(function(t){var n=s.getInt(e.target(),"left");h.set(e.target(),"left",n+e.xDelta()+"px")})});var R=function(e,t){return s.getInt(e,t)-v(d.get(e,"data-initial-"+t),10)};S.events.stop.bind(function(){k.get().each(function(e){C.each(function(t){T(e,"data-row").each(function(n){var r=R(e,"top");d.remove(e,"data-initial-top"),F.trigger.adjustHeight(t,r,v(n,10))}),T(e,"data-column").each(function(n){var r=R(e,"left");d.remove(e,"data-initial-left"),F.trigger.adjustWidth(t,r,v(n,10))}),a.refresh(u,t,y,w)})})});var A=function(e,t){F.trigger.startAdjust(),k.assign(e),d.set(e,"data-initial-"+t,v(h.get(e,t),10)),m.add(e,b),h.set(e,"opacity","0.2"),S.go(u.parent())},D=l.bind(u.parent(),"mousedown",function(e){a.isRowBar(e.target())&&A(e.target(),"top"),a.isColBar(e.target())&&A(e.target(),"left")}),O=function(e){return c.eq(e,u.view())},E=l.bind(u.view(),"mouseover",function(e){"table"===f.name(e.target())||g.ancestor(e.target(),"table",O)?(C="table"===f.name(e.target())?n.some(e.target()):x.ancestor(e.target(),"table",O),C.each(function(e){a.refresh(u,e,y,w)})):p.inBody(e.target())&&a.destroy(u)}),N=function(){D.unbind(),E.unbind(),S.destroy(),a.destroy(u)},B=function(e){a.refresh(u,e,y,w)},F=o.create({adjustHeight:r(["table","delta","row"]),adjustWidth:r(["table","delta","column"]),startAdjust:r([])});return{destroy:N,refresh:B,on:S.on,off:S.off,hideBars:t.curry(a.hide,u),showBars:t.curry(a.show,u),events:F.registry}}}),i("ephox.snooker.api.TableResize",["ephox.porkbun.Event","ephox.porkbun.Events","ephox.snooker.resize.Adjustments","ephox.snooker.resize.BarManager","ephox.snooker.resize.BarPositions"],function(e,t,n,r,o){return function(i,a){var u=o.height,s=r(i,a,u),c=t.create({beforeResize:e(["table"]),afterResize:e(["table"]),startDrag:e([])});return s.events.adjustHeight.bind(function(e){c.trigger.beforeResize(e.table());var t=u.delta(e.delta(),e.table());n.adjustHeight(e.table(),t,e.row(),u),c.trigger.afterResize(e.table())}),s.events.startAdjust.bind(function(e){c.trigger.startDrag()}),s.events.adjustWidth.bind(function(e){c.trigger.beforeResize(e.table());var t=a.delta(e.delta(),e.table());n.adjustWidth(e.table(),t,e.column(),a),c.trigger.afterResize(e.table())}),{on:s.on,off:s.off,hideBars:s.hideBars,showBars:s.showBars,destroy:s.destroy,events:c.registry}}}),i("tinymce.plugins.table.actions.TableWire",["ephox.snooker.api.ResizeWire","ephox.sugar.api.dom.Insert","ephox.sugar.api.dom.Remove","ephox.sugar.api.node.Body","ephox.sugar.api.node.Element","ephox.sugar.api.properties.Css","tinymce.plugins.table.alien.Util"],function(e,t,n,r,o,i,a){var u=function(){var e=o.fromTag("div");return i.setAll(e,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),t.append(r.body(),e),e};return{get:function(t,n){return t.inline?e.body(a.getBody(t),u()):e.only(o.fromDom(t.getDoc()))},remove:function(e,t){e.inline&&n.remove(t.parent())}}}),i("tinymce.plugins.table.actions.ResizeHandler",["ephox.katamari.api.Arr","ephox.katamari.api.Option","ephox.snooker.api.ResizeWire","ephox.snooker.api.TableDirection","ephox.snooker.api.TableResize","ephox.sugar.api.node.Element","ephox.sugar.api.properties.Attr","ephox.sugar.api.search.SelectorFilter","tinymce.plugins.table.actions.TableWire","tinymce.plugins.table.queries.Direction","tinymce.core.util.Tools"],function(e,t,n,r,o,i,a,u,s,c,l){return function(p){var f,d,m=t.none(),h=t.none(),g=t.none(),x=/(\d+(\.\d+)?)%/,v=function(e){return"TABLE"===e.nodeName},b=function(e){return p.dom.getStyle(e,"width")||p.dom.getAttrib(e,"width")},w=function(){return h},y=function(){return g.getOr(n.only(i.fromDom(p.getBody())))},k=function(){h.each(function(e){e.destroy()}),g.each(function(e){s.remove(p,e)})};return p.on("init",function(){var n=r(c.directionAt),i=s.get(p);if(g=t.some(i),p.settings.object_resizing&&!1!==p.settings.table_resize_bars&&(!0===p.settings.object_resizing||"table"===p.settings.object_resizing)){var l=o(i,n);l.on(),l.events.startDrag.bind(function(e){m=t.some(p.selection.getRng())}),l.events.afterResize.bind(function(t){var n=t.table(),r=u.descendants(n,"td[data-mce-style],th[data-mce-style]");e.each(r,function(e){a.remove(e,"data-mce-style")}),m.each(function(e){p.selection.setRng(e),p.focus()}),p.undoManager.add()}),h=t.some(l)}}),p.on("ObjectResizeStart",function(e){v(e.target)&&(f=e.width,d=b(e.target))}),p.on("ObjectResized",function(e){if(v(e.target)){var t=e.target;if(x.test(d)){var n=parseFloat(x.exec(d)[1],10),r=e.width*n/f;p.dom.setStyle(t,"width",r+"%")}else{var o=[];l.each(t.rows,function(e){l.each(e.cells,function(e){var t=p.dom.getStyle(e,"width",!0);o.push({cell:e,width:t})})}),l.each(o,function(e){p.dom.setStyle(e.cell,"width",e.width),p.dom.setAttrib(e.cell,"width",null)})}}}),{lazyResize:w,lazyWire:y,destroy:k}}}),i("ephox.snooker.api.CellLocation",[],function(){var e=function(e){return o(function(t,n,r,o){return t(e)})},t=function(e){return o(function(t,n,r,o){return n(e)})},n=function(e,t){return o(function(n,r,o,i){return o(e,t)})},r=function(e){return o(function(t,n,r,o){return o(e)})},o=function(e){return{fold:e}};return{none:e,first:t,middle:n,last:r}}),i("ephox.snooker.api.CellNavigation",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.snooker.api.CellLocation","ephox.snooker.api.TableLookup","ephox.sugar.api.dom.Compare"],function(e,t,n,r,o){var i=function(n,i){return r.table(n,i).bind(function(i){var a=r.cells(i);return e.findIndex(a,function(e){return o.eq(n,e)}).map(function(e){return{index:t.constant(e),all:t.constant(a)}})})};return{next:function(e,t){return i(e,t).fold(function(){return n.none(e)},function(t){return t.index()+1<t.all().length?n.middle(e,t.all()[t.index()+1]):n.last(e)})},prev:function(e,t){return i(e,t).fold(function(){return n.none()},function(t){return t.index()-1>=0?n.middle(e,t.all()[t.index()-1]):n.first(e)})}}}),i("ephox.sugar.api.selection.Situ",["ephox.katamari.api.Adt","ephox.katamari.api.Fun"],function(e,t){var n=e.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),r=function(e,t,n,r){return e.fold(t,n,r)},o=function(e){return e.fold(t.identity,t.identity,t.identity)};return{before:n.before,on:n.on,after:n.after,cata:r,getStart:o}}),i("ephox.sugar.api.selection.Selection",["ephox.katamari.api.Adt","ephox.katamari.api.Struct","ephox.sugar.api.node.Element","ephox.sugar.api.search.Traverse","ephox.sugar.api.selection.Situ"],function(e,t,n,r,o){var i=e.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),a=t.immutable("start","soffset","finish","foffset"),u=function(e){return i.exact(e.start(),e.soffset(),e.finish(),e.foffset())},s=function(e){return e.match({domRange:function(e){return n.fromDom(e.startContainer)},relative:function(e,t){return o.getStart(e)},exact:function(e,t,n,r){return e}})},c=function(e){var t=s(e);return r.defaultView(t)};return{domRange:i.domRange,relative:i.relative,exact:i.exact,exactFromRange:u,range:a,getWin:c}}),i("ephox.sugar.api.dom.DocumentPosition",["ephox.sugar.api.dom.Compare","ephox.sugar.api.node.Element","ephox.sugar.api.search.Traverse"],function(e,t,n){var r=function(e,t,r,o){var i=n.owner(e),a=i.dom().createRange();return a.setStart(e.dom(),t),a.setEnd(r.dom(),o),a},o=function(e,n,o,i){var a=r(e,n,o,i);return t.fromDom(a.commonAncestorContainer)};return{after:function(t,n,o,i){var a=r(t,n,o,i),u=e.eq(t,o)&&n===i;return a.collapsed&&!u},commonAncestorContainer:o}}),i("ephox.sugar.api.node.Fragment",["ephox.katamari.api.Arr","ephox.sugar.api.node.Element","global!document"],function(e,t,n){return{fromElements:function(r,o){var i=o||n,a=i.createDocumentFragment();return e.each(r,function(e){a.appendChild(e.dom())}),t.fromDom(a)}}}),i("ephox.sugar.selection.core.NativeRange",["ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.sugar.api.dom.Compare","ephox.sugar.api.node.Element"],function(e,t,n,r){var o=function(e,t){var n=e.document.createRange();return i(n,t),n},i=function(e,t){e.selectNodeContents(t.dom())},a=function(e,t){return t.compareBoundaryPoints(e.END_TO_START,e)<1&&t.compareBoundaryPoints(e.START_TO_END,e)>-1},u=function(e){return e.document.createRange()},s=function(e,t){t.fold(function(t){e.setStartBefore(t.dom())},function(t,n){e.setStart(t.dom(),n)},function(t){e.setStartAfter(t.dom())})},c=function(e,t){t.fold(function(t){e.setEndBefore(t.dom())},function(t,n){e.setEnd(t.dom(),n)},function(t){e.setEndAfter(t.dom())})},l=function(e,t){m(e),e.insertNode(t.dom())},p=function(e,t,r,o){return n.eq(e,r)&&t===o},f=function(e,t,n){var r=e.document.createRange();return s(r,t),c(r,n),r},d=function(e,t,n,r,o){var i=e.document.createRange();return i.setStart(t.dom(),n),i.setEnd(r.dom(),o),i},m=function(e){e.deleteContents()},h=function(e){var t=e.cloneContents();return r.fromDom(t)},g=function(t){return{left:e.constant(t.left),top:e.constant(t.top),right:e.constant(t.right),bottom:e.constant(t.bottom),width:e.constant(t.width),height:e.constant(t.height)}},x=function(e){var n=e.getClientRects(),r=n.length>0?n[0]:e.getBoundingClientRect();return r.width>0||r.height>0?t.some(r).map(g):t.none()},v=function(e){var n=e.getBoundingClientRect();return n.width>0||n.height>0?t.some(n).map(g):t.none()},b=function(e){return e.toString()};return{create:u,replaceWith:l,selectNodeContents:o,selectNodeContentsUsing:i,isCollapsed:p,relativeToNative:f,exactToNative:d,deleteContents:m,cloneFragment:h,getFirstRect:x,getBounds:v,isWithin:a,toString:b}}),i("ephox.sugar.selection.core.SelectionDirection",["ephox.katamari.api.Adt","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.katamari.api.Thunk","ephox.sugar.api.node.Element","ephox.sugar.selection.core.NativeRange"],function(e,t,n,r,o,i){var a=e.generate([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),u=function(e,t,n){return t(o.fromDom(n.startContainer),n.startOffset,o.fromDom(n.endContainer),n.endOffset)},s=function(e,o){return o.match({domRange:function(e){return{ltr:t.constant(e),rtl:n.none}},relative:function(t,o){return{ltr:r.cached(function(){return i.relativeToNative(e,t,o)}),rtl:r.cached(function(){return n.some(i.relativeToNative(e,o,t))})}},exact:function(t,o,a,u){return{ltr:r.cached(function(){return i.exactToNative(e,t,o,a,u)}),rtl:r.cached(function(){return n.some(i.exactToNative(e,a,u,t,o))})}}})},c=function(e,t){var n=t.ltr();if(n.collapsed){return t.rtl().filter(function(e){return!1===e.collapsed}).map(function(e){return a.rtl(o.fromDom(e.endContainer),e.endOffset,o.fromDom(e.startContainer),e.startOffset)}).getOrThunk(function(){return u(0,a.ltr,n)})}return u(0,a.ltr,n)},l=function(e,t){var n=s(e,t);return c(0,n)},p=function(e,t){return l(e,t).match({ltr:function(t,n,r,o){var i=e.document.createRange();return i.setStart(t.dom(),n),i.setEnd(r.dom(),o),i},rtl:function(t,n,r,o){var i=e.document.createRange();return i.setStart(r.dom(),o),i.setEnd(t.dom(),n),i}})};return{ltr:a.ltr,rtl:a.rtl,diagnose:l,asLtrRange:p}}),i("ephox.sugar.selection.alien.Geometry",["global!Math"],function(e){var t=function(t,n,r,o,i){if(0===i)return 0;if(n===o)return i-1;for(var a=o,u=1;u<i;u++){var s=t(u),c=e.abs(n-s.left);if(r>s.bottom);else{if(r<s.top||c>a)return u-1;a=c}}return 0};return{inRect:function(e,t,n){return t>=e.left&&t<=e.right&&n>=e.top&&n<=e.bottom},searchForPoint:t}}),i("ephox.sugar.selection.query.TextPoint",["ephox.katamari.api.Option","ephox.katamari.api.Options","ephox.sugar.api.node.Text","ephox.sugar.selection.alien.Geometry","global!Math"],function(e,t,n,r,o){var i=function(e,t,o,i,a){var u=function(n){var r=e.dom().createRange();return r.setStart(t.dom(),n),r.collapse(!0),r},s=function(e){return u(e).getBoundingClientRect()},c=n.get(t).length,l=r.searchForPoint(s,o,i,a.right,c);return u(l)};return{locate:function(n,o,a,u){var s=n.dom().createRange();s.selectNode(o.dom());var c=s.getClientRects();return t.findMap(c,function(t){return r.inRect(t,a,u)?e.some(t):e.none()}).map(function(e){return i(n,o,a,u,e)})}}}),i("ephox.sugar.selection.query.ContainerPoint",["ephox.katamari.api.Option","ephox.katamari.api.Options","ephox.sugar.api.node.Node","ephox.sugar.api.search.Traverse","ephox.sugar.selection.alien.Geometry","ephox.sugar.selection.query.TextPoint","global!Math"],function(e,t,n,r,o,i,a){var u=function(n,i,a,u){var c=n.dom().createRange(),l=r.children(i);return t.findMap(l,function(t){return c.selectNode(t.dom()),o.inRect(c.getBoundingClientRect(),a,u)?s(n,t,a,u):e.none()})},s=function(e,t,r,o){return(n.isText(t)?i.locate:u)(e,t,r,o)};return{locate:function(e,t,n,r){var o=e.dom().createRange();o.selectNode(t.dom());var i=o.getBoundingClientRect(),u=a.max(i.left,a.min(i.right,n)),c=a.max(i.top,a.min(i.bottom,r));return s(e,t,u,c)}}}),i("ephox.sugar.selection.query.EdgePoint",["ephox.katamari.api.Option","ephox.sugar.api.search.Traverse","ephox.sugar.api.selection.CursorPosition"],function(e,t,n){var r=function(e,t){return t-e.left<e.right-t},o=function(e,t,n){var r=e.dom().createRange();return r.selectNode(t.dom()),r.collapse(n),r},i=function(e,t,i){var a=e.dom().createRange();a.selectNode(t.dom());var u=a.getBoundingClientRect(),s=r(u,i);return(!0===s?n.first:n.last)(t).map(function(t){return o(e,t,s)})},a=function(t,n,i){var a=n.dom().getBoundingClientRect(),u=r(a,i);return e.some(o(t,n,u))};return{search:function(e,n,r){return(0===t.children(n).length?a:i)(e,n,r)}}}),i("ephox.sugar.selection.query.CaretRange",["ephox.katamari.api.Option","ephox.sugar.api.node.Element","ephox.sugar.api.search.Traverse","ephox.sugar.api.selection.Selection","ephox.sugar.selection.query.ContainerPoint","ephox.sugar.selection.query.EdgePoint","global!document","global!Math"],function(e,t,n,r,o,i,a,u){var s=function(t,n,r){return e.from(t.dom().caretPositionFromPoint(n,r)).bind(function(n){if(null===n.offsetNode)return e.none();var r=t.dom().createRange();return r.setStart(n.offsetNode,n.offset),r.collapse(),e.some(r)})},c=function(t,n,r){return e.from(t.dom().caretRangeFromPoint(n,r))},l=function(e,t,n,r){var i=e.dom().createRange();i.selectNode(t.dom());var a=i.getBoundingClientRect(),s=u.max(a.left,u.min(a.right,n)),c=u.max(a.top,u.min(a.bottom,r));return o.locate(e,t,s,c)},p=function(e,r,o){return t.fromPoint(e,r,o).bind(function(t){var a=function(){return i.search(e,t,r)};return 0===n.children(t).length?a():l(e,t,r,o).orThunk(a)})},f=a.caretPositionFromPoint?s:a.caretRangeFromPoint?c:p;return{fromPoint:function(e,n,o){var i=t.fromDom(e.document);return f(i,n,o).map(function(e){return r.range(t.fromDom(e.startContainer),e.startOffset,t.fromDom(e.endContainer),e.endOffset)})}}}),i("ephox.sugar.selection.query.Within",["ephox.katamari.api.Arr","ephox.sugar.api.node.Element","ephox.sugar.api.node.Node","ephox.sugar.api.search.SelectorFilter","ephox.sugar.api.search.Selectors","ephox.sugar.selection.core.NativeRange","ephox.sugar.selection.core.SelectionDirection"],function(e,t,n,r,o,i,a){var u=function(t,n,a,u){var s=i.create(t),c=o.is(n,u)?[n]:[],l=c.concat(r.descendants(n,u));return e.filter(l,function(e){return i.selectNodeContentsUsing(s,e),i.isWithin(a,s)})};return{find:function(e,r,o){var i=a.asLtrRange(e,r),s=t.fromDom(i.commonAncestorContainer);return n.isElement(s)?u(e,s,i,o):[]}}}),i("ephox.sugar.selection.quirks.Prefilter",["ephox.katamari.api.Arr","ephox.sugar.api.node.Element","ephox.sugar.api.node.Node","ephox.sugar.api.selection.Selection","ephox.sugar.api.selection.Situ"],function(e,t,n,r,o){var i=function(t,r){var i=n.name(t);return"input"===i?o.after(t):e.contains(["br","img"],i)?0===r?o.before(t):o.after(t):o.on(t,r)},a=function(e,t){var n=e.fold(o.before,i,o.after),a=t.fold(o.before,i,o.after);return r.relative(n,a)},u=function(e,t,n,o){var a=i(e,t),u=i(n,o);return r.relative(a,u)};return{beforeSpecial:i,preprocess:function(e){return e.match({domRange:function(e){var n=t.fromDom(e.startContainer),r=t.fromDom(e.endContainer);return u(n,e.startOffset,r,e.endOffset)},relative:a,exact:u})},preprocessRelative:a,preprocessExact:u}}),i("ephox.sugar.api.selection.WindowSelection",["ephox.katamari.api.Option","ephox.sugar.api.dom.DocumentPosition","ephox.sugar.api.node.Element","ephox.sugar.api.node.Fragment","ephox.sugar.api.search.Traverse","ephox.sugar.api.selection.Selection","ephox.sugar.selection.core.NativeRange","ephox.sugar.selection.core.SelectionDirection","ephox.sugar.selection.query.CaretRange","ephox.sugar.selection.query.Within","ephox.sugar.selection.quirks.Prefilter"],function(e,t,n,r,o,i,a,u,s,c,l){var p=function(t,n){e.from(t.getSelection()).each(function(e){e.removeAllRanges(),e.addRange(n)})},f=function(e,t,n,r,o){var i=a.exactToNative(e,t,n,r,o);p(e,i)},d=function(e,t,n){return c.find(e,t,n)},m=function(e,t){return u.diagnose(e,t).match({ltr:function(t,n,r,o){f(e,t,n,r,o)},rtl:function(t,n,r,o){var i=e.getSelection();i.extend?(i.collapse(t.dom(),n),i.extend(r.dom(),o)):f(e,r,o,t,n)}})},h=function(e,t,n,r,o){var i=l.preprocessExact(t,n,r,o);m(e,i)},g=function(e,t,n){var r=l.preprocessRelative(t,n);m(e,r)},x=function(e){var t=i.getWin(e).dom(),n=function(e,n,r,o){return a.exactToNative(t,e,n,r,o)},r=l.preprocess(e);return u.diagnose(t,r).match({ltr:n,rtl:n})},v=function(t){if(t.rangeCount>0){var r=t.getRangeAt(0),o=t.getRangeAt(t.rangeCount-1);return e.some(i.range(n.fromDom(r.startContainer),r.startOffset,n.fromDom(o.endContainer),o.endOffset))}return e.none()},b=function(r){var o=n.fromDom(r.anchorNode),a=n.fromDom(r.focusNode);return t.after(o,r.anchorOffset,a,r.focusOffset)?e.some(i.range(n.fromDom(r.anchorNode),r.anchorOffset,n.fromDom(r.focusNode),r.focusOffset)):v(r)},w=function(e,t){var n=a.selectNodeContents(e,t);p(e,n)},y=function(e,t){var r=a.selectNodeContents(e,t);return i.range(n.fromDom(r.startContainer),r.startOffset,n.fromDom(r.endContainer),r.endOffset)},k=function(t){var n=t.getSelection();return n.rangeCount>0?b(n):e.none()},S=function(e){return k(e).map(function(e){return i.exact(e.start(),e.soffset(),e.finish(),e.foffset())})},C=function(e,t){var n=u.asLtrRange(e,t);return a.getFirstRect(n)},T=function(e,t){var n=u.asLtrRange(e,t);return a.getBounds(n)},R=function(e,t,n){return s.fromPoint(e,t,n)},A=function(e,t){var n=u.asLtrRange(e,t);return a.toString(n)};return{setExact:h,getExact:k,get:S,setRelative:g,toNative:x,setToElement:w,clear:function(e){e.getSelection().removeAllRanges()},clone:function(e,t){var n=u.asLtrRange(e,t);return a.cloneFragment(n)},replace:function(e,t,n){var o=u.asLtrRange(e,t),i=r.fromElements(n,e.document);a.replaceWith(o,i)},deleteAt:function(e,t){var n=u.asLtrRange(e,t);a.deleteContents(n)},forElement:y,getFirstRect:C,getBounds:T,getAtPoint:R,findWithin:d,getAsString:A}}),i("tinymce.core.util.VK",["global!tinymce.util.Tools.resolve"],function(e){return e("tinymce.util.VK")}),i("tinymce.plugins.table.queries.TabContext",["ephox.katamari.api.Arr","ephox.katamari.api.Option","ephox.snooker.api.CellNavigation","ephox.snooker.api.TableLookup","ephox.sugar.api.dom.Compare","ephox.sugar.api.node.Element","ephox.sugar.api.node.Node","ephox.sugar.api.search.SelectorFilter","ephox.sugar.api.search.SelectorFind","ephox.sugar.api.selection.CursorPosition","ephox.sugar.api.selection.Selection","ephox.sugar.api.selection.WindowSelection","tinymce.core.util.VK","tinymce.plugins.table.alien.Util","tinymce.plugins.table.queries.TableTargets"],function(e,t,n,r,o,i,a,u,s,c,l,p,f,d,m){var h=function(e,t,r,o){return b(e,t,n.next(r),o)},g=function(e,t,r,o){return b(e,t,n.prev(r),o)},x=function(e,t){var n=l.exact(t,0,t,0);return p.toNative(n)},v=function(t,n){var r=u.descendants(n,"tr");return e.last(r).bind(function(e){return s.descendant(e,"td,th").map(function(e){return x(0,e)})})},b=function(e,n,o,i,a){return o.fold(t.none,t.none,function(e,t){return c.first(t).map(function(e){return x(0,e)})},function(t){return r.table(t,n).bind(function(n){var r=m.noMenu(t);return e.undoManager.transact(function(){i.insertRowsAfter(n,r)}),v(0,n)})})},w=["table","li","dl"];return{handle:function(t,n,u,s){if(t.keyCode===f.TAB){var c=d.getBody(n),l=function(t){var n=a.name(t);return o.eq(t,c)||e.contains(w,n)},p=n.selection.getRng();if(p.collapsed){var m=i.fromDom(p.startContainer);r.cell(m,l).each(function(e){t.preventDefault(),(t.shiftKey?g:h)(n,l,e,u,s).each(function(e){n.selection.setRng(e)})})}}}}}),i("ephox.darwin.api.Responses",["ephox.katamari.api.Struct"],function(e){return{response:e.immutable("selection","kill")}}),i("ephox.darwin.api.SelectionKeys",[],function(){var e=function(e){return function(t){return t===e}},t=e(38),n=e(40),r=function(e){return e>=37&&e<=40};return{ltr:{isBackward:e(37),isForward:e(39)},rtl:{isBackward:e(39),isForward:e(37)},isUp:t,isDown:n,isNavigation:r}});i("ephox.darwin.selection.Util",["ephox.katamari.api.Fun","ephox.sugar.api.node.Element","ephox.sugar.api.selection.Situ","ephox.sugar.selection.core.SelectionDirection"],function(e,t,n,r){return{convertToRange:function(n,o){var i=r.asLtrRange(n,o);return{start:e.constant(t.fromDom(i.startContainer)),soffset:e.constant(i.startOffset),finish:e.constant(t.fromDom(i.endContainer)),foffset:e.constant(i.endOffset)}},makeSitus:function(t,r,o,i){return{start:e.constant(n.on(t,r)),finish:e.constant(n.on(o,i))}}}}),i("ephox.darwin.api.WindowBridge",["ephox.darwin.selection.Util","ephox.katamari.api.Fun","ephox.katamari.api.Obj","ephox.katamari.api.Option","ephox.sugar.api.node.Element","ephox.sugar.api.selection.Selection","ephox.sugar.api.selection.Situ","ephox.sugar.api.selection.WindowSelection"],function(e,t,n,r,o,i,a,u){return function(s){var c=function(e,t){return r.from(s.document.elementFromPoint(e,t)).map(o.fromDom)},l=function(e){return e.dom().getBoundingClientRect()},p=function(e,r,o,a){var c=i.exact(e,r,o,a);return u.getFirstRect(s,c).map(function(e){return n.map(e,t.apply)})},f=function(){return u.get(s).map(function(t){return e.convertToRange(s,t)})},d=function(t){var n=i.relative(t.start(),t.finish());return e.convertToRange(s,n)},m=function(e,n){return u.getAtPoint(s,e,n).map(function(e){return{start:t.constant(a.on(e.start(),e.soffset())),finish:t.constant(a.on(e.finish(),e.foffset()))}})},h=function(){u.clear(s)},g=function(e){u.setToElement(s,e)};return{elementFromPoint:c,getRect:l,getRangedRect:p,getSelection:f,fromSitus:d,situsFromPoint:m,clearSelection:h,setSelection:function(e){u.setExact(s,e.start(),e.soffset(),e.finish(),e.foffset())},setRelativeSelection:function(e,t){u.setRelative(s,e,t)},selectContents:g,getInnerHeight:function(){return s.innerHeight},getScrollY:function(){return s.scrollY},scrollBy:function(e,t){s.scrollBy(e,t)}}}}),i("ephox.darwin.keyboard.KeySelection",["ephox.darwin.api.Responses","ephox.darwin.selection.CellSelection","ephox.darwin.selection.Util","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.sugar.api.dom.Compare","ephox.sugar.api.search.SelectorFind","ephox.sugar.api.selection.Awareness","ephox.sugar.api.selection.Selection","ephox.sugar.api.selection.Situ"],function(e,t,n,r,o,i,a,u,s,c){var l=function(e,t,n,r,u,s,c){return i.eq(n,u)&&r===s?o.none():a.closest(n,"td,th",t).bind(function(n){return a.closest(u,"td,th",t).bind(function(r){return p(e,t,n,r,c)})})},p=function(r,a,s,c,l){if(!i.eq(s,c)){var p=t.identify(s,c,a).getOr([]);if(p.length>0)return l(r,p,s,c),o.some(e.response(o.some(n.makeSitus(s,0,s,u.getEnd(s))),!0))}return o.none()};return{sync:l,detect:p,update:function(e,n,r,o,i){var a=function(e){return i.clear(r),i.selectRange(r,e.boxes(),e.start(),e.finish()),e.boxes()};return t.shiftSelection(o,e,n,i.firstSelectedSelector(),i.lastSelectedSelector()).map(a)}}}),i("ephox.darwin.keyboard.Carets",["ephox.katamari.api.Struct"],function(e){var t=e.immutableBag(["left","top","right","bottom"],[]),n=function(e,n){return t({left:e.left(),top:e.top()+n,right:e.right(),bottom:e.bottom()+n})},r=function(e,n){return t({left:e.left(),top:e.top()-n,right:e.right(),bottom:e.bottom()-n})},o=function(e,n){var r=e.bottom()-e.top();return t({left:e.left(),top:n-r,right:e.right(),bottom:n})},i=function(e,n){var r=e.bottom()-e.top();return t({left:e.left(),top:n,right:e.right(),bottom:n+r})},a=function(e,n,r){return t({left:e.left()+n,top:e.top()+r,right:e.right()+n,bottom:e.bottom()+r})},u=function(e){return e.top()},s=function(e){return e.bottom()},c=function(e){return"("+e.left()+", "+e.top()+") -> ("+e.right()+", "+e.bottom()+")"};return{nu:t,moveUp:r,moveDown:n,moveBottomTo:o,moveTopTo:i,getTop:u,getBottom:s,translate:a,toString:c}}),i("ephox.darwin.keyboard.Rectangles",["ephox.darwin.keyboard.Carets","ephox.katamari.api.Option","ephox.sugar.api.node.Node","ephox.sugar.api.selection.Awareness"],function(e,t,n,r){var o=function(e,n,o){return o>=0&&o<r.getEnd(n)?e.getRangedRect(n,o,n,o+1):o>0?e.getRangedRect(n,o-1,n,o):t.none()},i=function(t){return e.nu({left:t.left,top:t.top,right:t.right,bottom:t.bottom})},a=function(e,n){return t.some(e.getRect(n))};return{getBoxAt:function(e,r,u){return n.isElement(r)?a(e,r).map(i):n.isText(r)?o(e,r,u).map(i):t.none()},getEntireBox:function(e,o){return n.isElement(o)?a(e,o).map(i):n.isText(o)?e.getRangedRect(o,0,o,r.getEnd(o)).map(i):t.none()}}}),i("ephox.phoenix.gather.Walker",["ephox.katamari.api.Arr","ephox.katamari.api.Option","ephox.katamari.api.Struct"],function(e,t,n){var r=n.immutable("item","mode"),o=function(e,t,n,o){var a=void 0!==o?o:i;return e.property().parent(t).map(function(e){return r(e,a)})},i=function(e,t,n,o){var i=void 0!==o?o:a;return n.sibling(e,t).map(function(e){return r(e,i)})},a=function(e,t,n,o){var i=void 0!==o?o:a,u=e.property().children(t);return n.first(u).map(function(e){return r(e,i)})},u=[{current:o,next:i,fallback:t.none()},{current:i,next:a,fallback:t.some(o)},{current:a,next:a,fallback:t.some(i)}],s=function(t,n,r,o,i){var a=void 0!==i?i:u;return e.find(a,function(e){return e.current===r}).bind(function(e){return e.current(t,n,o,e.next).orThunk(function(){return e.fallback.bind(function(e){return s(t,n,e,o)})})})};return{backtrack:o,sidestep:i,advance:a,go:s}}),i("ephox.phoenix.gather.Walkers",["ephox.katamari.api.Option"],function(e){return{left:function(){return{sibling:function(e,t){return e.query().prevSibling(t)},first:function(t){return t.length>0?e.some(t[t.length-1]):e.none()}}},right:function(){return{sibling:function(e,t){
return e.query().nextSibling(t)},first:function(t){return t.length>0?e.some(t[0]):e.none()}}}}}),i("ephox.phoenix.gather.Seeker",["ephox.katamari.api.Option","ephox.phoenix.gather.Walker","ephox.phoenix.gather.Walkers"],function(e,t,n){var r=function(n,o,i,a,u,s){return t.go(n,o,a,u).bind(function(t){return s(t.item())?e.none():i(t.item())?e.some(t.item()):r(n,t.item(),i,t.mode(),u,s)})};return{left:function(e,o,i,a){return r(e,o,i,t.sidestep,n.left(),a)},right:function(e,o,i,a){return r(e,o,i,t.sidestep,n.right(),a)}}}),i("ephox.phoenix.api.general.Gather",["ephox.katamari.api.Fun","ephox.phoenix.gather.Seeker","ephox.phoenix.gather.Walker","ephox.phoenix.gather.Walkers"],function(e,t,n,r){var o=function(e,t){return 0===e.property().children(t).length},i=function(t,n,r){return u(t,n,e.curry(o,t),r)},a=function(t,n,r){return s(t,n,e.curry(o,t),r)},u=function(e,n,r,o){return t.left(e,n,r,o)},s=function(e,n,r,o){return t.right(e,n,r,o)};return{before:i,after:a,seekLeft:u,seekRight:s,walkers:function(){return{left:r.left,right:r.right}},walk:function(e,t,r,o,i){return n.go(e,t,r,o,i)},backtrack:n.backtrack,sidestep:n.sidestep,advance:n.advance}}),i("ephox.phoenix.api.dom.DomGather",["ephox.boss.api.DomUniverse","ephox.phoenix.api.general.Gather"],function(e,t){var n=e();return{gather:function(e,r,o){return t.gather(n,e,r,o)},before:function(e,r){return t.before(n,e,r)},after:function(e,r){return t.after(n,e,r)},seekLeft:function(e,r,o){return t.seekLeft(n,e,r,o)},seekRight:function(e,r,o){return t.seekRight(n,e,r,o)},walkers:function(){return t.walkers()},walk:function(e,r,o,i){return t.walk(n,e,r,o,i)}}}),i("ephox.darwin.keyboard.Retries",["ephox.darwin.keyboard.Carets","ephox.darwin.keyboard.Rectangles","ephox.katamari.api.Adt","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.phoenix.api.dom.DomGather","ephox.robin.api.dom.DomStructure","ephox.sugar.api.node.Node","ephox.sugar.api.search.PredicateFind","global!Math"],function(e,t,n,r,o,i,a,u,s,c){var l=n.generate([{none:[]},{retry:["caret"]}]),p=function(e,t){return e.left()<t.left()||c.abs(t.right()-e.left())<1||e.left()>t.right()},f=function(e,n,o){return s.closest(n,a.isBlock).fold(r.constant(!1),function(n){return t.getEntireBox(e,n).exists(function(e){return p(o,e)})})},d=function(t,n,r,o,i){var a=e.moveDown(i,5);return c.abs(r.bottom()-o.bottom())<1?l.retry(a):r.top()>i.bottom()?l.retry(a):r.top()===i.bottom()?l.retry(e.moveDown(i,1)):f(t,n,i)?l.retry(e.translate(a,5,0)):l.none()},m=function(t,n,r,o,i){var a=e.moveUp(i,5);return c.abs(r.top()-o.top())<1?l.retry(a):r.bottom()<i.top()?l.retry(a):r.bottom()===i.top()?l.retry(e.moveUp(i,1)):f(t,n,i)?l.retry(e.translate(a,5,0)):l.none()},h={point:e.getTop,adjuster:m,move:e.moveUp,gather:i.before},g={point:e.getBottom,adjuster:d,move:e.moveDown,gather:i.after},x=function(e,t,n){return e.elementFromPoint(t,n).filter(function(e){return"table"===u.name(e)}).isSome()},v=function(e,t,n,r,o){return b(e,t,n,t.move(r,5),o)},b=function(e,n,r,i,a){return 0===a?o.some(i):x(e,i.left(),n.point(i))?v(e,n,r,i,a-1):e.situsFromPoint(i.left(),n.point(i)).bind(function(u){return u.start().fold(o.none,function(u,s){return t.getEntireBox(e,u,s).bind(function(t){return n.adjuster(e,u,t,r,i).fold(o.none,function(t){return b(e,n,r,t,a-1)})}).orThunk(function(){return o.some(i)})},o.none)})},w=function(e,t){return e.situsFromPoint(t.left(),t.bottom()+5)},y=function(e,t){return e.situsFromPoint(t.left(),t.top()-5)},k=function(e,t,n){return e.point(t)>n.getInnerHeight()?o.some(e.point(t)-n.getInnerHeight()):e.point(t)<0?o.some(-e.point(t)):o.none()},S=function(e,t,n){var r=e.move(n,5),o=b(t,e,n,r,100).getOr(r);return k(e,o,t).fold(function(){return t.situsFromPoint(o.left(),e.point(o))},function(n){return t.scrollBy(0,n),t.situsFromPoint(o.left(),e.point(o)-n)})};return{tryUp:r.curry(S,h),tryDown:r.curry(S,g),ieTryUp:y,ieTryDown:w,getJumpSize:r.constant(5)}}),i("ephox.darwin.navigation.BeforeAfter",["ephox.katamari.api.Adt","ephox.robin.api.dom.DomParent","ephox.sugar.api.dom.Compare","ephox.sugar.api.search.SelectorFind","ephox.sugar.api.selection.Awareness"],function(e,t,n,r,o){var i=e.generate([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),a=function(e,t,n){var r=e.getRect(t),o=e.getRect(n);return o.right>r.left&&o.left<r.right},u=function(e){return r.closest(e,"tr")};return{verify:function(e,s,c,l,p,f,d){return r.closest(l,"td,th",d).bind(function(c){return r.closest(s,"td,th",d).map(function(r){return n.eq(c,r)?n.eq(l,c)&&o.getEnd(c)===p?f(r):i.none("in same cell"):t.sharedOne(u,[c,r]).fold(function(){return a(e,r,c)?i.success():f(r)},function(e){return f(r)})})}).getOr(i.none("default"))},cata:function(e,t,n,r,o){return e.fold(t,n,r,o)},adt:i}}),i("ephox.phoenix.api.data.Spot",["ephox.katamari.api.Struct"],function(e){return{point:e.immutable("element","offset"),delta:e.immutable("element","deltaOffset"),range:e.immutable("element","start","finish"),points:e.immutable("begin","end"),text:e.immutable("element","text")}}),i("ephox.sugar.api.search.ElementAddress",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.katamari.api.Struct","ephox.sugar.api.dom.Compare","ephox.sugar.api.search.PredicateFind","ephox.sugar.api.search.SelectorFilter","ephox.sugar.api.search.SelectorFind","ephox.sugar.api.search.Traverse"],function(e,t,n,r,o,i,a,u,s){var c=r.immutable("ancestor","descendants","element","index"),l=r.immutable("parent","children","element","index"),p=function(e,t){return i.closest(e,function(e){return s.parent(e).exists(function(e){return o.eq(e,t)})})},f=function(e){return s.parent(e).bind(function(t){var n=s.children(t);return d(n,e).map(function(r){return l(t,n,e,r)})})},d=function(n,r){return e.findIndex(n,t.curry(o.eq,r))};return{childOf:p,indexOf:d,indexInParent:f,selectorsInParent:function(e,t){return s.parent(e).bind(function(n){var r=a.children(n,t);return d(r,e).map(function(t){return l(n,r,e,t)})})},descendantsInAncestor:function(e,t,n){return u.closest(e,t).bind(function(t){var r=a.descendants(t,n);return d(r,e).map(function(n){return c(t,r,e,n)})})}}}),i("ephox.darwin.navigation.BrTags",["ephox.darwin.navigation.BeforeAfter","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.phoenix.api.data.Spot","ephox.sugar.api.node.Node","ephox.sugar.api.node.Text","ephox.sugar.api.search.ElementAddress","ephox.sugar.api.search.Traverse","ephox.sugar.api.selection.Awareness","ephox.sugar.api.selection.Situ"],function(e,t,n,r,o,i,a,u,s,c){var l=function(e){return"br"===o.name(e)},p=function(e,t,r){return t(e,r).bind(function(e){return o.isText(e)&&0===i.get(e).trim().length?p(e,t,r):n.some(e)})},f=function(e,t,n){return n.traverse(t).orThunk(function(){return p(t,n.gather,e)}).map(n.relative)},d=function(e,t){return u.child(e,t).filter(l).orThunk(function(){return u.child(e,t-1).filter(l)})},m=function(e,t,n,r){return d(t,n).bind(function(t){return r.traverse(t).fold(function(){return p(t,r.gather,e).map(r.relative)},function(e){return a.indexInParent(e).map(function(e){return c.on(e.parent(),e.index())})})})};return{tryBr:function(e,n,r,o){return(l(n)?f(e,n,o):m(e,n,r,o)).map(function(e){return{start:t.constant(e),finish:t.constant(e)}})},process:function(t){return e.cata(t,function(e){return n.none("BR ADT: none")},function(){return n.none()},function(e){return n.some(r.point(e,0))},function(e){return n.some(r.point(e,s.getEnd(e)))})}}}),i("ephox.darwin.keyboard.TableKeys",["ephox.darwin.keyboard.Carets","ephox.darwin.keyboard.Rectangles","ephox.darwin.keyboard.Retries","ephox.darwin.navigation.BeforeAfter","ephox.darwin.navigation.BrTags","ephox.katamari.api.Option","ephox.phoenix.api.data.Spot","ephox.sand.api.PlatformDetection","ephox.sugar.api.dom.Compare","ephox.sugar.api.selection.Awareness"],function(e,t,n,r,o,i,a,u,s,c){var l=u.detect(),p=function(e,t,n){return e.getSelection().bind(function(u){return o.tryBr(t,u.finish(),u.foffset(),n).fold(function(){return i.some(a.point(u.finish(),u.foffset()))},function(i){var a=e.fromSitus(i),s=r.verify(e,u.finish(),u.foffset(),a.finish(),a.foffset(),n.failure,t);return o.process(s)})})},f=function(t,n,o,a,u,l){return 0===l?i.none():h(t,n,o,a,u).bind(function(p){var m=t.fromSitus(p),h=r.verify(t,o,a,m.finish(),m.foffset(),u.failure,n);return r.cata(h,function(){return i.none()},function(){return i.some(p)},function(r){return s.eq(o,r)&&0===a?d(t,o,a,e.moveUp,u):f(t,n,r,0,u,l-1)},function(r){return s.eq(o,r)&&a===c.getEnd(r)?d(t,o,a,e.moveDown,u):f(t,n,r,c.getEnd(r),u,l-1)})})},d=function(e,r,o,i,a){return t.getBoxAt(e,r,o).bind(function(t){return m(e,a,i(t,n.getJumpSize()))})},m=function(e,t,n){return l.browser.isChrome()||l.browser.isSafari()||l.browser.isFirefox()||l.browser.isEdge()?t.otherRetry(e,n):l.browser.isIE()?t.ieRetry(e,n):i.none()},h=function(e,n,r,o,i){return t.getBoxAt(e,r,o).bind(function(t){return m(e,i,t)})};return{handle:function(e,t,n){return p(e,t,n).bind(function(r){return f(e,t,r.element(),r.offset(),n,20).map(e.fromSitus)})}}}),i("ephox.sugar.api.search.PredicateExists",["ephox.sugar.api.search.PredicateFind"],function(e){return{any:function(t){return e.first(t).isSome()},ancestor:function(t,n,r){return e.ancestor(t,n,r).isSome()},closest:function(t,n,r){return e.closest(t,n,r).isSome()},sibling:function(t,n){return e.sibling(t,n).isSome()},child:function(t,n){return e.child(t,n).isSome()},descendant:function(t,n){return e.descendant(t,n).isSome()}}}),i("ephox.darwin.keyboard.VerticalMovement",["ephox.darwin.api.Responses","ephox.darwin.keyboard.KeySelection","ephox.darwin.keyboard.TableKeys","ephox.darwin.selection.Util","ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.sand.api.PlatformDetection","ephox.sugar.api.dom.Compare","ephox.sugar.api.search.PredicateExists","ephox.sugar.api.search.SelectorFilter","ephox.sugar.api.search.SelectorFind","ephox.sugar.api.search.Traverse","ephox.sugar.api.selection.Awareness","ephox.sugar.api.selection.CursorPosition"],function(e,t,n,r,o,i,a,u,s,c,l,p,f,d,m){var h=u.detect(),g=function(e,t){return c.ancestor(e,function(e){return f.parent(e).exists(function(e){return s.eq(e,t)})})},x=function(e,t,r,o,u){return p.closest(o,"td,th",t).bind(function(o){return p.closest(o,"table",t).bind(function(s){return g(u,s)?n.handle(e,t,r).bind(function(e){return p.closest(e.finish(),"td,th",t).map(function(t){return{start:i.constant(o),finish:i.constant(t),range:i.constant(e)}})}):a.none()})})},v=function(t,n,o,i,u,s){return h.browser.isIE()?a.none():s(i,n).orThunk(function(){return x(t,n,o,i,u).map(function(t){var n=t.range();return e.response(a.some(r.makeSitus(n.start(),n.soffset(),n.finish(),n.foffset())),!0)})})},b=function(t,n){return p.closest(t,"tr",n).bind(function(t){return p.closest(t,"table",n).bind(function(n){var o=l.descendants(n,"tr");return s.eq(t,o[0])?f.prevSibling(n).bind(m.last).map(function(t){var n=d.getEnd(t);return e.response(a.some(r.makeSitus(t,n,t,n)),!0)}):a.none()})})},w=function(t,n){return p.closest(t,"tr",n).bind(function(t){return p.closest(t,"table",n).bind(function(n){var o=l.descendants(n,"tr");return s.eq(t,o[o.length-1])?f.nextSibling(n).bind(m.first).map(function(t){return e.response(a.some(r.makeSitus(t,0,t,0)),!0)}):a.none()})})};return{navigate:v,select:function(e,n,r,o,i,a,u){return x(e,r,o,i,a).bind(function(e){return t.detect(n,r,e.start(),e.finish(),u)})},firstUpCheck:b,lastDownCheck:w}}),i("ephox.darwin.mouse.MouseSelection",["ephox.darwin.selection.CellSelection","ephox.katamari.api.Option","ephox.sugar.api.dom.Compare","ephox.sugar.api.search.SelectorFind"],function(e,t,n,r){var o=function(e,t){return r.closest(e,"td,th",t)};return function(r,i,a,u){var s=t.none(),c=function(){s=t.none()};return{mousedown:function(e){u.clear(i),s=o(e.target(),a)},mouseover:function(t){s.each(function(s){u.clear(i),o(t.target(),a).each(function(t){var o=e.identify(s,t,a).getOr([]);(o.length>1||1===o.length&&!n.eq(s,t))&&(u.selectRange(i,o,s,t),r.selectContents(t))})})},mouseup:function(){s.each(c)}}}}),i("ephox.darwin.navigation.KeyDirection",["ephox.darwin.keyboard.Retries","ephox.darwin.navigation.BeforeAfter","ephox.phoenix.api.dom.DomGather","ephox.sugar.api.search.Traverse","ephox.sugar.api.selection.Situ"],function(e,t,n,r,o){return{down:{traverse:r.nextSibling,gather:n.after,relative:o.before,otherRetry:e.tryDown,ieRetry:e.ieTryDown,failure:t.adt.failedDown},up:{traverse:r.prevSibling,gather:n.before,relative:o.before,otherRetry:e.tryUp,ieRetry:e.ieTryUp,failure:t.adt.failedUp}}}),i("ephox.darwin.api.InputHandlers",["ephox.darwin.api.Responses","ephox.darwin.api.SelectionKeys","ephox.darwin.api.WindowBridge","ephox.darwin.keyboard.KeySelection","ephox.darwin.keyboard.VerticalMovement","ephox.darwin.mouse.MouseSelection","ephox.darwin.navigation.KeyDirection","ephox.darwin.selection.CellSelection","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.katamari.api.Options","ephox.katamari.api.Struct","ephox.sugar.api.selection.Situ"],function(e,t,n,r,o,i,a,u,s,c,l,p,f){var d=p.immutable("rows","cols");return{mouse:function(e,t,r,o){var a=n(e),u=i(a,t,r,o);return{mousedown:u.mousedown,mouseover:u.mouseover,mouseup:u.mouseup}},keyboard:function(i,p,m,h){var g=n(i),x=function(){return h.clear(p),c.none()};return{keydown:function(n,i,v,b,w,y){var k=n.raw().which,S=!0===n.raw().shiftKey;return u.retrieve(p,h.selectedSelector()).fold(function(){return t.isDown(k)&&S?s.curry(o.select,g,p,m,a.down,b,i,h.selectRange):t.isUp(k)&&S?s.curry(o.select,g,p,m,a.up,b,i,h.selectRange):t.isDown(k)?s.curry(o.navigate,g,m,a.down,b,i,o.lastDownCheck):t.isUp(k)?s.curry(o.navigate,g,m,a.up,b,i,o.firstUpCheck):c.none},function(n){var o=function(o){return function(){return l.findMap(o,function(e){return r.update(e.rows(),e.cols(),p,n,h)}).fold(function(){return u.getEdges(p,h.firstSelectedSelector(),h.lastSelectedSelector()).map(function(n){var r=t.isDown(k)||y.isForward(k)?f.after:f.before;return g.setRelativeSelection(f.on(n.first(),0),r(n.table())),h.clear(p),e.response(c.none(),!0)})},function(t){return c.some(e.response(c.none(),!0))})}};return t.isDown(k)&&S?o([d(1,0)]):t.isUp(k)&&S?o([d(-1,0)]):y.isBackward(k)&&S?o([d(0,-1),d(-1,0)]):y.isForward(k)&&S?o([d(0,1),d(1,0)]):t.isNavigation(k)&&!1===S?x:c.none})()},keyup:function(e,n,o,i,a){return u.retrieve(p,h.selectedSelector()).fold(function(){var u=e.raw().which;return 0==(!0===e.raw().shiftKey)?c.none():t.isNavigation(u)?r.sync(p,m,n,o,i,a,h.selectRange):c.none()},c.none)}}}}}),i("ephox.sugar.api.properties.Classes",["ephox.katamari.api.Arr","ephox.sugar.api.properties.Class","ephox.sugar.impl.ClassList","global!Array"],function(e,t,n,r){var o=function(e){for(var t=e.dom().classList,n=new r(t.length),o=0;o<t.length;o++)n[o]=t.item(o);return n};return{add:function(n,r){e.each(r,function(e){t.add(n,e)})},remove:function(n,r){e.each(r,function(e){t.remove(n,e)})},toggle:function(n,r){e.each(r,function(e){t.toggle(n,e)})},hasAll:function(n,r){return e.forall(r,function(e){return t.has(n,e)})},hasAny:function(n,r){return e.exists(r,function(e){return t.has(n,e)})},get:function(e){return n.supports(e)?o(e):n.get(e)}}}),i("ephox.sugar.api.properties.OnNode",["ephox.sugar.api.properties.Class","ephox.sugar.api.properties.Classes"],function(e,t){return{addClass:function(t){return function(n){e.add(n,t)}},removeClass:function(t){return function(n){e.remove(n,t)}},removeClasses:function(e){return function(n){t.remove(n,e)}},hasClass:function(t){return function(n){return e.has(n,t)}}}}),i("ephox.darwin.api.SelectionAnnotation",["ephox.katamari.api.Arr","ephox.sugar.api.properties.Attr","ephox.sugar.api.properties.Class","ephox.sugar.api.properties.OnNode","ephox.sugar.api.search.SelectorFilter"],function(e,t,n,r,o){return{byClass:function(t){var i=r.addClass(t.selected()),a=r.removeClasses([t.selected(),t.lastSelected(),t.firstSelected()]),u=function(n){var r=o.descendants(n,t.selectedSelector());e.each(r,a)};return{clear:u,selectRange:function(r,o,a,s){u(r),e.each(o,i),n.add(a,t.firstSelected()),n.add(s,t.lastSelected())},selectedSelector:t.selectedSelector,firstSelectedSelector:t.firstSelectedSelector,lastSelectedSelector:t.lastSelectedSelector}},byAttr:function(n){var r=function(e){t.remove(e,n.selected()),t.remove(e,n.firstSelected()),t.remove(e,n.lastSelected())},i=function(e){t.set(e,n.selected(),"1")},a=function(t){var i=o.descendants(t,n.selectedSelector());e.each(i,r)};return{clear:a,selectRange:function(r,o,u,s){a(r),e.each(o,i),t.set(u,n.firstSelected(),"1"),t.set(s,n.lastSelected(),"1")},selectedSelector:n.selectedSelector,firstSelectedSelector:n.firstSelectedSelector,lastSelectedSelector:n.lastSelectedSelector}}}}),i("tinymce.plugins.table.selection.CellSelection",["ephox.darwin.api.InputHandlers","ephox.darwin.api.SelectionAnnotation","ephox.darwin.api.SelectionKeys","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.katamari.api.Struct","ephox.snooker.api.TableLookup","ephox.sugar.api.dom.Compare","ephox.sugar.api.node.Element","ephox.sugar.api.node.Node","ephox.sugar.api.node.Text","ephox.sugar.api.properties.Attr","ephox.sugar.api.search.Traverse","ephox.sugar.api.selection.Selection","ephox.sugar.selection.core.SelectionDirection","tinymce.plugins.table.alien.Util","tinymce.plugins.table.queries.Direction","tinymce.plugins.table.selection.Ephemera"],function(e,t,n,r,o,i,a,u,s,c,l,p,f,d,m,h,g,x){return function(v,b){var w=i.immutableBag(["mousedown","mouseover","mouseup","keyup","keydown"],[]),y=o.none(),k=t.byAttr(x);v.on("init",function(t){var i=v.getWin(),x=h.getBody(v),S=h.getIsRoot(v),C=function(){var e=v.selection,t=s.fromDom(e.getStart()),n=s.fromDom(e.getEnd()),i=a.table(t),c=a.table(n);i.bind(function(e){return c.bind(function(t){return u.eq(e,t)?o.some(!0):o.none()})}).fold(function(){k.clear(x)},r.noop)},T=e.mouse(i,x,S,k),R=e.keyboard(i,x,S,k),A=function(e,t){t.kill()&&e.kill(),t.selection().each(function(e){var t=d.relative(e.start(),e.finish()),n=m.asLtrRange(i,t);v.selection.setRng(n)})},D=function(e){var t=B(e);if(t.raw().shiftKey&&n.isNavigation(t.raw().which)){var r=v.selection.getRng(),o=s.fromDom(r.startContainer),i=s.fromDom(r.endContainer);R.keyup(t,o,r.startOffset,i,r.endOffset).each(function(e){A(t,e)})}},O=function(e){return!(p.has(e,"data-mce-bogus")||"br"===c.name(e)||c.isText(e)&&0===l.get(e).length)},E=function(){var e=s.fromDom(v.getBody()),t=f.lastChild(e),n=function(e){return f.prevSibling(e).bind(function(e){return O(e)?o.some(e):n(e)})};return t.bind(function(e){return O(e)?o.some(e):n(e)})},N=function(e){var t=B(e);b().each(function(e){e.hideBars()}),40===e.which&&E().each(function(e){"table"===c.name(e)&&(v.settings.forced_root_block?v.dom.add(v.getBody(),v.settings.forced_root_block,v.settings.forced_root_block_attrs,"<br/>"):v.dom.add(v.getBody(),"br"))});var r=v.selection.getRng(),o=s.fromDom(v.selection.getStart()),i=s.fromDom(r.startContainer),a=s.fromDom(r.endContainer),u=g.directionAt(o).isRtl()?n.rtl:n.ltr;R.keydown(t,i,r.startOffset,a,r.endOffset,u).each(function(e){A(t,e)}),b().each(function(e){e.showBars()})},B=function(e){var t=s.fromDom(e.target),n=function(){e.stopPropagation()},o=function(){e.preventDefault()},i=r.compose(o,n);return{target:r.constant(t),x:r.constant(e.x),y:r.constant(e.y),stop:n,prevent:o,kill:i,raw:r.constant(e)}},F=function(e){return 0===e.button},P=function(e){return void 0===e.buttons||0!=(1&e.buttons)},I=function(e){F(e)&&T.mousedown(B(e))},W=function(e){P(e)&&T.mouseover(B(e))},M=function(e){F&&T.mouseup(B(e))};v.on("mousedown",I),v.on("mouseover",W),v.on("mouseup",M),v.on("keyup",D),v.on("keydown",N),v.on("nodechange",C),y=o.some(w({mousedown:I,mouseover:W,mouseup:M,keyup:D,keydown:N}))});var S=function(){y.each(function(e){})};return{clear:k.clear,destroy:S}}}),i("tinymce.plugins.table.selection.Selections",["ephox.darwin.api.TableSelection","tinymce.plugins.table.alien.Util","tinymce.plugins.table.selection.Ephemera","tinymce.plugins.table.selection.SelectionTypes"],function(e,t,n,r){return function(o){return{get:function(){var i=t.getBody(o);return e.retrieve(i,n.selectedSelector()).fold(function(){return void 0===o.selection.getStart()?r.none():r.single(o.selection)},function(e){return r.multiple(e)})}}}}),i("tinymce.plugins.table.ui.Buttons",["ephox.katamari.api.Fun","tinymce.core.util.Tools","tinymce.plugins.table.ui.TableDialog"],function(e,t,n){var r=t.each;return{addButtons:function(t){function o(e){return function(){t.execCommand(e)}}var i=[];r("inserttable tableprops deletetable | cell row column".split(" "),function(e){"|"==e?i.push({text:"-"}):i.push(t.menuItems[e])}),t.addButton("table",{type:"menubutton",title:"Table",menu:i}),t.addButton("tableprops",{title:"Table properties",onclick:e.curry(n.open,t,!0),icon:"table"}),t.addButton("tabledelete",{title:"Delete table",onclick:o("mceTableDelete")}),t.addButton("tablecellprops",{title:"Cell properties",onclick:o("mceTableCellProps")}),t.addButton("tablemergecells",{title:"Merge cells",onclick:o("mceTableMergeCells")}),t.addButton("tablesplitcells",{title:"Split cell",onclick:o("mceTableSplitCells")}),t.addButton("tableinsertrowbefore",{title:"Insert row before",onclick:o("mceTableInsertRowBefore")}),t.addButton("tableinsertrowafter",{title:"Insert row after",onclick:o("mceTableInsertRowAfter")}),t.addButton("tabledeleterow",{title:"Delete row",onclick:o("mceTableDeleteRow")}),t.addButton("tablerowprops",{title:"Row properties",onclick:o("mceTableRowProps")}),t.addButton("tablecutrow",{title:"Cut row",onclick:o("mceTableCutRow")}),t.addButton("tablecopyrow",{title:"Copy row",onclick:o("mceTableCopyRow")}),t.addButton("tablepasterowbefore",{title:"Paste row before",onclick:o("mceTablePasteRowBefore")}),t.addButton("tablepasterowafter",{title:"Paste row after",onclick:o("mceTablePasteRowAfter")}),t.addButton("tableinsertcolbefore",{title:"Insert column before",onclick:o("mceTableInsertColBefore")}),t.addButton("tableinsertcolafter",{title:"Insert column after",onclick:o("mceTableInsertColAfter")}),t.addButton("tabledeletecol",{title:"Delete column",onclick:o("mceTableDeleteCol")})},addToolbars:function(e){var t=function(t){return e.dom.is(t,"table")&&e.getBody().contains(t)},n=e.settings.table_toolbar;""!==n&&!1!==n&&(n||(n="tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol"),e.addContextToolbar(t,n))}}}),i("tinymce.plugins.table.ui.MenuItems",["ephox.katamari.api.Fun","ephox.katamari.api.Arr","ephox.katamari.api.Option","ephox.snooker.api.TableLookup","ephox.sugar.api.node.Element","tinymce.plugins.table.actions.InsertTable","tinymce.plugins.table.queries.TableTargets","tinymce.plugins.table.ui.TableDialog"],function(e,t,n,r,o,i,a,u){return{addMenuItems:function(s,c){function l(e){return function(){s.execCommand(e)}}var p=n.none(),f=[],d=[],m=[],h=[],g=function(e){e.disabled(!0)},x=function(e){e.disabled(!1)},v=function(){var e=this;f.push(e),p.fold(function(){g(e)},function(t){x(e)})},b=function(){var e=this;d.push(e),p.fold(function(){g(e)},function(t){x(e)})},w=function(){var e=this;m.push(e),p.fold(function(){g(e)},function(t){e.disabled(t.mergable().isNone())})},y=function(){var e=this;h.push(e),p.fold(function(){g(e)},function(t){e.disabled(t.unmergable().isNone())})},k=function(){p.fold(function(){t.each(f,g),t.each(d,g),t.each(m,g),t.each(h,g)},function(e){t.each(f,x),t.each(d,x),t.each(m,function(t){t.disabled(e.mergable().isNone())}),t.each(h,function(t){t.disabled(e.unmergable().isNone())})})};s.on("init",function(){s.on("nodechange",function(e){var t=n.from(s.dom.getParent(s.selection.getStart(),"th,td"));p=t.bind(function(e){var t=o.fromDom(e);return r.table(t).map(function(e){return a.forMenu(c,e,t)})}),k()})});var S=function(e,t,n,r){var o,i,a,u,s,c=r.getEl().getElementsByTagName("table")[0],l=r.isRtl()||"tl-tr"==r.parent().rel;for(c.nextSibling.innerHTML=t+1+" x "+(n+1),l&&(t=9-t),i=0;i<10;i++)for(o=0;o<10;o++)u=c.rows[i].childNodes[o].firstChild,s=(l?o>=t:o<=t)&&i<=n,e.dom.toggleClass(u,"mce-active",s),s&&(a=u);return a.parentNode},C=!1===s.settings.table_grid?{text:"Table",icon:"table",context:"table",onclick:e.curry(u.open,s)}:{text:"Table",icon:"table",context:"table",ariaHideMenu:!0,onclick:function(e){e.aria&&(this.parent().hideAll(),e.stopImmediatePropagation(),u.open(s))},onshow:function(){S(s,0,0,this.menu.items()[0])},onhide:function(){var e=this.menu.items()[0].getEl().getElementsByTagName("a");s.dom.removeClass(e,"mce-active"),s.dom.addClass(e[0],"mce-active")},menu:[{type:"container",html:function(){var e="";e='<table role="grid" class="mce-grid mce-grid-border" aria-readonly="true">';for(var t=0;t<10;t++){e+="<tr>";for(var n=0;n<10;n++)e+='<td role="gridcell" tabindex="-1"><a id="mcegrid'+(10*t+n)+'" href="#" data-mce-x="'+n+'" data-mce-y="'+t+'"></a></td>';e+="</tr>"}return e+="</table>",e+='<div class="mce-text-center" role="presentation">1 x 1</div>'}(),onPostRender:function(){this.lastX=this.lastY=0},onmousemove:function(e){var t,n,r=e.target;"A"==r.tagName.toUpperCase()&&(t=parseInt(r.getAttribute("data-mce-x"),10),n=parseInt(r.getAttribute("data-mce-y"),10),(this.isRtl()||"tl-tr"==this.parent().rel)&&(t=9-t),t===this.lastX&&n===this.lastY||(S(s,t,n,e.control),this.lastX=t,this.lastY=n))},onclick:function(e){var t=this;"A"==e.target.tagName.toUpperCase()&&(e.preventDefault(),e.stopPropagation(),t.parent().cancel(),s.undoManager.transact(function(){i.insert(s,t.lastX+1,t.lastY+1)}),s.addVisual())}}]},T={text:"Table properties",context:"table",onPostRender:v,onclick:e.curry(u.open,s,!0)},R={text:"Delete table",context:"table",onPostRender:v,cmd:"mceTableDelete"},A={text:"Row",context:"table",menu:[{text:"Insert row before",onclick:l("mceTableInsertRowBefore"),onPostRender:b},{text:"Insert row after",onclick:l("mceTableInsertRowAfter"),onPostRender:b},{text:"Delete row",onclick:l("mceTableDeleteRow"),onPostRender:b},{text:"Row properties",onclick:l("mceTableRowProps"),onPostRender:b},{text:"-"},{text:"Cut row",onclick:l("mceTableCutRow"),onPostRender:b},{text:"Copy row",onclick:l("mceTableCopyRow"),onPostRender:b},{text:"Paste row before",onclick:l("mceTablePasteRowBefore"),onPostRender:b},{text:"Paste row after",onclick:l("mceTablePasteRowAfter"),onPostRender:b}]},D={text:"Column",context:"table",menu:[{text:"Insert column before",onclick:l("mceTableInsertColBefore"),onPostRender:b},{text:"Insert column after",onclick:l("mceTableInsertColAfter"),onPostRender:b},{text:"Delete column",onclick:l("mceTableDeleteCol"),onPostRender:b}]},O={separator:"before",text:"Cell",context:"table",menu:[{text:"Cell properties",onclick:l("mceTableCellProps"),onPostRender:b},{text:"Merge cells",onclick:l("mceTableMergeCells"),onPostRender:w},{text:"Split cell",onclick:l("mceTableSplitCells"),onPostRender:y}]};s.addMenuItem("inserttable",C),s.addMenuItem("tableprops",T),s.addMenuItem("deletetable",R),s.addMenuItem("row",A),s.addMenuItem("column",D),s.addMenuItem("cell",O)}}}),i("tinymce.plugins.table.Plugin",["tinymce.core.PluginManager","tinymce.plugins.table.actions.Clipboard","tinymce.plugins.table.actions.InsertTable","tinymce.plugins.table.actions.TableActions","tinymce.plugins.table.actions.TableCommands","tinymce.plugins.table.actions.ResizeHandler","tinymce.plugins.table.queries.TabContext","tinymce.plugins.table.selection.CellSelection","tinymce.plugins.table.selection.Ephemera","tinymce.plugins.table.selection.Selections","tinymce.plugins.table.ui.Buttons","tinymce.plugins.table.ui.MenuItems"],function(e,t,n,r,o,i,a,u,s,c,l,p){function f(e){var f=this,d=i(e),m=u(e,d.lazyResize),h=r(e,d.lazyWire),g=c(e);o.registerCommands(e,h,m,g),t.registerEvents(e,g,h,m),p.addMenuItems(e,g),l.addButtons(e),l.addToolbars(e),e.on("PreInit",function(){e.serializer.addTempAttr(s.firstSelected()),e.serializer.addTempAttr(s.lastSelected())}),!1!==e.settings.table_tab_navigation&&e.on("keydown",function(t){a.handle(t,e,h,d.lazyWire)}),e.on("remove",function(){d.destroy(),m.destroy()}),f.insertTable=function(t,r){return n.insert(e,t,r)},f.setClipboardRows=o.setClipboardRows,f.getClipboardRows=o.getClipboardRows}return e.add("table",f),function(){}}),r("tinymce.plugins.table.Plugin")()}();