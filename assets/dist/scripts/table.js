!function(){"use strict";var t=tinymce.util.Tools.resolve("tinymce.PluginManager"),e=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},n=function(t,e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t(e.apply(null,n))}},r=function(t){return function(){return t}},o=function(t){return t};function i(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=e.concat(n);return t.apply(null,o)}}var u,a=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return!t.apply(null,e)}},c=function(t){return t()},l=r(!1),f=r(!0),s=l,d=f,m=function(){return g},g=function(){var t=function(t){return t.isNone()},e=function(t){return t()},n=function(t){return t},o={fold:function(t,e){return t()},is:s,isSome:s,isNone:d,getOr:n,getOrThunk:e,getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:function(){return null},getOrUndefined:function(){},or:n,orThunk:e,map:m,ap:m,each:function(){},bind:m,flatten:m,exists:s,forall:d,filter:m,equals:t,equals_:t,toArray:function(){return[]},toString:r("none()")};return Object.freeze&&Object.freeze(o),o}(),h=function(t){var e=function(){return t},n=function(){return o},r=function(e){return e(t)},o={fold:function(e,n){return n(t)},is:function(e){return t===e},isSome:d,isNone:s,getOr:e,getOrThunk:e,getOrDie:e,getOrNull:e,getOrUndefined:e,or:n,orThunk:n,map:function(e){return h(e(t))},ap:function(e){return e.fold(m,function(e){return h(e(t))})},each:function(e){e(t)},bind:r,flatten:e,exists:r,forall:r,filter:function(e){return e(t)?o:g},equals:function(e){return e.is(t)},equals_:function(e,n){return e.fold(s,function(e){return n(t,e)})},toArray:function(){return[t]},toString:function(){return"some("+t+")"}};return o},p={some:h,none:m,from:function(t){return null==t?g:h(t)}},v=function(t){return function(e){return function(t){if(null===t)return"null";var e=typeof t;return"object"===e&&Array.prototype.isPrototypeOf(t)?"array":"object"===e&&String.prototype.isPrototypeOf(t)?"string":e}(e)===t}},b=v("string"),w=v("array"),y=v("boolean"),x=v("function"),C=v("number"),S=void 0===(u=Array.prototype.indexOf)?function(t,e){return I(t,e)}:function(t,e){return u.call(t,e)},R=function(t,e){return S(t,e)>-1},T=function(t,e){return P(t,e).isSome()},D=function(t,e){for(var n=t.length,r=new Array(n),o=0;o<n;o++){var i=t[o];r[o]=e(i,o,t)}return r},k=function(t,e){for(var n=0,r=t.length;n<r;n++)e(t[n],n,t)},A=function(t,e){for(var n=[],r=0,o=t.length;r<o;r++){var i=t[r];e(i,r,t)&&n.push(i)}return n},O=function(t,e,n){return function(t,e){for(var n=t.length-1;n>=0;n--)e(t[n],n,t)}(t,function(t){n=e(n,t)}),n},E=function(t,e,n){return k(t,function(t){n=e(n,t)}),n},N=function(t,e){for(var n=0,r=t.length;n<r;n++){var o=t[n];if(e(o,n,t))return p.some(o)}return p.none()},P=function(t,e){for(var n=0,r=t.length;n<r;n++)if(e(t[n],n,t))return p.some(n);return p.none()},I=function(t,e){for(var n=0,r=t.length;n<r;++n)if(t[n]===e)return n;return-1},B=Array.prototype.push,W=function(t){for(var e=[],n=0,r=t.length;n<r;++n){if(!Array.prototype.isPrototypeOf(t[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+t);B.apply(e,t[n])}return e},M=function(t,e){var n=D(t,e);return W(n)},_=function(t,e){for(var n=0,r=t.length;n<r;++n)if(!0!==e(t[n],n,t))return!1;return!0},L=Array.prototype.slice,j=function(t){var e=L.call(t,0);return e.reverse(),e},F=(x(Array.from)&&Array.from,Object.keys),H=function(t,e){for(var n=F(t),r=0,o=n.length;r<o;r++){var i=n[r];e(t[i],i,t)}},z=function(t,e){return U(t,function(t,n,r){return{k:n,v:e(t,n,r)}})},U=function(t,e){var n={};return H(t,function(r,o){var i=e(r,o,t);n[i.k]=i.v}),n},q=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(t.length!==e.length)throw new Error('Wrong number of arguments to struct. Expected "['+t.length+']", got '+e.length+" arguments");var o={};return k(t,function(t,n){o[t]=r(e[n])}),o}},V=function(t){return t.slice(0).sort()},G=function(t,e){throw new Error("All required keys ("+V(t).join(", ")+") were not specified. Specified keys were: "+V(e).join(", ")+".")},Y=function(t){throw new Error("Unsupported keys for object: "+V(t).join(", "))},X=function(t,e){if(!w(e))throw new Error("The "+t+" fields must be an array. Was: "+e+".");k(e,function(e){if(!b(e))throw new Error("The value "+e+" in the "+t+" fields was not a string.")})},K=function(t){var e=V(t);N(e,function(t,n){return n<e.length-1&&t===e[n+1]}).each(function(t){throw new Error("The field: "+t+" occurs more than once in the combined fields: ["+e.join(", ")+"].")})},J=function(t,e){var n=t.concat(e);if(0===n.length)throw new Error("You must specify at least one required or optional field.");return X("required",t),X("optional",e),K(n),function(o){var i=F(o);_(t,function(t){return R(i,t)})||G(t,i);var u=A(i,function(t){return!R(n,t)});u.length>0&&Y(u);var a={};return k(t,function(t){a[t]=r(o[t])}),k(e,function(t){a[t]=r(Object.prototype.hasOwnProperty.call(o,t)?p.some(o[t]):p.none())}),a}},$=q("width","height"),Q=q("rows","columns"),Z=q("row","column"),tt=q("x","y"),et=q("element","rowspan","colspan"),nt=q("element","rowspan","colspan","isNew"),rt={dimensions:$,grid:Q,address:Z,coords:tt,extended:q("element","rowspan","colspan","row","column"),detail:et,detailnew:nt,rowdata:q("element","cells","section"),elementnew:q("element","isNew"),rowdatanew:q("element","cells","section","isNew"),rowcells:q("cells","section"),rowdetails:q("details","section"),bounds:q("startRow","startCol","finishRow","finishCol")},ot=function(t){if(null==t)throw new Error("Node cannot be null or undefined");return{dom:r(t)}},it={fromHtml:function(t,e){var n=(e||document).createElement("div");if(n.innerHTML=t,!n.hasChildNodes()||n.childNodes.length>1)throw console.error("HTML does not have a single root node",t),"HTML must have a single root node";return ot(n.childNodes[0])},fromTag:function(t,e){var n=(e||document).createElement(t);return ot(n)},fromText:function(t,e){var n=(e||document).createTextNode(t);return ot(n)},fromDom:ot,fromPoint:function(t,e,n){var r=t.dom();return p.from(r.elementFromPoint(e,n)).map(ot)}},ut=(Node.ATTRIBUTE_NODE,Node.CDATA_SECTION_NODE,Node.COMMENT_NODE),at=Node.DOCUMENT_NODE,ct=(Node.DOCUMENT_TYPE_NODE,Node.DOCUMENT_FRAGMENT_NODE,Node.ELEMENT_NODE),lt=Node.TEXT_NODE,ft=(Node.PROCESSING_INSTRUCTION_NODE,Node.ENTITY_REFERENCE_NODE,Node.ENTITY_NODE,Node.NOTATION_NODE,ct),st=at,dt=function(t,e){var n=t.dom();if(n.nodeType!==ft)return!1;if(void 0!==n.matches)return n.matches(e);if(void 0!==n.msMatchesSelector)return n.msMatchesSelector(e);if(void 0!==n.webkitMatchesSelector)return n.webkitMatchesSelector(e);if(void 0!==n.mozMatchesSelector)return n.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")},mt=function(t){return t.nodeType!==ft&&t.nodeType!==st||0===t.childElementCount},gt="undefined"!=typeof window?window:Function("return this;")(),ht=function(t,e){return function(t,e){for(var n=null!=e?e:gt,r=0;r<t.length&&null!=n;++r)n=n[t[r]];return n}(t.split("."),e)},pt=function(t,e){var n=function(t,e){return ht(t,e)}(t,e);if(null==n)throw t+" not available on this browser";return n},vt=function(){return pt("Node")},bt=function(t,e,n){return 0!=(t.compareDocumentPosition(e)&n)},wt=function(t,e){return bt(t,e,vt().DOCUMENT_POSITION_CONTAINED_BY)},yt=function(t){var e,n=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return n||(n=!0,e=t.apply(null,r)),e}},xt=function(){return Ct(0,0)},Ct=function(t,e){return{major:t,minor:e}},St={nu:Ct,detect:function(t,e){var n=String(e).toLowerCase();return 0===t.length?xt():function(t,e){var n=function(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(r.test(e))return r}}(t,e);if(!n)return{major:0,minor:0};var r=function(t){return Number(e.replace(n,"$"+t))};return Ct(r(1),r(2))}(t,n)},unknown:xt},Rt=function(t,e){return function(){return e===t}},Tt=function(t){var e=t.current;return{current:e,version:t.version,isEdge:Rt("Edge",e),isChrome:Rt("Chrome",e),isIE:Rt("IE",e),isOpera:Rt("Opera",e),isFirefox:Rt("Firefox",e),isSafari:Rt("Safari",e)}},Dt={unknown:function(){return Tt({current:void 0,version:St.unknown()})},nu:Tt,edge:r("Edge"),chrome:r("Chrome"),ie:r("IE"),opera:r("Opera"),firefox:r("Firefox"),safari:r("Safari")},kt=function(t,e){return function(){return e===t}},At=function(t){var e=t.current;return{current:e,version:t.version,isWindows:kt("Windows",e),isiOS:kt("iOS",e),isAndroid:kt("Android",e),isOSX:kt("OSX",e),isLinux:kt("Linux",e),isSolaris:kt("Solaris",e),isFreeBSD:kt("FreeBSD",e)}},Ot={unknown:function(){return At({current:void 0,version:St.unknown()})},nu:At,windows:r("Windows"),ios:r("iOS"),android:r("Android"),linux:r("Linux"),osx:r("OSX"),solaris:r("Solaris"),freebsd:r("FreeBSD")},Et=function(t,e){var n=String(e).toLowerCase();return N(t,function(t){return t.search(n)})},Nt=function(t,e){return Et(t,e).map(function(t){var n=St.detect(t.versionRegexes,e);return{current:t.name,version:n}})},Pt=function(t,e){return Et(t,e).map(function(t){var n=St.detect(t.versionRegexes,e);return{current:t.name,version:n}})},It=function(t,e){return-1!==t.indexOf(e)},Bt=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Wt=function(t){return function(e){return It(e,t)}},Mt=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return It(t,"edge/")&&It(t,"chrome")&&It(t,"safari")&&It(t,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Bt],search:function(t){return It(t,"chrome")&&!It(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return It(t,"msie")||It(t,"trident")}},{name:"Opera",versionRegexes:[Bt,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Wt("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Wt("firefox")},{name:"Safari",versionRegexes:[Bt,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return(It(t,"safari")||It(t,"mobile/"))&&It(t,"applewebkit")}}],_t=[{name:"Windows",search:Wt("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return It(t,"iphone")||It(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Wt("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Wt("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Wt("linux"),versionRegexes:[]},{name:"Solaris",search:Wt("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Wt("freebsd"),versionRegexes:[]}],Lt={browsers:r(Mt),oses:r(_t)},jt=function(t){var e=Lt.browsers(),n=Lt.oses(),o=Nt(e,t).fold(Dt.unknown,Dt.nu),i=Pt(n,t).fold(Ot.unknown,Ot.nu),u=function(t,e,n){var o=t.isiOS()&&!0===/ipad/i.test(n),i=t.isiOS()&&!o,u=t.isAndroid()&&3===t.version.major,a=t.isAndroid()&&4===t.version.major,c=o||u||a&&!0===/mobile/i.test(n),l=t.isiOS()||t.isAndroid(),f=l&&!c,s=e.isSafari()&&t.isiOS()&&!1===/safari/i.test(n);return{isiPad:r(o),isiPhone:r(i),isTablet:r(c),isPhone:r(f),isTouch:r(l),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:r(s)}}(i,o,t);return{browser:o,os:i,deviceType:u}},Ft={detect:yt(function(){var t=navigator.userAgent;return jt(t)})},Ht=function(t,e){return t.dom()===e.dom()},zt=Ft.detect().browser.isIE()?function(t,e){return wt(t.dom(),e.dom())}:function(t,e){var n=t.dom(),r=e.dom();return n!==r&&n.contains(r)},Ut=dt,qt=function(t){return it.fromDom(t.dom().ownerDocument)},Vt=function(t){var e=t.dom();return p.from(e.parentNode).map(it.fromDom)},Gt=function(t,e){for(var n=x(e)?e:r(!1),o=t.dom(),i=[];null!==o.parentNode&&void 0!==o.parentNode;){var u=o.parentNode,a=it.fromDom(u);if(i.push(a),!0===n(a))break;o=u}return i},Yt=function(t){var e=t.dom();return p.from(e.previousSibling).map(it.fromDom)},Xt=function(t){var e=t.dom();return p.from(e.nextSibling).map(it.fromDom)},Kt=function(t){var e=t.dom();return D(e.childNodes,it.fromDom)},Jt=function(t,e){var n=t.dom().childNodes;return p.from(n[e]).map(it.fromDom)},$t=(q("element","offset"),function(t,e,n){return M(Kt(t),function(t){return dt(t,e)?n(t)?[t]:[]:$t(t,e,n)})}),Qt={firstLayer:function(t,e){return $t(t,e,r(!0))},filterFirstLayer:$t},Zt=function(t){return t.dom().nodeName.toLowerCase()},te=function(t){return t.dom().nodeType},ee=function(t){return function(e){return te(e)===t}},ne=function(t){return te(t)===ut||"#comment"===Zt(t)},re=ee(ct),oe=ee(lt),ie=ee(at),ue=function(t,e,n){if(!(b(n)||y(n)||C(n)))throw console.error("Invalid call to Attr.set. Key ",e,":: Value ",n,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(e,n+"")},ae=function(t,e,n){ue(t.dom(),e,n)},ce=function(t,e){var n=t.dom();H(e,function(t,e){ue(n,e,t)})},le=function(t,e){var n=t.dom().getAttribute(e);return null===n?void 0:n},fe=function(t,e){var n=t.dom();return!(!n||!n.hasAttribute)&&n.hasAttribute(e)},se=function(t,e){t.dom().removeAttribute(e)},de=function(t){return E(t.dom().attributes,function(t,e){return t[e.name]=e.value,t},{})},me=function(t){var e=oe(t)?t.dom().parentNode:t.dom();return null!=e&&e.ownerDocument.body.contains(e)},ge=yt(function(){return he(it.fromDom(document))}),he=function(t){var e=t.dom().body;if(null==e)throw"Body is not available yet";return it.fromDom(e)},pe=function(t,e){var n=[];return k(Kt(t),function(t){e(t)&&(n=n.concat([t])),n=n.concat(pe(t,e))}),n},ve=function(t,e,n){return function(t,e,n){return A(Gt(t,n),e)}(t,function(t){return dt(t,e)},n)},be=function(t,e){return function(t,e){return A(Kt(t),e)}(t,function(t){return dt(t,e)})},we=function(t,e){return function(t,e){var n=void 0===e?document:e.dom();return mt(n)?[]:D(n.querySelectorAll(t),it.fromDom)}(e,t)};function ye(t,e,n,r,o){return t(n,r)?p.some(n):x(o)&&o(n)?p.none():e(n,r,o)}var xe=function(t,e,n){for(var o=t.dom(),i=x(n)?n:r(!1);o.parentNode;){o=o.parentNode;var u=it.fromDom(o);if(e(u))return p.some(u);if(i(u))break}return p.none()},Ce=function(t,e,n){return xe(t,function(t){return dt(t,e)},n)},Se=function(t,e){return function(t,e){return N(t.dom().childNodes,n(e,it.fromDom)).map(it.fromDom)}(t,function(t){return dt(t,e)})},Re=function(t,e){return function(t,e){var n=void 0===e?document:e.dom();return mt(n)?p.none():p.from(n.querySelector(t)).map(it.fromDom)}(e,t)},Te=function(t,e,n){return ye(dt,Ce,t,e,n)},De=function(t,e,n){var o=void 0!==n?n:r(!1);return o(e)?p.none():R(t,Zt(e))?p.some(e):Ce(e,t.join(","),function(t){return dt(t,"table")||o(t)})},ke=function(t,e){return Vt(e).map(function(e){return be(e,t)})},Ae=i(ke,"th,td"),Oe=i(ke,"tr"),Ee=function(t,e){return parseInt(le(t,e),10)},Ne={cell:function(t,e){return De(["td","th"],t,e)},firstCell:function(t){return Re(t,"th,td")},cells:function(t){return Qt.firstLayer(t,"th,td")},neighbourCells:Ae,table:function(t,e){return Te(t,"table",e)},row:function(t,e){return De(["tr"],t,e)},rows:function(t){return Qt.firstLayer(t,"tr")},notCell:function(t,e){return De(["caption","tr","tbody","tfoot","thead"],t,e)},neighbourRows:Oe,attr:Ee,grid:function(t,e,n){var r=Ee(t,e),o=Ee(t,n);return rt.grid(r,o)}},Pe=function(t){var e=Ne.rows(t);return D(e,function(t){var e=t,n=Vt(e).map(function(t){var e=Zt(t);return"tfoot"===e||"thead"===e||"tbody"===e?e:"tbody"}).getOr("tbody"),r=D(Ne.cells(t),function(t){var e=fe(t,"rowspan")?parseInt(le(t,"rowspan"),10):1,n=fe(t,"colspan")?parseInt(le(t,"colspan"),10):1;return rt.detail(t,e,n)});return rt.rowdata(e,r,n)})},Ie=function(t,e){return D(t,function(t){var n=D(Ne.cells(t),function(t){var e=fe(t,"rowspan")?parseInt(le(t,"rowspan"),10):1,n=fe(t,"colspan")?parseInt(le(t,"colspan"),10):1;return rt.detail(t,e,n)});return rt.rowdata(t,n,e.section())})},Be=function(t,e){return t+","+e},We=function(t,e){var n=M(t.all(),function(t){return t.cells()});return A(n,e)},Me={generate:function(t){var e={},n=[],o=t.length,i=0;k(t,function(t,r){var o=[];k(t.cells(),function(t,n){for(var u=0;void 0!==e[Be(r,u)];)u++;for(var a=rt.extended(t.element(),t.rowspan(),t.colspan(),r,u),c=0;c<t.colspan();c++)for(var l=0;l<t.rowspan();l++){var f=u+c,s=Be(r+l,f);e[s]=a,i=Math.max(i,f+1)}o.push(a)}),n.push(rt.rowdata(t.element(),o,t.section()))});var u=rt.grid(o,i);return{grid:r(u),access:r(e),all:r(n)}},getAt:function(t,e,n){var r=t.access()[Be(e,n)];return void 0!==r?p.some(r):p.none()},findItem:function(t,e,n){var r=We(t,function(t){return n(e,t.element())});return r.length>0?p.some(r[0]):p.none()},filterItems:We,justCells:function(t){var e=D(t.all(),function(t){return t.cells()});return W(e)}},_e=function(t){return void 0!==t.style},Le=function(t,e,n){if(!b(n))throw console.error("Invalid call to CSS.set. Property ",e,":: Value ",n,":: Element ",t),new Error("CSS value must be a string: "+n);_e(t)&&t.style.setProperty(e,n)},je=function(t,e,n){var r=t.dom();Le(r,e,n)},Fe=function(t,e){var n=t.dom();H(e,function(t,e){Le(n,e,t)})},He=function(t,e){var n=t.dom(),r=window.getComputedStyle(n).getPropertyValue(e),o=""!==r||me(t)?r:ze(n,e);return null===o?void 0:o},ze=function(t,e){return _e(t)?t.style.getPropertyValue(e):""},Ue=function(t,e){var n=t.dom(),r=ze(n,e);return p.from(r).filter(function(t){return t.length>0})},qe=function(t,e){!function(t,e){_e(t)&&t.style.removeProperty(e)}(t.dom(),e),fe(t,"style")&&""===le(t,"style").replace(/^\s+|\s+$/g,"")&&se(t,"style")},Ve=function(t,e){Vt(t).each(function(n){n.dom().insertBefore(e.dom(),t.dom())})},Ge=function(t,e){Xt(t).fold(function(){Vt(t).each(function(t){Xe(t,e)})},function(t){Ve(t,e)})},Ye=function(t,e){(function(t){return Jt(t,0)})(t).fold(function(){Xe(t,e)},function(n){t.dom().insertBefore(e.dom(),n.dom())})},Xe=function(t,e){t.dom().appendChild(e.dom())},Ke=function(t,e){Ve(t,e),Xe(e,t)},Je=function(t,e){k(e,function(n,r){var o=0===r?t:e[r-1];Ge(o,n)})},$e=function(t,e){k(e,function(e){Xe(t,e)})},Qe=function(t){t.dom().textContent="",k(Kt(t),function(t){Ze(t)})},Ze=function(t){var e=t.dom();null!==e.parentNode&&e.parentNode.removeChild(e)},tn=function(t){var e,n=Kt(t);n.length>0&&(e=t,k(n,function(t){Ve(e,t)})),Ze(t)},en=q("minRow","minCol","maxRow","maxCol"),nn=function(t,e){var n=t.grid().columns(),r=t.grid().rows(),o=n,i=0,u=0;return H(t.access(),function(t){if(e(t)){var n=t.row(),a=n+t.rowspan()-1,c=t.column(),l=c+t.colspan()-1;n<r?r=n:a>i&&(i=a),c<o?o=c:l>u&&(u=l)}}),en(r,o,i,u)},rn=function(t,e,n){var r=t[n].element(),o=it.fromTag("td");Xe(o,it.fromTag("br")),(e?Xe:Ye)(r,o)},on=function(t,e){var n=function(t){return dt(t.element(),e)},r=Pe(t),o=Me.generate(r),i=nn(o,n),u="th:not("+e+"),td:not("+e+")",a=Qt.filterFirstLayer(t,"th,td",function(t){return dt(t,u)});return k(a,Ze),function(t,e,n,r){for(var o=e.grid().columns(),i=e.grid().rows(),u=0;u<i;u++)for(var a=!1,c=0;c<o;c++)u<n.minRow()||u>n.maxRow()||c<n.minCol()||c>n.maxCol()||(Me.getAt(e,u,c).filter(r).isNone()?rn(t,a,u):a=!0)}(r,o,i,n),function(t,e){var n=A(Qt.firstLayer(t,"tr"),function(t){return 0===t.dom().childElementCount});k(n,Ze),e.minCol()!==e.maxCol()&&e.minRow()!==e.maxRow()||k(Qt.firstLayer(t,"th,td"),function(t){se(t,"rowspan"),se(t,"colspan")}),se(t,"width"),se(t,"height"),qe(t,"width"),qe(t,"height")}(t,i),t},un=function(t,e){return it.fromDom(t.dom().cloneNode(e))},an=function(t){return un(t,!1)},cn=function(t){return un(t,!0)},ln=function(t,e){var n=function(t,e){var n=it.fromTag(e),r=de(t);return ce(n,r),n}(t,e),r=Kt(cn(t));return $e(n,r),n},fn=function(t,e){var n=function(e){return t(e)?p.from(e.dom().nodeValue):p.none()},r=Ft.detect().browser,o=r.isIE()&&10===r.version.major?function(t){try{return n(t)}catch(t){return p.none()}}:n;return{get:function(n){if(!t(n))throw new Error("Can only get "+e+" value of a "+e+" node");return o(n).getOr("")},getOption:o,set:function(n,r){if(!t(n))throw new Error("Can only set raw "+e+" value of a "+e+" node");n.dom().nodeValue=r}}}(oe,"text"),sn=function(t){return fn.get(t)},dn=function(t){return fn.getOption(t)},mn=function(t,e){fn.set(t,e)},gn=function(t){return"img"===Zt(t)?1:dn(t).fold(function(){return Kt(t).length},function(t){return t.length})},hn=["img","br"],pn=function(t){return dn(t).filter(function(t){return 0!==t.trim().length||t.indexOf("Â ")>-1}).isSome()||R(hn,Zt(t))},vn=function(t){return e=pn,(n=function(t){for(var r=0;r<t.childNodes.length;r++){if(e(it.fromDom(t.childNodes[r])))return p.some(it.fromDom(t.childNodes[r]));var o=n(t.childNodes[r]);if(o.isSome())return o}return p.none()})(t.dom());var e,n},bn=function(t){return wn(t,pn)},wn=function(t,e){var n=function(t){for(var r=Kt(t),o=r.length-1;o>=0;o--){var i=r[o];if(e(i))return p.some(i);var u=n(i);if(u.isSome())return u}return p.none()};return n(t)},yn=function(){var t=it.fromTag("td");return Xe(t,it.fromTag("br")),t},xn=function(t,e,n){var r=ln(t,e);return H(n,function(t,e){null===t?se(r,e):ae(r,e,t)}),r},Cn=function(t){return t},Sn=function(t){return function(){return it.fromTag("tr",t.dom())}},Rn=function(t,e,n){return{row:Sn(e),cell:function(e){var r,o,i,u,a=qt(e.element()),c=it.fromTag(Zt(e.element()),a.dom()),l=n.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),f=l.length>0?function(t,e,n){return vn(t).map(function(r){var o=n.join(","),i=ve(r,o,function(e){return Ht(e,t)});return O(i,function(t,e){var n=an(e);return se(n,"contenteditable"),Xe(t,n),n},e)}).getOr(e)}(e.element(),c,l):c;return Xe(f,it.fromTag("br")),r=e.element(),o=c,i=r.dom(),u=o.dom(),_e(i)&&_e(u)&&(u.style.cssText=i.style.cssText),qe(c,"height"),1!==e.colspan()&&qe(e.element(),"width"),t(e.element(),c),c},replace:xn,gap:yn}},Tn=function(t){return{row:Sn(t),cell:yn,replace:Cn,gap:yn}},Dn=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function kn(){return{up:r({selector:Ce,closest:Te,predicate:xe,all:Gt}),down:r({selector:we,predicate:pe}),styles:r({get:He,getRaw:Ue,set:je,remove:qe}),attrs:r({get:le,set:ae,remove:se,copyTo:function(t,e){var n=de(t);ce(e,n)}}),insert:r({before:Ve,after:Ge,afterAll:Je,append:Xe,appendAll:$e,prepend:Ye,wrap:Ke}),remove:r({unwrap:tn,remove:Ze}),create:r({nu:it.fromTag,clone:function(t){return it.fromDom(t.dom().cloneNode(!1))},text:it.fromText}),query:r({comparePosition:function(t,e){return t.dom().compareDocumentPosition(e.dom())},prevSibling:Yt,nextSibling:Xt}),property:r({children:Kt,name:Zt,parent:Vt,isText:oe,isComment:ne,isElement:re,getText:sn,setText:mn,isBoundary:function(t){return!!re(t)&&("body"===Zt(t)||R(Dn,Zt(t)))},isEmptyTag:function(t){return!!re(t)&&R(["br","img","hr","input"],Zt(t))}}),eq:Ht,is:Ut}}var An=q("left","right"),On=function(t,e,n){var o=t.property().children(e);return P(o,i(t.eq,n)).map(function(t){return{before:r(o.slice(0,t)),after:r(o.slice(t+1))}})},En=function(t,e,n){return On(t,e,n).map(function(r){var o=t.create().clone(e);return t.insert().appendAll(o,r.before().concat([n])),t.insert().appendAll(e,r.after()),t.insert().before(e,o),An(o,e)})},Nn=function(t,e,n){return On(t,e,n).map(function(n){var r=t.create().clone(e);return t.insert().appendAll(r,n.after()),t.insert().after(e,r),An(e,r)})},Pn=function(t,e,n,r){var o=q("first","second","splits"),i=function(e,u,a){var c=o(e,p.none(),a);return n(e)?o(e,u,a):t.property().parent(e).bind(function(o){return r(t,o,e).map(function(t){var e=[{first:t.left,second:t.right}],r=n(o)?o:t.left();return i(r,p.some(t.right()),a.concat(e))}).getOr(c)})};return i(e,p.none(),[])},In=function(t,e,n,r){var o=e(t,n);return O(r,function(n,r){var o=e(t,r);return Bn(t,n,o)},o)},Bn=function(t,e,n){return e.bind(function(e){return n.filter(i(t.eq,e))})},Wn=function(t,e,n){return n.length>0?function(t,e,n,r){return r(t,e,n[0],n.slice(1))}(t,e,n,In):p.none()},Mn=function(t,e){return i(t.eq,e)},_n=function(t,e,n,o){var i=void 0!==o?o:r(!1),u=[e].concat(t.up().all(e)),a=[n].concat(t.up().all(n)),c=function(t){return P(t,i).fold(function(){return t},function(e){return t.slice(0,e+1)})},l=c(u),f=c(a),s=N(l,function(e){return T(f,Mn(t,e))});return{firstpath:r(l),secondpath:r(f),shared:r(s)}},Ln=function(t,e,n){var r=_n(t,e,n);return r.shared().bind(function(e){return function(t,e,n,r){var o=t.property().children(e);if(t.eq(e,n[0]))return p.some([n[0]]);if(t.eq(e,r[0]))return p.some([r[0]]);var i=function(n){var r=j(n),i=P(r,Mn(t,e)).getOr(-1),u=i<r.length-1?r[i+1]:r[i];return P(o,Mn(t,u))},u=i(n),a=i(r);return u.bind(function(t){return a.map(function(e){var n=Math.min(t,e),r=Math.max(t,e);return o.slice(n,r+1)})})}(t,e,r.firstpath(),r.secondpath())})},jn=_n,Fn=function(t,e,n){return Wn(t,e,n)},Hn=function(t,e,n){return Ln(t,e,n)},zn=function(t,e,n,r){return jn(t,e,n,r)},Un=function(t,e,n){return En(t,e,n)},qn=function(t,e,n){return Nn(t,e,n)},Vn=function(t,e,n,r){return Pn(t,e,n,r)},Gn=kn(),Yn={sharedOne:function(t,e){return Fn(Gn,function(e,n){return t(n)},e)},subset:function(t,e){return Hn(Gn,t,e)},ancestors:function(t,e,n){return zn(Gn,t,e,n)},breakToLeft:function(t,e){return Un(Gn,t,e)},breakToRight:function(t,e){return qn(Gn,t,e)},breakPath:function(t,e,n){return Vn(Gn,t,e,function(t,e,r){return n(e,r)})}},Xn=function(t,e){return e.column()>=t.startCol()&&e.column()+e.colspan()-1<=t.finishCol()&&e.row()>=t.startRow()&&e.row()+e.rowspan()-1<=t.finishRow()},Kn=function(t,e){var n=e.column(),r=e.column()+e.colspan()-1,o=e.row(),i=e.row()+e.rowspan()-1;return n<=t.finishCol()&&r>=t.startCol()&&o<=t.finishRow()&&i>=t.startRow()},Jn=function(t,e){for(var n=!0,r=i(Xn,e),o=e.startRow();o<=e.finishRow();o++)for(var u=e.startCol();u<=e.finishCol();u++)n=n&&Me.getAt(t,o,u).exists(r);return n?p.some(e):p.none()},$n=function(t,e,n){var r=Me.findItem(t,e,Ht),o=Me.findItem(t,n,Ht);return r.bind(function(t){return o.map(function(e){return n=t,r=e,rt.bounds(Math.min(n.row(),r.row()),Math.min(n.column(),r.column()),Math.max(n.row()+n.rowspan()-1,r.row()+r.rowspan()-1),Math.max(n.column()+n.colspan()-1,r.column()+r.colspan()-1));var n,r})})},Qn=$n,Zn=function(t,e,n){return $n(t,e,n).bind(function(e){return Jn(t,e)})},tr=function(t,e,n,r){return Me.findItem(t,e,Ht).bind(function(e){var o=n>0?e.row()+e.rowspan()-1:e.row(),i=r>0?e.column()+e.colspan()-1:e.column();return Me.getAt(t,o+n,i+r).map(function(t){return t.element()})})},er=function(t,e,n){return Qn(t,e,n).map(function(e){var n=Me.filterItems(t,i(Kn,e));return D(n,function(t){return t.element()})})},nr=function(t,e){return Me.findItem(t,e,function(t,e){return zt(e,t)}).bind(function(t){return t.element()})},rr=function(t){var e=Pe(t);return Me.generate(e)},or=function(t,e,n){return Ne.table(t).bind(function(r){var o=rr(r);return tr(o,t,e,n)})},ir=function(t,e,n){var r=rr(t);return er(r,e,n)},ur=function(t,e,n,r,o){var i=rr(t),u=Ht(t,n)?e:nr(i,e),a=Ht(t,o)?r:nr(i,r);return er(i,u,a)},ar=function(t,e,n){var r=rr(t);return Zn(r,e,n)},cr=function(t,e){return Ce(t,"table")},lr=J(["boxes","start","finish"],[]),fr=function(t,e,n){var r=function(t){return function(e){return n(e)||Ht(e,t)}};return Ht(t,e)?p.some(lr({boxes:p.some([t]),start:t,finish:e})):cr(t).bind(function(o){return cr(e).bind(function(i){if(Ht(o,i))return p.some(lr({boxes:ir(o,t,e),start:t,finish:e}));if(zt(o,i)){var u=(a=ve(e,"td,th",r(o))).length>0?a[a.length-1]:e;return p.some(lr({boxes:ur(o,t,o,e,i),start:t,finish:u}))}if(zt(i,o)){var a,c=(a=ve(t,"td,th",r(i))).length>0?a[a.length-1]:t;return p.some(lr({boxes:ur(i,t,o,e,i),start:t,finish:c}))}return Yn.ancestors(t,e).shared().bind(function(u){return Te(u,"table",n).bind(function(n){var u=ve(e,"td,th",r(n)),a=u.length>0?u[u.length-1]:e,c=ve(t,"td,th",r(n)),l=c.length>0?c[c.length-1]:t;return p.some(lr({boxes:ur(n,t,o,e,i),start:l,finish:a}))})})})})},sr={identify:fr,retrieve:function(t,e){var n=we(t,e);return n.length>0?p.some(n):p.none()},shiftSelection:function(t,e,n,o,i){return function(t,e){return N(t,function(t){return dt(t,e)})}(t,i).bind(function(t){return or(t,e,n).bind(function(t){return function(t,e){return Ce(t,"table").bind(function(n){return Re(n,e).bind(function(e){return fr(e,t).bind(function(t){return t.boxes().map(function(e){return{boxes:r(e),start:r(t.start()),finish:r(t.finish())}})})})})}(t,o)})})},getEdges:function(t,e,n){return Re(t,e).bind(function(e){return Re(t,n).bind(function(t){return Yn.sharedOne(cr,[e,t]).map(function(n){return{first:r(e),last:r(t),table:r(n)}})})})}},dr=function(t,e){return sr.retrieve(t,e)},mr=function(t,e,n){return sr.getEdges(t,e,n).bind(function(e){var n=function(e){return Ht(t,e)},r=Ce(e.first(),"thead,tfoot,tbody,table",n),o=Ce(e.last(),"thead,tfoot,tbody,table",n);return r.bind(function(t){return o.bind(function(n){return Ht(t,n)?ar(e.table(),e.first(),e.last()):p.none()})})})},gr="data-mce-selected",hr={selected:r(gr),selectedSelector:r("td[data-mce-selected],th[data-mce-selected]"),attributeSelector:r("[data-mce-selected]"),firstSelected:r("data-mce-first-selected"),firstSelectedSelector:r("td[data-mce-first-selected],th[data-mce-first-selected]"),lastSelected:r("data-mce-last-selected"),lastSelectedSelector:r("td[data-mce-last-selected],th[data-mce-last-selected]")},pr=function(t){if(!w(t))throw new Error("cases must be an array");if(0===t.length)throw new Error("there must be at least one case");var e=[],n={};return k(t,function(r,o){var i=F(r);if(1!==i.length)throw new Error("one and only one name per case");var u=i[0],a=r[u];if(void 0!==n[u])throw new Error("duplicate key detected:"+u);if("cata"===u)throw new Error("cannot have a case named cata (sorry)");if(!w(a))throw new Error("case arguments must be an array");e.push(u),n[u]=function(){var n=arguments.length;if(n!==a.length)throw new Error("Wrong number of arguments to case "+u+". Expected "+a.length+" ("+a+"), got "+n);for(var r=new Array(n),i=0;i<r.length;i++)r[i]=arguments[i];return{fold:function(){if(arguments.length!==t.length)throw new Error("Wrong number of arguments to fold. Expected "+t.length+", got "+arguments.length);return arguments[o].apply(null,r)},match:function(t){var n=F(t);if(e.length!==n.length)throw new Error("Wrong number of arguments to match. Expected: "+e.join(",")+"\nActual: "+n.join(","));if(!_(e,function(t){return R(n,t)}))throw new Error("Not all branches were specified when using match. Specified: "+n.join(", ")+"\nRequired: "+e.join(", "));return t[u].apply(null,r)},log:function(t){console.log(t,{constructors:e,constructor:u,params:r})}}}}),n},vr=pr([{none:[]},{multiple:["elements"]},{single:["selection"]}]),br={cata:function(t,e,n,r){return t.fold(e,n,r)},none:vr.none,multiple:vr.multiple,single:vr.single},wr=function(t,e){return br.cata(e.get(),r([]),o,r([t]))},yr=function(t,e){return br.cata(e.get(),p.none,function(e,n){return 0===e.length?p.none():mr(t,hr.firstSelectedSelector(),hr.lastSelectedSelector()).bind(function(t){return e.length>1?p.some({bounds:r(t),cells:r(e)}):p.none()})},p.none)},xr=function(t,e){var n=wr(t,e);return n.length>0&&_(n,function(t){return fe(t,"rowspan")&&parseInt(le(t,"rowspan"),10)>1||fe(t,"colspan")&&parseInt(le(t,"colspan"),10)>1})?p.some(n):p.none()},Cr=wr,Sr=function(t){return{element:r(t),mergable:p.none,unmergable:p.none,selection:r([t])}},Rr=q("element","clipboard","generators"),Tr={noMenu:Sr,forMenu:function(t,e,n){return{element:r(n),mergable:r(yr(e,t)),unmergable:r(xr(n,t)),selection:r(Cr(n,t))}},notCell:function(t){return Sr(t)},paste:Rr,pasteRows:function(t,e,n,o,i){return{element:r(n),mergable:p.none,unmergable:p.none,selection:r(Cr(n,t)),clipboard:r(o),generators:r(i)}}},Dr={registerEvents:function(t,n,r,o){t.on("BeforeGetContent",function(r){!0===r.selection&&br.cata(n.get(),e,function(e){r.preventDefault(),function(t){return Ne.table(t[0]).map(cn).map(function(t){return[on(t,hr.attributeSelector())]})}(e).each(function(e){r.content="text"===r.format?function(t){return D(t,function(t){return t.dom().innerText}).join("")}(e):function(t,e){return D(e,function(e){return t.selection.serializer.serialize(e.dom(),{})}).join("")}(t,e)})},e)}),t.on("BeforeSetContent",function(e){!0===e.selection&&!0===e.paste&&p.from(t.dom.getParent(t.selection.getStart(),"th,td")).each(function(n){var i=it.fromDom(n);Ne.table(i).bind(function(n){var u,a,c,l=A((u=e.content,(c=(a||document).createElement("div")).innerHTML=u,Kt(it.fromDom(c))),function(t){return"meta"!==Zt(t)});if(1===l.length&&"table"===Zt(l[0])){e.preventDefault();var f=it.fromDom(t.getDoc()),s=Tn(f),d=Tr.paste(i,l[0],s);r.pasteCells(n,d).each(function(e){t.selection.setRng(e),t.focus(),o.clear(n)})}})})})}};function kr(t,e){var n=function(n){var r=e(n);if(r<=0||null===r){var o=He(n,t);return parseFloat(o)||0}return r},r=function(t,e){return E(e,function(e,n){var r=He(t,n),o=void 0===r?0:parseInt(r,10);return isNaN(o)?e:e+o},0)};return{set:function(e,n){if(!C(n)&&!n.match(/^[0-9]+$/))throw t+".set accepts only positive integer values. Value was "+n;var r=e.dom();_e(r)&&(r.style[t]=n+"px")},get:n,getOuter:n,aggregate:r,max:function(t,e,n){var o=r(t,n);return e>o?e-o:0}}}var Ar=kr("height",function(t){var e=t.dom();return me(t)?e.getBoundingClientRect().height:e.offsetHeight}),Or=function(t){return Ar.get(t)},Er=function(t){return Ar.getOuter(t)},Nr=kr("width",function(t){return t.dom().offsetWidth}),Pr=function(t){return Nr.get(t)},Ir=function(t){return Nr.getOuter(t)},Br=Ft.detect(),Wr=function(t,e,n){return function(t,e){var n=parseFloat(t);return isNaN(n)?e:n}(He(t,e),n)},Mr=function(t){return Br.browser.isIE()||Br.browser.isEdge()?function(t){var e=Wr(t,"padding-top",0),n=Wr(t,"padding-bottom",0),r=Wr(t,"border-top-width",0),o=Wr(t,"border-bottom-width",0),i=t.dom().getBoundingClientRect().height;return"border-box"===He(t,"box-sizing")?i:i-e-n-(r+o)}(t):Wr(t,"height",Or(t))},_r=/(\d+(\.\d+)?)(\w|%)*/,Lr=/(\d+(\.\d+)?)%/,jr=/(\d+(\.\d+)?)px|em/,Fr=function(t,e){je(t,"height",e+"px")},Hr=function(t,e,n,r){var o,i,u=parseInt(t,10);return function(t,e,n){return""===e||!(t.length<e.length)&&t.substr(n,n+e.length)===e}(o=t,i="%",o.length-i.length)&&"table"!==Zt(e)?function(t,e,n,r){var o=Ne.table(t).map(function(t){var r=n(t);return Math.floor(e/100*r)}).getOr(e);return r(t,o),o}(e,u,n,r):u},zr=function(t){var e=function(t){return Ue(t,"height").getOrThunk(function(){return Mr(t)+"px"})}(t);return e?Hr(e,t,Or,Fr):Or(t)},Ur=function(t,e){return fe(t,e)?parseInt(le(t,e),10):1},qr=function(t){return Ue(t,"width").fold(function(){return p.from(le(t,"width"))},function(t){return p.some(t)})},Vr=function(t,e){return t/e.pixelWidth()*100},Gr={percentageBasedSizeRegex:r(Lr),pixelBasedSizeRegex:r(jr),setPixelWidth:function(t,e){je(t,"width",e+"px")},setPercentageWidth:function(t,e){je(t,"width",e+"%")},setHeight:Fr,getPixelWidth:function(t,e){return qr(t).fold(function(){return Pr(t)},function(n){return function(t,e,n){if(jr.test(e)){var r=jr.exec(e);return parseInt(r[1],10)}if(Lr.test(e)){var o=Lr.exec(e);return function(t,e){return t/100*e.pixelWidth()}(parseFloat(o[1]),n)}return Pr(t)}(t,n,e)})},getPercentageWidth:function(t,e){return qr(t).fold(function(){var n=Pr(t);return Vr(n,e)},function(n){return function(t,e,n){if(Lr.test(e)){var r=Lr.exec(e);return parseFloat(r[1])}var o=Pr(t);return Vr(o,n)}(t,n,e)})},getGenericWidth:function(t){return qr(t).bind(function(t){if(_r.test(t)){var e=_r.exec(t);return p.some({width:r(e[1]),unit:r(e[3])})}return p.none()})},setGenericWidth:function(t,e,n){je(t,"width",e+n)},getHeight:function(t){return function(t,e,n){return n(t)/Ur(t,e)}(t,"rowspan",zr)},getRawWidth:qr},Yr=function(t,e){Gr.getGenericWidth(t).each(function(n){var r=n.width()/2;Gr.setGenericWidth(t,r,n.unit()),Gr.setGenericWidth(e,r,n.unit())})},Xr=function(t,e){return{left:r(t),top:r(e),translate:function(n,r){return Xr(t+n,e+r)}}},Kr=Xr,Jr=function(t,e){return void 0!==t?t:void 0!==e?e:0},$r=function(t){var e=t.dom().ownerDocument,n=e.body,r=function(t){var e=t.dom();return e===e.window&&t instanceof Window?t:ie(t)?e.defaultView||e.parentWindow:null}(it.fromDom(e)),o=e.documentElement,i=Jr(r.pageYOffset,o.scrollTop),u=Jr(r.pageXOffset,o.scrollLeft),a=Jr(o.clientTop,n.clientTop),c=Jr(o.clientLeft,n.clientLeft);return Qr(t).translate(u-c,i-a)},Qr=function(t){var e=t.dom(),n=e.ownerDocument,r=n.body,o=it.fromDom(n.documentElement);return r===e?Kr(r.offsetLeft,r.offsetTop):function(t,e){var n=e||it.fromDom(document.documentElement);return xe(t,i(Ht,n)).isSome()}(t,o)?function(t){var e=t.getBoundingClientRect();return Kr(e.left,e.top)}(e):Kr(0,0)},Zr=q("row","y"),to=q("col","x"),eo=function(t){return $r(t).left()+Ir(t)},no=function(t){return $r(t).left()},ro=function(t,e){return to(t,no(e))},oo=function(t,e){return to(t,eo(e))},io=function(t){return $r(t).top()},uo=function(t,e,n){if(0===n.length)return[];var r=D(n.slice(1),function(e,n){return e.map(function(e){return t(n,e)})}),o=n[n.length-1].map(function(t){return e(n.length-1,t)});return r.concat([o])},ao={delta:o,positions:i(uo,function(t,e){return Zr(t,io(e))},function(t,e){return Zr(t,io(e)+Er(e))}),edge:io},co={delta:o,edge:no,positions:i(uo,ro,oo)},lo={height:ao,rtl:{delta:function(t,e){return-t},edge:eo,positions:i(uo,oo,ro)},ltr:co},fo={ltr:lo.ltr,rtl:lo.rtl};function so(t){var e=function(e){return t(e).isRtl()?fo.rtl:fo.ltr};return{delta:function(t,n){return e(n).delta(t,n)},edge:function(t){return e(t).edge(t)},positions:function(t,n){return e(n).positions(t,n)}}}var mo,go=function(t){var e=Pe(t);return Me.generate(e).grid()},ho=function(t){var e=t,n=function(){return e};return{get:n,set:function(t){e=t},clone:function(){return ho(n())}}},po=function(t,e,n){if(0===e.length)throw new Error("You must specify at least one required field.");return X("required",e),K(e),function(r){var o=F(r);_(e,function(t){return R(o,t)})||G(e,o),t(e,o);var i=A(e,function(t){return!n.validate(r[t],t)});return i.length>0&&function(t,e){throw new Error("All values need to be of type: "+e+". Keys ("+V(t).join(", ")+") were not.")}(i,n.label),r}},vo=function(t,e){var n=A(e,function(e){return!R(t,e)});n.length>0&&Y(n)},bo=function(t){return function(t,e){return po(t,e,{validate:x,label:"function"})}(vo,t)},wo=function(t){var e=fe(t,"colspan")?parseInt(le(t,"colspan"),10):1,n=fe(t,"rowspan")?parseInt(le(t,"rowspan"),10):1;return{element:r(t),colspan:r(e),rowspan:r(n)}},yo=bo(["cell","row","replace","gap"]),xo=function(t,e){yo(t);var n=ho(p.none()),r=void 0!==e?e:wo,o=function(e){return function(e){return t.cell(e)}(r(e))},i=function(t){var e=o(t);return n.get().isNone()&&n.set(p.some(e)),u=p.some({item:t,replacement:e}),e},u=p.none();return{getOrInit:function(t,e){return u.fold(function(){return i(t)},function(n){return e(t,n.item)?n.replacement:i(t)})},cursor:n.get}},Co=function(t,e){return function(n){var r=ho(p.none());yo(n);var o=[],i=function(i){var u=n.replace(i,e,{scope:t});return o.push({item:i,sub:u}),r.get().isNone()&&r.set(p.some(u)),u};return{replaceOrInit:function(t,e){return function(t,e){return N(o,function(n){return e(n.item,t)})}(t,e).fold(function(){return i(t)},function(n){return e(t,n.item)?n.sub:i(t)})},cursor:r.get}}},So=function(t){yo(t);var e=ho(p.none());return{combine:function(n){return e.get().isNone()&&e.set(p.some(n)),function(){var e=t.cell({element:r(n),colspan:r(1),rowspan:r(1)});return qe(e,"width"),qe(n,"width"),e}},cursor:e.get}},Ro=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],To=function(t,e){var n=t.property().name(e);return R(Ro,n)},Do=function(t,e){return R(["br","img","hr","input"],t.property().name(e))},ko=To,Ao=function(t,e){var n=t.property().name(e);return R(["ol","ul"],n)},Oo=Do,Eo=kn(),No=function(t){return ko(Eo,t)},Po=function(t){return Ao(Eo,t)},Io=function(t){return Oo(Eo,t)},Bo=function(t){var e,n=function(t){return"br"===Zt(t)},r=function(t){return bn(t).bind(function(e){var r=Xt(e).map(function(t){return!!No(t)||(Io(t)?"img"!==Zt(t):void 0)}).getOr(!1);return Vt(e).map(function(o){return!0===r||"li"===Zt(i=o)||xe(i,Po).isSome()||n(e)||No(o)&&!Ht(t,o)?[]:[it.fromTag("br")];var i})}).getOr([])},o=0===(e=M(t,function(t){var e=Kt(t);return function(t){return _(t,function(t){return n(t)||oe(t)&&0===sn(t).trim().length})}(e)?[]:e.concat(r(t))})).length?[it.fromTag("br")]:e;Qe(t[0]),$e(t[0],o)},Wo=Object.prototype.hasOwnProperty,Mo=(mo=function(t,e){return e},function(){for(var t=new Array(arguments.length),e=0;e<t.length;e++)t[e]=arguments[e];if(0===t.length)throw new Error("Can't merge zero objects");for(var n={},r=0;r<t.length;r++){var o=t[r];for(var i in o)Wo.call(o,i)&&(n[i]=mo(n[i],o[i]))}return n}),_o=function(t){for(var e=[],n=function(t){e.push(t)},r=0;r<t.length;r++)t[r].each(n);return e},Lo=function(t,e){for(var n=0;n<t.length;n++){var r=e(t[n],n);if(r.isSome())return r}return p.none()},jo=function(t,e){return rt.rowcells(e,t.section())},Fo=function(t,e){return t.cells()[e]},Ho={addCell:function(t,e,n){var r=t.cells(),o=r.slice(0,e),i=r.slice(e),u=o.concat([n]).concat(i);return jo(t,u)},setCells:jo,mutateCell:function(t,e,n){t.cells()[e]=n},getCell:Fo,getCellElement:function(t,e){return Fo(t,e).element()},mapCells:function(t,e){var n=t.cells(),r=D(n,e);return rt.rowcells(r,t.section())},cellLength:function(t){return t.cells().length}},zo=function(t,e){if(0===t.length)return 0;var n=t[0];return P(t,function(t){return!e(n.element(),t.element())}).fold(function(){return t.length},function(t){return t})},Uo=function(t,e,n,o){var i=function(t,e){return t[e]}(t,e).cells().slice(n),u=zo(i,o),a=function(t,e){return D(t,function(t){return Ho.getCell(t,e)})}(t,n).slice(e),c=zo(a,o);return{colspan:r(u),rowspan:r(c)}},qo=function(t,e){var n=D(t,function(t,e){return D(t.cells(),function(t,e){return!1})});return D(t,function(r,o){var i=M(r.cells(),function(r,i){if(!1===n[o][i]){var u=Uo(t,o,i,e);return function(t,e,r,o){for(var i=t;i<t+r;i++)for(var u=e;u<e+o;u++)n[i][u]=!0}(o,i,u.rowspan(),u.colspan()),[rt.detailnew(r.element(),u.rowspan(),u.colspan(),r.isNew())]}return[]});return rt.rowdetails(i,r.section())})},Vo=function(t,e,n){for(var r=[],o=0;o<t.grid().rows();o++){for(var i=[],u=0;u<t.grid().columns();u++){var a=Me.getAt(t,o,u).map(function(t){return rt.elementnew(t.element(),n)}).getOrThunk(function(){return rt.elementnew(e.gap(),!0)});i.push(a)}var c=rt.rowcells(i,t.all()[o].section());r.push(c)}return r},Go=function(t,e,n,r){n===r?se(t,e):ae(t,e,n)},Yo=function(t,e){var n=[],o=[],i=function(e,r){e.length>0?function(e,r){var i=Se(t,r).getOrThunk(function(){var e=it.fromTag(r,qt(t).dom());return Xe(t,e),e});Qe(i);var u=D(e,function(t){t.isNew()&&n.push(t.element());var e=t.element();return Qe(e),k(t.cells(),function(t){t.isNew()&&o.push(t.element()),Go(t.element(),"colspan",t.colspan(),1),Go(t.element(),"rowspan",t.rowspan(),1),Xe(e,t.element())}),e});$e(i,u)}(e,r):function(e){Se(t,e).each(Ze)}(r)},u=[],a=[],c=[];return k(e,function(t){switch(t.section()){case"thead":u.push(t);break;case"tbody":a.push(t);break;case"tfoot":c.push(t)}}),i(u,"thead"),i(a,"tbody"),i(c,"tfoot"),{newRows:r(n),newCells:r(o)}},Xo=function(t){return D(t,function(t){var e=an(t.element());return k(t.cells(),function(t){var n=cn(t.element());Go(n,"colspan",t.colspan(),1),Go(n,"rowspan",t.rowspan(),1),Xe(e,n)}),e})},Ko=function(t,e){for(var n=[],r=0;r<t;r++)n.push(e(r));return n},Jo=function(t,e){for(var n=[],r=t;r<e;r++)n.push(r);return n},$o=function(t,e){if(e<0||e>=t.length-1)return p.none();var n=t[e].fold(function(){var n=j(t.slice(0,e));return Lo(n,function(t,e){return t.map(function(t){return{value:t,delta:e+1}})})},function(t){return p.some({value:t,delta:0})}),r=t[e+1].fold(function(){var n=t.slice(e+1);return Lo(n,function(t,e){return t.map(function(t){return{value:t,delta:e+1}})})},function(t){return p.some({value:t,delta:1})});return n.bind(function(t){return r.map(function(e){var n=e.delta+t.delta;return Math.abs(e.value-t.value)/n})})},Qo=function(t,e,n){var r=t();return N(r,e).orThunk(function(){return p.from(r[0]).orThunk(n)}).map(function(t){return t.element()})},Zo=function(t){var e=t.grid(),n=Jo(0,e.columns()),o=Jo(0,e.rows());return D(n,function(e){return Qo(function(){return M(o,function(n){return Me.getAt(t,n,e).filter(function(t){return t.column()===e}).fold(r([]),function(t){return[t]})})},function(t){return 1===t.colspan()},function(){return Me.getAt(t,0,e)})})},ti=function(t){var e=t.grid(),n=Jo(0,e.rows()),o=Jo(0,e.columns());return D(n,function(e){return Qo(function(){return M(o,function(n){return Me.getAt(t,e,n).filter(function(t){return t.row()===e}).fold(r([]),function(t){return[t]})})},function(t){return 1===t.rowspan()},function(){return Me.getAt(t,e,0)})})},ei=function(t,e,n,r,o){var i=it.fromTag("div");return Fe(i,{position:"absolute",left:e-r/2+"px",top:n+"px",height:o+"px",width:r+"px"}),ce(i,{"data-column":t,role:"presentation"}),i},ni=function(t,e,n,r,o){var i=it.fromTag("div");return Fe(i,{position:"absolute",left:e+"px",top:n-o/2+"px",height:o+"px",width:r+"px"}),ce(i,{"data-row":t,role:"presentation"}),i},ri=function(t){var e=t.replace(/\./g,"-");return{resolve:function(t){return e+"-"+t}}},oi=ri("ephox-snooker"),ii={resolve:oi.resolve},ui=function(t,e){var n=le(t,e);return void 0===n||""===n?[]:n.split(" ")},ai=function(t){return void 0!==t.dom().classList},ci=function(t,e){return function(t,e,n){var r=ui(t,e).concat([n]);return ae(t,e,r.join(" ")),!0}(t,"class",e)},li=function(t,e){return function(t,e,n){var r=A(ui(t,e),function(t){return t!==n});return r.length>0?ae(t,e,r.join(" ")):se(t,e),!1}(t,"class",e)},fi=function(t,e){ai(t)?t.dom().classList.add(e):ci(t,e)},si=function(t){0===(ai(t)?t.dom().classList:function(t){return ui(t,"class")}(t)).length&&se(t,"class")},di=function(t,e){return ai(t)&&t.dom().classList.contains(e)},mi=ii.resolve("resizer-bar"),gi=ii.resolve("resizer-rows"),hi=ii.resolve("resizer-cols"),pi=function(t){var e=we(t.parent(),"."+mi);k(e,Ze)},vi=function(t,e,n){var r=t.origin();k(e,function(e,o){e.each(function(e){var o=n(r,e);fi(o,mi),Xe(t.parent(),o)})})},bi=function(t,e,n,r,o,i){var u=$r(e);!function(t,e,n,r){vi(t,e,function(t,e){var o=ni(e.row(),n.left()-t.left(),e.y()-t.top(),r,7);return fi(o,gi),o})}(t,n.length>0?o.positions(n,e):[],u,Ir(e)),function(t,e,n,r){vi(t,e,function(t,e){var o=ei(e.col(),e.x()-t.left(),n.top()-t.top(),7,r);return fi(o,hi),o})}(t,r.length>0?i.positions(r,e):[],u,Er(e))},wi=function(t,e){var n=we(t.parent(),"."+mi);k(n,e)},yi={refresh:function(t,e,n,r){pi(t);var o=Pe(e),i=Me.generate(o),u=ti(i),a=Zo(i);bi(t,e,u,a,n,r)},hide:function(t){wi(t,function(t){je(t,"display","none")})},show:function(t){wi(t,function(t){je(t,"display","block")})},destroy:pi,isRowBar:function(t){return di(t,gi)},isColBar:function(t){return di(t,hi)}},xi=function(t,e){return D(t,function(t){var n=function(t){return Lo(t,function(t){return Vt(t.element()).map(function(t){var e=Vt(t).isNone();return rt.elementnew(t,e)})}).getOrThunk(function(){return rt.elementnew(e.row(),!0)})}(t.details());return rt.rowdatanew(n.element(),t.details(),t.section(),n.isNew())})},Ci=function(t,e){var n=qo(t,Ht);return xi(n,e)},Si=function(t,e){var n=W(D(t.all(),function(t){return t.cells()}));return N(n,function(t){return Ht(e,t.element())})},Ri=function(t,e,n,o,i){return function(u,a,c,l,f){var s=Pe(a),d=Me.generate(s);return e(d,c).map(function(e){var n=function(t,e){return Vo(t,e,!1)}(d,l),o=t(n,e,Ht,i(l)),u=Ci(o.grid(),l);return{grid:r(u),cursor:o.cursor}}).fold(function(){return p.none()},function(t){var e=Yo(a,t.grid());return n(a,t.grid(),f),o(a),yi.refresh(u,a,lo.height,f),p.some({cursor:t.cursor,newRows:e.newRows,newCells:e.newCells})})}},Ti=Ci,Di=function(t,e){return Ne.cell(e.element()).bind(function(e){return Si(t,e)})},ki=function(t,e){var n=D(e.selection(),function(e){return Ne.cell(e).bind(function(e){return Si(t,e)})}),r=_o(n);return r.length>0?p.some(r):p.none()},Ai=function(t,e){return Ne.cell(e.element()).bind(function(n){return Si(t,n).map(function(t){return Mo(t,{generators:e.generators,clipboard:e.clipboard})})})},Oi=function(t,e){var n=D(e.selection(),function(e){return Ne.cell(e).bind(function(e){return Si(t,e)})}),r=_o(n);return r.length>0?p.some(Mo({cells:r},{generators:e.generators,clipboard:e.clipboard})):p.none()},Ei=function(t,e){return e.mergable()},Ni=function(t,e){return e.unmergable()},Pi=function(t){return{is:function(e){return t===e},isValue:f,isError:l,getOr:r(t),getOrThunk:r(t),getOrDie:r(t),or:function(e){return Pi(t)},orThunk:function(e){return Pi(t)},fold:function(e,n){return n(t)},map:function(e){return Pi(e(t))},mapError:function(e){return Pi(t)},each:function(e){e(t)},bind:function(e){return e(t)},exists:function(e){return e(t)},forall:function(e){return e(t)},toOption:function(){return p.some(t)}}},Ii=function(t){return{is:l,isValue:l,isError:f,getOr:o,getOrThunk:function(t){return t()},getOrDie:function(){return(e=String(t),function(){throw new Error(e)})();var e},or:function(t){return t},orThunk:function(t){return t()},fold:function(e,n){return e(t)},map:function(e){return Ii(t)},mapError:function(e){return Ii(e(t))},each:e,bind:function(e){return Ii(t)},exists:l,forall:f,toOption:p.none}},Bi={value:Pi,error:Ii},Wi=function(t,e){return D(t,function(){return rt.elementnew(e.cell(),!0)})},Mi=function(t,e,n){return t.concat(Ko(e,function(e){return Ho.setCells(t[t.length-1],Wi(t[t.length-1].cells(),n))}))},_i=function(t,e,n){return D(t,function(t){return Ho.setCells(t,t.cells().concat(Wi(Jo(0,e),n)))})},Li=function(t,e,n){if(t.row()>=e.length||t.column()>Ho.cellLength(e[0]))return Bi.error("invalid start address out of table bounds, row: "+t.row()+", column: "+t.column());var o=e.slice(t.row()),i=o[0].cells().slice(t.column()),u=Ho.cellLength(n[0]),a=n.length;return Bi.value({rowDelta:r(o.length-a),colDelta:r(i.length-u)})},ji=function(t,e){var n=Ho.cellLength(t[0]),o=Ho.cellLength(e[0]);return{rowDelta:r(0),colDelta:r(n-o)}},Fi=function(t,e,n){var r=e.colDelta()<0?_i:o;return(e.rowDelta()<0?Mi:o)(r(t,Math.abs(e.colDelta()),n),Math.abs(e.rowDelta()),n)},Hi=function(t,e,n,r){if(0===t.length)return t;for(var o=e.startRow();o<=e.finishRow();o++)for(var i=e.startCol();i<=e.finishCol();i++)Ho.mutateCell(t[o],i,rt.elementnew(r(),!1));return t},zi=function(t,e,n,r){for(var o=!0,i=0;i<t.length;i++)for(var u=0;u<Ho.cellLength(t[0]);u++){var a=n(Ho.getCellElement(t[i],u),e);!0===a&&!1===o?Ho.mutateCell(t[i],u,rt.elementnew(r(),!0)):!0===a&&(o=!1)}return t},Ui=function(t,e,n,r){if(e>0&&e<t.length){var o=function(t,e){return E(t,function(t,n){return T(t,function(t){return e(t.element(),n.element())})?t:t.concat([n])},[])}(t[e-1].cells(),n);k(o,function(o){for(var i=p.none(),u=e;u<t.length;u++)for(var a=0;a<Ho.cellLength(t[0]);a++){var c=t[u].cells()[a];n(c.element(),o.element())&&(i.isNone()&&(i=p.some(r())),i.each(function(e){Ho.mutateCell(t[u],a,rt.elementnew(e,!0))}))}})}return t},qi=function(t,e,n,r){var o=i(r,Ho.getCell(t[e],n).element()),u=t[e];return t.length>1&&Ho.cellLength(u)>1&&(n>0&&o(Ho.getCellElement(u,n-1))||n<u.length-1&&o(Ho.getCellElement(u,n+1))||e>0&&o(Ho.getCellElement(t[e-1],n))||e<t.length-1&&o(Ho.getCellElement(t[e+1],n)))},Vi=function(t,e,n,r,o){return Li(t,e,n).map(function(i){var u=Fi(e,i,r);return function(t,e,n,r,o){for(var i=t.row(),u=t.column(),a=i+n.length,c=u+Ho.cellLength(n[0]),l=i;l<a;l++)for(var f=u;f<c;f++){qi(e,l,f,o)&&zi(e,Ho.getCellElement(e[l],f),o,r.cell);var s=Ho.getCellElement(n[l-i],f-u),d=r.replace(s);Ho.mutateCell(e[l],f,rt.elementnew(d,!0))}return e}(t,u,n,r,o)})},Gi=function(t,e,n,r,o){Ui(e,t,o,r.cell);var i=ji(n,e),u=Fi(n,i,r),a=ji(e,u),c=Fi(e,a,r);return c.slice(0,t).concat(u).concat(c.slice(t,c.length))},Yi=function(t,e,n,r,o){var i=t.slice(0,e),u=t.slice(e),a=Ho.mapCells(t[n],function(n,i){return e>0&&e<t.length&&r(Ho.getCellElement(t[e-1],i),Ho.getCellElement(t[e],i))?Ho.getCell(t[e],i):rt.elementnew(o(n.element(),r),!0)});return i.concat([a]).concat(u)},Xi=function(t,e,n,r,o){return D(t,function(t){var i=e>0&&e<Ho.cellLength(t)&&r(Ho.getCellElement(t,e-1),Ho.getCellElement(t,e))?Ho.getCell(t,e):rt.elementnew(o(Ho.getCellElement(t,n),r),!0);return Ho.addCell(t,e,i)})},Ki=function(t,e,n,r,o){var i=n+1;return D(t,function(t,u){var a=u===e?rt.elementnew(o(Ho.getCellElement(t,n),r),!0):Ho.getCell(t,n);return Ho.addCell(t,i,a)})},Ji=function(t,e,n,r,o){var i=e+1,u=t.slice(0,i),a=t.slice(i),c=Ho.mapCells(t[e],function(t,e){return e===n?rt.elementnew(o(t.element(),r),!0):t});return u.concat([c]).concat(a)},$i=function(t,e,n){return t.slice(0,e).concat(t.slice(n+1))},Qi=function(t,e,n){var r=D(t,function(t){var r=t.cells().slice(0,e).concat(t.cells().slice(n+1));return rt.rowcells(r,t.section())});return A(r,function(t){return t.cells().length>0})},Zi=function(t,e,n,r){return D(t,function(t){return Ho.mapCells(t,function(t){return function(t){return T(e,function(e){return n(t.element(),e.element())})}(t)?rt.elementnew(r(t.element(),n),!0):t})})},tu=function(t,e,n,r){return void 0!==Ho.getCellElement(t[e],n)&&e>0&&r(Ho.getCellElement(t[e-1],n),Ho.getCellElement(t[e],n))},eu=function(t,e,n){return e>0&&n(Ho.getCellElement(t,e-1),Ho.getCellElement(t,e))},nu=function(t,e,n,r){var o=M(t,function(r,o){return tu(t,o,e,n)||eu(r,e,n)?[]:[Ho.getCell(r,e)]});return Zi(t,o,n,r)},ru=function(t,e,n,r){var o=t[e],i=M(o.cells(),function(r,i){return tu(t,e,i,n)||eu(o,i,n)?[]:[r]});return Zi(t,i,n,r)},ou=function(t){return{fold:t}},iu=function(){return ou(function(t,e,n,r,o){return t()})},uu=function(t){return ou(function(e,n,r,o,i){return n(t)})},au=function(t,e){return ou(function(n,r,o,i,u){return o(t,e)})},cu=function(t,e,n){return ou(function(r,o,i,u,a){return u(t,e,n)})},lu=function(t,e){return ou(function(n,r,o,i,u){return u(t,e)})},fu=function(t,e,n,o){var i=t.slice(0),u=function(t,e){return 0===t.length?iu():1===t.length?uu(0):0===e?au(0,1):e===t.length-1?lu(e-1,e):e>0&&e<t.length-1?cu(e-1,e,e+1):iu()}(t,e),a=function(t){return D(t,r(0))},c=r(a(i)),l=function(t,e){if(n>=0){var r=Math.max(o.minCellWidth(),i[e]-n);return a(i.slice(0,t)).concat([n,r-i[e]]).concat(a(i.slice(e+1)))}var u=Math.max(o.minCellWidth(),i[t]+n),c=i[t]-u;return a(i.slice(0,t)).concat([u-i[t],c]).concat(a(i.slice(e+1)))},f=l;return u.fold(c,function(t){return o.singleColumnWidth(i[t],n)},f,function(t,e,n){return l(e,n)},function(t,e){if(n>=0)return a(i.slice(0,e)).concat([n]);var r=Math.max(o.minCellWidth(),i[e]+n);return a(i.slice(0,e)).concat([r-i[e]])})},su=function(t,e){return fe(t,e)&&parseInt(le(t,e),10)>1},du={hasColspan:function(t){return su(t,"colspan")},hasRowspan:function(t){return su(t,"rowspan")},minWidth:r(10),minHeight:r(10),getInt:function(t,e){return parseInt(He(t,e),10)}},mu=function(t,e,n){return Ue(t,e).fold(function(){return n(t)+"px"},function(t){return t})},gu=function(t){return mu(t,"width",Gr.getPixelWidth)},hu=function(t){return mu(t,"height",Gr.getHeight)},pu=function(t,e,n,r,o){var i=Zo(t),u=D(i,function(t){return t.map(e.edge)});return D(i,function(t,e){return t.filter(a(du.hasColspan)).fold(function(){var t=$o(u,e);return r(t)},function(t){return n(t,o)})})},vu=function(t){return t.map(function(t){return t+"px"}).getOr("")},bu=function(t,e,n,r){var o=ti(t),i=D(o,function(t){return t.map(e.edge)});return D(o,function(t,e){return t.filter(a(du.hasRowspan)).fold(function(){var t=$o(i,e);return r(t)},function(t){return n(t)})})},wu={getRawWidths:function(t,e){return pu(t,e,gu,vu)},getPixelWidths:function(t,e,n){return pu(t,e,Gr.getPixelWidth,function(t){return t.getOrThunk(n.minCellWidth)},n)},getPercentageWidths:function(t,e,n){return pu(t,e,Gr.getPercentageWidth,function(t){return t.fold(function(){return n.minCellWidth()},function(t){return t/n.pixelWidth()*100})},n)},getPixelHeights:function(t,e){return bu(t,e,Gr.getHeight,function(t){return t.getOrThunk(du.minHeight)})},getRawHeights:function(t,e){return bu(t,e,hu,vu)}},yu=function(t,e,n){for(var r=0,o=t;o<e;o++)r+=void 0!==n[o]?n[o]:0;return r},xu=function(t,e){var n=Me.justCells(t);return D(n,function(t){var n=yu(t.column(),t.column()+t.colspan(),e);return{element:t.element,width:r(n),colspan:t.colspan}})},Cu=function(t,e){var n=Me.justCells(t);return D(n,function(t){var n=yu(t.row(),t.row()+t.rowspan(),e);return{element:t.element,height:r(n),rowspan:t.rowspan}})},Su=function(t,e){return D(t.all(),function(t,n){return{element:t.element,height:r(e[n])}})},Ru=function(t){var e=parseInt(t,10),n=o;return{width:r(e),pixelWidth:r(e),getWidths:wu.getPixelWidths,getCellDelta:n,singleColumnWidth:function(t,e){return[Math.max(du.minWidth(),t+e)-t]},minCellWidth:du.minWidth,setElementWidth:Gr.setPixelWidth,setTableWidth:function(t,e,n){var r=O(e,function(t,e){return t+e},0);Gr.setPixelWidth(t,r)}}},Tu=function(t,e){if(Gr.percentageBasedSizeRegex().test(e))return function(t,e){var n=parseFloat(t),o=Pr(e);return{width:r(n),pixelWidth:r(o),getWidths:wu.getPercentageWidths,getCellDelta:function(t){return t/o*100},singleColumnWidth:function(t,e){return[100-t]},minCellWidth:function(){return du.minWidth()/o*100},setElementWidth:Gr.setPercentageWidth,setTableWidth:function(t,e,r){var o=n+r;Gr.setPercentageWidth(t,o)}}}(Gr.percentageBasedSizeRegex().exec(e)[1],t);if(Gr.pixelBasedSizeRegex().test(e)){var n=Gr.pixelBasedSizeRegex().exec(e);return Ru(n[1])}var o=Pr(t);return Ru(o)},Du=function(t){return Gr.getRawWidth(t).fold(function(){var e=Pr(t);return Ru(e)},function(e){return Tu(t,e)})},ku=function(t){return Me.generate(t)},Au=function(t){var e=Pe(t);return ku(e)},Ou={adjustWidth:function(t,e,n,r){var o=Du(t),i=o.getCellDelta(e),u=Au(t),a=o.getWidths(u,r,o),c=fu(a,n,i,o),l=D(c,function(t,e){return t+a[e]}),f=xu(u,l);k(f,function(t){o.setElementWidth(t.element(),t.width())}),n===u.grid().columns()-1&&o.setTableWidth(t,l,i)},adjustHeight:function(t,e,n,r){var o=Au(t),i=wu.getPixelHeights(o,r),u=D(i,function(t,r){return n===r?Math.max(e+t,du.minHeight()):t}),a=Cu(o,u),c=Su(o,u);k(c,function(t){Gr.setHeight(t.element(),t.height())}),k(a,function(t){Gr.setHeight(t.element(),t.height())});var l=O(u,function(t,e){return t+e},0);Gr.setHeight(t,l)},adjustWidthTo:function(t,e,n){var r=Du(t),o=ku(e),i=r.getWidths(o,n,r),u=xu(o,i);k(u,function(t){r.setElementWidth(t.element(),t.width())});var a=O(i,function(t,e){return e+t},0);u.length>0&&r.setElementWidth(t,a)}},Eu=function(t){0===Ne.cells(t).length&&Ze(t)},Nu=q("grid","cursor"),Pu=function(t,e,n){return Iu(t,e,n).orThunk(function(){return Iu(t,0,0)})},Iu=function(t,e,n){return p.from(t[e]).bind(function(t){return p.from(t.cells()[n]).bind(function(t){return p.from(t.element())})})},Bu=function(t,e,n){return Nu(t,Iu(t,e,n))},Wu=function(t){return E(t,function(t,e){return T(t,function(t){return t.row()===e.row()})?t:t.concat([e])},[]).sort(function(t,e){return t.row()-e.row()})},Mu=function(t){return E(t,function(t,e){return T(t,function(t){return t.column()===e.column()})?t:t.concat([e])},[]).sort(function(t,e){return t.column()-e.column()})},_u=function(t,e,n){var r=Ie(t,n),o=Me.generate(r);return Vo(o,e,!0)},Lu=Ou.adjustWidthTo,ju={insertRowBefore:Ri(function(t,e,n,r){var o=e.row(),i=e.row(),u=Yi(t,i,o,n,r.getOrInit);return Bu(u,i,e.column())},Di,e,e,xo),insertRowsBefore:Ri(function(t,e,n,r){var o=e[0].row(),i=e[0].row(),u=Wu(e),a=E(u,function(t,e){return Yi(t,i,o,n,r.getOrInit)},t);return Bu(a,i,e[0].column())},ki,e,e,xo),insertRowAfter:Ri(function(t,e,n,r){var o=e.row(),i=e.row()+e.rowspan(),u=Yi(t,i,o,n,r.getOrInit);return Bu(u,i,e.column())},Di,e,e,xo),insertRowsAfter:Ri(function(t,e,n,r){var o=Wu(e),i=o[o.length-1].row(),u=o[o.length-1].row()+o[o.length-1].rowspan(),a=E(o,function(t,e){return Yi(t,u,i,n,r.getOrInit)},t);return Bu(a,u,e[0].column())},ki,e,e,xo),insertColumnBefore:Ri(function(t,e,n,r){var o=e.column(),i=e.column(),u=Xi(t,i,o,n,r.getOrInit);return Bu(u,e.row(),i)},Di,Lu,e,xo),insertColumnsBefore:Ri(function(t,e,n,r){var o=Mu(e),i=o[0].column(),u=o[0].column(),a=E(o,function(t,e){return Xi(t,u,i,n,r.getOrInit)},t);return Bu(a,e[0].row(),u)},ki,Lu,e,xo),insertColumnAfter:Ri(function(t,e,n,r){var o=e.column(),i=e.column()+e.colspan(),u=Xi(t,i,o,n,r.getOrInit);return Bu(u,e.row(),i)},Di,Lu,e,xo),insertColumnsAfter:Ri(function(t,e,n,r){var o=e[e.length-1].column(),i=e[e.length-1].column()+e[e.length-1].colspan(),u=Mu(e),a=E(u,function(t,e){return Xi(t,i,o,n,r.getOrInit)},t);return Bu(a,e[0].row(),i)},ki,Lu,e,xo),splitCellIntoColumns:Ri(function(t,e,n,r){var o=Ki(t,e.row(),e.column(),n,r.getOrInit);return Bu(o,e.row(),e.column())},Di,e,e,xo),splitCellIntoRows:Ri(function(t,e,n,r){var o=Ji(t,e.row(),e.column(),n,r.getOrInit);return Bu(o,e.row(),e.column())},Di,e,e,xo),eraseColumns:Ri(function(t,e,n,r){var o=Mu(e),i=Qi(t,o[0].column(),o[o.length-1].column()),u=Pu(i,e[0].row(),e[0].column());return Nu(i,u)},ki,Lu,Eu,xo),eraseRows:Ri(function(t,e,n,r){var o=Wu(e),i=$i(t,o[0].row(),o[o.length-1].row()),u=Pu(i,e[0].row(),e[0].column());return Nu(i,u)},ki,e,Eu,xo),makeColumnHeader:Ri(function(t,e,n,r){var o=nu(t,e.column(),n,r.replaceOrInit);return Bu(o,e.row(),e.column())},Di,e,e,Co("row","th")),unmakeColumnHeader:Ri(function(t,e,n,r){var o=nu(t,e.column(),n,r.replaceOrInit);return Bu(o,e.row(),e.column())},Di,e,e,Co(null,"td")),makeRowHeader:Ri(function(t,e,n,r){var o=ru(t,e.row(),n,r.replaceOrInit);return Bu(o,e.row(),e.column())},Di,e,e,Co("col","th")),unmakeRowHeader:Ri(function(t,e,n,r){var o=ru(t,e.row(),n,r.replaceOrInit);return Bu(o,e.row(),e.column())},Di,e,e,Co(null,"td")),mergeCells:Ri(function(t,e,n,o){var i=e.cells();Bo(i);var u=Hi(t,e.bounds(),n,r(i[0]));return Nu(u,p.from(i[0]))},Ei,e,e,So),unmergeCells:Ri(function(t,e,n,r){var o=O(e,function(t,e){return zi(t,e,n,r.combine(e))},t);return Nu(o,p.from(e[0]))},Ni,e,e,So),pasteCells:Ri(function(t,e,n,r){var o,i,u,a,c=(o=e.clipboard(),i=e.generators(),u=Pe(o),a=Me.generate(u),Vo(a,i,!0)),l=rt.address(e.row(),e.column());return Vi(l,t,c,e.generators(),n).fold(function(){return Nu(t,p.some(e.element()))},function(t){var n=Pu(t,e.row(),e.column());return Nu(t,n)})},Ai,Lu,e,xo),pasteRowsBefore:Ri(function(t,e,n,r){var o=t[e.cells[0].row()],i=e.cells[0].row(),u=_u(e.clipboard(),e.generators(),o),a=Gi(i,t,u,e.generators(),n),c=Pu(a,e.cells[0].row(),e.cells[0].column());return Nu(a,c)},Oi,e,e,xo),pasteRowsAfter:Ri(function(t,e,n,r){var o=t[e.cells[0].row()],i=e.cells[e.cells.length-1].row()+e.cells[e.cells.length-1].rowspan(),u=_u(e.clipboard(),e.generators(),o),a=Gi(i,t,u,e.generators(),n),c=Pu(a,e.cells[0].row(),e.cells[0].column());return Nu(a,c)},Oi,e,e,xo)},Fu=function(t){return it.fromDom(t.getBody())},Hu=function(t){return t.getBoundingClientRect().width},zu=function(t){return t.getBoundingClientRect().height},Uu=function(t){return function(e){return Ht(e,Fu(t))}},qu=function(t){return/^[0-9]+$/.test(t)&&(t+="px"),t},Vu=function(t){var e=we(t,"td[data-mce-style],th[data-mce-style]");se(t,"data-mce-style"),k(e,function(t){se(t,"data-mce-style")})},Gu={isRtl:r(!1)},Yu={isRtl:r(!0)},Xu={directionAt:function(t){return"rtl"===function(t){return"rtl"===He(t,"direction")?"rtl":"ltr"}(t)?Yu:Gu}},Ku=["tableprops","tabledelete","|","tableinsertrowbefore","tableinsertrowafter","tabledeleterow","|","tableinsertcolbefore","tableinsertcolafter","tabledeletecol"],Ju={"border-collapse":"collapse",width:"100%"},$u={border:"1"},Qu=function(t){return t.getParam("table_default_attributes",$u,"object")},Zu=function(t){return t.getParam("table_default_styles",Ju,"object")},ta=function(t){return t.getParam("table_tab_navigation",!0,"boolean")},ea=function(t){return t.getParam("table_cell_advtab",!0,"boolean")},na=function(t){return t.getParam("table_row_advtab",!0,"boolean")},ra=function(t){return t.getParam("table_advtab",!0,"boolean")},oa=function(t){return t.getParam("table_appearance_options",!0,"boolean")},ia=function(t){return t.getParam("table_style_by_css",!1,"boolean")},ua=function(t){return t.getParam("table_cell_class_list",[],"array")},aa=function(t){return t.getParam("table_row_class_list",[],"array")},ca=function(t){return t.getParam("table_class_list",[],"array")},la=function(t){return!1===t.getParam("table_responsive_width")},fa=function(t,e){return t.fire("newrow",{node:e})},sa=function(t,e){return t.fire("newcell",{node:e})},da=function(t,e,n,r){t.fire("ObjectResizeStart",{target:e,width:n,height:r})},ma=function(t,e,n,r){t.fire("ObjectResized",{target:e,width:n,height:r})},ga=function(t,n){var r=function(t){return"table"===Zt(Fu(t))},o=function(t){var e=t.getParam("table_clone_elements");return b(e)?p.some(e.split(/[ ,]/)):Array.isArray(e)?p.some(e):p.none()}(t),i=function(e,n,r,i){return function(u,a){Vu(u);var c=i(),l=it.fromDom(t.getDoc()),f=so(Xu.directionAt),s=Rn(r,l,o);return n(u)?e(c,u,a,s,f).bind(function(e){return k(e.newRows(),function(e){fa(t,e.dom())}),k(e.newCells(),function(e){sa(t,e.dom())}),e.cursor().map(function(e){var n=t.dom.createRng();return n.setStart(e.dom(),0),n.setEnd(e.dom(),0),n})}):p.none()}};return{deleteRow:i(ju.eraseRows,function(e){var n=go(e);return!1===r(t)||n.rows()>1},e,n),deleteColumn:i(ju.eraseColumns,function(e){var n=go(e);return!1===r(t)||n.columns()>1},e,n),insertRowsBefore:i(ju.insertRowsBefore,f,e,n),insertRowsAfter:i(ju.insertRowsAfter,f,e,n),insertColumnsBefore:i(ju.insertColumnsBefore,f,Yr,n),insertColumnsAfter:i(ju.insertColumnsAfter,f,Yr,n),mergeCells:i(ju.mergeCells,f,e,n),unmergeCells:i(ju.unmergeCells,f,e,n),pasteRowsBefore:i(ju.pasteRowsBefore,f,e,n),pasteRowsAfter:i(ju.pasteRowsAfter,f,e,n),pasteCells:i(ju.pasteCells,f,e,n)}},ha=function(t,e,n){var r=Pe(t),o=Me.generate(r);return ki(o,e).map(function(t){var e=Vo(o,n,!1).slice(t[0].row(),t[t.length-1].row()+t[t.length-1].rowspan()),r=Ti(e,n);return Xo(r)})},pa=tinymce.util.Tools.resolve("tinymce.util.Tools"),va={applyAlign:function(t,e,n){n&&t.formatter.apply("align"+n,{},e)},applyVAlign:function(t,e,n){n&&t.formatter.apply("valign"+n,{},e)},unApplyAlign:function(t,e){pa.each("left center right".split(" "),function(n){t.formatter.remove("align"+n,{},e)})},unApplyVAlign:function(t,e){pa.each("top middle bottom".split(" "),function(n){t.formatter.remove("valign"+n,{},e)})},getTDTHOverallStyle:function(t,e,n){var r;return r=function(e,r){for(var o=0;o<r.length;o++){var i=t.getStyle(r[o],n);if(void 0===e&&(e=i),e!==i)return""}return e}(r,t.select("td,th",e))}},ba=function(t,e){var n=t.dom,r=e.control.rootControl,o=r.toJSON(),i=n.parseStyle(o.style);i["border-style"]=o.borderStyle,i["border-color"]=o.borderColor,i["background-color"]=o.backgroundColor,i.width=o.width?qu(o.width):"",i.height=o.height?qu(o.height):"",r.find("#style").value(n.serializeStyle(n.parseStyle(n.serializeStyle(i))))},wa=function(t,e){var n=t.dom,r=e.control.rootControl,o=r.toJSON(),i=n.parseStyle(o.style);r.find("#borderStyle").value(i["border-style"]||""),r.find("#borderColor").value(i["border-color"]||""),r.find("#backgroundColor").value(i["background-color"]||""),r.find("#width").value(i.width||""),r.find("#height").value(i.height||"")},ya={createStyleForm:function(t){var e=function(){var e=function(t){return t.getParam("color_picker_callback")}(t);if(e)return function(n){return e.call(t,function(t){n.control.value(t).fire("change")},n.control.value())}};return{title:"Advanced",type:"form",defaults:{onchange:i(ba,t)},items:[{label:"Style",name:"style",type:"textbox",onchange:i(wa,t)},{type:"form",padding:0,formItemDefaults:{layout:"grid",alignH:["start","right"]},defaults:{size:7},items:[{label:"Border style",type:"listbox",name:"borderStyle",width:90,onselect:i(ba,t),values:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{label:"Border color",type:"colorbox",name:"borderColor",onaction:e()},{label:"Background color",type:"colorbox",name:"backgroundColor",onaction:e()}]}]}},buildListItems:function(t,e,n){var r=function(t,n){return n=n||[],pa.each(t,function(t){var o={text:t.text||t.title};t.menu?o.menu=r(t.menu):(o.value=t.value,e&&e(o)),n.push(o)}),n};return r(t,n||[])},updateStyleField:ba,extractAdvancedStyles:function(t,e){var n=t.parseStyle(t.getAttrib(e,"style")),r={};return n["border-style"]&&(r.borderStyle=n["border-style"]),n["border-color"]&&(r.borderColor=n["border-color"]),n["background-color"]&&(r.backgroundColor=n["background-color"]),r.style=t.serializeStyle(n),r},updateAdvancedFields:wa,syncAdvancedStyleFields:function(t,e){e.control.rootControl.find("#style")[0].getEl().isEqualNode(document.activeElement)?wa(t,e):ba(t,e)}},xa=function(t,e,n){var r,o=t.dom;function i(t,n,r){(1===e.length||r)&&o.setAttrib(t,n,r)}function u(t,n,r){(1===e.length||r)&&o.setStyle(t,n,r)}ea(t)&&ya.syncAdvancedStyleFields(t,n),r=n.control.rootControl.toJSON(),t.undoManager.transact(function(){pa.each(e,function(n){var a,c;i(n,"scope",r.scope),1===e.length?i(n,"style",r.style):(a=n,c=r.style,delete a.dataset.mceStyle,a.style.cssText+=";"+c),i(n,"class",r.class),u(n,"width",qu(r.width)),u(n,"height",qu(r.height)),r.type&&n.nodeName.toLowerCase()!==r.type&&(n=o.rename(n,r.type)),1===e.length&&(va.unApplyAlign(t,n),va.unApplyVAlign(t,n)),r.align&&va.applyAlign(t,n,r.align),r.valign&&va.applyVAlign(t,n,r.valign)}),t.focus()})},Ca=function(t){var e,n,r,o=[];if(o=t.dom.select("td[data-mce-selected],th[data-mce-selected]"),e=t.dom.getParent(t.selection.getStart(),"td,th"),!o.length&&e&&o.push(e),e=e||o[0]){n=o.length>1?{width:"",height:"",scope:"",class:"",align:"",valign:"",style:"",type:e.nodeName.toLowerCase()}:function(t,e){var n=t.dom,r={width:n.getStyle(e,"width")||n.getAttrib(e,"width"),height:n.getStyle(e,"height")||n.getAttrib(e,"height"),scope:n.getAttrib(e,"scope"),class:n.getAttrib(e,"class"),type:e.nodeName.toLowerCase(),style:"",align:"",valign:""};return pa.each("left center right".split(" "),function(n){t.formatter.matchNode(e,"align"+n)&&(r.align=n)}),pa.each("top middle bottom".split(" "),function(n){t.formatter.matchNode(e,"valign"+n)&&(r.valign=n)}),ea(t)&&pa.extend(r,ya.extractAdvancedStyles(n,e)),r}(t,e),ua(t).length>0&&(r={name:"class",type:"listbox",label:"Class",values:ya.buildListItems(ua(t),function(e){e.value&&(e.textStyle=function(){return t.formatter.getCssText({block:"td",classes:[e.value]})})})});var u={type:"form",layout:"flex",direction:"column",labelGapCalc:"children",padding:0,items:[{type:"form",layout:"grid",columns:2,labelGapCalc:!1,padding:0,defaults:{type:"textbox",maxWidth:50},items:[{label:"Width",name:"width",onchange:i(ya.updateStyleField,t)},{label:"Height",name:"height",onchange:i(ya.updateStyleField,t)},{label:"Cell type",name:"type",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{label:"Scope",name:"scope",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{label:"H Align",name:"align",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"V Align",name:"valign",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}]},r]};ea(t)?t.windowManager.open({title:"Cell properties",bodyType:"tabpanel",data:n,body:[{title:"General",type:"form",items:u},ya.createStyleForm(t)],onsubmit:i(xa,t,o)}):t.windowManager.open({title:"Cell properties",data:n,body:u,onsubmit:i(xa,t,o)})}},Sa=function(t,e,n){var r=t.getParent(e,"table"),o=e.parentNode,i=t.select(n,r)[0];i||(i=t.create(n),r.firstChild?"CAPTION"===r.firstChild.nodeName?t.insertAfter(i,r.firstChild):r.insertBefore(i,r.firstChild):r.appendChild(i)),i.appendChild(e),o.hasChildNodes()||t.remove(o)};function Ra(t,e,n,r){var o=t.dom;function i(t,n,r){(1===e.length||r)&&o.setAttrib(t,n,r)}na(t)&&ya.syncAdvancedStyleFields(t,r);var u=r.control.rootControl.toJSON();t.undoManager.transact(function(){pa.each(e,function(r){var a,c,l;i(r,"scope",u.scope),i(r,"style",u.style),i(r,"class",u.class),a=r,c="height",l=qu(u.height),(1===e.length||l)&&o.setStyle(a,c,l),u.type!==r.parentNode.nodeName.toLowerCase()&&Sa(t.dom,r,u.type),u.align!==n.align&&(va.unApplyAlign(t,r),va.applyAlign(t,r,u.align))}),t.focus()})}var Ta=function(t){var e,n,r,o,u,a,c=t.dom,l=[];e=c.getParent(t.selection.getStart(),"table"),n=c.getParent(t.selection.getStart(),"td,th"),pa.each(e.rows,function(t){pa.each(t.cells,function(e){if(c.getAttrib(e,"data-mce-selected")||e===n)return l.push(t),!1})}),(r=l[0])&&(u=l.length>1?{height:"",scope:"",style:"",class:"",align:"",type:r.parentNode.nodeName.toLowerCase()}:function(t,e){var n=t.dom,r={height:n.getStyle(e,"height")||n.getAttrib(e,"height"),scope:n.getAttrib(e,"scope"),class:n.getAttrib(e,"class"),align:"",style:"",type:e.parentNode.nodeName.toLowerCase()};return pa.each("left center right".split(" "),function(n){t.formatter.matchNode(e,"align"+n)&&(r.align=n)}),na(t)&&pa.extend(r,ya.extractAdvancedStyles(n,e)),r}(t,r),aa(t).length>0&&(o={name:"class",type:"listbox",label:"Class",values:ya.buildListItems(aa(t),function(e){e.value&&(e.textStyle=function(){return t.formatter.getCssText({block:"tr",classes:[e.value]})})})}),a={type:"form",columns:2,padding:0,defaults:{type:"textbox"},items:[{type:"listbox",name:"type",label:"Row type",text:"Header",maxWidth:null,values:[{text:"Header",value:"thead"},{text:"Body",value:"tbody"},{text:"Footer",value:"tfoot"}]},{type:"listbox",name:"align",label:"Alignment",text:"None",maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height"},o]},na(t)?t.windowManager.open({title:"Row properties",data:u,bodyType:"tabpanel",body:[{title:"General",type:"form",items:a},ya.createStyleForm(t)],onsubmit:i(Ra,t,l,u)}):t.windowManager.open({title:"Row properties",data:u,body:a,onsubmit:i(Ra,t,l,u)}))},Da=tinymce.util.Tools.resolve("tinymce.Env"),ka={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},percentages:!0},Aa=function(t,e,n,r,o){void 0===o&&(o=ka);var i=it.fromTag("table");Fe(i,o.styles),ce(i,o.attributes);var u=it.fromTag("tbody");Xe(i,u);for(var a=[],c=0;c<t;c++){for(var l=it.fromTag("tr"),f=0;f<e;f++){var s=c<n||f<r?it.fromTag("th"):it.fromTag("td");f<r&&ae(s,"scope","row"),c<n&&ae(s,"scope","col"),Xe(s,it.fromTag("br")),o.percentages&&je(s,"width",100/e+"%"),Xe(l,s)}a.push(l)}return $e(u,a),i},Oa=function(t,e){t.selection.select(e.dom(),!0),t.selection.collapse(!0)},Ea=function(t,e,n){var r,o=Zu(t),u={styles:o,attributes:Qu(t),percentages:(r=o.width,b(r)&&-1!==r.indexOf("%")&&!la(t))},a=Aa(n,e,0,0,u);ae(a,"data-mce-id","__mce");var c,l,f,s=(c=a,l=it.fromTag("div"),f=it.fromDom(c.dom().cloneNode(!0)),Xe(l,f),function(t){return t.dom().innerHTML}(l));return t.insertContent(s),Re(Fu(t),'table[data-mce-id="__mce"]').map(function(e){return la(t)&&je(e,"width",He(e,"width")),se(e,"data-mce-id"),function(t,e){k(we(e,"tr"),function(e){fa(t,e.dom()),k(we(e,"th,td"),function(e){sa(t,e.dom())})})}(t,e),function(t,e){Re(e,"td,th").each(i(Oa,t))}(t,e),e.dom()}).getOr(null)};function Na(t,e,n,r){if("TD"===e.tagName||"TH"===e.tagName)t.setStyle(e,n,r);else if(e.children)for(var o=0;o<e.children.length;o++)Na(t,e.children[o],n,r)}var Pa=function(t,e,n){var r,o,i=t.dom;ra(t)&&ya.syncAdvancedStyleFields(t,n),!1===(o=n.control.rootControl.toJSON()).class&&delete o.class,t.undoManager.transact(function(){e||(e=Ea(t,o.cols||1,o.rows||1)),function(t,e,n){var r,o=t.dom,i={},u={};if(i.class=n.class,u.height=qu(n.height),o.getAttrib(e,"width")&&!ia(t)?i.width=(r=n.width)?r.replace(/px$/,""):"":u.width=qu(n.width),ia(t)?(u["border-width"]=qu(n.border),u["border-spacing"]=qu(n.cellspacing),pa.extend(i,{"data-mce-border-color":n.borderColor,"data-mce-cell-padding":n.cellpadding,"data-mce-border":n.border})):pa.extend(i,{border:n.border,cellpadding:n.cellpadding,cellspacing:n.cellspacing}),ia(t)&&e.children)for(var a=0;a<e.children.length;a++)Na(o,e.children[a],{"border-width":qu(n.border),"border-color":n.borderColor,padding:qu(n.cellpadding)});n.style?pa.extend(u,o.parseStyle(n.style)):u=pa.extend({},o.parseStyle(o.getAttrib(e,"style")),u),i.style=o.serializeStyle(u),o.setAttribs(e,i)}(t,e,o),(r=i.select("caption",e)[0])&&!o.caption&&i.remove(r),!r&&o.caption&&((r=i.create("caption")).innerHTML=Da.ie?"Â ":'<br data-mce-bogus="1"/>',e.insertBefore(r,e.firstChild)),va.unApplyAlign(t,e),o.align&&va.applyAlign(t,e,o.align),t.focus(),t.addVisual()})},Ia=function(t,e){var n,r,o,u,a,c=t.dom,l={};!0===e?(n=c.getParent(t.selection.getStart(),"table"))&&(l=function(t,e){var n=t.dom,r={width:n.getStyle(e,"width")||n.getAttrib(e,"width"),height:n.getStyle(e,"height")||n.getAttrib(e,"height"),cellspacing:n.getStyle(e,"border-spacing")||n.getAttrib(e,"cellspacing"),cellpadding:n.getAttrib(e,"data-mce-cell-padding")||n.getAttrib(e,"cellpadding")||va.getTDTHOverallStyle(t.dom,e,"padding"),border:n.getAttrib(e,"data-mce-border")||n.getAttrib(e,"border")||va.getTDTHOverallStyle(t.dom,e,"border"),borderColor:n.getAttrib(e,"data-mce-border-color"),caption:!!n.select("caption",e)[0],class:n.getAttrib(e,"class")};return pa.each("left center right".split(" "),function(n){t.formatter.matchNode(e,"align"+n)&&(r.align=n)}),ra(t)&&pa.extend(r,ya.extractAdvancedStyles(n,e)),r}(t,n)):(r={label:"Cols",name:"cols"},o={label:"Rows",name:"rows"}),ca(t).length>0&&(l.class&&(l.class=l.class.replace(/\s*mce\-item\-table\s*/g,"")),u={name:"class",type:"listbox",label:"Class",values:ya.buildListItems(ca(t),function(e){e.value&&(e.textStyle=function(){return t.formatter.getCssText({block:"table",classes:[e.value]})})})}),a={type:"form",layout:"flex",direction:"column",labelGapCalc:"children",padding:0,items:[{type:"form",labelGapCalc:!1,padding:0,layout:"grid",columns:2,defaults:{type:"textbox",maxWidth:50},items:oa(t)?[r,o,{label:"Width",name:"width",onchange:i(ya.updateStyleField,t)},{label:"Height",name:"height",onchange:i(ya.updateStyleField,t)},{label:"Cell spacing",name:"cellspacing"},{label:"Cell padding",name:"cellpadding"},{label:"Border",name:"border"},{label:"Caption",name:"caption",type:"checkbox"}]:[r,o,{label:"Width",name:"width",onchange:i(ya.updateStyleField,t)},{label:"Height",name:"height",onchange:i(ya.updateStyleField,t)}]},{label:"Alignment",name:"align",type:"listbox",text:"None",values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},u]},ra(t)?t.windowManager.open({title:"Table properties",data:l,bodyType:"tabpanel",body:[{title:"General",type:"form",items:a},ya.createStyleForm(t)],onsubmit:i(Pa,t,n)}):t.windowManager.open({title:"Table properties",data:l,body:a,onsubmit:i(Pa,t,n)})},Ba=pa.each,Wa={registerCommands:function(t,n,r,o,u){var c=Uu(t),l=function(){return it.fromDom(t.dom.getParent(t.selection.getStart(),"th,td"))},f=function(t){return Ne.table(t,c)},s=function(t){return{width:Hu(t.dom()),height:Hu(t.dom())}},d=function(e){var n=l();f(n).each(function(i){var u=Tr.forMenu(o,i,n),a=s(i);e(i,u).each(function(e){!function(t,e,n){var r=s(n);e.width===r.width&&e.height===r.height||(da(t,n.dom(),e.width,e.height),ma(t,n.dom(),r.width,r.height))}(t,a,i),t.selection.setRng(e),t.focus(),r.clear(i),Vu(i)})})},m=function(n){var r=l();return f(r).bind(function(n){var i=it.fromDom(t.getDoc()),u=Tr.forMenu(o,n,r),a=Rn(e,i,p.none());return ha(n,u,a)})},g=function(e){u.get().each(function(n){var i=D(n,function(t){return cn(t)}),u=l();f(u).bind(function(n){var a=it.fromDom(t.getDoc()),c=Tn(a),l=Tr.pasteRows(o,n,u,i,c);e(n,l).each(function(e){t.selection.setRng(e),t.focus(),r.clear(n)})})})};Ba({mceTableSplitCells:function(){d(n.unmergeCells)},mceTableMergeCells:function(){d(n.mergeCells)},mceTableInsertRowBefore:function(){d(n.insertRowsBefore)},mceTableInsertRowAfter:function(){d(n.insertRowsAfter)},mceTableInsertColBefore:function(){d(n.insertColumnsBefore)},mceTableInsertColAfter:function(){d(n.insertColumnsAfter)},mceTableDeleteCol:function(){d(n.deleteColumn)},mceTableDeleteRow:function(){d(n.deleteRow)},mceTableCutRow:function(t){u.set(m()),d(n.deleteRow)},mceTableCopyRow:function(t){u.set(m())},mceTablePasteRowBefore:function(t){g(n.pasteRowsBefore)},mceTablePasteRowAfter:function(t){g(n.pasteRowsAfter)},mceTableDelete:function(){var e=it.fromDom(t.dom.getParent(t.selection.getStart(),"th,td"));Ne.table(e,c).filter(a(c)).each(function(e){var n=it.fromText("");Ge(e,n),Ze(e);var r=t.dom.createRng();r.setStart(n.dom(),0),r.setEnd(n.dom(),0),t.selection.setRng(r)})}},function(e,n){t.addCommand(n,e)}),Ba({mceInsertTable:i(Ia,t),mceTableProps:i(Ia,t,!0),mceTableRowProps:i(Ta,t),mceTableCellProps:i(Ca,t)},function(e,n){t.addCommand(n,function(t,n){e(n)})})}},Ma=function(t){var e=p.from(t.dom().documentElement).map(it.fromDom).getOr(t);return{parent:r(e),view:r(t),origin:r(Kr(0,0))}},_a=function(t,e){return{parent:r(e),view:r(t),origin:r(Kr(0,0))}};function La(t){var e=q.apply(null,t),n=[];return{bind:function(t){if(void 0===t)throw"Event bind error: undefined handler";n.push(t)},unbind:function(t){n=A(n,function(e){return e!==t})},trigger:function(){var t=e.apply(null,arguments);k(n,function(e){e(t)})}}}var ja={create:function(t){return{registry:z(t,function(t){return{bind:t.bind,unbind:t.unbind}}),trigger:z(t,function(t){return t.trigger})}}},Fa={mode:bo(["compare","extract","mutate","sink"]),sink:bo(["element","start","stop","destroy"]),api:bo(["forceDrop","drop","move","delayDrop"])},Ha={resolve:ri("ephox-dragster").resolve},za=function(t,e){return function(o){if(t(o)){var i=it.fromDom(o.target),u=function(){o.stopPropagation()},a=function(){o.preventDefault()},c=n(a,u),l=function(t,e,n,o,i,u,a){return{target:r(t),x:r(e),y:r(n),stop:o,prevent:i,kill:u,raw:r(a)}}(i,o.clientX,o.clientY,u,a,c,o);e(l)}}},Ua=function(t,e,n,r){return function(t,e,n,r,o){var u=za(n,r);return t.dom().addEventListener(e,u,o),{unbind:i(qa,t,e,u,o)}}(t,e,n,r,!1)},qa=function(t,e,n,r){t.dom().removeEventListener(e,n,r)},Va=r(!0),Ga=function(t,e,n){return Ua(t,e,Va,n)},Ya=Fa.mode({compare:function(t,e){return Kr(e.left()-t.left(),e.top()-t.top())},extract:function(t){return p.some(Kr(t.x(),t.y()))},sink:function(t,e){var n=function(t){var e=Mo({layerClass:Ha.resolve("blocker")},t),n=it.fromTag("div");return ae(n,"role","presentation"),Fe(n,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),fi(n,Ha.resolve("blocker")),fi(n,e.layerClass),{element:function(){return n},destroy:function(){Ze(n)}}}(e),r=Ga(n.element(),"mousedown",t.forceDrop),o=Ga(n.element(),"mouseup",t.drop),i=Ga(n.element(),"mousemove",t.move),u=Ga(n.element(),"mouseout",t.delayDrop);return Fa.sink({element:n.element,start:function(t){Xe(t,n.element())},stop:function(){Ze(n.element())},destroy:function(){n.destroy(),o.unbind(),i.unbind(),u.unbind(),r.unbind()}})},mutate:function(t,e){t.mutate(e.left(),e.top())}});function Xa(){var t=p.none(),e=ja.create({move:La(["info"])});return{onEvent:function(n,r){r.extract(n).each(function(n){(function(e,n){var r=t.map(function(t){return e.compare(t,n)});return t=p.some(n),r})(r,n).each(function(t){e.trigger.move(t)})})},reset:function(){t=p.none()},events:e.registry}}function Ka(){var t={onEvent:function(t,e){},reset:e},n=Xa(),r=t;return{on:function(){r.reset(),r=n},off:function(){r.reset(),r=t},isOn:function(){return r===n},onEvent:function(t,e){r.onEvent(t,e)},events:n.events}}var Ja=function(t,e,n){var r,o,i,u=!1,a=ja.create({start:La([]),stop:La([])}),c=Ka(),l=function(){d.stop(),c.isOn()&&(c.off(),a.trigger.stop())},f=(r=l,o=200,i=null,{cancel:function(){null!==i&&(clearTimeout(i),i=null)},throttle:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];null!==i&&clearTimeout(i),i=setTimeout(function(){r.apply(null,t),i=null},o)}});c.events.move.bind(function(n){e.mutate(t,n.info())});var s=function(t){return function(){var e=Array.prototype.slice.call(arguments,0);if(u)return t.apply(null,e)}},d=e.sink(Fa.api({forceDrop:l,drop:s(l),move:s(function(t,n){f.cancel(),c.onEvent(t,e)}),delayDrop:s(f.throttle)}),n);return{element:d.element,go:function(t){d.start(t),c.on(),a.trigger.start()},on:function(){u=!0},off:function(){u=!1},destroy:function(){d.destroy()},events:a.registry}},$a={transform:function(t,e){var n=void 0!==e?e:{},r=void 0!==n.mode?n.mode:Ya;return Ja(t,r,e)}};function Qa(){var t=ja.create({drag:La(["xDelta","yDelta","target"])}),e=p.none(),n=function(){var t=ja.create({drag:La(["xDelta","yDelta"])});return{mutate:function(e,n){t.trigger.drag(e,n)},events:t.registry}}();return n.events.drag.bind(function(n){e.each(function(e){t.trigger.drag(n.xDelta(),n.yDelta(),e)})}),{assign:function(t){e=p.some(t)},get:function(){return e},mutate:n.mutate,events:t.registry}}var Za=function(t,e,n){return Te(t,e,n).isSome()},tc=ii.resolve("resizer-bar-dragging");function ec(t,e){var n=lo.height,r=function(t,e,n){var r=Qa(),o=$a.transform(r,{}),u=p.none(),a=function(t,e){return p.from(le(t,e))};r.events.drag.bind(function(t){a(t.target(),"data-row").each(function(e){var n=du.getInt(t.target(),"top");je(t.target(),"top",n+t.yDelta()+"px")}),a(t.target(),"data-column").each(function(e){var n=du.getInt(t.target(),"left");je(t.target(),"left",n+t.xDelta()+"px")})});var c=function(t,e){return du.getInt(t,e)-parseInt(le(t,"data-initial-"+e),10)};o.events.stop.bind(function(){r.get().each(function(r){u.each(function(o){a(r,"data-row").each(function(t){var e=c(r,"top");se(r,"data-initial-top"),m.trigger.adjustHeight(o,e,parseInt(t,10))}),a(r,"data-column").each(function(t){var e=c(r,"left");se(r,"data-initial-left"),m.trigger.adjustWidth(o,e,parseInt(t,10))}),yi.refresh(t,o,n,e)})})});var l=function(e,n){m.trigger.startAdjust(),r.assign(e),ae(e,"data-initial-"+n,parseInt(He(e,n),10)),fi(e,tc),je(e,"opacity","0.2"),o.go(t.parent())},f=Ga(t.parent(),"mousedown",function(t){yi.isRowBar(t.target())&&l(t.target(),"top"),yi.isColBar(t.target())&&l(t.target(),"left")}),s=function(e){return Ht(e,t.view())},d=Ga(t.view(),"mouseover",function(r){"table"===Zt(r.target())||Za(r.target(),"table",s)?(u="table"===Zt(r.target())?p.some(r.target()):Ce(r.target(),"table",s)).each(function(r){yi.refresh(t,r,n,e)}):me(r.target())&&yi.destroy(t)}),m=ja.create({adjustHeight:La(["table","delta","row"]),adjustWidth:La(["table","delta","column"]),startAdjust:La([])});return{destroy:function(){f.unbind(),d.unbind(),o.destroy(),yi.destroy(t)},refresh:function(r){yi.refresh(t,r,n,e)},on:o.on,off:o.off,hideBars:i(yi.hide,t),showBars:i(yi.show,t),events:m.registry}}(t,e,n),o=ja.create({beforeResize:La(["table"]),afterResize:La(["table"]),startDrag:La([])});return r.events.adjustHeight.bind(function(t){o.trigger.beforeResize(t.table());var e=n.delta(t.delta(),t.table());Ou.adjustHeight(t.table(),e,t.row(),n),o.trigger.afterResize(t.table())}),r.events.startAdjust.bind(function(t){o.trigger.startDrag()}),r.events.adjustWidth.bind(function(t){o.trigger.beforeResize(t.table());var n=e.delta(t.delta(),t.table());Ou.adjustWidth(t.table(),n,t.column(),e),o.trigger.afterResize(t.table())}),{on:r.on,off:r.off,hideBars:r.hideBars,showBars:r.showBars,destroy:r.destroy,events:o.registry}}var nc=function(t,e){return t.inline?_a(Fu(t),function(){var t=it.fromTag("div");return Fe(t,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),Xe(ge(),t),t}()):Ma(it.fromDom(t.getDoc()))},rc=function(t,e){t.inline&&Ze(e.parent())},oc=function(t){var e,n,r=p.none(),o=p.none(),i=p.none(),u=/(\d+(\.\d+)?)%/,a=function(t){return"TABLE"===t.nodeName};return t.on("init",function(){var e=so(Xu.directionAt),n=nc(t);if(i=p.some(n),function(t){var e=t.getParam("object_resizing",!0);return"table"===e||e}(t)&&function(t){return t.getParam("table_resize_bars",!0,"boolean")}(t)){var u=ec(n,e);u.on(),u.events.startDrag.bind(function(e){r=p.some(t.selection.getRng())}),u.events.beforeResize.bind(function(e){var n=e.table().dom();da(t,n,Hu(n),zu(n))}),u.events.afterResize.bind(function(e){var n=e.table(),o=n.dom();Vu(n),r.each(function(e){t.selection.setRng(e),t.focus()}),ma(t,o,Hu(o),zu(o)),t.undoManager.add()}),o=p.some(u)}}),t.on("ObjectResizeStart",function(r){var o,i=r.target;a(i)&&(e=r.width,o=i,n=t.dom.getStyle(o,"width")||t.dom.getAttrib(o,"width"))}),t.on("ObjectResized",function(r){var o=r.target;if(a(o)){var i=o;if(u.test(n)){var c=parseFloat(u.exec(n)[1]),l=r.width*c/e;t.dom.setStyle(i,"width",l+"%")}else{var f=[];pa.each(i.rows,function(e){pa.each(e.cells,function(e){var n=t.dom.getStyle(e,"width",!0);f.push({cell:e,width:n})})}),pa.each(f,function(e){t.dom.setStyle(e.cell,"width",e.width),t.dom.setAttrib(e.cell,"width",null)})}}}),{lazyResize:function(){return o},lazyWire:function(){return i.getOr(Ma(it.fromDom(t.getBody())))},destroy:function(){o.each(function(t){t.destroy()}),i.each(function(e){rc(t,e)})}}},ic=function(t){return{fold:t}},uc=function(t){return ic(function(e,n,r,o){return e(t)})},ac=function(t){return ic(function(e,n,r,o){return n(t)})},cc=function(t,e){return ic(function(n,r,o,i){return o(t,e)})},lc=function(t){return ic(function(e,n,r,o){return o(t)})},fc=function(t,e){return Ne.table(t,e).bind(function(e){var n=Ne.cells(e);return P(n,function(e){return Ht(t,e)}).map(function(t){return{index:r(t),all:r(n)}})})},sc=function(t,e){return fc(t,e).fold(function(){return uc(t)},function(e){return e.index()+1<e.all().length?cc(t,e.all()[e.index()+1]):lc(t)})},dc=function(t,e){return fc(t,e).fold(function(){return uc()},function(e){return e.index()-1>=0?cc(t,e.all()[e.index()-1]):ac(t)})},mc=pr([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),gc={before:mc.before,on:mc.on,after:mc.after,cata:function(t,e,n,r){return t.fold(e,n,r)},getStart:function(t){return t.fold(o,o,o)}},hc=pr([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),pc=q("start","soffset","finish","foffset"),vc=function(t){return function(t){var e=t.dom().ownerDocument.defaultView;return it.fromDom(e)}(function(t){return t.match({domRange:function(t){return it.fromDom(t.startContainer)},relative:function(t,e){return gc.getStart(t)},exact:function(t,e,n,r){return t}})}(t))},bc=(hc.domRange,hc.relative),wc=hc.exact,yc=function(t,e,n,r){var o=function(t,e,n,r){var o=qt(t).dom().createRange();return o.setStart(t.dom(),e),o.setEnd(n.dom(),r),o}(t,e,n,r),i=Ht(t,n)&&e===r;return o.collapsed&&!i},xc=function(t,e){t.selectNodeContents(e.dom())},Cc=function(t,e,n){var r,o=t.document.createRange();return r=o,e.fold(function(t){r.setStartBefore(t.dom())},function(t,e){r.setStart(t.dom(),e)},function(t){r.setStartAfter(t.dom())}),function(t,e){e.fold(function(e){t.setEndBefore(e.dom())},function(e,n){t.setEnd(e.dom(),n)},function(e){t.setEndAfter(e.dom())})}(o,n),o},Sc=function(t,e,n,r,o){var i=t.document.createRange();return i.setStart(e.dom(),n),i.setEnd(r.dom(),o),i},Rc=function(t){return{left:r(t.left),top:r(t.top),right:r(t.right),bottom:r(t.bottom),width:r(t.width),height:r(t.height)}},Tc=pr([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Dc=function(t,e,n){return e(it.fromDom(n.startContainer),n.startOffset,it.fromDom(n.endContainer),n.endOffset)},kc=function(t,e){return function(t,e){var n=e.ltr();return n.collapsed?e.rtl().filter(function(t){return!1===t.collapsed}).map(function(t){return Tc.rtl(it.fromDom(t.endContainer),t.endOffset,it.fromDom(t.startContainer),t.startOffset)}).getOrThunk(function(){return Dc(0,Tc.ltr,n)}):Dc(0,Tc.ltr,n)}(0,function(t,e){return e.match({domRange:function(t){return{ltr:r(t),rtl:p.none}},relative:function(e,n){return{ltr:yt(function(){return Cc(t,e,n)}),rtl:yt(function(){return p.some(Cc(t,n,e))})}},exact:function(e,n,r,o){return{ltr:yt(function(){return Sc(t,e,n,r,o)}),rtl:yt(function(){return p.some(Sc(t,r,o,e,n))})}}})}(t,e))},Ac=function(t,e){return kc(t,e).match({ltr:function(e,n,r,o){var i=t.document.createRange();return i.setStart(e.dom(),n),i.setEnd(r.dom(),o),i},rtl:function(e,n,r,o){var i=t.document.createRange();return i.setStart(r.dom(),o),i.setEnd(e.dom(),n),i}})},Oc=(Tc.ltr,Tc.rtl,function(t,e,n){return e>=t.left&&e<=t.right&&n>=t.top&&n<=t.bottom}),Ec=function(t,e,n,r,o){var i=function(n){var r=t.dom().createRange();return r.setStart(e.dom(),n),r.collapse(!0),r},u=sn(e).length,a=function(t,e,n,r,o){if(0===o)return 0;if(e===r)return o-1;for(var i=r,u=1;u<o;u++){var a=t(u),c=Math.abs(e-a.left);if(n<=a.bottom){if(n<a.top||c>i)return u-1;i=c}}return 0}(function(t){return i(t).getBoundingClientRect()},n,r,o.right,u);return i(a)},Nc=function(t,e,n,r){var o=t.dom().createRange();o.selectNode(e.dom());var i=o.getClientRects();return Lo(i,function(t){return Oc(t,n,r)?p.some(t):p.none()}).map(function(o){return Ec(t,e,n,r,o)})},Pc=function(t,e,n,r){var o=t.dom().createRange(),i=Kt(e);return Lo(i,function(e){return o.selectNode(e.dom()),Oc(o.getBoundingClientRect(),n,r)?Ic(t,e,n,r):p.none()})},Ic=function(t,e,n,r){return(oe(e)?Nc:Pc)(t,e,n,r)},Bc=function(t,e){return e-t.left<t.right-e},Wc=function(t,e,n){var r=t.dom().createRange();return r.selectNode(e.dom()),r.collapse(n),r},Mc=function(t,e,n){var r=t.dom().createRange();r.selectNode(e.dom());var o=r.getBoundingClientRect(),i=Bc(o,n);return(!0===i?vn:bn)(e).map(function(e){return Wc(t,e,i)})},_c=function(t,e,n){var r=e.dom().getBoundingClientRect(),o=Bc(r,n);return p.some(Wc(t,e,o))},Lc=function(t,e,n,r){var o=t.dom().createRange();o.selectNode(e.dom());var i=o.getBoundingClientRect();return function(t,e,n,r){var o=t.dom().createRange();o.selectNode(e.dom());var i=o.getBoundingClientRect(),u=Math.max(i.left,Math.min(i.right,n)),a=Math.max(i.top,Math.min(i.bottom,r));return Ic(t,e,u,a)}(t,e,Math.max(i.left,Math.min(i.right,n)),Math.max(i.top,Math.min(i.bottom,r)))},jc=document.caretPositionFromPoint?function(t,e,n){return p.from(t.dom().caretPositionFromPoint(e,n)).bind(function(e){if(null===e.offsetNode)return p.none();var n=t.dom().createRange();return n.setStart(e.offsetNode,e.offset),n.collapse(),p.some(n)})}:document.caretRangeFromPoint?function(t,e,n){return p.from(t.dom().caretRangeFromPoint(e,n))}:function(t,e,n){return it.fromPoint(t,e,n).bind(function(r){var o=function(){return function(t,e,n){return(0===Kt(e).length?_c:Mc)(t,e,n)}(t,r,e)};return 0===Kt(r).length?o():Lc(t,r,e,n).orThunk(o)})},Fc=function(t,e){var n=Zt(t);return"input"===n?gc.after(t):R(["br","img"],n)?0===e?gc.before(t):gc.after(t):gc.on(t,e)},Hc=function(t,e){var n=t.fold(gc.before,Fc,gc.after),r=e.fold(gc.before,Fc,gc.after);return bc(n,r)},zc=function(t,e,n,r){var o=Fc(t,e),i=Fc(n,r);return bc(o,i)},Uc=function(t,e){p.from(t.getSelection()).each(function(t){t.removeAllRanges(),t.addRange(e)})},qc=function(t,e,n,r,o){var i=Sc(t,e,n,r,o);Uc(t,i)},Vc=function(t,e){return kc(t,e).match({ltr:function(e,n,r,o){qc(t,e,n,r,o)},rtl:function(e,n,r,o){var i=t.getSelection();if(i.setBaseAndExtent)i.setBaseAndExtent(e.dom(),n,r.dom(),o);else if(i.extend)try{!function(t,e,n,r,o,i){e.collapse(n.dom(),r),e.extend(o.dom(),i)}(0,i,e,n,r,o)}catch(i){qc(t,r,o,e,n)}else qc(t,r,o,e,n)}})},Gc=function(t,e,n,r,o){var i=zc(e,n,r,o);Vc(t,i)},Yc=function(t,e,n){var r=Hc(e,n);Vc(t,r)},Xc=function(t){var e=vc(t).dom(),n=function(t,n,r,o){return Sc(e,t,n,r,o)},r=function(t){return t.match({domRange:function(t){var e=it.fromDom(t.startContainer),n=it.fromDom(t.endContainer);return zc(e,t.startOffset,n,t.endOffset)},relative:Hc,exact:zc})}(t);return kc(e,r).match({ltr:n,rtl:n})},Kc=function(t){var e=it.fromDom(t.anchorNode),n=it.fromDom(t.focusNode);return yc(e,t.anchorOffset,n,t.focusOffset)?p.some(pc(it.fromDom(t.anchorNode),t.anchorOffset,it.fromDom(t.focusNode),t.focusOffset)):function(t){if(t.rangeCount>0){var e=t.getRangeAt(0),n=t.getRangeAt(t.rangeCount-1);return p.some(pc(it.fromDom(e.startContainer),e.startOffset,it.fromDom(n.endContainer),n.endOffset))}return p.none()}(t)},Jc=function(t,e){var n=function(t,e){var n=t.document.createRange();return xc(n,e),n}(t,e);Uc(t,n)},$c=function(t){return function(t){return p.from(t.getSelection()).filter(function(t){return t.rangeCount>0}).bind(Kc)}(t).map(function(t){return wc(t.start(),t.soffset(),t.finish(),t.foffset())})},Qc=function(t,e){return function(t){var e=t.getClientRects(),n=e.length>0?e[0]:t.getBoundingClientRect();return n.width>0||n.height>0?p.some(n).map(Rc):p.none()}(Ac(t,e))},Zc=function(t,e,n){return function(t,e,n){var r=it.fromDom(t.document);return jc(r,e,n).map(function(t){return pc(it.fromDom(t.startContainer),t.startOffset,it.fromDom(t.endContainer),t.endOffset)})}(t,e,n)},tl=function(t){t.getSelection().removeAllRanges()},el=tinymce.util.Tools.resolve("tinymce.util.VK"),nl=function(t,e,n,r){return ul(t,e,sc(n),r)},rl=function(t,e,n,r){return ul(t,e,dc(n),r)},ol=function(t,e){var n=wc(e,0,e,0);return Xc(n)},il=function(t,e){var n,r=we(e,"tr");return(n=r,0===n.length?p.none():p.some(n[n.length-1])).bind(function(t){return Re(t,"td,th").map(function(t){return ol(0,t)})})},ul=function(t,e,n,r,o){return n.fold(p.none,p.none,function(t,e){return vn(e).map(function(t){return ol(0,t)})},function(n){return Ne.table(n,e).bind(function(e){var o=Tr.noMenu(n);return t.undoManager.transact(function(){r.insertRowsAfter(e,o)}),il(0,e)})})},al=["table","li","dl"],cl={handle:function(t,e,n,r){if(t.keyCode===el.TAB){var o=Fu(e),i=function(t){var e=Zt(t);return Ht(t,o)||R(al,e)},u=e.selection.getRng();if(u.collapsed){var a=it.fromDom(u.startContainer);Ne.cell(a,i).each(function(o){t.preventDefault(),(t.shiftKey?rl:nl)(e,i,o,n,r).each(function(t){e.selection.setRng(t)})})}}}},ll={response:q("selection","kill")},fl=function(t){return function(e){return e===t}},sl=fl(38),dl=fl(40),ml={ltr:{isBackward:fl(37),isForward:fl(39)},rtl:{isBackward:fl(39),isForward:fl(37)},isUp:sl,isDown:dl,isNavigation:function(t){return t>=37&&t<=40}},gl={convertToRange:function(t,e){var n=Ac(t,e);return{start:r(it.fromDom(n.startContainer)),soffset:r(n.startOffset),finish:r(it.fromDom(n.endContainer)),foffset:r(n.endOffset)}},makeSitus:function(t,e,n,o){return{start:r(gc.on(t,e)),finish:r(gc.on(n,o))}}},hl=(Ft.detect().browser.isSafari(),function(t){var e=void 0!==t?t.dom():document,n=e.body.scrollLeft||e.documentElement.scrollLeft,r=e.body.scrollTop||e.documentElement.scrollTop;return Kr(n,r)}),pl=function(t,e,n){(void 0!==n?n.dom():document).defaultView.scrollBy(t,e)};function vl(t){return{elementFromPoint:function(e,n){return it.fromPoint(it.fromDom(t.document),e,n)},getRect:function(t){return t.dom().getBoundingClientRect()},getRangedRect:function(e,n,r,o){var i=wc(e,n,r,o);return Qc(t,i).map(function(t){return z(t,c)})},getSelection:function(){return $c(t).map(function(e){return gl.convertToRange(t,e)})},fromSitus:function(e){var n=bc(e.start(),e.finish());return gl.convertToRange(t,n)},situsFromPoint:function(e,n){return Zc(t,e,n).map(function(t){return{start:r(gc.on(t.start(),t.soffset())),finish:r(gc.on(t.finish(),t.foffset()))}})},clearSelection:function(){tl(t)},setSelection:function(e){Gc(t,e.start(),e.soffset(),e.finish(),e.foffset())},setRelativeSelection:function(e,n){Yc(t,e,n)},selectContents:function(e){Jc(t,e)},getInnerHeight:function(){return t.innerHeight},getScrollY:function(){return hl(it.fromDom(t.document)).top()},scrollBy:function(e,n){pl(e,n,it.fromDom(t.document))}}}var bl=function(t,e,n,r,o){return Ht(n,r)?p.none():sr.identify(n,r,e).bind(function(e){var r=e.boxes().getOr([]);return r.length>0?(o(t,r,e.start(),e.finish()),p.some(ll.response(p.some(gl.makeSitus(n,0,n,gn(n))),!0))):p.none()})},wl={sync:function(t,e,n,r,o,i,u){return Ht(n,o)&&r===i?p.none():Te(n,"td,th",e).bind(function(n){return Te(o,"td,th",e).bind(function(r){return bl(t,e,n,r,u)})})},detect:bl,update:function(t,e,n,r,o){return sr.shiftSelection(r,t,e,o.firstSelectedSelector(),o.lastSelectedSelector()).map(function(t){return o.clear(n),o.selectRange(n,t.boxes(),t.start(),t.finish()),t.boxes()})}},yl=J(["left","top","right","bottom"],[]),xl={nu:yl,moveUp:function(t,e){return yl({left:t.left(),top:t.top()-e,right:t.right(),bottom:t.bottom()-e})},moveDown:function(t,e){return yl({left:t.left(),top:t.top()+e,right:t.right(),bottom:t.bottom()+e})},moveBottomTo:function(t,e){var n=t.bottom()-t.top();return yl({left:t.left(),top:e-n,right:t.right(),bottom:e})},moveTopTo:function(t,e){var n=t.bottom()-t.top();return yl({left:t.left(),top:e,right:t.right(),bottom:e+n})},getTop:function(t){return t.top()},getBottom:function(t){return t.bottom()},translate:function(t,e,n){return yl({left:t.left()+e,top:t.top()+n,right:t.right()+e,bottom:t.bottom()+n})},toString:function(t){return"("+t.left()+", "+t.top()+") -> ("+t.right()+", "+t.bottom()+")"}},Cl=function(t){return xl.nu({left:t.left,top:t.top,right:t.right,bottom:t.bottom})},Sl=function(t,e){return p.some(t.getRect(e))},Rl=function(t,e,n){return re(e)?Sl(t,e).map(Cl):oe(e)?function(t,e,n){return n>=0&&n<gn(e)?t.getRangedRect(e,n,e,n+1):n>0?t.getRangedRect(e,n-1,e,n):p.none()}(t,e,n).map(Cl):p.none()},Tl=function(t,e){return re(e)?Sl(t,e).map(Cl):oe(e)?t.getRangedRect(e,0,e,gn(e)).map(Cl):p.none()},Dl=q("item","mode"),kl=function(t,e,n,r){var o=void 0!==r?r:Al;return t.property().parent(e).map(function(t){return Dl(t,o)})},Al=function(t,e,n,r){var o=void 0!==r?r:Ol;return n.sibling(t,e).map(function(t){return Dl(t,o)})},Ol=function(t,e,n,r){var o=void 0!==r?r:Ol,i=t.property().children(e);return n.first(i).map(function(t){return Dl(t,o)})},El=[{current:kl,next:Al,fallback:p.none()},{current:Al,next:Ol,fallback:p.some(kl)},{current:Ol,next:Ol,fallback:p.some(Al)}],Nl=function(t,e,n,r,o){return N(o=void 0!==o?o:El,function(t){return t.current===n}).bind(function(n){return n.current(t,e,r,n.next).orThunk(function(){return n.fallback.bind(function(n){return Nl(t,e,n,r)})})})},Pl={backtrack:kl,sidestep:Al,advance:Ol,go:Nl},Il={left:function(){return{sibling:function(t,e){return t.query().prevSibling(e)},first:function(t){return t.length>0?p.some(t[t.length-1]):p.none()}}},right:function(){return{sibling:function(t,e){return t.query().nextSibling(e)},first:function(t){return t.length>0?p.some(t[0]):p.none()}}}},Bl=function(t,e,n,r,o,i){return Pl.go(t,e,r,o).bind(function(e){return i(e.item())?p.none():n(e.item())?p.some(e.item()):Bl(t,e.item(),n,e.mode(),o,i)})},Wl=function(t,e,n,r){return Bl(t,e,n,Pl.sidestep,Il.left(),r)},Ml=function(t,e,n,r){return Bl(t,e,n,Pl.sidestep,Il.right(),r)},_l=function(t,e){return 0===t.property().children(e).length},Ll=function(t,e,n,r){return Wl(t,e,n,r)},jl=function(t,e,n,r){return Ml(t,e,n,r)},Fl={before:function(t,e,n){return Ll(t,e,i(_l,t),n)},after:function(t,e,n){return jl(t,e,i(_l,t),n)},seekLeft:Ll,seekRight:jl,walkers:function(){return{left:Il.left,right:Il.right}},walk:function(t,e,n,r,o){return Pl.go(t,e,n,r,o)},backtrack:Pl.backtrack,sidestep:Pl.sidestep,advance:Pl.advance},Hl=kn(),zl={gather:function(t,e,n){return Fl.gather(Hl,t,e,n)},before:function(t,e){return Fl.before(Hl,t,e)},after:function(t,e){return Fl.after(Hl,t,e)},seekLeft:function(t,e,n){return Fl.seekLeft(Hl,t,e,n)},seekRight:function(t,e,n){return Fl.seekRight(Hl,t,e,n)},walkers:function(){return Fl.walkers()},walk:function(t,e,n,r){return Fl.walk(Hl,t,e,n,r)}},Ul=pr([{none:[]},{retry:["caret"]}]),ql=function(t,e,n){return(o=e,i=No,ye(function(t){return i(t)},xe,o,i,u)).fold(r(!1),function(e){return Tl(t,e).exists(function(t){return function(t,e){return t.left()<e.left()||Math.abs(e.right()-t.left())<1||t.left()>e.right()}(n,t)})});var o,i,u},Vl={point:xl.getTop,adjuster:function(t,e,n,r,o){var i=xl.moveUp(o,5);return Math.abs(n.top()-r.top())<1?Ul.retry(i):n.bottom()<o.top()?Ul.retry(i):n.bottom()===o.top()?Ul.retry(xl.moveUp(o,1)):ql(t,e,o)?Ul.retry(xl.translate(i,5,0)):Ul.none()},move:xl.moveUp,gather:zl.before},Gl={point:xl.getBottom,adjuster:function(t,e,n,r,o){var i=xl.moveDown(o,5);return Math.abs(n.bottom()-r.bottom())<1?Ul.retry(i):n.top()>o.bottom()?Ul.retry(i):n.top()===o.bottom()?Ul.retry(xl.moveDown(o,1)):ql(t,e,o)?Ul.retry(xl.translate(i,5,0)):Ul.none()},move:xl.moveDown,gather:zl.after},Yl=function(t,e,n,r,o){return 0===o?p.some(r):function(t,e,n){return t.elementFromPoint(e,n).filter(function(t){return"table"===Zt(t)}).isSome()}(t,r.left(),e.point(r))?function(t,e,n,r,o){return Yl(t,e,n,e.move(r,5),o)}(t,e,n,r,o-1):t.situsFromPoint(r.left(),e.point(r)).bind(function(i){return i.start().fold(p.none,function(i,u){return Tl(t,i,u).bind(function(u){return e.adjuster(t,i,u,n,r).fold(p.none,function(r){return Yl(t,e,n,r,o-1)})}).orThunk(function(){return p.some(r)})},p.none)})},Xl=function(t,e,n){var r=t.move(n,5),o=Yl(e,t,n,r,100).getOr(r);return function(t,e,n){return t.point(e)>n.getInnerHeight()?p.some(t.point(e)-n.getInnerHeight()):t.point(e)<0?p.some(-t.point(e)):p.none()}(t,o,e).fold(function(){return e.situsFromPoint(o.left(),t.point(o))},function(n){return e.scrollBy(0,n),e.situsFromPoint(o.left(),t.point(o)-n)})},Kl={tryUp:i(Xl,Vl),tryDown:i(Xl,Gl),ieTryUp:function(t,e){return t.situsFromPoint(e.left(),e.top()-5)},ieTryDown:function(t,e){return t.situsFromPoint(e.left(),e.bottom()+5)},getJumpSize:r(5)},Jl=pr([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),$l=function(t){return Te(t,"tr")},Ql={verify:function(t,e,n,r,o,i,u){return Te(r,"td,th",u).bind(function(n){return Te(e,"td,th",u).map(function(e){return Ht(n,e)?Ht(r,n)&&gn(n)===o?i(e):Jl.none("in same cell"):Yn.sharedOne($l,[n,e]).fold(function(){return function(t,e,n){var r=t.getRect(e),o=t.getRect(n);return o.right>r.left&&o.left<r.right}(t,e,n)?Jl.success():i(e)},function(t){return i(e)})})}).getOr(Jl.none("default"))},cata:function(t,e,n,r,o){return t.fold(e,n,r,o)},adt:Jl},Zl={point:q("element","offset"),delta:q("element","deltaOffset"),range:q("element","start","finish"),points:q("begin","end"),text:q("element","text")},tf=(q("ancestor","descendants","element","index"),q("parent","children","element","index")),ef=function(t,e){return P(t,i(Ht,e))},nf=function(t){return"br"===Zt(t)},rf=function(t,e,n){return e(t,n).bind(function(t){return oe(t)&&0===sn(t).trim().length?rf(t,e,n):p.some(t)})},of=function(t,e,n,r){return function(t,e){return Jt(t,e).filter(nf).orThunk(function(){return Jt(t,e-1).filter(nf)})}(e,n).bind(function(e){return r.traverse(e).fold(function(){return rf(e,r.gather,t).map(r.relative)},function(t){return(e=t,Vt(e).bind(function(t){var n=Kt(t);return ef(n,e).map(function(r){return tf(t,n,e,r)})})).map(function(t){return gc.on(t.parent(),t.index())});var e})})},uf=function(t,e,n,o){return(nf(e)?function(t,e,n){return n.traverse(e).orThunk(function(){return rf(e,n.gather,t)}).map(n.relative)}(t,e,o):of(t,e,n,o)).map(function(t){return{start:r(t),finish:r(t)}})},af=function(t){return Ql.cata(t,function(t){return p.none()},function(){return p.none()},function(t){return p.some(Zl.point(t,0))},function(t){return p.some(Zl.point(t,gn(t)))})},cf=Ft.detect(),lf=function(t,e,n,r,o,i){return 0===i?p.none():df(t,e,n,r,o).bind(function(u){var a=t.fromSitus(u),c=Ql.verify(t,n,r,a.finish(),a.foffset(),o.failure,e);return Ql.cata(c,function(){return p.none()},function(){return p.some(u)},function(u){return Ht(n,u)&&0===r?ff(t,n,r,xl.moveUp,o):lf(t,e,u,0,o,i-1)},function(u){return Ht(n,u)&&r===gn(u)?ff(t,n,r,xl.moveDown,o):lf(t,e,u,gn(u),o,i-1)})})},ff=function(t,e,n,r,o){return Rl(t,e,n).bind(function(e){return sf(t,o,r(e,Kl.getJumpSize()))})},sf=function(t,e,n){return cf.browser.isChrome()||cf.browser.isSafari()||cf.browser.isFirefox()||cf.browser.isEdge()?e.otherRetry(t,n):cf.browser.isIE()?e.ieRetry(t,n):p.none()},df=function(t,e,n,r,o){return Rl(t,n,r).bind(function(e){return sf(t,o,e)})},mf=function(t,e,n){return function(t,e,n){return t.getSelection().bind(function(r){return uf(e,r.finish(),r.foffset(),n).fold(function(){return p.some(Zl.point(r.finish(),r.foffset()))},function(o){var i=t.fromSitus(o),u=Ql.verify(t,r.finish(),r.foffset(),i.finish(),i.foffset(),n.failure,e);return af(u)})})}(t,e,n).bind(function(r){return lf(t,e,r.element(),r.offset(),n,20).map(t.fromSitus)})},gf=Ft.detect(),hf=function(t,e){return xe(t,function(t){return Vt(t).exists(function(t){return Ht(t,e)})},n).isSome();var n},pf=function(t,e,n,o,i){return Te(o,"td,th",e).bind(function(o){return Te(o,"table",e).bind(function(u){return hf(i,u)?mf(t,e,n).bind(function(t){return Te(t.finish(),"td,th",e).map(function(e){return{start:r(o),finish:r(e),range:r(t)}})}):p.none()})})},vf=function(t,e,n,r,o,i){return gf.browser.isIE()?p.none():i(r,e).orThunk(function(){return pf(t,e,n,r,o).map(function(t){var e=t.range();return ll.response(p.some(gl.makeSitus(e.start(),e.soffset(),e.finish(),e.foffset())),!0)})})},bf=function(t,e,n,r,o,i,u){return pf(t,n,r,o,i).bind(function(t){return wl.detect(e,n,t.start(),t.finish(),u)})},wf=function(t,e){return Te(t,"tr",e).bind(function(t){return Te(t,"table",e).bind(function(n){var r=we(n,"tr");return Ht(t,r[0])?zl.seekLeft(n,function(t){return bn(t).isSome()},e).map(function(t){var e=gn(t);return ll.response(p.some(gl.makeSitus(t,e,t,e)),!0)}):p.none()})})},yf=function(t,e){return Te(t,"tr",e).bind(function(t){return Te(t,"table",e).bind(function(n){var r=we(n,"tr");return Ht(t,r[r.length-1])?zl.seekRight(n,function(t){return vn(t).isSome()},e).map(function(t){return ll.response(p.some(gl.makeSitus(t,0,t,0)),!0)}):p.none()})})},xf=function(t,e){return Te(t,"td,th",e)},Cf={down:{traverse:Xt,gather:zl.after,relative:gc.before,otherRetry:Kl.tryDown,ieRetry:Kl.ieTryDown,failure:Ql.adt.failedDown},up:{traverse:Yt,gather:zl.before,relative:gc.before,otherRetry:Kl.tryUp,ieRetry:Kl.ieTryUp,failure:Ql.adt.failedUp}},Sf=q("rows","cols"),Rf={mouse:function(t,e,n,r){var o=function(t,e,n,r){var o=p.none(),i=function(){o=p.none()};return{mousedown:function(t){r.clear(e),o=xf(t.target(),n)},mouseover:function(i){o.each(function(o){r.clear(e),xf(i.target(),n).each(function(i){sr.identify(o,i,n).each(function(n){var u=n.boxes().getOr([]);(u.length>1||1===u.length&&!Ht(o,i))&&(r.selectRange(e,u,n.start(),n.finish()),t.selectContents(i))})})})},mouseup:function(){o.each(i)}}}(vl(t),e,n,r);return{mousedown:o.mousedown,mouseover:o.mouseover,mouseup:o.mouseup}},keyboard:function(t,e,n,r){var o=vl(t),u=function(){return r.clear(e),p.none()};return{keydown:function(t,a,c,l,f,s){var d=t.raw().which,m=!0===t.raw().shiftKey;return sr.retrieve(e,r.selectedSelector()).fold(function(){return ml.isDown(d)&&m?i(bf,o,e,n,Cf.down,l,a,r.selectRange):ml.isUp(d)&&m?i(bf,o,e,n,Cf.up,l,a,r.selectRange):ml.isDown(d)?i(vf,o,n,Cf.down,l,a,yf):ml.isUp(d)?i(vf,o,n,Cf.up,l,a,wf):p.none},function(t){var n=function(n){return function(){return Lo(n,function(n){return wl.update(n.rows(),n.cols(),e,t,r)}).fold(function(){return sr.getEdges(e,r.firstSelectedSelector(),r.lastSelectedSelector()).map(function(t){var n=ml.isDown(d)||s.isForward(d)?gc.after:gc.before;return o.setRelativeSelection(gc.on(t.first(),0),n(t.table())),r.clear(e),ll.response(p.none(),!0)})},function(t){return p.some(ll.response(p.none(),!0))})}};return ml.isDown(d)&&m?n([Sf(1,0)]):ml.isUp(d)&&m?n([Sf(-1,0)]):s.isBackward(d)&&m?n([Sf(0,-1),Sf(-1,0)]):s.isForward(d)&&m?n([Sf(0,1),Sf(1,0)]):ml.isNavigation(d)&&!1===m?u:p.none})()},keyup:function(t,o,i,u,a){return sr.retrieve(e,r.selectedSelector()).fold(function(){var c=t.raw().which;return 0==(!0===t.raw().shiftKey)?p.none():ml.isNavigation(c)?wl.sync(e,n,o,i,u,a,r.selectRange):p.none()},p.none)}}}},Tf=function(t,e){k(e,function(e){!function(t,e){ai(t)?t.dom().classList.remove(e):li(t,e),si(t)}(t,e)})},Df={byClass:function(t){var e,n,r=(e=t.selected(),function(t){fi(t,e)}),o=(n=[t.selected(),t.lastSelected(),t.firstSelected()],function(t){Tf(t,n)}),i=function(e){var n=we(e,t.selectedSelector());k(n,o)};return{clear:i,selectRange:function(e,n,o,u){i(e),k(n,r),fi(o,t.firstSelected()),fi(u,t.lastSelected())},selectedSelector:t.selectedSelector,firstSelectedSelector:t.firstSelectedSelector,lastSelectedSelector:t.lastSelectedSelector}},byAttr:function(t){var e=function(e){se(e,t.selected()),se(e,t.firstSelected()),se(e,t.lastSelected())},n=function(e){ae(e,t.selected(),"1")},r=function(n){var r=we(n,t.selectedSelector());k(r,e)};return{clear:r,selectRange:function(e,o,i,u){r(e),k(o,n),ae(i,t.firstSelected(),"1"),ae(u,t.lastSelected(),"1")},selectedSelector:t.selectedSelector,firstSelectedSelector:t.firstSelectedSelector,lastSelectedSelector:t.lastSelectedSelector}}},kf=function(t){return!1===di(it.fromDom(t.target),"ephox-snooker-resizer-bar")},Af=function(t){return{get:function(){var e=Fu(t);return dr(e,hr.selectedSelector()).fold(function(){return void 0===t.selection.getStart()?br.none():br.single(t.selection)},function(t){return br.multiple(t)})}}},Of=pa.each,Ef={addButtons:function(t){var e=[];function n(e){return function(){t.execCommand(e)}}Of("inserttable tableprops deletetable | cell row column".split(" "),function(n){"|"===n?e.push({text:"-"}):e.push(t.menuItems[n])}),t.addButton("table",{type:"menubutton",title:"Table",menu:e}),t.addButton("tableprops",{title:"Table properties",onclick:n("mceTableProps"),icon:"table"}),t.addButton("tabledelete",{title:"Delete table",onclick:n("mceTableDelete")}),t.addButton("tablecellprops",{title:"Cell properties",onclick:n("mceTableCellProps")}),t.addButton("tablemergecells",{title:"Merge cells",onclick:n("mceTableMergeCells")}),t.addButton("tablesplitcells",{title:"Split cell",onclick:n("mceTableSplitCells")}),t.addButton("tableinsertrowbefore",{title:"Insert row before",onclick:n("mceTableInsertRowBefore")}),t.addButton("tableinsertrowafter",{title:"Insert row after",onclick:n("mceTableInsertRowAfter")}),t.addButton("tabledeleterow",{title:"Delete row",onclick:n("mceTableDeleteRow")}),t.addButton("tablerowprops",{title:"Row properties",onclick:n("mceTableRowProps")}),t.addButton("tablecutrow",{title:"Cut row",onclick:n("mceTableCutRow")}),t.addButton("tablecopyrow",{title:"Copy row",onclick:n("mceTableCopyRow")}),t.addButton("tablepasterowbefore",{title:"Paste row before",onclick:n("mceTablePasteRowBefore")}),t.addButton("tablepasterowafter",{title:"Paste row after",onclick:n("mceTablePasteRowAfter")}),t.addButton("tableinsertcolbefore",{title:"Insert column before",onclick:n("mceTableInsertColBefore")}),t.addButton("tableinsertcolafter",{title:"Insert column after",onclick:n("mceTableInsertColAfter")}),t.addButton("tabledeletecol",{title:"Delete column",onclick:n("mceTableDeleteCol")})},addToolbars:function(t){var e=function(t){var e=t.getParam("table_toolbar",Ku);return""===e||!1===e?[]:b(e)?e.split(/[ ,]/):w(e)?e:[]}(t);e.length>0&&t.addContextToolbar(function(e){return t.dom.is(e,"table")&&t.getBody().contains(e)},e.join(" "))}},Nf={addMenuItems:function(t,e){var n=p.none(),r=[],o=[],i=[],u=[],a=function(t){t.disabled(!0)},c=function(t){t.disabled(!1)},l=function(){var t=this;r.push(t),n.fold(function(){a(t)},function(e){c(t)})},f=function(){var t=this;o.push(t),n.fold(function(){a(t)},function(e){c(t)})};t.on("init",function(){t.on("nodechange",function(l){var f=p.from(t.dom.getParent(t.selection.getStart(),"th,td"));(n=f.bind(function(t){var n=it.fromDom(t);return Ne.table(n).map(function(t){return Tr.forMenu(e,t,n)})})).fold(function(){k(r,a),k(o,a),k(i,a),k(u,a)},function(t){k(r,c),k(o,c),k(i,function(e){e.disabled(t.mergable().isNone())}),k(u,function(e){e.disabled(t.unmergable().isNone())})})})});var s=function(t,e,n,r){var o,i,u,a,c,l=r.getEl().getElementsByTagName("table")[0],f=r.isRtl()||"tl-tr"===r.parent().rel;for(l.nextSibling.innerHTML=e+1+" x "+(n+1),f&&(e=9-e),i=0;i<10;i++)for(o=0;o<10;o++)a=l.rows[i].childNodes[o].firstChild,c=(f?o>=e:o<=e)&&i<=n,t.dom.toggleClass(a,"mce-active",c),c&&(u=a);return u.parentNode},d=!1===function(t){return t.getParam("table_grid",!0,"boolean")}(t)?{text:"Table",icon:"table",context:"table",onclick:m("mceInsertTable")}:{text:"Table",icon:"table",context:"table",ariaHideMenu:!0,onclick:function(e){e.aria&&(this.parent().hideAll(),e.stopImmediatePropagation(),t.execCommand("mceInsertTable"))},onshow:function(){s(t,0,0,this.menu.items()[0])},onhide:function(){var e=this.menu.items()[0].getEl().getElementsByTagName("a");t.dom.removeClass(e,"mce-active"),t.dom.addClass(e[0],"mce-active")},menu:[{type:"container",html:function(){var t="";t='<table role="grid" class="mce-grid mce-grid-border" aria-readonly="true">';for(var e=0;e<10;e++){t+="<tr>";for(var n=0;n<10;n++)t+='<td role="gridcell" tabindex="-1"><a id="mcegrid'+(10*e+n)+'" href="#" data-mce-x="'+n+'" data-mce-y="'+e+'"></a></td>';t+="</tr>"}return t+="</table>",t+='<div class="mce-text-center" role="presentation">1 x 1</div>'}(),onPostRender:function(){this.lastX=this.lastY=0},onmousemove:function(e){var n,r,o=e.target;"A"===o.tagName.toUpperCase()&&(n=parseInt(o.getAttribute("data-mce-x"),10),r=parseInt(o.getAttribute("data-mce-y"),10),(this.isRtl()||"tl-tr"===this.parent().rel)&&(n=9-n),n===this.lastX&&r===this.lastY||(s(t,n,r,e.control),this.lastX=n,this.lastY=r))},onclick:function(e){var n=this;"A"===e.target.tagName.toUpperCase()&&(e.preventDefault(),e.stopPropagation(),n.parent().cancel(),t.undoManager.transact(function(){Ea(t,n.lastX+1,n.lastY+1)}),t.addVisual())}}]};function m(e){return function(){t.execCommand(e)}}var g={text:"Table properties",context:"table",onPostRender:l,onclick:m("mceTableProps")},h={text:"Delete table",context:"table",onPostRender:l,cmd:"mceTableDelete"},v={text:"Row",context:"table",menu:[{text:"Insert row before",onclick:m("mceTableInsertRowBefore"),onPostRender:f},{text:"Insert row after",onclick:m("mceTableInsertRowAfter"),onPostRender:f},{text:"Delete row",onclick:m("mceTableDeleteRow"),onPostRender:f},{text:"Row properties",onclick:m("mceTableRowProps"),onPostRender:f},{text:"-"},{text:"Cut row",onclick:m("mceTableCutRow"),onPostRender:f},{text:"Copy row",onclick:m("mceTableCopyRow"),onPostRender:f},{text:"Paste row before",onclick:m("mceTablePasteRowBefore"),onPostRender:f},{text:"Paste row after",onclick:m("mceTablePasteRowAfter"),onPostRender:f}]},b={text:"Column",context:"table",menu:[{text:"Insert column before",onclick:m("mceTableInsertColBefore"),onPostRender:f},{text:"Insert column after",onclick:m("mceTableInsertColAfter"),onPostRender:f},{text:"Delete column",onclick:m("mceTableDeleteCol"),onPostRender:f}]},w={separator:"before",text:"Cell",context:"table",menu:[{text:"Cell properties",onclick:m("mceTableCellProps"),onPostRender:f},{text:"Merge cells",onclick:m("mceTableMergeCells"),onPostRender:function(){var t=this;i.push(t),n.fold(function(){a(t)},function(e){t.disabled(e.mergable().isNone())})}},{text:"Split cell",onclick:m("mceTableSplitCells"),onPostRender:function(){var t=this;u.push(t),n.fold(function(){a(t)},function(e){t.disabled(e.unmergable().isNone())})}}]};t.addMenuItem("inserttable",d),t.addMenuItem("tableprops",g),t.addMenuItem("deletetable",h),t.addMenuItem("row",v),t.addMenuItem("column",b),t.addMenuItem("cell",w)}},Pf=function(t,e){return{insertTable:function(e,n){return Ea(t,e,n)},setClipboardRows:function(t){return function(t,e){var n=D(t,it.fromDom);e.set(p.from(n))}(t,e)},getClipboardRows:function(){return function(t){return t.get().fold(function(){},function(t){return D(t,function(t){return t.dom()})})}(e)}}};t.add("table",function(t){var o=oc(t),i=function(t,o){var i=J(["mousedown","mouseover","mouseup","keyup","keydown"],[]),u=p.none(),a=Df.byAttr(hr);return t.on("init",function(c){var l=t.getWin(),f=Fu(t),s=Uu(t),d=Rf.mouse(l,f,s,a),m=Rf.keyboard(l,f,s,a),g=function(e,n){(function(t){return!0===t.raw().shiftKey})(e)&&(n.kill()&&e.kill(),n.selection().each(function(e){var n=bc(e.start(),e.finish()),r=Ac(l,n);t.selection.setRng(r)}))},h=function(e){var n=w(e);if(n.raw().shiftKey&&ml.isNavigation(n.raw().which)){var r=t.selection.getRng(),o=it.fromDom(r.startContainer),i=it.fromDom(r.endContainer);m.keyup(n,o,r.startOffset,i,r.endOffset).each(function(t){g(n,t)})}},v=function(e){var n=w(e);o().each(function(t){t.hideBars()});var r=t.selection.getRng(),i=it.fromDom(t.selection.getStart()),u=it.fromDom(r.startContainer),a=it.fromDom(r.endContainer),c=Xu.directionAt(i).isRtl()?ml.rtl:ml.ltr;m.keydown(n,u,r.startOffset,a,r.endOffset,c).each(function(t){g(n,t)}),o().each(function(t){t.showBars()})},b=function(t){return t.hasOwnProperty("x")&&t.hasOwnProperty("y")},w=function(t){var e=it.fromDom(t.target),o=function(){t.stopPropagation()},i=function(){t.preventDefault()},u=n(i,o);return{target:r(e),x:r(b(t)?t.x:null),y:r(b(t)?t.y:null),stop:o,prevent:i,kill:u,raw:r(t)}},y=function(t){return 0===t.button},x=function(t){y(t)&&kf(t)&&d.mousedown(w(t))},C=function(t){var e;void 0!==(e=t).buttons&&0==(1&e.buttons)||!kf(t)||d.mouseover(w(t))},S=function(t){y(t)&&kf(t)&&d.mouseup(w(t))};t.on("mousedown",x),t.on("mouseover",C),t.on("mouseup",S),t.on("keyup",h),t.on("keydown",v),t.on("nodechange",function(){var n=t.selection,r=it.fromDom(n.getStart()),o=it.fromDom(n.getEnd());Yn.sharedOne(Ne.table,[r,o]).fold(function(){a.clear(f)},e)}),u=p.some(i({mousedown:x,mouseover:C,mouseup:S,keyup:h,keydown:v}))}),{clear:a.clear,destroy:function(){u.each(function(t){})}}}(t,o.lazyResize),u=ga(t,o.lazyWire),a=Af(t),c=ho(p.none());return Wa.registerCommands(t,u,i,a,c),Dr.registerEvents(t,a,u,i),Nf.addMenuItems(t,a),Ef.addButtons(t),Ef.addToolbars(t),t.on("PreInit",function(){t.serializer.addTempAttr(hr.firstSelected()),t.serializer.addTempAttr(hr.lastSelected())}),ta(t)&&t.on("keydown",function(e){cl.handle(e,t,u,o.lazyWire)}),t.on("remove",function(){o.destroy(),i.destroy()}),Pf(t,c)})}();
