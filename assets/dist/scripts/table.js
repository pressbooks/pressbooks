!function(t){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),n=function(){},r=function(t,e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t(e.apply(null,n))}},o=function(t){return function(){return t}},i=function(t){return t};function u(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=e.concat(n);return t.apply(null,o)}}var c,a=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return!t.apply(null,e)}},l=function(t){return t()},f=o(!1),s=o(!0),d=f,m=s,g=function(){return h},h=function(){var t=function(t){return t.isNone()},e=function(t){return t()},n=function(t){return t},r={fold:function(t,e){return t()},is:d,isSome:d,isNone:m,getOr:n,getOrThunk:e,getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:function(){return null},getOrUndefined:function(){},or:n,orThunk:e,map:g,ap:g,each:function(){},bind:g,flatten:g,exists:d,forall:m,filter:g,equals:t,equals_:t,toArray:function(){return[]},toString:o("none()")};return Object.freeze&&Object.freeze(r),r}(),p=function(t){var e=function(){return t},n=function(){return o},r=function(e){return e(t)},o={fold:function(e,n){return n(t)},is:function(e){return t===e},isSome:m,isNone:d,getOr:e,getOrThunk:e,getOrDie:e,getOrNull:e,getOrUndefined:e,or:n,orThunk:n,map:function(e){return p(e(t))},ap:function(e){return e.fold(g,function(e){return p(e(t))})},each:function(e){e(t)},bind:r,flatten:e,exists:r,forall:r,filter:function(e){return e(t)?o:h},equals:function(e){return e.is(t)},equals_:function(e,n){return e.fold(d,function(e){return n(t,e)})},toArray:function(){return[t]},toString:function(){return"some("+t+")"}};return o},v={some:p,none:g,from:function(t){return null==t?h:p(t)}},b=function(t){return function(e){return function(t){if(null===t)return"null";var e=typeof t;return"object"===e&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"===e&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":e}(e)===t}},w=b("string"),y=b("array"),x=b("boolean"),C=b("function"),S=b("number"),R=Array.prototype.slice,T=void 0===(c=Array.prototype.indexOf)?function(t,e){return W(t,e)}:function(t,e){return c.call(t,e)},D=function(t,e){return T(t,e)>-1},O=function(t,e){return B(t,e).isSome()},A=function(t,e){for(var n=t.length,r=new Array(n),o=0;o<n;o++){var i=t[o];r[o]=e(i,o,t)}return r},E=function(t,e){for(var n=0,r=t.length;n<r;n++)e(t[n],n,t)},N=function(t,e){for(var n=[],r=0,o=t.length;r<o;r++){var i=t[r];e(i,r,t)&&n.push(i)}return n},k=function(t,e,n){return function(t,e){for(var n=t.length-1;n>=0;n--)e(t[n],n,t)}(t,function(t){n=e(n,t)}),n},P=function(t,e,n){return E(t,function(t){n=e(n,t)}),n},I=function(t,e){for(var n=0,r=t.length;n<r;n++){var o=t[n];if(e(o,n,t))return v.some(o)}return v.none()},B=function(t,e){for(var n=0,r=t.length;n<r;n++)if(e(t[n],n,t))return v.some(n);return v.none()},W=function(t,e){for(var n=0,r=t.length;n<r;++n)if(t[n]===e)return n;return-1},M=Array.prototype.push,_=function(t){for(var e=[],n=0,r=t.length;n<r;++n){if(!Array.prototype.isPrototypeOf(t[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+t);M.apply(e,t[n])}return e},L=function(t,e){var n=A(t,e);return _(n)},j=function(t,e){for(var n=0,r=t.length;n<r;++n)if(!0!==e(t[n],n,t))return!1;return!0},F=function(t){var e=R.call(t,0);return e.reverse(),e},H=(C(Array.from)&&Array.from,Object.keys),z=function(t,e){for(var n=H(t),r=0,o=n.length;r<o;r++){var i=n[r];e(t[i],i,t)}},U=function(t,e){return q(t,function(t,n,r){return{k:n,v:e(t,n,r)}})},q=function(t,e){var n={};return z(t,function(r,o){var i=e(r,o,t);n[i.k]=i.v}),n},V=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(t.length!==e.length)throw new Error('Wrong number of arguments to struct. Expected "['+t.length+']", got '+e.length+" arguments");var r={};return E(t,function(t,n){r[t]=o(e[n])}),r}},G=function(t){return t.slice(0).sort()},Y=function(t,e){throw new Error("All required keys ("+G(t).join(", ")+") were not specified. Specified keys were: "+G(e).join(", ")+".")},X=function(t){throw new Error("Unsupported keys for object: "+G(t).join(", "))},K=function(t,e){if(!y(e))throw new Error("The "+t+" fields must be an array. Was: "+e+".");E(e,function(e){if(!w(e))throw new Error("The value "+e+" in the "+t+" fields was not a string.")})},J=function(t){var e=G(t);I(e,function(t,n){return n<e.length-1&&t===e[n+1]}).each(function(t){throw new Error("The field: "+t+" occurs more than once in the combined fields: ["+e.join(", ")+"].")})},$=function(t,e){var n=t.concat(e);if(0===n.length)throw new Error("You must specify at least one required or optional field.");return K("required",t),K("optional",e),J(n),function(r){var i=H(r);j(t,function(t){return D(i,t)})||Y(t,i);var u=N(i,function(t){return!D(n,t)});u.length>0&&X(u);var c={};return E(t,function(t){c[t]=o(r[t])}),E(e,function(t){c[t]=o(Object.prototype.hasOwnProperty.call(r,t)?v.some(r[t]):v.none())}),c}},Q=(t.Node.ATTRIBUTE_NODE,t.Node.CDATA_SECTION_NODE,t.Node.COMMENT_NODE),Z=t.Node.DOCUMENT_NODE,tt=(t.Node.DOCUMENT_TYPE_NODE,t.Node.DOCUMENT_FRAGMENT_NODE,t.Node.ELEMENT_NODE),et=t.Node.TEXT_NODE,nt=(t.Node.PROCESSING_INSTRUCTION_NODE,t.Node.ENTITY_REFERENCE_NODE,t.Node.ENTITY_NODE,t.Node.NOTATION_NODE,function(t){return t.dom().nodeName.toLowerCase()}),rt=function(t){return t.dom().nodeType},ot=function(t){return function(e){return rt(e)===t}},it=function(t){return rt(t)===Q||"#comment"===nt(t)},ut=ot(tt),ct=ot(et),at=ot(Z),lt=function(e,n,r){if(!(w(r)||x(r)||S(r)))throw t.console.error("Invalid call to Attr.set. Key ",n,":: Value ",r,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(n,r+"")},ft=function(t,e,n){lt(t.dom(),e,n)},st=function(t,e){var n=t.dom();z(e,function(t,e){lt(n,e,t)})},dt=function(t,e){var n=t.dom().getAttribute(e);return null===n?void 0:n},mt=function(t,e){var n=t.dom();return!(!n||!n.hasAttribute)&&n.hasAttribute(e)},gt=function(t,e){t.dom().removeAttribute(e)},ht=function(t){return P(t.dom().attributes,function(t,e){return t[e.name]=e.value,t},{})},pt=function(t,e){return-1!==t.indexOf(e)},vt=function(t){return void 0!==t.style&&C(t.style.getPropertyValue)},bt=function(t){var e,n=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return n||(n=!0,e=t.apply(null,r)),e}},wt=function(t){if(null==t)throw new Error("Node cannot be null or undefined");return{dom:o(t)}},yt={fromHtml:function(e,n){var r=(n||t.document).createElement("div");if(r.innerHTML=e,!r.hasChildNodes()||r.childNodes.length>1)throw t.console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return wt(r.childNodes[0])},fromTag:function(e,n){var r=(n||t.document).createElement(e);return wt(r)},fromText:function(e,n){var r=(n||t.document).createTextNode(e);return wt(r)},fromDom:wt,fromPoint:function(t,e,n){var r=t.dom();return v.from(r.elementFromPoint(e,n)).map(wt)}},xt=function(t){var e=ct(t)?t.dom().parentNode:t.dom();return null!=e&&e.ownerDocument.body.contains(e)},Ct=bt(function(){return St(yt.fromDom(t.document))}),St=function(t){var e=t.dom().body;if(null==e)throw new Error("Body is not available yet");return yt.fromDom(e)},Rt=function(e,n,r){if(!w(r))throw t.console.error("Invalid call to CSS.set. Property ",n,":: Value ",r,":: Element ",e),new Error("CSS value must be a string: "+r);vt(e)&&e.style.setProperty(n,r)},Tt=function(t,e,n){var r=t.dom();Rt(r,e,n)},Dt=function(t,e){var n=t.dom();z(e,function(t,e){Rt(n,e,t)})},Ot=function(e,n){var r=e.dom(),o=t.window.getComputedStyle(r).getPropertyValue(n),i=""!==o||xt(e)?o:At(r,n);return null===i?void 0:i},At=function(t,e){return vt(t)?t.style.getPropertyValue(e):""},Et=function(t,e){var n=t.dom(),r=At(n,e);return v.from(r).filter(function(t){return t.length>0})},Nt=function(t,e){!function(t,e){vt(t)&&t.style.removeProperty(e)}(t.dom(),e),mt(t,"style")&&""===dt(t,"style").replace(/^\s+|\s+$/g,"")&&gt(t,"style")},kt=void 0!==t.window?t.window:Function("return this;")(),Pt=function(t,e){return function(t,e){for(var n=null!=e?e:kt,r=0;r<t.length&&null!=n;++r)n=n[t[r]];return n}(t.split("."),e)},It=function(t,e){var n=function(t,e){return Pt(t,e)}(t,e);if(null==n)throw t+" not available on this browser";return n},Bt=function(){return It("Node")},Wt=function(t,e,n){return 0!=(t.compareDocumentPosition(e)&n)},Mt=function(t,e){return Wt(t,e,Bt().DOCUMENT_POSITION_CONTAINED_BY)},_t=function(){return Lt(0,0)},Lt=function(t,e){return{major:t,minor:e}},jt={nu:Lt,detect:function(t,e){var n=String(e).toLowerCase();return 0===t.length?_t():function(t,e){var n=function(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(r.test(e))return r}}(t,e);if(!n)return{major:0,minor:0};var r=function(t){return Number(e.replace(n,"$"+t))};return Lt(r(1),r(2))}(t,n)},unknown:_t},Ft=function(t,e){return function(){return e===t}},Ht=function(t){var e=t.current;return{current:e,version:t.version,isEdge:Ft("Edge",e),isChrome:Ft("Chrome",e),isIE:Ft("IE",e),isOpera:Ft("Opera",e),isFirefox:Ft("Firefox",e),isSafari:Ft("Safari",e)}},zt={unknown:function(){return Ht({current:void 0,version:jt.unknown()})},nu:Ht,edge:o("Edge"),chrome:o("Chrome"),ie:o("IE"),opera:o("Opera"),firefox:o("Firefox"),safari:o("Safari")},Ut=function(t,e){return function(){return e===t}},qt=function(t){var e=t.current;return{current:e,version:t.version,isWindows:Ut("Windows",e),isiOS:Ut("iOS",e),isAndroid:Ut("Android",e),isOSX:Ut("OSX",e),isLinux:Ut("Linux",e),isSolaris:Ut("Solaris",e),isFreeBSD:Ut("FreeBSD",e)}},Vt={unknown:function(){return qt({current:void 0,version:jt.unknown()})},nu:qt,windows:o("Windows"),ios:o("iOS"),android:o("Android"),linux:o("Linux"),osx:o("OSX"),solaris:o("Solaris"),freebsd:o("FreeBSD")},Gt=function(t,e){var n=String(e).toLowerCase();return I(t,function(t){return t.search(n)})},Yt=function(t,e){return Gt(t,e).map(function(t){var n=jt.detect(t.versionRegexes,e);return{current:t.name,version:n}})},Xt=function(t,e){return Gt(t,e).map(function(t){var n=jt.detect(t.versionRegexes,e);return{current:t.name,version:n}})},Kt=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Jt=function(t){return function(e){return pt(e,t)}},$t=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return pt(t,"edge/")&&pt(t,"chrome")&&pt(t,"safari")&&pt(t,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Kt],search:function(t){return pt(t,"chrome")&&!pt(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return pt(t,"msie")||pt(t,"trident")}},{name:"Opera",versionRegexes:[Kt,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Jt("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Jt("firefox")},{name:"Safari",versionRegexes:[Kt,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return(pt(t,"safari")||pt(t,"mobile/"))&&pt(t,"applewebkit")}}],Qt=[{name:"Windows",search:Jt("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return pt(t,"iphone")||pt(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Jt("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Jt("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Jt("linux"),versionRegexes:[]},{name:"Solaris",search:Jt("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Jt("freebsd"),versionRegexes:[]}],Zt={browsers:o($t),oses:o(Qt)},te=function(t){var e=Zt.browsers(),n=Zt.oses(),r=Yt(e,t).fold(zt.unknown,zt.nu),i=Xt(n,t).fold(Vt.unknown,Vt.nu),u=function(t,e,n){var r=t.isiOS()&&!0===/ipad/i.test(n),i=t.isiOS()&&!r,u=t.isAndroid()&&3===t.version.major,c=t.isAndroid()&&4===t.version.major,a=r||u||c&&!0===/mobile/i.test(n),l=t.isiOS()||t.isAndroid(),f=l&&!a,s=e.isSafari()&&t.isiOS()&&!1===/safari/i.test(n);return{isiPad:o(r),isiPhone:o(i),isTablet:o(a),isPhone:o(f),isTouch:o(l),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:o(s)}}(i,r,t);return{browser:r,os:i,deviceType:u}},ee={detect:bt(function(){var e=t.navigator.userAgent;return te(e)})},ne=tt,re=Z,oe=function(t,e){var n=t.dom();if(n.nodeType!==ne)return!1;if(void 0!==n.matches)return n.matches(e);if(void 0!==n.msMatchesSelector)return n.msMatchesSelector(e);if(void 0!==n.webkitMatchesSelector)return n.webkitMatchesSelector(e);if(void 0!==n.mozMatchesSelector)return n.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")},ie=function(t){return t.nodeType!==ne&&t.nodeType!==re||0===t.childElementCount},ue=function(t,e){return t.dom()===e.dom()},ce=ee.detect().browser.isIE()?function(t,e){return Mt(t.dom(),e.dom())}:function(t,e){var n=t.dom(),r=e.dom();return n!==r&&n.contains(r)},ae=oe,le=function(t){return yt.fromDom(t.dom().ownerDocument)},fe=function(t){var e=t.dom();return v.from(e.parentNode).map(yt.fromDom)},se=function(t,e){for(var n=C(e)?e:o(!1),r=t.dom(),i=[];null!==r.parentNode&&void 0!==r.parentNode;){var u=r.parentNode,c=yt.fromDom(u);if(i.push(c),!0===n(c))break;r=u}return i},de=function(t){var e=t.dom();return v.from(e.previousSibling).map(yt.fromDom)},me=function(t){var e=t.dom();return v.from(e.nextSibling).map(yt.fromDom)},ge=function(t){var e=t.dom();return A(e.childNodes,yt.fromDom)},he=function(t,e){var n=t.dom().childNodes;return v.from(n[e]).map(yt.fromDom)},pe=(V("element","offset"),function(t,e){fe(t).each(function(n){n.dom().insertBefore(e.dom(),t.dom())})}),ve=function(t,e){me(t).fold(function(){fe(t).each(function(t){we(t,e)})},function(t){pe(t,e)})},be=function(t,e){(function(t){return he(t,0)})(t).fold(function(){we(t,e)},function(n){t.dom().insertBefore(e.dom(),n.dom())})},we=function(t,e){t.dom().appendChild(e.dom())},ye=function(t,e){pe(t,e),we(e,t)},xe=function(t,e){E(e,function(n,r){var o=0===r?t:e[r-1];ve(o,n)})},Ce=function(t,e){E(e,function(e){we(t,e)})},Se=function(t){t.dom().textContent="",E(ge(t),function(t){Re(t)})},Re=function(t){var e=t.dom();null!==e.parentNode&&e.parentNode.removeChild(e)},Te=function(t){var e,n=ge(t);n.length>0&&(e=t,E(n,function(t){pe(e,t)})),Re(t)},De=(V("width","height"),V("width","height"),V("rows","columns")),Oe=V("row","column"),Ae=(V("x","y"),V("element","rowspan","colspan")),Ee=V("element","rowspan","colspan","isNew"),Ne=V("element","rowspan","colspan","row","column"),ke=V("element","cells","section"),Pe=V("element","isNew"),Ie=V("element","cells","section","isNew"),Be=V("cells","section"),We=V("details","section"),Me=V("startRow","startCol","finishRow","finishCol"),_e=function(t,e){var n=[];return E(ge(t),function(t){e(t)&&(n=n.concat([t])),n=n.concat(_e(t,e))}),n},Le=function(t,e,n){return function(t,e,n){return N(se(t,n),e)}(t,function(t){return oe(t,e)},n)},je=function(t,e){return function(t,e){return N(ge(t),e)}(t,function(t){return oe(t,e)})},Fe=function(e,n){return function(e,n){var r=void 0===n?t.document:n.dom();return ie(r)?[]:A(r.querySelectorAll(e),yt.fromDom)}(n,e)};function He(t,e,n,r,o){return t(n,r)?v.some(n):C(o)&&o(n)?v.none():e(n,r,o)}var ze=function(t,e,n){for(var r=t.dom(),i=C(n)?n:o(!1);r.parentNode;){r=r.parentNode;var u=yt.fromDom(r);if(e(u))return v.some(u);if(i(u))break}return v.none()},Ue=function(t,e,n){return ze(t,function(t){return oe(t,e)},n)},qe=function(t,e){return function(t,e){return I(t.dom().childNodes,r(e,yt.fromDom)).map(yt.fromDom)}(t,function(t){return oe(t,e)})},Ve=function(e,n){return function(e,n){var r=void 0===n?t.document:n.dom();return ie(r)?v.none():v.from(r.querySelector(e)).map(yt.fromDom)}(n,e)},Ge=function(t,e,n){return He(oe,Ue,t,e,n)},Ye=function(t,e,n){return L(ge(t),function(t){return oe(t,e)?n(t)?[t]:[]:Ye(t,e,n)})},Xe={firstLayer:function(t,e){return Ye(t,e,o(!0))},filterFirstLayer:Ye},Ke=function(t,e,n){return void 0===n&&(n=f),n(e)?v.none():D(t,nt(e))?v.some(e):Ue(e,t.join(","),function(t){return oe(t,"table")||n(t)})},Je=function(t,e){return fe(e).map(function(e){return je(e,t)})},$e=u(Je,"th,td"),Qe=u(Je,"tr"),Ze=function(t,e){return parseInt(dt(t,e),10)},tn={cell:function(t,e){return Ke(["td","th"],t,e)},firstCell:function(t){return Ve(t,"th,td")},cells:function(t){return Xe.firstLayer(t,"th,td")},neighbourCells:$e,table:function(t,e){return Ge(t,"table",e)},row:function(t,e){return Ke(["tr"],t,e)},rows:function(t){return Xe.firstLayer(t,"tr")},notCell:function(t,e){return Ke(["caption","tr","tbody","tfoot","thead"],t,e)},neighbourRows:Qe,attr:Ze,grid:function(t,e,n){var r=Ze(t,e),o=Ze(t,n);return De(r,o)}},en=function(t){var e=tn.rows(t);return A(e,function(t){var e=t,n=fe(e).map(function(t){var e=nt(t);return"tfoot"===e||"thead"===e||"tbody"===e?e:"tbody"}).getOr("tbody"),r=A(tn.cells(t),function(t){var e=mt(t,"rowspan")?parseInt(dt(t,"rowspan"),10):1,n=mt(t,"colspan")?parseInt(dt(t,"colspan"),10):1;return Ae(t,e,n)});return ke(e,r,n)})},nn=function(t,e){return A(t,function(t){var n=A(tn.cells(t),function(t){var e=mt(t,"rowspan")?parseInt(dt(t,"rowspan"),10):1,n=mt(t,"colspan")?parseInt(dt(t,"colspan"),10):1;return Ae(t,e,n)});return ke(t,n,e.section())})},rn=function(t,e){return t+","+e},on=function(t,e){var n=L(t.all(),function(t){return t.cells()});return N(n,e)},un={generate:function(t){var e={},n=[],r=t.length,i=0;E(t,function(t,r){var o=[];E(t.cells(),function(t){for(var n=0;void 0!==e[rn(r,n)];)n++;for(var u=Ne(t.element(),t.rowspan(),t.colspan(),r,n),c=0;c<t.colspan();c++)for(var a=0;a<t.rowspan();a++){var l=n+c,f=rn(r+a,l);e[f]=u,i=Math.max(i,l+1)}o.push(u)}),n.push(ke(t.element(),o,t.section()))});var u=De(r,i);return{grid:o(u),access:o(e),all:o(n)}},getAt:function(t,e,n){var r=t.access()[rn(e,n)];return void 0!==r?v.some(r):v.none()},findItem:function(t,e,n){var r=on(t,function(t){return n(e,t.element())});return r.length>0?v.some(r[0]):v.none()},filterItems:on,justCells:function(t){var e=A(t.all(),function(t){return t.cells()});return _(e)}},cn=V("minRow","minCol","maxRow","maxCol"),an=function(t,e,n){var r=t[n].element(),o=yt.fromTag("td");we(o,yt.fromTag("br")),(e?we:be)(r,o)},ln=function(t,e){var n=function(t){return oe(t.element(),e)},r=en(t),o=un.generate(r),i=function(t,e){var n=t.grid().columns(),r=t.grid().rows(),o=n,i=0,u=0;return z(t.access(),function(t){if(e(t)){var n=t.row(),c=n+t.rowspan()-1,a=t.column(),l=a+t.colspan()-1;n<r?r=n:c>i&&(i=c),a<o?o=a:l>u&&(u=l)}}),cn(r,o,i,u)}(o,n),u="th:not("+e+"),td:not("+e+")",c=Xe.filterFirstLayer(t,"th,td",function(t){return oe(t,u)});return E(c,Re),function(t,e,n,r){for(var o=e.grid().columns(),i=e.grid().rows(),u=0;u<i;u++)for(var c=!1,a=0;a<o;a++)u<n.minRow()||u>n.maxRow()||a<n.minCol()||a>n.maxCol()||(un.getAt(e,u,a).filter(r).isNone()?an(t,c,u):c=!0)}(r,o,i,n),function(t,e){var n=N(Xe.firstLayer(t,"tr"),function(t){return 0===t.dom().childElementCount});E(n,Re),e.minCol()!==e.maxCol()&&e.minRow()!==e.maxRow()||E(Xe.firstLayer(t,"th,td"),function(t){gt(t,"rowspan"),gt(t,"colspan")}),gt(t,"width"),gt(t,"height"),Nt(t,"width"),Nt(t,"height")}(t,i),t},fn=function(t,e){var n=function(e){return t(e)?v.from(e.dom().nodeValue):v.none()},r=ee.detect().browser,o=r.isIE()&&10===r.version.major?function(t){try{return n(t)}catch(t){return v.none()}}:n;return{get:function(n){if(!t(n))throw new Error("Can only get "+e+" value of a "+e+" node");return o(n).getOr("")},getOption:o,set:function(n,r){if(!t(n))throw new Error("Can only set raw "+e+" value of a "+e+" node");n.dom().nodeValue=r}}}(ct,"text"),sn=function(t){return fn.get(t)},dn=function(t){return fn.getOption(t)},mn=function(t,e){fn.set(t,e)},gn=function(t){return"img"===nt(t)?1:dn(t).fold(function(){return ge(t).length},function(t){return t.length})},hn=["img","br"],pn=function(t){return dn(t).filter(function(t){return 0!==t.trim().length||t.indexOf(" ")>-1}).isSome()||D(hn,nt(t))},vn=function(t){return e=pn,(n=function(t){for(var r=0;r<t.childNodes.length;r++){if(e(yt.fromDom(t.childNodes[r])))return v.some(yt.fromDom(t.childNodes[r]));var o=n(t.childNodes[r]);if(o.isSome())return o}return v.none()})(t.dom());var e,n},bn=function(t){return wn(t,pn)},wn=function(t,e){var n=function(t){for(var r=ge(t),o=r.length-1;o>=0;o--){var i=r[o];if(e(i))return v.some(i);var u=n(i);if(u.isSome())return u}return v.none()};return n(t)},yn=function(t,e){return yt.fromDom(t.dom().cloneNode(e))},xn=function(t){return yn(t,!1)},Cn=function(t){return yn(t,!0)},Sn=function(t,e){var n=function(t,e){var n=yt.fromTag(e),r=ht(t);return st(n,r),n}(t,e),r=ge(Cn(t));return Ce(n,r),n},Rn=function(){var t=yt.fromTag("td");return we(t,yt.fromTag("br")),t},Tn=function(t,e,n){var r=Sn(t,e);return z(n,function(t,e){null===t?gt(r,e):ft(r,e,t)}),r},Dn=function(t){return t},On=function(t){return function(){return yt.fromTag("tr",t.dom())}},An=function(t,e,n){return{row:On(e),cell:function(e){var r,o,i,u,c=le(e.element()),a=yt.fromTag(nt(e.element()),c.dom()),l=n.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),f=l.length>0?function(t,e,n){return vn(t).map(function(r){var o=n.join(","),i=Le(r,o,function(e){return ue(e,t)});return k(i,function(t,e){var n=xn(e);return gt(n,"contenteditable"),we(t,n),n},e)}).getOr(e)}(e.element(),a,l):a;return we(f,yt.fromTag("br")),r=e.element(),o=a,i=r.dom(),u=o.dom(),vt(i)&&vt(u)&&(u.style.cssText=i.style.cssText),Nt(a,"height"),1!==e.colspan()&&Nt(e.element(),"width"),t(e.element(),a),a},replace:Tn,gap:Rn}},En=function(t){return{row:On(t),cell:Rn,replace:Dn,gap:Rn}},Nn=function(t,e){return e.column()>=t.startCol()&&e.column()+e.colspan()-1<=t.finishCol()&&e.row()>=t.startRow()&&e.row()+e.rowspan()-1<=t.finishRow()},kn=function(t,e){var n=e.column(),r=e.column()+e.colspan()-1,o=e.row(),i=e.row()+e.rowspan()-1;return n<=t.finishCol()&&r>=t.startCol()&&o<=t.finishRow()&&i>=t.startRow()},Pn=function(t,e){for(var n=!0,r=u(Nn,e),o=e.startRow();o<=e.finishRow();o++)for(var i=e.startCol();i<=e.finishCol();i++)n=n&&un.getAt(t,o,i).exists(r);return n?v.some(e):v.none()},In=function(t,e,n){var r=un.findItem(t,e,ue),o=un.findItem(t,n,ue);return r.bind(function(t){return o.map(function(e){return n=t,r=e,Me(Math.min(n.row(),r.row()),Math.min(n.column(),r.column()),Math.max(n.row()+n.rowspan()-1,r.row()+r.rowspan()-1),Math.max(n.column()+n.colspan()-1,r.column()+r.colspan()-1));var n,r})})},Bn=In,Wn=function(t,e,n){return In(t,e,n).bind(function(e){return Pn(t,e)})},Mn=function(t,e,n,r){return un.findItem(t,e,ue).bind(function(e){var o=n>0?e.row()+e.rowspan()-1:e.row(),i=r>0?e.column()+e.colspan()-1:e.column();return un.getAt(t,o+n,i+r).map(function(t){return t.element()})})},_n=function(t,e,n){return Bn(t,e,n).map(function(e){var n=un.filterItems(t,u(kn,e));return A(n,function(t){return t.element()})})},Ln=function(t,e){return un.findItem(t,e,function(t,e){return ce(e,t)}).map(function(t){return t.element()})},jn=function(t){var e=en(t);return un.generate(e)},Fn=function(t,e,n){return tn.table(t).bind(function(r){var o=jn(r);return Mn(o,t,e,n)})},Hn=function(t,e,n){var r=jn(t);return _n(r,e,n)},zn=function(t,e,n,r,o){var i=jn(t),u=ue(t,n)?v.some(e):Ln(i,e),c=ue(t,o)?v.some(r):Ln(i,r);return u.bind(function(t){return c.bind(function(e){return _n(i,t,e)})})},Un=function(t,e,n){var r=jn(t);return Wn(r,e,n)},qn=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function Vn(){return{up:o({selector:Ue,closest:Ge,predicate:ze,all:se}),down:o({selector:Fe,predicate:_e}),styles:o({get:Ot,getRaw:Et,set:Tt,remove:Nt}),attrs:o({get:dt,set:ft,remove:gt,copyTo:function(t,e){var n=ht(t);st(e,n)}}),insert:o({before:pe,after:ve,afterAll:xe,append:we,appendAll:Ce,prepend:be,wrap:ye}),remove:o({unwrap:Te,remove:Re}),create:o({nu:yt.fromTag,clone:function(t){return yt.fromDom(t.dom().cloneNode(!1))},text:yt.fromText}),query:o({comparePosition:function(t,e){return t.dom().compareDocumentPosition(e.dom())},prevSibling:de,nextSibling:me}),property:o({children:ge,name:nt,parent:fe,document:function(t){return t.dom().ownerDocument},isText:ct,isComment:it,isElement:ut,getText:sn,setText:mn,isBoundary:function(t){return!!ut(t)&&("body"===nt(t)||D(qn,nt(t)))},isEmptyTag:function(t){return!!ut(t)&&D(["br","img","hr","input"],nt(t))}}),eq:ue,is:ae}}var Gn=V("left","right"),Yn=V("first","second","splits"),Xn=function(t,e,n){var r=t.property().children(e);return B(r,u(t.eq,n)).map(function(t){return{before:o(r.slice(0,t)),after:o(r.slice(t+1))}})},Kn=function(t,e,n,r){var o=e(t,n);return k(r,function(n,r){var o=e(t,r);return Jn(t,n,o)},o)},Jn=function(t,e,n){return e.bind(function(e){return n.filter(u(t.eq,e))})},$n=function(t,e){return u(t.eq,e)},Qn=function(t,e,n,r){void 0===r&&(r=f);var i=[e].concat(t.up().all(e)),u=[n].concat(t.up().all(n)),c=function(t){return B(t,r).fold(function(){return t},function(e){return t.slice(0,e+1)})},a=c(i),l=c(u),s=I(a,function(e){return O(l,$n(t,e))});return{firstpath:o(a),secondpath:o(l),shared:o(s)}},Zn={sharedOne:function(t,e,n){return n.length>0?function(t,e,n,r){return r(t,e,n[0],n.slice(1))}(t,e,n,Kn):v.none()},subset:function(t,e,n){var r=Qn(t,e,n);return r.shared().bind(function(e){return function(t,e,n,r){var o=t.property().children(e);if(t.eq(e,n[0]))return v.some([n[0]]);if(t.eq(e,r[0]))return v.some([r[0]]);var i=function(n){var r=F(n),i=B(r,$n(t,e)).getOr(-1),u=i<r.length-1?r[i+1]:r[i];return B(o,$n(t,u))},u=i(n),c=i(r);return u.bind(function(t){return c.map(function(e){var n=Math.min(t,e),r=Math.max(t,e);return o.slice(n,r+1)})})}(t,e,r.firstpath(),r.secondpath())})},ancestors:Qn,breakToLeft:function(t,e,n){return Xn(t,e,n).map(function(r){var o=t.create().clone(e);return t.insert().appendAll(o,r.before().concat([n])),t.insert().appendAll(e,r.after()),t.insert().before(e,o),Gn(o,e)})},breakToRight:function(t,e,n){return Xn(t,e,n).map(function(n){var r=t.create().clone(e);return t.insert().appendAll(r,n.after()),t.insert().after(e,r),Gn(e,r)})},breakPath:function(t,e,n,r){var o=function(e,i,u){var c=Yn(e,v.none(),u);return n(e)?Yn(e,i,u):t.property().parent(e).bind(function(i){return r(t,i,e).map(function(t){var e=[{first:t.left,second:t.right}],r=n(i)?i:t.left();return o(r,v.some(t.right()),u.concat(e))})}).getOr(c)};return o(e,v.none(),[])}},tr=Vn(),er={sharedOne:function(t,e){return Zn.sharedOne(tr,function(e,n){return t(n)},e)},subset:function(t,e){return Zn.subset(tr,t,e)},ancestors:function(t,e,n){return Zn.ancestors(tr,t,e,n)},breakToLeft:function(t,e){return Zn.breakToLeft(tr,t,e)},breakToRight:function(t,e){return Zn.breakToRight(tr,t,e)},breakPath:function(t,e,n){return Zn.breakPath(tr,t,e,function(t,e,r){return n(e,r)})}},nr={create:$(["boxes","start","finish"],[])},rr=function(t){return Ue(t,"table")},or=function(t,e,n){var r=function(t){return function(e){return void 0!==n&&n(e)||ue(e,t)}};return ue(t,e)?v.some(nr.create({boxes:v.some([t]),start:t,finish:e})):rr(t).bind(function(o){return rr(e).bind(function(i){if(ue(o,i))return v.some(nr.create({boxes:Hn(o,t,e),start:t,finish:e}));if(ce(o,i)){var u=(c=Le(e,"td,th",r(o))).length>0?c[c.length-1]:e;return v.some(nr.create({boxes:zn(o,t,o,e,i),start:t,finish:u}))}if(ce(i,o)){var c,a=(c=Le(t,"td,th",r(i))).length>0?c[c.length-1]:t;return v.some(nr.create({boxes:zn(i,t,o,e,i),start:t,finish:a}))}return er.ancestors(t,e).shared().bind(function(u){return Ge(u,"table",n).bind(function(n){var u=Le(e,"td,th",r(n)),c=u.length>0?u[u.length-1]:e,a=Le(t,"td,th",r(n)),l=a.length>0?a[a.length-1]:t;return v.some(nr.create({boxes:zn(n,t,o,e,i),start:l,finish:c}))})})})})},ir={identify:or,retrieve:function(t,e){var n=Fe(t,e);return n.length>0?v.some(n):v.none()},shiftSelection:function(t,e,n,r,i){return function(t,e){return I(t,function(t){return oe(t,e)})}(t,i).bind(function(t){return Fn(t,e,n).bind(function(t){return function(t,e){return Ue(t,"table").bind(function(n){return Ve(n,e).bind(function(e){return or(e,t).bind(function(t){return t.boxes().map(function(e){return{boxes:o(e),start:o(t.start()),finish:o(t.finish())}})})})})}(t,r)})})},getEdges:function(t,e,n){return Ve(t,e).bind(function(e){return Ve(t,n).bind(function(t){return er.sharedOne(rr,[e,t]).map(function(n){return{first:o(e),last:o(t),table:o(n)}})})})}},ur=function(t,e){return ir.retrieve(t,e)},cr=function(t,e,n){return ir.getEdges(t,e,n).bind(function(e){var n=function(e){return ue(t,e)},r=Ue(e.first(),"thead,tfoot,tbody,table",n),o=Ue(e.last(),"thead,tfoot,tbody,table",n);return r.bind(function(t){return o.bind(function(n){return ue(t,n)?Un(e.table(),e.first(),e.last()):v.none()})})})},ar="data-mce-selected",lr={selected:o(ar),selectedSelector:o("td[data-mce-selected],th[data-mce-selected]"),attributeSelector:o("[data-mce-selected]"),firstSelected:o("data-mce-first-selected"),firstSelectedSelector:o("td[data-mce-first-selected],th[data-mce-first-selected]"),lastSelected:o("data-mce-last-selected"),lastSelectedSelector:o("td[data-mce-last-selected],th[data-mce-last-selected]")},fr=function(e){if(!y(e))throw new Error("cases must be an array");if(0===e.length)throw new Error("there must be at least one case");var n=[],r={};return E(e,function(o,i){var u=H(o);if(1!==u.length)throw new Error("one and only one name per case");var c=u[0],a=o[c];if(void 0!==r[c])throw new Error("duplicate key detected:"+c);if("cata"===c)throw new Error("cannot have a case named cata (sorry)");if(!y(a))throw new Error("case arguments must be an array");n.push(c),r[c]=function(){var r=arguments.length;if(r!==a.length)throw new Error("Wrong number of arguments to case "+c+". Expected "+a.length+" ("+a+"), got "+r);for(var o=new Array(r),u=0;u<o.length;u++)o[u]=arguments[u];return{fold:function(){if(arguments.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+arguments.length);return arguments[i].apply(null,o)},match:function(t){var e=H(t);if(n.length!==e.length)throw new Error("Wrong number of arguments to match. Expected: "+n.join(",")+"\nActual: "+e.join(","));if(!j(n,function(t){return D(e,t)}))throw new Error("Not all branches were specified when using match. Specified: "+e.join(", ")+"\nRequired: "+n.join(", "));return t[c].apply(null,o)},log:function(e){t.console.log(e,{constructors:n,constructor:c,params:o})}}}}),r},sr=fr([{none:[]},{multiple:["elements"]},{single:["selection"]}]),dr={cata:function(t,e,n,r){return t.fold(e,n,r)},none:sr.none,multiple:sr.multiple,single:sr.single},mr=function(t,e){return dr.cata(e.get(),o([]),i,o([t]))},gr=function(t,e){return dr.cata(e.get(),v.none,function(e,n){return 0===e.length?v.none():cr(t,lr.firstSelectedSelector(),lr.lastSelectedSelector()).bind(function(t){return e.length>1?v.some({bounds:o(t),cells:o(e)}):v.none()})},v.none)},hr=function(t,e){var n=mr(t,e);return n.length>0&&j(n,function(t){return mt(t,"rowspan")&&parseInt(dt(t,"rowspan"),10)>1||mt(t,"colspan")&&parseInt(dt(t,"colspan"),10)>1})?v.some(n):v.none()},pr=mr,vr=function(t){return{element:o(t),mergable:v.none,unmergable:v.none,selection:o([t])}},br=V("element","clipboard","generators"),wr={noMenu:vr,forMenu:function(t,e,n){return{element:o(n),mergable:o(gr(e,t)),unmergable:o(hr(n,t)),selection:o(pr(n,t))}},notCell:function(t){return vr(t)},paste:br,pasteRows:function(t,e,n,r,i){return{element:o(n),mergable:v.none,unmergable:v.none,selection:o(pr(n,t)),clipboard:o(r),generators:o(i)}}},yr={registerEvents:function(e,r,o,i){e.on("BeforeGetContent",function(t){!0===t.selection&&dr.cata(r.get(),n,function(n){t.preventDefault(),function(t){return tn.table(t[0]).map(Cn).map(function(t){return[ln(t,lr.attributeSelector())]})}(n).each(function(n){t.content="text"===t.format?function(t){return A(t,function(t){return t.dom().innerText}).join("")}(n):function(t,e){return A(e,function(e){return t.selection.serializer.serialize(e.dom(),{})}).join("")}(e,n)})},n)}),e.on("BeforeSetContent",function(n){!0===n.selection&&!0===n.paste&&v.from(e.dom.getParent(e.selection.getStart(),"th,td")).each(function(r){var u=yt.fromDom(r);tn.table(u).each(function(r){var c,a,l,f=N((c=n.content,(l=(a||t.document).createElement("div")).innerHTML=c,ge(yt.fromDom(l))),function(t){return"meta"!==nt(t)});if(1===f.length&&"table"===nt(f[0])){n.preventDefault();var s=yt.fromDom(e.getDoc()),d=En(s),m=wr.paste(u,f[0],d);o.pasteCells(r,m).each(function(t){e.selection.setRng(t),e.focus(),i.clear(r)})}})})})}};function xr(t,e){var n=function(n){var r=e(n);if(r<=0||null===r){var o=Ot(n,t);return parseFloat(o)||0}return r},r=function(t,e){return P(e,function(e,n){var r=Ot(t,n),o=void 0===r?0:parseInt(r,10);return isNaN(o)?e:e+o},0)};return{set:function(e,n){if(!S(n)&&!n.match(/^[0-9]+$/))throw new Error(t+".set accepts only positive integer values. Value was "+n);var r=e.dom();vt(r)&&(r.style[t]=n+"px")},get:n,getOuter:n,aggregate:r,max:function(t,e,n){var o=r(t,n);return e>o?e-o:0}}}var Cr=xr("height",function(t){var e=t.dom();return xt(t)?e.getBoundingClientRect().height:e.offsetHeight}),Sr=function(t){return Cr.get(t)},Rr=function(t){return Cr.getOuter(t)},Tr=xr("width",function(t){return t.dom().offsetWidth}),Dr=function(t){return Tr.get(t)},Or=function(t){return Tr.getOuter(t)},Ar=ee.detect(),Er=function(t,e,n){return function(t,e){var n=parseFloat(t);return isNaN(n)?e:n}(Ot(t,e),n)},Nr=function(t){return Ar.browser.isIE()||Ar.browser.isEdge()?function(t){var e=Er(t,"padding-top",0),n=Er(t,"padding-bottom",0),r=Er(t,"border-top-width",0),o=Er(t,"border-bottom-width",0),i=t.dom().getBoundingClientRect().height;return"border-box"===Ot(t,"box-sizing")?i:i-e-n-(r+o)}(t):Er(t,"height",Sr(t))},kr=/(\d+(\.\d+)?)(\w|%)*/,Pr=/(\d+(\.\d+)?)%/,Ir=/(\d+(\.\d+)?)px|em/,Br=function(t,e){Tt(t,"height",e+"px")},Wr=function(t,e,n,r){var o,i,u=parseInt(t,10);return function(t,e,n){return""===e||!(t.length<e.length)&&t.substr(n,n+e.length)===e}(o=t,i="%",o.length-i.length)&&"table"!==nt(e)?function(t,e,n,r){var o=tn.table(t).map(function(t){var r=n(t);return Math.floor(e/100*r)}).getOr(e);return r(t,o),o}(e,u,n,r):u},Mr=function(t){var e=function(t){return Et(t,"height").getOrThunk(function(){return Nr(t)+"px"})}(t);return e?Wr(e,t,Sr,Br):Sr(t)},_r=function(t,e){return mt(t,e)?parseInt(dt(t,e),10):1},Lr=function(t){return Et(t,"width").fold(function(){return v.from(dt(t,"width"))},function(t){return v.some(t)})},jr=function(t,e){return t/e.pixelWidth()*100},Fr={percentageBasedSizeRegex:o(Pr),pixelBasedSizeRegex:o(Ir),setPixelWidth:function(t,e){Tt(t,"width",e+"px")},setPercentageWidth:function(t,e){Tt(t,"width",e+"%")},setHeight:Br,getPixelWidth:function(t,e){return Lr(t).fold(function(){return Dr(t)},function(n){return function(t,e,n){var r=Ir.exec(e);if(null!==r)return parseInt(r[1],10);var o=Pr.exec(e);return null!==o?function(t,e){return t/100*e.pixelWidth()}(parseFloat(o[1]),n):Dr(t)}(t,n,e)})},getPercentageWidth:function(t,e){return Lr(t).fold(function(){var n=Dr(t);return jr(n,e)},function(n){return function(t,e,n){var r=Pr.exec(e);if(null!==r)return parseFloat(r[1]);var o=Dr(t);return jr(o,n)}(t,n,e)})},getGenericWidth:function(t){return Lr(t).bind(function(t){var e=kr.exec(t);return null!==e?v.some({width:o(parseFloat(e[1])),unit:o(e[3])}):v.none()})},setGenericWidth:function(t,e,n){Tt(t,"width",e+n)},getHeight:function(t){return function(t,e,n){return n(t)/_r(t,e)}(t,"rowspan",Mr)},getRawWidth:Lr},Hr=function(t,e){Fr.getGenericWidth(t).each(function(n){var r=n.width()/2;Fr.setGenericWidth(t,r,n.unit()),Fr.setGenericWidth(e,r,n.unit())})},zr=function(t,e){return{left:o(t),top:o(e),translate:function(n,r){return zr(t+n,e+r)}}},Ur=zr,qr=function(t,e){return void 0!==t?t:void 0!==e?e:0},Vr=function(e){var n=e.dom().ownerDocument,r=n.body,o=function(e){var n=e.dom();return n===n.window&&e instanceof t.Window?e:at(e)?n.defaultView||n.parentWindow:null}(yt.fromDom(n)),i=n.documentElement,u=qr(o.pageYOffset,i.scrollTop),c=qr(o.pageXOffset,i.scrollLeft),a=qr(i.clientTop,r.clientTop),l=qr(i.clientLeft,r.clientLeft);return Gr(e).translate(c-l,u-a)},Gr=function(e){var n=e.dom(),r=n.ownerDocument,o=r.body,i=yt.fromDom(r.documentElement);return o===n?Ur(o.offsetLeft,o.offsetTop):function(e,n){var r=n||yt.fromDom(t.document.documentElement);return ze(e,u(ue,r)).isSome()}(e,i)?function(t){var e=t.getBoundingClientRect();return Ur(e.left,e.top)}(n):Ur(0,0)},Yr=V("row","y"),Xr=V("col","x"),Kr=function(t){return Vr(t).left()+Or(t)},Jr=function(t){return Vr(t).left()},$r=function(t,e){return Xr(t,Jr(e))},Qr=function(t,e){return Xr(t,Kr(e))},Zr=function(t){return Vr(t).top()},to=function(t,e){return Yr(t,Zr(e))},eo=function(t,e){return Yr(t,Zr(e)+Rr(e))},no=function(t,e,n){if(0===n.length)return[];var r=A(n.slice(1),function(e,n){return e.map(function(e){return t(n,e)})}),o=n[n.length-1].map(function(t){return e(n.length-1,t)});return r.concat([o])},ro={height:{delta:i,positions:function(t){return no(to,eo,t)},edge:Zr},rtl:{delta:function(t){return-t},edge:Kr,positions:function(t){return no(Qr,$r,t)}},ltr:{delta:i,edge:Jr,positions:function(t){return no($r,Qr,t)}}},oo={ltr:ro.ltr,rtl:ro.rtl};function io(t){var e=function(e){return t(e).isRtl()?oo.rtl:oo.ltr};return{delta:function(t,n){return e(n).delta(t,n)},edge:function(t){return e(t).edge(t)},positions:function(t,n){return e(n).positions(t,n)}}}var uo=function(t){var e=en(t);return un.generate(e).grid()},co=function(){return(co=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},ao=function(t){for(var e=[],n=function(t){e.push(t)},r=0;r<t.length;r++)t[r].each(n);return e},lo=function(t,e){for(var n=0;n<t.length;n++){var r=e(t[n],n);if(r.isSome())return r}return v.none()},fo=function(t,e,n,r){n===r?gt(t,e):ft(t,e,n)},so=function(t,e){var n=[],r=[],i=function(e,o){e.length>0?function(e,o){var i=qe(t,o).getOrThunk(function(){var e=yt.fromTag(o,le(t).dom());return we(t,e),e});Se(i);var u=A(e,function(t){t.isNew()&&n.push(t.element());var e=t.element();return Se(e),E(t.cells(),function(t){t.isNew()&&r.push(t.element()),fo(t.element(),"colspan",t.colspan(),1),fo(t.element(),"rowspan",t.rowspan(),1),we(e,t.element())}),e});Ce(i,u)}(e,o):function(e){qe(t,e).each(Re)}(o)},u=[],c=[],a=[];return E(e,function(t){switch(t.section()){case"thead":u.push(t);break;case"tbody":c.push(t);break;case"tfoot":a.push(t)}}),i(u,"thead"),i(c,"tbody"),i(a,"tfoot"),{newRows:o(n),newCells:o(r)}},mo=function(t){return A(t,function(t){var e=xn(t.element());return E(t.cells(),function(t){var n=Cn(t.element());fo(n,"colspan",t.colspan(),1),fo(n,"rowspan",t.rowspan(),1),we(e,n)}),e})},go=function(t,e){var n=dt(t,e);return void 0===n||""===n?[]:n.split(" ")},ho=function(t){return void 0!==t.dom().classList},po=function(t,e){return function(t,e,n){var r=go(t,e).concat([n]);return ft(t,e,r.join(" ")),!0}(t,"class",e)},vo=function(t,e){return function(t,e,n){var r=N(go(t,e),function(t){return t!==n});return r.length>0?ft(t,e,r.join(" ")):gt(t,e),!1}(t,"class",e)},bo=function(t,e){ho(t)?t.dom().classList.add(e):po(t,e)},wo=function(t){0===(ho(t)?t.dom().classList:function(t){return go(t,"class")}(t)).length&&gt(t,"class")},yo=function(t,e){return ho(t)&&t.dom().classList.contains(e)},xo=function(t,e){for(var n=[],r=t;r<e;r++)n.push(r);return n},Co=function(t,e){if(e<0||e>=t.length-1)return v.none();var n=t[e].fold(function(){var n=F(t.slice(0,e));return lo(n,function(t,e){return t.map(function(t){return{value:t,delta:e+1}})})},function(t){return v.some({value:t,delta:0})}),r=t[e+1].fold(function(){var n=t.slice(e+1);return lo(n,function(t,e){return t.map(function(t){return{value:t,delta:e+1}})})},function(t){return v.some({value:t,delta:1})});return n.bind(function(t){return r.map(function(e){var n=e.delta+t.delta;return Math.abs(e.value-t.value)/n})})},So=function(t,e,n){var r=t();return I(r,e).orThunk(function(){return v.from(r[0]).orThunk(n)}).map(function(t){return t.element()})},Ro=function(t){var e=t.grid(),n=xo(0,e.columns()),r=xo(0,e.rows());return A(n,function(e){return So(function(){return L(r,function(n){return un.getAt(t,n,e).filter(function(t){return t.column()===e}).fold(o([]),function(t){return[t]})})},function(t){return 1===t.colspan()},function(){return un.getAt(t,0,e)})})},To=function(t){var e=t.grid(),n=xo(0,e.rows()),r=xo(0,e.columns());return A(n,function(e){return So(function(){return L(r,function(n){return un.getAt(t,e,n).filter(function(t){return t.row()===e}).fold(o([]),function(t){return[t]})})},function(t){return 1===t.rowspan()},function(){return un.getAt(t,e,0)})})},Do=function(t){var e=t.replace(/\./g,"-");return{resolve:function(t){return e+"-"+t}}},Oo=Do("ephox-snooker"),Ao={resolve:Oo.resolve},Eo=function(t,e,n,r,o){var i=yt.fromTag("div");return Dt(i,{position:"absolute",left:e-r/2+"px",top:n+"px",height:o+"px",width:r+"px"}),st(i,{"data-column":t,role:"presentation"}),i},No=function(t,e,n,r,o){var i=yt.fromTag("div");return Dt(i,{position:"absolute",left:e+"px",top:n-o/2+"px",height:o+"px",width:r+"px"}),st(i,{"data-row":t,role:"presentation"}),i},ko=Ao.resolve("resizer-bar"),Po=Ao.resolve("resizer-rows"),Io=Ao.resolve("resizer-cols"),Bo=function(t){var e=Fe(t.parent(),"."+ko);E(e,Re)},Wo=function(t,e,n){var r=t.origin();E(e,function(e,o){e.each(function(e){var o=n(r,e);bo(o,ko),we(t.parent(),o)})})},Mo=function(t,e,n,r,o,i){var u=Vr(e);!function(t,e,n,r){Wo(t,e,function(t,e){var o=No(e.row(),n.left()-t.left(),e.y()-t.top(),r,7);return bo(o,Po),o})}(t,n.length>0?o.positions(n,e):[],u,Or(e)),function(t,e,n,r){Wo(t,e,function(t,e){var o=Eo(e.col(),e.x()-t.left(),n.top()-t.top(),7,r);return bo(o,Io),o})}(t,r.length>0?i.positions(r,e):[],u,Rr(e))},_o=function(t,e){var n=Fe(t.parent(),"."+ko);E(n,e)},Lo=function(t,e,n,r){Bo(t);var o=en(e),i=un.generate(o),u=To(i),c=Ro(i);Mo(t,e,u,c,n,r)},jo=function(t){_o(t,function(t){Tt(t,"display","none")})},Fo=function(t){_o(t,function(t){Tt(t,"display","block")})},Ho=Bo,zo=function(t){return yo(t,Po)},Uo=function(t){return yo(t,Io)},qo=function(t,e){return Be(e,t.section())},Vo=function(t,e){return t.cells()[e]},Go={addCell:function(t,e,n){var r=t.cells(),o=r.slice(0,e),i=r.slice(e),u=o.concat([n]).concat(i);return qo(t,u)},setCells:qo,mutateCell:function(t,e,n){t.cells()[e]=n},getCell:Vo,getCellElement:function(t,e){return Vo(t,e).element()},mapCells:function(t,e){var n=t.cells(),r=A(n,e);return Be(r,t.section())},cellLength:function(t){return t.cells().length}},Yo=function(t,e){if(0===t.length)return 0;var n=t[0];return B(t,function(t){return!e(n.element(),t.element())}).fold(function(){return t.length},function(t){return t})},Xo=function(t,e,n,r){var i=function(t,e){return t[e]}(t,e).cells().slice(n),u=Yo(i,r),c=function(t,e){return A(t,function(t){return Go.getCell(t,e)})}(t,n).slice(e),a=Yo(c,r);return{colspan:o(u),rowspan:o(a)}},Ko=function(t,e){var n=A(t,function(t,e){return A(t.cells(),function(t,e){return!1})});return A(t,function(r,o){var i=L(r.cells(),function(r,i){if(!1===n[o][i]){var u=Xo(t,o,i,e);return function(t,e,r,o){for(var i=t;i<t+r;i++)for(var u=e;u<e+o;u++)n[i][u]=!0}(o,i,u.rowspan(),u.colspan()),[Ee(r.element(),u.rowspan(),u.colspan(),r.isNew())]}return[]});return We(i,r.section())})},Jo=function(t,e,n){for(var r=[],o=0;o<t.grid().rows();o++){for(var i=[],u=0;u<t.grid().columns();u++){var c=un.getAt(t,o,u).map(function(t){return Pe(t.element(),n)}).getOrThunk(function(){return Pe(e.gap(),!0)});i.push(c)}var a=Be(i,t.all()[o].section());r.push(a)}return r},$o=function(t,e){return A(t,function(t){var n=function(t){return lo(t,function(t){return fe(t.element()).map(function(t){var e=fe(t).isNone();return Pe(t,e)})}).getOrThunk(function(){return Pe(e.row(),!0)})}(t.details());return Ie(n.element(),t.details(),t.section(),n.isNew())})},Qo=function(t,e){var n=Ko(t,ue);return $o(n,e)},Zo=function(t,e){var n=_(A(t.all(),function(t){return t.cells()}));return I(n,function(t){return ue(e,t.element())})},ti=function(t,e,n,r,i){return function(u,c,a,l,f){var s=en(c),d=un.generate(s);return e(d,a).map(function(e){var n=function(t,e){return Jo(t,e,!1)}(d,l),r=t(n,e,ue,i(l)),u=Qo(r.grid(),l);return{grid:o(u),cursor:r.cursor}}).fold(function(){return v.none()},function(t){var e=so(c,t.grid());return n(c,t.grid(),f),r(c),Lo(u,c,ro.height,f),v.some({cursor:t.cursor,newRows:e.newRows,newCells:e.newCells})})}},ei=function(t,e){return tn.cell(e.element()).bind(function(e){return Zo(t,e)})},ni=function(t,e){var n=A(e.selection(),function(e){return tn.cell(e).bind(function(e){return Zo(t,e)})}),r=ao(n);return r.length>0?v.some({cells:r,generators:e.generators,clipboard:e.clipboard}):v.none()},ri=function(t,e){var n=A(e.selection(),function(e){return tn.cell(e).bind(function(e){return Zo(t,e)})}),r=ao(n);return r.length>0?v.some(r):v.none()},oi=function(t){return{is:function(e){return t===e},isValue:s,isError:f,getOr:o(t),getOrThunk:o(t),getOrDie:o(t),or:function(e){return oi(t)},orThunk:function(e){return oi(t)},fold:function(e,n){return n(t)},map:function(e){return oi(e(t))},mapError:function(e){return oi(t)},each:function(e){e(t)},bind:function(e){return e(t)},exists:function(e){return e(t)},forall:function(e){return e(t)},toOption:function(){return v.some(t)}}},ii=function(t){return{is:f,isValue:f,isError:s,getOr:i,getOrThunk:function(t){return t()},getOrDie:function(){return(e=String(t),function(){throw new Error(e)})();var e},or:function(t){return t},orThunk:function(t){return t()},fold:function(e,n){return e(t)},map:function(e){return ii(t)},mapError:function(e){return ii(e(t))},each:n,bind:function(e){return ii(t)},exists:f,forall:s,toOption:v.none}},ui={value:oi,error:ii,fromOption:function(t,e){return t.fold(function(){return ii(e)},oi)}},ci=function(t,e){return A(t,function(){return Pe(e.cell(),!0)})},ai=function(t,e,n){return t.concat(function(t,e){for(var n=[],r=0;r<t;r++)n.push(e(r));return n}(e,function(e){return Go.setCells(t[t.length-1],ci(t[t.length-1].cells(),n))}))},li=function(t,e,n){return A(t,function(t){return Go.setCells(t,t.cells().concat(ci(xo(0,e),n)))})},fi=function(t,e,n){if(t.row()>=e.length||t.column()>Go.cellLength(e[0]))return ui.error("invalid start address out of table bounds, row: "+t.row()+", column: "+t.column());var r=e.slice(t.row()),i=r[0].cells().slice(t.column()),u=Go.cellLength(n[0]),c=n.length;return ui.value({rowDelta:o(r.length-c),colDelta:o(i.length-u)})},si=function(t,e){var n=Go.cellLength(t[0]),r=Go.cellLength(e[0]);return{rowDelta:o(0),colDelta:o(n-r)}},di=function(t,e,n){var r=e.colDelta()<0?li:i;return(e.rowDelta()<0?ai:i)(r(t,Math.abs(e.colDelta()),n),Math.abs(e.rowDelta()),n)},mi=function(t,e,n,r){if(0===t.length)return t;for(var o=e.startRow();o<=e.finishRow();o++)for(var i=e.startCol();i<=e.finishCol();i++)Go.mutateCell(t[o],i,Pe(r(),!1));return t},gi=function(t,e,n,r){for(var o=!0,i=0;i<t.length;i++)for(var u=0;u<Go.cellLength(t[0]);u++){var c=n(Go.getCellElement(t[i],u),e);!0===c&&!1===o?Go.mutateCell(t[i],u,Pe(r(),!0)):!0===c&&(o=!1)}return t},hi=function(t,e,n,r){if(e>0&&e<t.length){var o=function(t,e){return P(t,function(t,n){return O(t,function(t){return e(t.element(),n.element())})?t:t.concat([n])},[])}(t[e-1].cells(),n);E(o,function(o){for(var i=v.none(),u=function(e){for(var u=function(u){var c=t[e].cells()[u];n(c.element(),o.element())&&(i.isNone()&&(i=v.some(r())),i.each(function(n){Go.mutateCell(t[e],u,Pe(n,!0))}))},c=0;c<Go.cellLength(t[0]);c++)u(c)},c=e;c<t.length;c++)u(c)})}return t},pi=function(t,e,n,r){var o=u(r,Go.getCell(t[e],n).element()),i=t[e];return t.length>1&&Go.cellLength(i)>1&&(n>0&&o(Go.getCellElement(i,n-1))||n<i.cells().length-1&&o(Go.getCellElement(i,n+1))||e>0&&o(Go.getCellElement(t[e-1],n))||e<t.length-1&&o(Go.getCellElement(t[e+1],n)))},vi=function(t,e,n,r,o){return fi(t,e,n).map(function(i){var u=di(e,i,r);return function(t,e,n,r,o){for(var i=t.row(),u=t.column(),c=i+n.length,a=u+Go.cellLength(n[0]),l=i;l<c;l++)for(var f=u;f<a;f++){pi(e,l,f,o)&&gi(e,Go.getCellElement(e[l],f),o,r.cell);var s=Go.getCellElement(n[l-i],f-u),d=r.replace(s);Go.mutateCell(e[l],f,Pe(d,!0))}return e}(t,u,n,r,o)})},bi=function(t,e,n,r,o){hi(e,t,o,r.cell);var i=si(n,e),u=di(n,i,r),c=si(e,u),a=di(e,c,r);return a.slice(0,t).concat(u).concat(a.slice(t,a.length))},wi=function(t,e,n,r,o){var i=t.slice(0,e),u=t.slice(e),c=Go.mapCells(t[n],function(n,i){return e>0&&e<t.length&&r(Go.getCellElement(t[e-1],i),Go.getCellElement(t[e],i))?Go.getCell(t[e],i):Pe(o(n.element(),r),!0)});return i.concat([c]).concat(u)},yi=function(t,e,n,r,o){return A(t,function(t){var i=e>0&&e<Go.cellLength(t)&&r(Go.getCellElement(t,e-1),Go.getCellElement(t,e))?Go.getCell(t,e):Pe(o(Go.getCellElement(t,n),r),!0);return Go.addCell(t,e,i)})},xi=function(t,e,n,r,o){var i=n+1;return A(t,function(t,u){var c=u===e?Pe(o(Go.getCellElement(t,n),r),!0):Go.getCell(t,n);return Go.addCell(t,i,c)})},Ci=function(t,e,n,r,o){var i=e+1,u=t.slice(0,i),c=t.slice(i),a=Go.mapCells(t[e],function(t,e){return e===n?Pe(o(t.element(),r),!0):t});return u.concat([a]).concat(c)},Si=function(t,e,n){return t.slice(0,e).concat(t.slice(n+1))},Ri=function(t,e,n){var r=A(t,function(t){var r=t.cells().slice(0,e).concat(t.cells().slice(n+1));return Be(r,t.section())});return N(r,function(t){return t.cells().length>0})},Ti=function(t,e,n,r){return A(t,function(t){return Go.mapCells(t,function(t){return function(t){return O(e,function(e){return n(t.element(),e.element())})}(t)?Pe(r(t.element(),n),!0):t})})},Di=function(t,e,n,r){return void 0!==Go.getCellElement(t[e],n)&&e>0&&r(Go.getCellElement(t[e-1],n),Go.getCellElement(t[e],n))},Oi=function(t,e,n){return e>0&&n(Go.getCellElement(t,e-1),Go.getCellElement(t,e))},Ai=function(t,e,n,r){var o=L(t,function(r,o){return Di(t,o,e,n)||Oi(r,e,n)?[]:[Go.getCell(r,e)]});return Ti(t,o,n,r)},Ei=function(t,e,n,r){var o=t[e],i=L(o.cells(),function(r,i){return Di(t,e,i,n)||Oi(o,i,n)?[]:[r]});return Ti(t,i,n,r)},Ni=fr([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}]),ki=co({},Ni),Pi=function(t,e,n,r){var i=t.slice(0),u=function(t,e){return 0===t.length?ki.none():1===t.length?ki.only(0):0===e?ki.left(0,1):e===t.length-1?ki.right(e-1,e):e>0&&e<t.length-1?ki.middle(e-1,e,e+1):ki.none()}(t,e),c=function(t){return A(t,o(0))},a=o(c(i)),l=function(t,e){if(n>=0){var o=Math.max(r.minCellWidth(),i[e]-n);return c(i.slice(0,t)).concat([n,o-i[e]]).concat(c(i.slice(e+1)))}var u=Math.max(r.minCellWidth(),i[t]+n),a=i[t]-u;return c(i.slice(0,t)).concat([u-i[t],a]).concat(c(i.slice(e+1)))},f=l;return u.fold(a,function(t){return r.singleColumnWidth(i[t],n)},f,function(t,e,n){return l(e,n)},function(t,e){if(n>=0)return c(i.slice(0,e)).concat([n]);var o=Math.max(r.minCellWidth(),i[e]+n);return c(i.slice(0,e)).concat([o-i[e]])})},Ii=function(t,e){return mt(t,e)&&parseInt(dt(t,e),10)>1},Bi={hasColspan:function(t){return Ii(t,"colspan")},hasRowspan:function(t){return Ii(t,"rowspan")},minWidth:o(10),minHeight:o(10),getInt:function(t,e){return parseInt(Ot(t,e),10)}},Wi=function(t,e,n){return Et(t,e).fold(function(){return n(t)+"px"},function(t){return t})},Mi=function(t,e){return Wi(t,"width",function(t){return Fr.getPixelWidth(t,e)})},_i=function(t){return Wi(t,"height",Fr.getHeight)},Li=function(t,e,n,r,o){var i=Ro(t),u=A(i,function(t){return t.map(e.edge)});return A(i,function(t,e){return t.filter(a(Bi.hasColspan)).fold(function(){var t=Co(u,e);return r(t)},function(t){return n(t,o)})})},ji=function(t){return t.map(function(t){return t+"px"}).getOr("")},Fi=function(t,e,n,r){var o=To(t),i=A(o,function(t){return t.map(e.edge)});return A(o,function(t,e){return t.filter(a(Bi.hasRowspan)).fold(function(){var t=Co(i,e);return r(t)},function(t){return n(t)})})},Hi={getRawWidths:function(t,e,n){return Li(t,e,Mi,ji,n)},getPixelWidths:function(t,e,n){return Li(t,e,Fr.getPixelWidth,function(t){return t.getOrThunk(n.minCellWidth)},n)},getPercentageWidths:function(t,e,n){return Li(t,e,Fr.getPercentageWidth,function(t){return t.fold(function(){return n.minCellWidth()},function(t){return t/n.pixelWidth()*100})},n)},getPixelHeights:function(t,e){return Fi(t,e,Fr.getHeight,function(t){return t.getOrThunk(Bi.minHeight)})},getRawHeights:function(t,e){return Fi(t,e,_i,ji)}},zi=function(t,e,n){for(var r=0,o=t;o<e;o++)r+=void 0!==n[o]?n[o]:0;return r},Ui=function(t,e){var n=un.justCells(t);return A(n,function(t){var n=zi(t.column(),t.column()+t.colspan(),e);return{element:t.element,width:o(n),colspan:t.colspan}})},qi=function(t,e){var n=un.justCells(t);return A(n,function(t){var n=zi(t.row(),t.row()+t.rowspan(),e);return{element:t.element,height:o(n),rowspan:t.rowspan}})},Vi=function(t,e){return A(t.all(),function(t,n){return{element:t.element,height:o(e[n])}})},Gi=function(t){var e=i;return{width:o(t),pixelWidth:o(t),getWidths:Hi.getPixelWidths,getCellDelta:e,singleColumnWidth:function(t,e){return[Math.max(Bi.minWidth(),t+e)-t]},minCellWidth:Bi.minWidth,setElementWidth:Fr.setPixelWidth,setTableWidth:function(t,e,n){var r=k(e,function(t,e){return t+e},0);Fr.setPixelWidth(t,r)}}},Yi=function(t,e){var n=Fr.percentageBasedSizeRegex().exec(e);if(null!==n)return function(t,e){var n=parseFloat(t),r=Dr(e);return{width:o(n),pixelWidth:o(r),getWidths:Hi.getPercentageWidths,getCellDelta:function(t){return t/r*100},singleColumnWidth:function(t,e){return[100-t]},minCellWidth:function(){return Bi.minWidth()/r*100},setElementWidth:Fr.setPercentageWidth,setTableWidth:function(t,e,r){var o=r/100*n;Fr.setPercentageWidth(t,n+o)}}}(n[1],t);var r=Fr.pixelBasedSizeRegex().exec(e);if(null!==r){var i=parseInt(r[1],10);return Gi(i)}var u=Dr(t);return Gi(u)},Xi=function(t){return Fr.getRawWidth(t).fold(function(){var e=Dr(t);return Gi(e)},function(e){return Yi(t,e)})},Ki=function(t){return un.generate(t)},Ji=function(t){var e=en(t);return Ki(e)},$i={adjustWidth:function(t,e,n,r){var o=Xi(t),i=o.getCellDelta(e),u=Ji(t),c=o.getWidths(u,r,o),a=Pi(c,n,i,o),l=A(a,function(t,e){return t+c[e]}),f=Ui(u,l);E(f,function(t){o.setElementWidth(t.element(),t.width())}),n===u.grid().columns()-1&&o.setTableWidth(t,l,i)},adjustHeight:function(t,e,n,r){var o=Ji(t),i=Hi.getPixelHeights(o,r),u=A(i,function(t,r){return n===r?Math.max(e+t,Bi.minHeight()):t}),c=qi(o,u),a=Vi(o,u);E(a,function(t){Fr.setHeight(t.element(),t.height())}),E(c,function(t){Fr.setHeight(t.element(),t.height())});var l=k(u,function(t,e){return t+e},0);Fr.setHeight(t,l)},adjustWidthTo:function(t,e,n){var r=Xi(t),o=Ki(e),i=r.getWidths(o,n,r),u=Ui(o,i);E(u,function(t){r.setElementWidth(t.element(),t.width())}),u.length>0&&r.setTableWidth(t,i,r.getCellDelta(0))}},Qi=function(t){var e=t,n=function(){return e};return{get:n,set:function(t){e=t},clone:function(){return Qi(n())}}},Zi=function(t,e,n){if(0===e.length)throw new Error("You must specify at least one required field.");return K("required",e),J(e),function(r){var o=H(r);j(e,function(t){return D(o,t)})||Y(e,o),t(e,o);var i=N(e,function(t){return!n.validate(r[t],t)});return i.length>0&&function(t,e){throw new Error("All values need to be of type: "+e+". Keys ("+G(t).join(", ")+") were not.")}(i,n.label),r}},tu=function(t,e){var n=N(e,function(e){return!D(t,e)});n.length>0&&X(n)},eu=function(t){return function(t,e){return Zi(t,e,{validate:C,label:"function"})}(tu,t)},nu=eu(["cell","row","replace","gap"]),ru=function(t){var e=mt(t,"colspan")?parseInt(dt(t,"colspan"),10):1,n=mt(t,"rowspan")?parseInt(dt(t,"rowspan"),10):1;return{element:o(t),colspan:o(e),rowspan:o(n)}},ou=function(t,e){void 0===e&&(e=ru),nu(t);var n=Qi(v.none()),r=function(n){return function(e){return t.cell(e)}(e(n))},o=function(t){var e=r(t);return n.get().isNone()&&n.set(v.some(e)),i=v.some({item:t,replacement:e}),e},i=v.none();return{getOrInit:function(t,e){return i.fold(function(){return o(t)},function(n){return e(t,n.item)?n.replacement:o(t)})},cursor:n.get}},iu=function(t,e){return function(n){var r=Qi(v.none());nu(n);var o=[],i=function(i){var u={scope:t},c=n.replace(i,e,u);return o.push({item:i,sub:c}),r.get().isNone()&&r.set(v.some(c)),c};return{replaceOrInit:function(t,e){return function(t,e){return I(o,function(n){return e(n.item,t)})}(t,e).fold(function(){return i(t)},function(n){return e(t,n.item)?n.sub:i(t)})},cursor:r.get}}},uu=function(t){nu(t);var e=Qi(v.none());return{combine:function(n){return e.get().isNone()&&e.set(v.some(n)),function(){var e=t.cell({element:o(n),colspan:o(1),rowspan:o(1)});return Nt(e,"width"),Nt(n,"width"),e}},cursor:e.get}},cu=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],au=function(t,e){var n=t.property().name(e);return D(cu,n)},lu=function(t,e){return D(["br","img","hr","input"],t.property().name(e))},fu=au,su=function(t,e){var n=t.property().name(e);return D(["ol","ul"],n)},du=lu,mu=Vn(),gu=function(t){return fu(mu,t)},hu=function(t){return su(mu,t)},pu=function(t){return du(mu,t)},vu=function(t){var e,n=function(t){return"br"===nt(t)},r=function(t){return bn(t).bind(function(e){var r=me(e).map(function(t){return!!gu(t)||!!pu(t)&&"img"!==nt(t)}).getOr(!1);return fe(e).map(function(o){return!0===r||"li"===nt(i=o)||ze(i,hu).isSome()||n(e)||gu(o)&&!ue(t,o)?[]:[yt.fromTag("br")];var i})}).getOr([])},o=0===(e=L(t,function(t){var e=ge(t);return function(t){return j(t,function(t){return n(t)||ct(t)&&0===sn(t).trim().length})}(e)?[]:e.concat(r(t))})).length?[yt.fromTag("br")]:e;Se(t[0]),Ce(t[0],o)},bu=function(t){0===tn.cells(t).length&&Re(t)},wu=V("grid","cursor"),yu=function(t,e,n){return xu(t,e,n).orThunk(function(){return xu(t,0,0)})},xu=function(t,e,n){return v.from(t[e]).bind(function(t){return v.from(t.cells()[n]).bind(function(t){return v.from(t.element())})})},Cu=function(t,e,n){return wu(t,xu(t,e,n))},Su=function(t){return P(t,function(t,e){return O(t,function(t){return t.row()===e.row()})?t:t.concat([e])},[]).sort(function(t,e){return t.row()-e.row()})},Ru=function(t){return P(t,function(t,e){return O(t,function(t){return t.column()===e.column()})?t:t.concat([e])},[]).sort(function(t,e){return t.column()-e.column()})},Tu=function(t,e,n){var r=nn(t,n),o=un.generate(r);return Jo(o,e,!0)},Du=$i.adjustWidthTo,Ou={insertRowBefore:ti(function(t,e,n,r){var o=e.row(),i=e.row(),u=wi(t,i,o,n,r.getOrInit);return Cu(u,i,e.column())},ei,n,n,ou),insertRowsBefore:ti(function(t,e,n,r){var o=e[0].row(),i=e[0].row(),u=Su(e),c=P(u,function(t,e){return wi(t,i,o,n,r.getOrInit)},t);return Cu(c,i,e[0].column())},ri,n,n,ou),insertRowAfter:ti(function(t,e,n,r){var o=e.row(),i=e.row()+e.rowspan(),u=wi(t,i,o,n,r.getOrInit);return Cu(u,i,e.column())},ei,n,n,ou),insertRowsAfter:ti(function(t,e,n,r){var o=Su(e),i=o[o.length-1].row(),u=o[o.length-1].row()+o[o.length-1].rowspan(),c=P(o,function(t,e){return wi(t,u,i,n,r.getOrInit)},t);return Cu(c,u,e[0].column())},ri,n,n,ou),insertColumnBefore:ti(function(t,e,n,r){var o=e.column(),i=e.column(),u=yi(t,i,o,n,r.getOrInit);return Cu(u,e.row(),i)},ei,Du,n,ou),insertColumnsBefore:ti(function(t,e,n,r){var o=Ru(e),i=o[0].column(),u=o[0].column(),c=P(o,function(t,e){return yi(t,u,i,n,r.getOrInit)},t);return Cu(c,e[0].row(),u)},ri,Du,n,ou),insertColumnAfter:ti(function(t,e,n,r){var o=e.column(),i=e.column()+e.colspan(),u=yi(t,i,o,n,r.getOrInit);return Cu(u,e.row(),i)},ei,Du,n,ou),insertColumnsAfter:ti(function(t,e,n,r){var o=e[e.length-1].column(),i=e[e.length-1].column()+e[e.length-1].colspan(),u=Ru(e),c=P(u,function(t,e){return yi(t,i,o,n,r.getOrInit)},t);return Cu(c,e[0].row(),i)},ri,Du,n,ou),splitCellIntoColumns:ti(function(t,e,n,r){var o=xi(t,e.row(),e.column(),n,r.getOrInit);return Cu(o,e.row(),e.column())},ei,Du,n,ou),splitCellIntoRows:ti(function(t,e,n,r){var o=Ci(t,e.row(),e.column(),n,r.getOrInit);return Cu(o,e.row(),e.column())},ei,n,n,ou),eraseColumns:ti(function(t,e,n,r){var o=Ru(e),i=Ri(t,o[0].column(),o[o.length-1].column()),u=yu(i,e[0].row(),e[0].column());return wu(i,u)},ri,Du,bu,ou),eraseRows:ti(function(t,e,n,r){var o=Su(e),i=Si(t,o[0].row(),o[o.length-1].row()),u=yu(i,e[0].row(),e[0].column());return wu(i,u)},ri,n,bu,ou),makeColumnHeader:ti(function(t,e,n,r){var o=Ai(t,e.column(),n,r.replaceOrInit);return Cu(o,e.row(),e.column())},ei,n,n,iu("row","th")),unmakeColumnHeader:ti(function(t,e,n,r){var o=Ai(t,e.column(),n,r.replaceOrInit);return Cu(o,e.row(),e.column())},ei,n,n,iu(null,"td")),makeRowHeader:ti(function(t,e,n,r){var o=Ei(t,e.row(),n,r.replaceOrInit);return Cu(o,e.row(),e.column())},ei,n,n,iu("col","th")),unmakeRowHeader:ti(function(t,e,n,r){var o=Ei(t,e.row(),n,r.replaceOrInit);return Cu(o,e.row(),e.column())},ei,n,n,iu(null,"td")),mergeCells:ti(function(t,e,n,r){var i=e.cells();vu(i);var u=mi(t,e.bounds(),n,o(i[0]));return wu(u,v.from(i[0]))},function(t,e){return e.mergable()},n,n,uu),unmergeCells:ti(function(t,e,n,r){var o=k(e,function(t,e){return gi(t,e,n,r.combine(e))},t);return wu(o,v.from(e[0]))},function(t,e){return e.unmergable()},Du,n,uu),pasteCells:ti(function(t,e,n,r){var o,i,u,c,a=(o=e.clipboard(),i=e.generators(),u=en(o),c=un.generate(u),Jo(c,i,!0)),l=Oe(e.row(),e.column());return vi(l,t,a,e.generators(),n).fold(function(){return wu(t,v.some(e.element()))},function(t){var n=yu(t,e.row(),e.column());return wu(t,n)})},function(t,e){return tn.cell(e.element()).bind(function(n){return Zo(t,n).map(function(t){return co({},t,{generators:e.generators,clipboard:e.clipboard})})})},Du,n,ou),pasteRowsBefore:ti(function(t,e,n,r){var o=t[e.cells[0].row()],i=e.cells[0].row(),u=Tu(e.clipboard(),e.generators(),o),c=bi(i,t,u,e.generators(),n),a=yu(c,e.cells[0].row(),e.cells[0].column());return wu(c,a)},ni,n,n,ou),pasteRowsAfter:ti(function(t,e,n,r){var o=t[e.cells[0].row()],i=e.cells[e.cells.length-1].row()+e.cells[e.cells.length-1].rowspan(),u=Tu(e.clipboard(),e.generators(),o),c=bi(i,t,u,e.generators(),n),a=yu(c,e.cells[0].row(),e.cells[0].column());return wu(c,a)},ni,n,n,ou)},Au=function(t){return yt.fromDom(t.getBody())},Eu=function(t){return t.getBoundingClientRect().width},Nu=function(t){return t.getBoundingClientRect().height},ku=function(t){return function(e){return ue(e,Au(t))}},Pu=function(t){return/^[0-9]+$/.test(t)&&(t+="px"),t},Iu=function(t){var e=Fe(t,"td[data-mce-style],th[data-mce-style]");gt(t,"data-mce-style"),E(e,function(t){gt(t,"data-mce-style")})},Bu={isRtl:o(!1)},Wu={isRtl:o(!0)},Mu={directionAt:function(t){return"rtl"===function(t){return"rtl"===Ot(t,"direction")?"rtl":"ltr"}(t)?Wu:Bu}},_u=["tableprops","tabledelete","|","tableinsertrowbefore","tableinsertrowafter","tabledeleterow","|","tableinsertcolbefore","tableinsertcolafter","tabledeletecol"],Lu={"border-collapse":"collapse",width:"100%"},ju={border:"1"},Fu=function(t){return t.getParam("table_default_attributes",ju,"object")},Hu=function(t){return t.getParam("table_default_styles",Lu,"object")},zu=function(t){return t.getParam("table_tab_navigation",!0,"boolean")},Uu=function(t){return t.getParam("table_cell_advtab",!0,"boolean")},qu=function(t){return t.getParam("table_row_advtab",!0,"boolean")},Vu=function(t){return t.getParam("table_advtab",!0,"boolean")},Gu=function(t){return t.getParam("table_appearance_options",!0,"boolean")},Yu=function(t){return t.getParam("table_style_by_css",!1,"boolean")},Xu=function(t){return t.getParam("table_cell_class_list",[],"array")},Ku=function(t){return t.getParam("table_row_class_list",[],"array")},Ju=function(t){return t.getParam("table_class_list",[],"array")},$u=function(t){return!1===t.getParam("table_responsive_width")},Qu=function(t,e){return t.fire("newrow",{node:e})},Zu=function(t,e){return t.fire("newcell",{node:e})},tc=function(t,e,n,r){t.fire("ObjectResizeStart",{target:e,width:n,height:r})},ec=function(t,e,n,r){t.fire("ObjectResized",{target:e,width:n,height:r})},nc=function(t,e){var r=function(t){return"table"===nt(Au(t))},o=function(t){var e=t.getParam("table_clone_elements");return w(e)?v.some(e.split(/[ ,]/)):Array.isArray(e)?v.some(e):v.none()}(t),i=function(e,n,r,i){return function(u,c){Iu(u);var a=i(),l=yt.fromDom(t.getDoc()),f=io(Mu.directionAt),s=An(r,l,o);return n(u)?e(a,u,c,s,f).bind(function(e){return E(e.newRows(),function(e){Qu(t,e.dom())}),E(e.newCells(),function(e){Zu(t,e.dom())}),e.cursor().map(function(e){var n=t.dom.createRng();return n.setStart(e.dom(),0),n.setEnd(e.dom(),0),n})}):v.none()}};return{deleteRow:i(Ou.eraseRows,function(e){var n=uo(e);return!1===r(t)||n.rows()>1},n,e),deleteColumn:i(Ou.eraseColumns,function(e){var n=uo(e);return!1===r(t)||n.columns()>1},n,e),insertRowsBefore:i(Ou.insertRowsBefore,s,n,e),insertRowsAfter:i(Ou.insertRowsAfter,s,n,e),insertColumnsBefore:i(Ou.insertColumnsBefore,s,Hr,e),insertColumnsAfter:i(Ou.insertColumnsAfter,s,Hr,e),mergeCells:i(Ou.mergeCells,s,n,e),unmergeCells:i(Ou.unmergeCells,s,n,e),pasteRowsBefore:i(Ou.pasteRowsBefore,s,n,e),pasteRowsAfter:i(Ou.pasteRowsAfter,s,n,e),pasteCells:i(Ou.pasteCells,s,n,e)}},rc=function(t,e,n){var r=en(t),o=un.generate(r);return ri(o,e).map(function(t){var e=Jo(o,n,!1).slice(t[0].row(),t[t.length-1].row()+t[t.length-1].rowspan()),r=Qo(e,n);return mo(r)})},oc=tinymce.util.Tools.resolve("tinymce.util.Tools"),ic={applyAlign:function(t,e,n){n&&t.formatter.apply("align"+n,{},e)},applyVAlign:function(t,e,n){n&&t.formatter.apply("valign"+n,{},e)},unApplyAlign:function(t,e){oc.each("left center right".split(" "),function(n){t.formatter.remove("align"+n,{},e)})},unApplyVAlign:function(t,e){oc.each("top middle bottom".split(" "),function(n){t.formatter.remove("valign"+n,{},e)})},getTDTHOverallStyle:function(t,e,n){var r;return r=function(e,r){for(var o=0;o<r.length;o++){var i=t.getStyle(r[o],n);if(void 0===e&&(e=i),e!==i)return""}return e}(r,t.select("td,th",e))}},uc=function(t,e){var n=t.dom,r=e.control.rootControl,o=r.toJSON(),i=n.parseStyle(o.style);i["border-style"]=o.borderStyle,i["border-color"]=o.borderColor,i["background-color"]=o.backgroundColor,i.width=o.width?Pu(o.width):"",i.height=o.height?Pu(o.height):"",r.find("#style").value(n.serializeStyle(n.parseStyle(n.serializeStyle(i))))},cc=function(t,e){var n=t.dom,r=e.control.rootControl,o=r.toJSON(),i=n.parseStyle(o.style);r.find("#borderStyle").value(i["border-style"]||""),r.find("#borderColor").value(i["border-color"]||""),r.find("#backgroundColor").value(i["background-color"]||""),r.find("#width").value(i.width||""),r.find("#height").value(i.height||"")},ac={createStyleForm:function(t){var e=function(){var e=function(t){return t.getParam("color_picker_callback")}(t);if(e)return function(n){return e.call(t,function(t){n.control.value(t).fire("change")},n.control.value())}};return{title:"Advanced",type:"form",defaults:{onchange:u(uc,t)},items:[{label:"Style",name:"style",type:"textbox",onchange:u(cc,t)},{type:"form",padding:0,formItemDefaults:{layout:"grid",alignH:["start","right"]},defaults:{size:7},items:[{label:"Border style",type:"listbox",name:"borderStyle",width:90,onselect:u(uc,t),values:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{label:"Border color",type:"colorbox",name:"borderColor",onaction:e()},{label:"Background color",type:"colorbox",name:"backgroundColor",onaction:e()}]}]}},buildListItems:function(t,e,n){var r=function(t,n){return n=n||[],oc.each(t,function(t){var o={text:t.text||t.title};t.menu?o.menu=r(t.menu):(o.value=t.value,e&&e(o)),n.push(o)}),n};return r(t,n||[])},updateStyleField:uc,extractAdvancedStyles:function(t,e){var n=t.parseStyle(t.getAttrib(e,"style")),r={};return n["border-style"]&&(r.borderStyle=n["border-style"]),n["border-color"]&&(r.borderColor=n["border-color"]),n["background-color"]&&(r.backgroundColor=n["background-color"]),r.style=t.serializeStyle(n),r},updateAdvancedFields:cc,syncAdvancedStyleFields:function(e,n){n.control.rootControl.find("#style")[0].getEl().isEqualNode(t.document.activeElement)?cc(e,n):uc(e,n)}},lc=function(t,e,n){var r,o=t.dom;function i(t,n,r){(1===e.length||r)&&o.setAttrib(t,n,r)}function u(t,n,r){(1===e.length||r)&&o.setStyle(t,n,r)}Uu(t)&&ac.syncAdvancedStyleFields(t,n),r=n.control.rootControl.toJSON(),t.undoManager.transact(function(){oc.each(e,function(n){var c,a;i(n,"scope",r.scope),1===e.length?i(n,"style",r.style):(c=n,a=r.style,delete c.dataset.mceStyle,c.style.cssText+=";"+a),i(n,"class",r.class),u(n,"width",Pu(r.width)),u(n,"height",Pu(r.height)),r.type&&n.nodeName.toLowerCase()!==r.type&&(n=o.rename(n,r.type)),1===e.length&&(ic.unApplyAlign(t,n),ic.unApplyVAlign(t,n)),r.align&&ic.applyAlign(t,n,r.align),r.valign&&ic.applyVAlign(t,n,r.valign)}),t.focus()})},fc=function(t){var e,n,r,o=[];if(o=t.dom.select("td[data-mce-selected],th[data-mce-selected]"),e=t.dom.getParent(t.selection.getStart(),"td,th"),!o.length&&e&&o.push(e),e=e||o[0]){n=o.length>1?{width:"",height:"",scope:"",class:"",align:"",valign:"",style:"",type:e.nodeName.toLowerCase()}:function(t,e){var n=t.dom,r={width:n.getStyle(e,"width")||n.getAttrib(e,"width"),height:n.getStyle(e,"height")||n.getAttrib(e,"height"),scope:n.getAttrib(e,"scope"),class:n.getAttrib(e,"class"),type:e.nodeName.toLowerCase(),style:"",align:"",valign:""};return oc.each("left center right".split(" "),function(n){t.formatter.matchNode(e,"align"+n)&&(r.align=n)}),oc.each("top middle bottom".split(" "),function(n){t.formatter.matchNode(e,"valign"+n)&&(r.valign=n)}),Uu(t)&&oc.extend(r,ac.extractAdvancedStyles(n,e)),r}(t,e),Xu(t).length>0&&(r={name:"class",type:"listbox",label:"Class",values:ac.buildListItems(Xu(t),function(e){e.value&&(e.textStyle=function(){return t.formatter.getCssText({block:"td",classes:[e.value]})})})});var i={type:"form",layout:"flex",direction:"column",labelGapCalc:"children",padding:0,items:[{type:"form",layout:"grid",columns:2,labelGapCalc:!1,padding:0,defaults:{type:"textbox",maxWidth:50},items:[{label:"Width",name:"width",onchange:u(ac.updateStyleField,t)},{label:"Height",name:"height",onchange:u(ac.updateStyleField,t)},{label:"Cell type",name:"type",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{label:"Scope",name:"scope",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{label:"H Align",name:"align",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"V Align",name:"valign",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}]},r]};Uu(t)?t.windowManager.open({title:"Cell properties",bodyType:"tabpanel",data:n,body:[{title:"General",type:"form",items:i},ac.createStyleForm(t)],onsubmit:u(lc,t,o)}):t.windowManager.open({title:"Cell properties",data:n,body:i,onsubmit:u(lc,t,o)})}},sc=function(t,e,n){var r=t.getParent(e,"table"),o=e.parentNode,i=t.select(n,r)[0];i||(i=t.create(n),r.firstChild?"CAPTION"===r.firstChild.nodeName?t.insertAfter(i,r.firstChild):r.insertBefore(i,r.firstChild):r.appendChild(i)),i.appendChild(e),o.hasChildNodes()||t.remove(o)};function dc(t,e,n,r){var o=t.dom;function i(t,n,r){(1===e.length||r)&&o.setAttrib(t,n,r)}qu(t)&&ac.syncAdvancedStyleFields(t,r);var u=r.control.rootControl.toJSON();t.undoManager.transact(function(){oc.each(e,function(r){var c,a,l;i(r,"scope",u.scope),i(r,"style",u.style),i(r,"class",u.class),c=r,a="height",l=Pu(u.height),(1===e.length||l)&&o.setStyle(c,a,l),u.type!==r.parentNode.nodeName.toLowerCase()&&sc(t.dom,r,u.type),u.align!==n.align&&(ic.unApplyAlign(t,r),ic.applyAlign(t,r,u.align))}),t.focus()})}var mc=function(t){var e,n,r,o,i,c,a=t.dom,l=[];e=a.getParent(t.selection.getStart(),"table"),n=a.getParent(t.selection.getStart(),"td,th"),oc.each(e.rows,function(t){oc.each(t.cells,function(e){if(a.getAttrib(e,"data-mce-selected")||e===n)return l.push(t),!1})}),(r=l[0])&&(i=l.length>1?{height:"",scope:"",style:"",class:"",align:"",type:r.parentNode.nodeName.toLowerCase()}:function(t,e){var n=t.dom,r={height:n.getStyle(e,"height")||n.getAttrib(e,"height"),scope:n.getAttrib(e,"scope"),class:n.getAttrib(e,"class"),align:"",style:"",type:e.parentNode.nodeName.toLowerCase()};return oc.each("left center right".split(" "),function(n){t.formatter.matchNode(e,"align"+n)&&(r.align=n)}),qu(t)&&oc.extend(r,ac.extractAdvancedStyles(n,e)),r}(t,r),Ku(t).length>0&&(o={name:"class",type:"listbox",label:"Class",values:ac.buildListItems(Ku(t),function(e){e.value&&(e.textStyle=function(){return t.formatter.getCssText({block:"tr",classes:[e.value]})})})}),c={type:"form",columns:2,padding:0,defaults:{type:"textbox"},items:[{type:"listbox",name:"type",label:"Row type",text:"Header",maxWidth:null,values:[{text:"Header",value:"thead"},{text:"Body",value:"tbody"},{text:"Footer",value:"tfoot"}]},{type:"listbox",name:"align",label:"Alignment",text:"None",maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height"},o]},qu(t)?t.windowManager.open({title:"Row properties",data:i,bodyType:"tabpanel",body:[{title:"General",type:"form",items:c},ac.createStyleForm(t)],onsubmit:u(dc,t,l,i)}):t.windowManager.open({title:"Row properties",data:i,body:c,onsubmit:u(dc,t,l,i)}))},gc=tinymce.util.Tools.resolve("tinymce.Env"),hc={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},percentages:!0},pc=function(t,e,n,r,o){void 0===o&&(o=hc);var i=yt.fromTag("table");Dt(i,o.styles),st(i,o.attributes);var u=yt.fromTag("tbody");we(i,u);for(var c=[],a=0;a<t;a++){for(var l=yt.fromTag("tr"),f=0;f<e;f++){var s=a<n||f<r?yt.fromTag("th"):yt.fromTag("td");f<r&&ft(s,"scope","row"),a<n&&ft(s,"scope","col"),we(s,yt.fromTag("br")),o.percentages&&Tt(s,"width",100/e+"%"),we(l,s)}c.push(l)}return Ce(u,c),i},vc=function(t,e){t.selection.select(e.dom(),!0),t.selection.collapse(!0)},bc=function(t,e,n){var r,o=Hu(t),i={styles:o,attributes:Fu(t),percentages:(r=o.width,w(r)&&-1!==r.indexOf("%")&&!$u(t))},c=pc(n,e,0,0,i);ft(c,"data-mce-id","__mce");var a,l,f,s=(a=c,l=yt.fromTag("div"),f=yt.fromDom(a.dom().cloneNode(!0)),we(l,f),function(t){return t.dom().innerHTML}(l));return t.insertContent(s),Ve(Au(t),'table[data-mce-id="__mce"]').map(function(e){return $u(t)&&Tt(e,"width",Ot(e,"width")),gt(e,"data-mce-id"),function(t,e){E(Fe(e,"tr"),function(e){Qu(t,e.dom()),E(Fe(e,"th,td"),function(e){Zu(t,e.dom())})})}(t,e),function(t,e){Ve(e,"td,th").each(u(vc,t))}(t,e),e.dom()}).getOr(null)};function wc(t,e,n,r){if("TD"===e.tagName||"TH"===e.tagName)t.setStyle(e,n,r);else if(e.children)for(var o=0;o<e.children.length;o++)wc(t,e.children[o],n,r)}var yc,xc=function(t,e,n){var r,o,i=t.dom;Vu(t)&&ac.syncAdvancedStyleFields(t,n),!1===(o=n.control.rootControl.toJSON()).class&&delete o.class,t.undoManager.transact(function(){e||(e=bc(t,o.cols||1,o.rows||1)),function(t,e,n){var r,o=t.dom,i={},u={};if(i.class=n.class,u.height=Pu(n.height),o.getAttrib(e,"width")&&!Yu(t)?i.width=(r=n.width)?r.replace(/px$/,""):"":u.width=Pu(n.width),Yu(t)?(u["border-width"]=Pu(n.border),u["border-spacing"]=Pu(n.cellspacing),oc.extend(i,{"data-mce-border-color":n.borderColor,"data-mce-cell-padding":n.cellpadding,"data-mce-border":n.border})):oc.extend(i,{border:n.border,cellpadding:n.cellpadding,cellspacing:n.cellspacing}),Yu(t)&&e.children)for(var c=0;c<e.children.length;c++)wc(o,e.children[c],{"border-width":Pu(n.border),"border-color":n.borderColor,padding:Pu(n.cellpadding)});n.style?oc.extend(u,o.parseStyle(n.style)):u=oc.extend({},o.parseStyle(o.getAttrib(e,"style")),u),i.style=o.serializeStyle(u),o.setAttribs(e,i)}(t,e,o),(r=i.select("caption",e)[0])&&!o.caption&&i.remove(r),!r&&o.caption&&((r=i.create("caption")).innerHTML=gc.ie?" ":'<br data-mce-bogus="1"/>',e.insertBefore(r,e.firstChild)),ic.unApplyAlign(t,e),o.align&&ic.applyAlign(t,e,o.align),t.focus(),t.addVisual()})},Cc=function(t,e){var n,r,o,i,c,a=t.dom,l={};!0===e?(n=a.getParent(t.selection.getStart(),"table"))&&(l=function(t,e){var n=t.dom,r={width:n.getStyle(e,"width")||n.getAttrib(e,"width"),height:n.getStyle(e,"height")||n.getAttrib(e,"height"),cellspacing:n.getStyle(e,"border-spacing")||n.getAttrib(e,"cellspacing"),cellpadding:n.getAttrib(e,"data-mce-cell-padding")||n.getAttrib(e,"cellpadding")||ic.getTDTHOverallStyle(t.dom,e,"padding"),border:n.getAttrib(e,"data-mce-border")||n.getAttrib(e,"border")||ic.getTDTHOverallStyle(t.dom,e,"border"),borderColor:n.getAttrib(e,"data-mce-border-color"),caption:!!n.select("caption",e)[0],class:n.getAttrib(e,"class")};return oc.each("left center right".split(" "),function(n){t.formatter.matchNode(e,"align"+n)&&(r.align=n)}),Vu(t)&&oc.extend(r,ac.extractAdvancedStyles(n,e)),r}(t,n)):(r={label:"Cols",name:"cols"},o={label:"Rows",name:"rows"}),Ju(t).length>0&&(l.class&&(l.class=l.class.replace(/\s*mce\-item\-table\s*/g,"")),i={name:"class",type:"listbox",label:"Class",values:ac.buildListItems(Ju(t),function(e){e.value&&(e.textStyle=function(){return t.formatter.getCssText({block:"table",classes:[e.value]})})})}),c={type:"form",layout:"flex",direction:"column",labelGapCalc:"children",padding:0,items:[{type:"form",labelGapCalc:!1,padding:0,layout:"grid",columns:2,defaults:{type:"textbox",maxWidth:50},items:Gu(t)?[r,o,{label:"Width",name:"width",onchange:u(ac.updateStyleField,t)},{label:"Height",name:"height",onchange:u(ac.updateStyleField,t)},{label:"Cell spacing",name:"cellspacing"},{label:"Cell padding",name:"cellpadding"},{label:"Border",name:"border"},{label:"Caption",name:"caption",type:"checkbox"}]:[r,o,{label:"Width",name:"width",onchange:u(ac.updateStyleField,t)},{label:"Height",name:"height",onchange:u(ac.updateStyleField,t)}]},{label:"Alignment",name:"align",type:"listbox",text:"None",values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},i]},Vu(t)?t.windowManager.open({title:"Table properties",data:l,bodyType:"tabpanel",body:[{title:"General",type:"form",items:c},ac.createStyleForm(t)],onsubmit:u(xc,t,n)}):t.windowManager.open({title:"Table properties",data:l,body:c,onsubmit:u(xc,t,n)})},Sc=oc.each,Rc={registerCommands:function(t,e,r,o,i){var c=ku(t),l=function(e){return function(){return v.from(t.dom.getParent(t.selection.getStart(),e)).map(yt.fromDom)}},f=l("caption"),s=l("th,td"),d=function(t){return tn.table(t,c)},m=function(t){return{width:Eu(t.dom()),height:Eu(t.dom())}},g=function(e){s().each(function(n){d(n).each(function(i){var u=wr.forMenu(o,i,n),c=m(i);e(i,u).each(function(e){!function(t,e,n){var r=m(n);e.width===r.width&&e.height===r.height||(tc(t,n.dom(),e.width,e.height),ec(t,n.dom(),r.width,r.height))}(t,c,i),t.selection.setRng(e),t.focus(),r.clear(i),Iu(i)})})})},h=function(e){return s().bind(function(e){return d(e).bind(function(r){var i=yt.fromDom(t.getDoc()),u=wr.forMenu(o,r,e),c=An(n,i,v.none());return rc(r,u,c)})})},p=function(e){i.get().each(function(n){var i=A(n,function(t){return Cn(t)});s().each(function(n){d(n).each(function(u){var c=yt.fromDom(t.getDoc()),a=En(c),l=wr.pasteRows(o,u,n,i,a);e(u,l).each(function(e){t.selection.setRng(e),t.focus(),r.clear(u)})})})})};Sc({mceTableSplitCells:function(){g(e.unmergeCells)},mceTableMergeCells:function(){g(e.mergeCells)},mceTableInsertRowBefore:function(){g(e.insertRowsBefore)},mceTableInsertRowAfter:function(){g(e.insertRowsAfter)},mceTableInsertColBefore:function(){g(e.insertColumnsBefore)},mceTableInsertColAfter:function(){g(e.insertColumnsAfter)},mceTableDeleteCol:function(){g(e.deleteColumn)},mceTableDeleteRow:function(){g(e.deleteRow)},mceTableCutRow:function(t){i.set(h()),g(e.deleteRow)},mceTableCopyRow:function(t){i.set(h())},mceTablePasteRowBefore:function(t){p(e.pasteRowsBefore)},mceTablePasteRowAfter:function(t){p(e.pasteRowsAfter)},mceTableDelete:function(){s().orThunk(f).each(function(e){tn.table(e,c).filter(a(c)).each(function(e){var n=yt.fromText("");ve(e,n),Re(e);var r=t.dom.createRng();r.setStart(n.dom(),0),r.setEnd(n.dom(),0),t.selection.setRng(r)})})}},function(e,n){t.addCommand(n,e)}),Sc({mceInsertTable:u(Cc,t),mceTableProps:u(Cc,t,!0),mceTableRowProps:u(mc,t),mceTableCellProps:u(fc,t)},function(e,n){t.addCommand(n,function(t,n){e(n)})})}},Tc=function(t){var e=v.from(t.dom().documentElement).map(yt.fromDom).getOr(t);return{parent:o(e),view:o(t),origin:o(Ur(0,0))}},Dc=function(t,e){return{parent:o(e),view:o(t),origin:o(Ur(0,0))}},Oc=function(t){var e=V.apply(null,t),n=[];return{bind:function(t){if(void 0===t)throw new Error("Event bind error: undefined handler");n.push(t)},unbind:function(t){n=N(n,function(e){return e!==t})},trigger:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var o=e.apply(null,t);E(n,function(t){t(o)})}}},Ac={create:function(t){return{registry:U(t,function(t){return{bind:t.bind,unbind:t.unbind}}),trigger:U(t,function(t){return t.trigger})}}},Ec=function(t,e){return function(n){if(t(n)){var i=yt.fromDom(n.target),u=function(){n.stopPropagation()},c=function(){n.preventDefault()},a=r(c,u),l=function(t,e,n,r,i,u,c){return{target:o(t),x:o(e),y:o(n),stop:r,prevent:i,kill:u,raw:o(c)}}(i,n.clientX,n.clientY,u,c,a,n);e(l)}}},Nc=function(t,e,n,r){return function(t,e,n,r,o){var i=Ec(n,r);return t.dom().addEventListener(e,i,o),{unbind:u(kc,t,e,i,o)}}(t,e,n,r,!1)},kc=function(t,e,n,r){t.dom().removeEventListener(e,n,r)},Pc=o(!0),Ic=function(t,e,n){return Nc(t,e,Pc,n)},Bc=Object.prototype.hasOwnProperty,Wc=(yc=function(t,e){return e},function(){for(var t=new Array(arguments.length),e=0;e<t.length;e++)t[e]=arguments[e];if(0===t.length)throw new Error("Can't merge zero objects");for(var n={},r=0;r<t.length;r++){var o=t[r];for(var i in o)Bc.call(o,i)&&(n[i]=yc(n[i],o[i]))}return n}),Mc={resolve:Do("ephox-dragster").resolve},_c=eu(["compare","extract","mutate","sink"]),Lc=eu(["element","start","stop","destroy"]),jc=eu(["forceDrop","drop","move","delayDrop"]),Fc=_c({compare:function(t,e){return Ur(e.left()-t.left(),e.top()-t.top())},extract:function(t){return v.some(Ur(t.x(),t.y()))},sink:function(t,e){var n=function(t){var e=Wc({layerClass:Mc.resolve("blocker")},t),n=yt.fromTag("div");return ft(n,"role","presentation"),Dt(n,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),bo(n,Mc.resolve("blocker")),bo(n,e.layerClass),{element:function(){return n},destroy:function(){Re(n)}}}(e),r=Ic(n.element(),"mousedown",t.forceDrop),o=Ic(n.element(),"mouseup",t.drop),i=Ic(n.element(),"mousemove",t.move),u=Ic(n.element(),"mouseout",t.delayDrop);return Lc({element:n.element,start:function(t){we(t,n.element())},stop:function(){Re(n.element())},destroy:function(){n.destroy(),o.unbind(),i.unbind(),u.unbind(),r.unbind()}})},mutate:function(t,e){t.mutate(e.left(),e.top())}});function Hc(){var t=v.none(),e=Ac.create({move:Oc(["info"])});return{onEvent:function(n,r){r.extract(n).each(function(n){(function(e,n){var r=t.map(function(t){return e.compare(t,n)});return t=v.some(n),r})(r,n).each(function(t){e.trigger.move(t)})})},reset:function(){t=v.none()},events:e.registry}}function zc(){var t={onEvent:n,reset:n},e=Hc(),r=t;return{on:function(){r.reset(),r=e},off:function(){r.reset(),r=t},isOn:function(){return r===e},onEvent:function(t,e){r.onEvent(t,e)},events:e.events}}var Uc=function(e,n,r){var o,i,u,c=!1,a=Ac.create({start:Oc([]),stop:Oc([])}),l=zc(),f=function(){m.stop(),l.isOn()&&(l.off(),a.trigger.stop())},s=(o=f,i=200,u=null,{cancel:function(){null!==u&&(t.clearTimeout(u),u=null)},throttle:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];null!==u&&t.clearTimeout(u),u=t.setTimeout(function(){o.apply(null,e),u=null},i)}});l.events.move.bind(function(t){n.mutate(e,t.info())});var d=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];c&&t.apply(null,e)}},m=n.sink(jc({forceDrop:f,drop:d(f),move:d(function(t){s.cancel(),l.onEvent(t,n)}),delayDrop:d(s.throttle)}),r);return{element:m.element,go:function(t){m.start(t),l.on(),a.trigger.start()},on:function(){c=!0},off:function(){c=!1},destroy:function(){m.destroy()},events:a.registry}},qc=function(t,e){void 0===e&&(e={});var n=void 0!==e.mode?e.mode:Fc;return Uc(t,n,e)},Vc=function(){var t=Ac.create({drag:Oc(["xDelta","yDelta","target"])}),e=v.none(),n=function(){var t=Ac.create({drag:Oc(["xDelta","yDelta"])});return{mutate:function(e,n){t.trigger.drag(e,n)},events:t.registry}}();return n.events.drag.bind(function(n){e.each(function(e){t.trigger.drag(n.xDelta(),n.yDelta(),e)})}),{assign:function(t){e=v.some(t)},get:function(){return e},mutate:n.mutate,events:t.registry}},Gc=function(t){return"true"===dt(t,"contenteditable")},Yc=Ao.resolve("resizer-bar-dragging"),Xc=function(t,e,n){var r=Vc(),o=qc(r,{}),i=v.none(),c=function(t,e){return v.from(dt(t,e))};r.events.drag.bind(function(t){c(t.target(),"data-row").each(function(e){var n=Bi.getInt(t.target(),"top");Tt(t.target(),"top",n+t.yDelta()+"px")}),c(t.target(),"data-column").each(function(e){var n=Bi.getInt(t.target(),"left");Tt(t.target(),"left",n+t.xDelta()+"px")})});var a=function(t,e){return Bi.getInt(t,e)-parseInt(dt(t,"data-initial-"+e),10)};o.events.stop.bind(function(){r.get().each(function(r){i.each(function(o){c(r,"data-row").each(function(t){var e=a(r,"top");gt(r,"data-initial-top"),g.trigger.adjustHeight(o,e,parseInt(t,10))}),c(r,"data-column").each(function(t){var e=a(r,"left");gt(r,"data-initial-left"),g.trigger.adjustWidth(o,e,parseInt(t,10))}),Lo(t,o,n,e)})})});var l=function(e,n){g.trigger.startAdjust(),r.assign(e),ft(e,"data-initial-"+n,parseInt(Ot(e,n),10)),bo(e,Yc),Tt(e,"opacity","0.2"),o.go(t.parent())},f=Ic(t.parent(),"mousedown",function(t){zo(t.target())&&l(t.target(),"top"),Uo(t.target())&&l(t.target(),"left")}),s=function(e){return ue(e,t.view())},d=function(t){return Ge(t,"table",s).filter(function(t){return function(t,e){return Ge(t,"[contenteditable]",e)}(t,s).exists(Gc)})},m=Ic(t.view(),"mouseover",function(r){d(r.target()).fold(function(){xt(r.target())&&Ho(t)},function(r){i=v.some(r),Lo(t,r,n,e)})}),g=Ac.create({adjustHeight:Oc(["table","delta","row"]),adjustWidth:Oc(["table","delta","column"]),startAdjust:Oc([])});return{destroy:function(){f.unbind(),m.unbind(),o.destroy(),Ho(t)},refresh:function(r){Lo(t,r,n,e)},on:o.on,off:o.off,hideBars:u(jo,t),showBars:u(Fo,t),events:g.registry}},Kc=function(t,e){return t.inline?Dc(Au(t),function(){var t=yt.fromTag("div");return Dt(t,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),we(Ct(),t),t}()):Tc(yt.fromDom(t.getDoc()))},Jc=function(t,e){t.inline&&Re(e.parent())},$c=function(t){var e,n,r=v.none(),o=v.none(),i=v.none(),u=/(\d+(\.\d+)?)%/,c=function(t){return"TABLE"===t.nodeName};return t.on("init",function(){var e=io(Mu.directionAt),n=Kc(t);if(i=v.some(n),function(t){var e=t.getParam("object_resizing",!0);return"table"===e||e}(t)&&function(t){return t.getParam("table_resize_bars",!0,"boolean")}(t)){var u=function(t,e){var n=ro.height,r=Xc(t,e,n),o=Ac.create({beforeResize:Oc(["table"]),afterResize:Oc(["table"]),startDrag:Oc([])});return r.events.adjustHeight.bind(function(t){o.trigger.beforeResize(t.table());var e=n.delta(t.delta(),t.table());$i.adjustHeight(t.table(),e,t.row(),n),o.trigger.afterResize(t.table())}),r.events.startAdjust.bind(function(t){o.trigger.startDrag()}),r.events.adjustWidth.bind(function(t){o.trigger.beforeResize(t.table());var n=e.delta(t.delta(),t.table());$i.adjustWidth(t.table(),n,t.column(),e),o.trigger.afterResize(t.table())}),{on:r.on,off:r.off,hideBars:r.hideBars,showBars:r.showBars,destroy:r.destroy,events:o.registry}}(n,e);u.on(),u.events.startDrag.bind(function(e){r=v.some(t.selection.getRng())}),u.events.beforeResize.bind(function(e){var n=e.table().dom();tc(t,n,Eu(n),Nu(n))}),u.events.afterResize.bind(function(e){var n=e.table(),o=n.dom();Iu(n),r.each(function(e){t.selection.setRng(e),t.focus()}),ec(t,o,Eu(o),Nu(o)),t.undoManager.add()}),o=v.some(u)}}),t.on("ObjectResizeStart",function(r){var o,i=r.target;c(i)&&(e=r.width,o=i,n=t.dom.getStyle(o,"width")||t.dom.getAttrib(o,"width"))}),t.on("ObjectResized",function(r){var o=r.target;if(c(o)){var i=o;if(u.test(n)){var a=parseFloat(u.exec(n)[1]),l=r.width*a/e;t.dom.setStyle(i,"width",l+"%")}else{var f=[];oc.each(i.rows,function(e){oc.each(e.cells,function(e){var n=t.dom.getStyle(e,"width",!0);f.push({cell:e,width:n})})}),oc.each(f,function(e){t.dom.setStyle(e.cell,"width",e.width),t.dom.setAttrib(e.cell,"width",null)})}}}),{lazyResize:function(){return o},lazyWire:function(){return i.getOr(Tc(yt.fromDom(t.getBody())))},destroy:function(){o.each(function(t){t.destroy()}),i.each(function(e){Jc(t,e)})}}},Qc=fr([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),Zc=co({},Qc,{none:function(t){return void 0===t&&(t=void 0),Qc.none(t)}}),ta=function(t,e){return tn.table(t,e).bind(function(e){var n=tn.cells(e);return B(n,function(e){return ue(t,e)}).map(function(t){return{index:o(t),all:o(n)}})})},ea=function(t,e){return ta(t,e).fold(function(){return Zc.none(t)},function(e){return e.index()+1<e.all().length?Zc.middle(t,e.all()[e.index()+1]):Zc.last(t)})},na=function(t,e){return ta(t,e).fold(function(){return Zc.none()},function(e){return e.index()-1>=0?Zc.middle(t,e.all()[e.index()-1]):Zc.first(t)})},ra={create:V("start","soffset","finish","foffset")},oa=fr([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),ia={before:oa.before,on:oa.on,after:oa.after,cata:function(t,e,n,r){return t.fold(e,n,r)},getStart:function(t){return t.fold(i,i,i)}},ua=fr([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),ca={domRange:ua.domRange,relative:ua.relative,exact:ua.exact,exactFromRange:function(t){return ua.exact(t.start(),t.soffset(),t.finish(),t.foffset())},getWin:function(t){var e,n=function(t){return t.match({domRange:function(t){return yt.fromDom(t.startContainer)},relative:function(t,e){return ia.getStart(t)},exact:function(t,e,n,r){return t}})}(t);return e=n.dom().ownerDocument.defaultView,yt.fromDom(e)},range:ra.create},aa=function(t,e){t.selectNodeContents(e.dom())},la=function(t,e,n){var r,o=t.document.createRange();return r=o,e.fold(function(t){r.setStartBefore(t.dom())},function(t,e){r.setStart(t.dom(),e)},function(t){r.setStartAfter(t.dom())}),function(t,e){e.fold(function(e){t.setEndBefore(e.dom())},function(e,n){t.setEnd(e.dom(),n)},function(e){t.setEndAfter(e.dom())})}(o,n),o},fa=function(t,e,n,r,o){var i=t.document.createRange();return i.setStart(e.dom(),n),i.setEnd(r.dom(),o),i},sa=function(t){return{left:o(t.left),top:o(t.top),right:o(t.right),bottom:o(t.bottom),width:o(t.width),height:o(t.height)}},da=fr([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),ma=function(t,e,n){return e(yt.fromDom(n.startContainer),n.startOffset,yt.fromDom(n.endContainer),n.endOffset)},ga=function(t,e){return function(t,e){var n=e.ltr();return n.collapsed?e.rtl().filter(function(t){return!1===t.collapsed}).map(function(t){return da.rtl(yt.fromDom(t.endContainer),t.endOffset,yt.fromDom(t.startContainer),t.startOffset)}).getOrThunk(function(){return ma(0,da.ltr,n)}):ma(0,da.ltr,n)}(0,function(t,e){return e.match({domRange:function(t){return{ltr:o(t),rtl:v.none}},relative:function(e,n){return{ltr:bt(function(){return la(t,e,n)}),rtl:bt(function(){return v.some(la(t,n,e))})}},exact:function(e,n,r,o){return{ltr:bt(function(){return fa(t,e,n,r,o)}),rtl:bt(function(){return v.some(fa(t,r,o,e,n))})}}})}(t,e))},ha=function(t,e){return ga(t,e).match({ltr:function(e,n,r,o){var i=t.document.createRange();return i.setStart(e.dom(),n),i.setEnd(r.dom(),o),i},rtl:function(e,n,r,o){var i=t.document.createRange();return i.setStart(r.dom(),o),i.setEnd(e.dom(),n),i}})},pa=function(t,e,n){return e>=t.left&&e<=t.right&&n>=t.top&&n<=t.bottom},va=function(t,e,n,r,o){var i=function(n){var r=t.dom().createRange();return r.setStart(e.dom(),n),r.collapse(!0),r},u=sn(e).length,c=function(t,e,n,r,o){if(0===o)return 0;if(e===r)return o-1;for(var i=r,u=1;u<o;u++){var c=t(u),a=Math.abs(e-c.left);if(n<=c.bottom){if(n<c.top||a>i)return u-1;i=a}}return 0}(function(t){return i(t).getBoundingClientRect()},n,r,o.right,u);return i(c)},ba=function(t,e,n,r){var o=t.dom().createRange();o.selectNode(e.dom());var i=o.getClientRects();return lo(i,function(t){return pa(t,n,r)?v.some(t):v.none()}).map(function(o){return va(t,e,n,r,o)})},wa=function(t,e,n,r){var o=t.dom().createRange(),i=ge(e);return lo(i,function(e){return o.selectNode(e.dom()),pa(o.getBoundingClientRect(),n,r)?ya(t,e,n,r):v.none()})},ya=function(t,e,n,r){return(ct(e)?ba:wa)(t,e,n,r)},xa=function(t,e){return e-t.left<t.right-e},Ca=function(t,e,n){var r=t.dom().createRange();return r.selectNode(e.dom()),r.collapse(n),r},Sa=function(t,e,n){var r=t.dom().createRange();r.selectNode(e.dom());var o=r.getBoundingClientRect(),i=xa(o,n);return(!0===i?vn:bn)(e).map(function(e){return Ca(t,e,i)})},Ra=function(t,e,n){var r=e.dom().getBoundingClientRect(),o=xa(r,n);return v.some(Ca(t,e,o))},Ta=function(t,e,n,r){var o=t.dom().createRange();o.selectNode(e.dom());var i=o.getBoundingClientRect();return function(t,e,n,r){var o=t.dom().createRange();o.selectNode(e.dom());var i=o.getBoundingClientRect(),u=Math.max(i.left,Math.min(i.right,n)),c=Math.max(i.top,Math.min(i.bottom,r));return ya(t,e,u,c)}(t,e,Math.max(i.left,Math.min(i.right,n)),Math.max(i.top,Math.min(i.bottom,r)))},Da=document.caretPositionFromPoint?function(t,e,n){return v.from(t.dom().caretPositionFromPoint(e,n)).bind(function(e){if(null===e.offsetNode)return v.none();var n=t.dom().createRange();return n.setStart(e.offsetNode,e.offset),n.collapse(),v.some(n)})}:document.caretRangeFromPoint?function(t,e,n){return v.from(t.dom().caretRangeFromPoint(e,n))}:function(t,e,n){return yt.fromPoint(t,e,n).bind(function(r){var o=function(){return function(t,e,n){return(0===ge(e).length?Ra:Sa)(t,e,n)}(t,r,e)};return 0===ge(r).length?o():Ta(t,r,e,n).orThunk(o)})},Oa=function(t,e){var n=nt(t);return"input"===n?ia.after(t):D(["br","img"],n)?0===e?ia.before(t):ia.after(t):ia.on(t,e)},Aa=function(t,e){var n=t.fold(ia.before,Oa,ia.after),r=e.fold(ia.before,Oa,ia.after);return ca.relative(n,r)},Ea=function(t,e,n,r){var o=Oa(t,e),i=Oa(n,r);return ca.relative(o,i)},Na=function(t,e,n,r){var o=function(t,e,n,r){var o=le(t).dom().createRange();return o.setStart(t.dom(),e),o.setEnd(n.dom(),r),o}(t,e,n,r),i=ue(t,n)&&e===r;return o.collapsed&&!i},ka=function(t,e){v.from(t.getSelection()).each(function(t){t.removeAllRanges(),t.addRange(e)})},Pa=function(t,e,n,r,o){var i=fa(t,e,n,r,o);ka(t,i)},Ia=function(t,e){return ga(t,e).match({ltr:function(e,n,r,o){Pa(t,e,n,r,o)},rtl:function(e,n,r,o){var i=t.getSelection();if(i.setBaseAndExtent)i.setBaseAndExtent(e.dom(),n,r.dom(),o);else if(i.extend)try{!function(t,e,n,r,o,i){e.collapse(n.dom(),r),e.extend(o.dom(),i)}(0,i,e,n,r,o)}catch(i){Pa(t,r,o,e,n)}else Pa(t,r,o,e,n)}})},Ba=function(t){var e=ca.getWin(t).dom(),n=function(t,n,r,o){return fa(e,t,n,r,o)},r=function(t){return t.match({domRange:function(t){var e=yt.fromDom(t.startContainer),n=yt.fromDom(t.endContainer);return Ea(e,t.startOffset,n,t.endOffset)},relative:Aa,exact:Ea})}(t);return ga(e,r).match({ltr:n,rtl:n})},Wa=function(t){var e=yt.fromDom(t.anchorNode),n=yt.fromDom(t.focusNode);return Na(e,t.anchorOffset,n,t.focusOffset)?v.some(ra.create(e,t.anchorOffset,n,t.focusOffset)):function(t){if(t.rangeCount>0){var e=t.getRangeAt(0),n=t.getRangeAt(t.rangeCount-1);return v.some(ra.create(yt.fromDom(e.startContainer),e.startOffset,yt.fromDom(n.endContainer),n.endOffset))}return v.none()}(t)},Ma=function(t,e){var n=function(t,e){var n=t.document.createRange();return aa(n,e),n}(t,e);ka(t,n)},_a=function(t){return function(t){return v.from(t.getSelection()).filter(function(t){return t.rangeCount>0}).bind(Wa)}(t).map(function(t){return ca.exact(t.start(),t.soffset(),t.finish(),t.foffset())})},La=function(t,e){return function(t){var e=t.getClientRects(),n=e.length>0?e[0]:t.getBoundingClientRect();return n.width>0||n.height>0?v.some(n).map(sa):v.none()}(ha(t,e))},ja=function(t,e,n){return function(t,e,n){var r=yt.fromDom(t.document);return Da(r,e,n).map(function(t){return ra.create(yt.fromDom(t.startContainer),t.startOffset,yt.fromDom(t.endContainer),t.endOffset)})}(t,e,n)},Fa=tinymce.util.Tools.resolve("tinymce.util.VK"),Ha=function(t,e,n,r){return Va(t,e,ea(n),r)},za=function(t,e,n,r){return Va(t,e,na(n),r)},Ua=function(t,e){var n=ca.exact(e,0,e,0);return Ba(n)},qa=function(t,e){var n,r=Fe(e,"tr");return(n=r,0===n.length?v.none():v.some(n[n.length-1])).bind(function(t){return Ve(t,"td,th").map(function(t){return Ua(0,t)})})},Va=function(t,e,n,r,o){return n.fold(v.none,v.none,function(t,e){return vn(e).map(function(t){return Ua(0,t)})},function(n){return tn.table(n,e).bind(function(e){var o=wr.noMenu(n);return t.undoManager.transact(function(){r.insertRowsAfter(e,o)}),qa(0,e)})})},Ga=["table","li","dl"],Ya={handle:function(t,e,n,r){if(t.keyCode===Fa.TAB){var o=Au(e),i=function(t){var e=nt(t);return ue(t,o)||D(Ga,e)},u=e.selection.getRng();if(u.collapsed){var c=yt.fromDom(u.startContainer);tn.cell(c,i).each(function(o){t.preventDefault(),(t.shiftKey?za:Ha)(e,i,o,n,r).each(function(t){e.selection.setRng(t)})})}}}},Xa={create:V("selection","kill")},Ka=function(t,e,n,r){return{start:o(ia.on(t,e)),finish:o(ia.on(n,r))}},Ja={convertToRange:function(t,e){var n=ha(t,e);return ra.create(yt.fromDom(n.startContainer),n.startOffset,yt.fromDom(n.endContainer),n.endOffset)},makeSitus:Ka},$a=function(t,e,n,r,o){return ue(n,r)?v.none():ir.identify(n,r,e).bind(function(e){var r=e.boxes().getOr([]);return r.length>0?(o(t,r,e.start(),e.finish()),v.some(Xa.create(v.some(Ja.makeSitus(n,0,n,gn(n))),!0))):v.none()})},Qa={sync:function(t,e,n,r,o,i,u){return ue(n,o)&&r===i?v.none():Ge(n,"td,th",e).bind(function(n){return Ge(o,"td,th",e).bind(function(r){return $a(t,e,n,r,u)})})},detect:$a,update:function(t,e,n,r,o){return ir.shiftSelection(r,t,e,o.firstSelectedSelector(),o.lastSelectedSelector()).map(function(t){return o.clear(n),o.selectRange(n,t.boxes(),t.start(),t.finish()),t.boxes()})}},Za=V("item","mode"),tl=function(t,e,n,r){return void 0===r&&(r=el),t.property().parent(e).map(function(t){return Za(t,r)})},el=function(t,e,n,r){return void 0===r&&(r=nl),n.sibling(t,e).map(function(t){return Za(t,r)})},nl=function(t,e,n,r){void 0===r&&(r=nl);var o=t.property().children(e);return n.first(o).map(function(t){return Za(t,r)})},rl=[{current:tl,next:el,fallback:v.none()},{current:el,next:nl,fallback:v.some(tl)},{current:nl,next:nl,fallback:v.some(el)}],ol=function(t,e,n,r,o){return void 0===o&&(o=rl),I(o,function(t){return t.current===n}).bind(function(n){return n.current(t,e,r,n.next).orThunk(function(){return n.fallback.bind(function(n){return ol(t,e,n,r)})})})},il=function(){return{sibling:function(t,e){return t.query().prevSibling(e)},first:function(t){return t.length>0?v.some(t[t.length-1]):v.none()}}},ul=function(){return{sibling:function(t,e){return t.query().nextSibling(e)},first:function(t){return t.length>0?v.some(t[0]):v.none()}}},cl=function(t,e,n,r,o,i){return ol(t,e,r,o).bind(function(e){return i(e.item())?v.none():n(e.item())?v.some(e.item()):cl(t,e.item(),n,e.mode(),o,i)})},al=function(t){return function(e){return 0===t.property().children(e).length}},ll=function(t,e,n,r){return cl(t,e,n,el,il(),r)},fl=function(t,e,n,r){return cl(t,e,n,el,ul(),r)},sl=Vn(),dl=function(t,e){return function(t,e,n){return ll(t,e,al(t),n)}(sl,t,e)},ml=function(t,e){return function(t,e,n){return fl(t,e,al(t),n)}(sl,t,e)},gl=V("element","offset"),hl=(V("element","deltaOffset"),V("element","start","finish"),V("begin","end"),V("element","text"),fr([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}])),pl=function(t){return Ge(t,"tr")},vl=co({},hl,{verify:function(t,e,n,r,o,i,u){return Ge(r,"td,th",u).bind(function(n){return Ge(e,"td,th",u).map(function(e){return ue(n,e)?ue(r,n)&&gn(n)===o?i(e):hl.none("in same cell"):er.sharedOne(pl,[n,e]).fold(function(){return function(t,e,n){var r=t.getRect(e),o=t.getRect(n);return o.right>r.left&&o.left<r.right}(t,e,n)?hl.success():i(e)},function(t){return i(e)})})}).getOr(hl.none("default"))},cata:function(t,e,n,r,o){return t.fold(e,n,r,o)}}),bl=(V("ancestor","descendants","element","index"),V("parent","children","element","index")),wl=function(t,e){return B(t,u(ue,e))},yl=function(t){return"br"===nt(t)},xl=function(t,e,n){return e(t,n).bind(function(t){return ct(t)&&0===sn(t).trim().length?xl(t,e,n):v.some(t)})},Cl=function(t,e,n,r){return function(t,e){return he(t,e).filter(yl).orThunk(function(){return he(t,e-1).filter(yl)})}(e,n).bind(function(e){return r.traverse(e).fold(function(){return xl(e,r.gather,t).map(r.relative)},function(t){return(e=t,fe(e).bind(function(t){var n=ge(t);return wl(n,e).map(function(r){return bl(t,n,e,r)})})).map(function(t){return ia.on(t.parent(),t.index())});var e})})},Sl=function(t,e,n,r){return(yl(e)?function(t,e,n){return n.traverse(e).orThunk(function(){return xl(e,n.gather,t)}).map(n.relative)}(t,e,r):Cl(t,e,n,r)).map(function(t){return{start:o(t),finish:o(t)}})},Rl=function(t){return vl.cata(t,function(t){return v.none()},function(){return v.none()},function(t){return v.some(gl(t,0))},function(t){return v.some(gl(t,gn(t)))})},Tl=$(["left","top","right","bottom"],[]),Dl={nu:Tl,moveUp:function(t,e){return Tl({left:t.left(),top:t.top()-e,right:t.right(),bottom:t.bottom()-e})},moveDown:function(t,e){return Tl({left:t.left(),top:t.top()+e,right:t.right(),bottom:t.bottom()+e})},moveBottomTo:function(t,e){var n=t.bottom()-t.top();return Tl({left:t.left(),top:e-n,right:t.right(),bottom:e})},moveTopTo:function(t,e){var n=t.bottom()-t.top();return Tl({left:t.left(),top:e,right:t.right(),bottom:e+n})},getTop:function(t){return t.top()},getBottom:function(t){return t.bottom()},translate:function(t,e,n){return Tl({left:t.left()+e,top:t.top()+n,right:t.right()+e,bottom:t.bottom()+n})},toString:function(t){return"("+t.left()+", "+t.top()+") -> ("+t.right()+", "+t.bottom()+")"}},Ol=function(t){return Dl.nu({left:t.left,top:t.top,right:t.right,bottom:t.bottom})},Al=function(t,e){return v.some(t.getRect(e))},El=function(t,e,n){return ut(e)?Al(t,e).map(Ol):ct(e)?function(t,e,n){return n>=0&&n<gn(e)?t.getRangedRect(e,n,e,n+1):n>0?t.getRangedRect(e,n-1,e,n):v.none()}(t,e,n).map(Ol):v.none()},Nl=function(t,e){return ut(e)?Al(t,e).map(Ol):ct(e)?t.getRangedRect(e,0,e,gn(e)).map(Ol):v.none()},kl=fr([{none:[]},{retry:["caret"]}]),Pl=function(t,e,n){return(r=e,i=gu,He(function(t){return i(t)},ze,r,i,u)).fold(o(!1),function(e){return Nl(t,e).exists(function(t){return function(t,e){return t.left()<e.left()||Math.abs(e.right()-t.left())<1||t.left()>e.right()}(n,t)})});var r,i,u},Il={point:Dl.getTop,adjuster:function(t,e,n,r,o){var i=Dl.moveUp(o,5);return Math.abs(n.top()-r.top())<1?kl.retry(i):n.bottom()<o.top()?kl.retry(i):n.bottom()===o.top()?kl.retry(Dl.moveUp(o,1)):Pl(t,e,o)?kl.retry(Dl.translate(i,5,0)):kl.none()},move:Dl.moveUp,gather:dl},Bl={point:Dl.getBottom,adjuster:function(t,e,n,r,o){var i=Dl.moveDown(o,5);return Math.abs(n.bottom()-r.bottom())<1?kl.retry(i):n.top()>o.bottom()?kl.retry(i):n.top()===o.bottom()?kl.retry(Dl.moveDown(o,1)):Pl(t,e,o)?kl.retry(Dl.translate(i,5,0)):kl.none()},move:Dl.moveDown,gather:ml},Wl=function(t,e,n,r,o){return 0===o?v.some(r):function(t,e,n){return t.elementFromPoint(e,n).filter(function(t){return"table"===nt(t)}).isSome()}(t,r.left(),e.point(r))?function(t,e,n,r,o){return Wl(t,e,n,e.move(r,5),o)}(t,e,n,r,o-1):t.situsFromPoint(r.left(),e.point(r)).bind(function(i){return i.start().fold(v.none,function(i){return Nl(t,i).bind(function(u){return e.adjuster(t,i,u,n,r).fold(v.none,function(r){return Wl(t,e,n,r,o-1)})}).orThunk(function(){return v.some(r)})},v.none)})},Ml=function(t,e,n){var r=t.move(n,5),o=Wl(e,t,n,r,100).getOr(r);return function(t,e,n){return t.point(e)>n.getInnerHeight()?v.some(t.point(e)-n.getInnerHeight()):t.point(e)<0?v.some(-t.point(e)):v.none()}(t,o,e).fold(function(){return e.situsFromPoint(o.left(),t.point(o))},function(n){return e.scrollBy(0,n),e.situsFromPoint(o.left(),t.point(o)-n)})},_l={tryUp:u(Ml,Il),tryDown:u(Ml,Bl),ieTryUp:function(t,e){return t.situsFromPoint(e.left(),e.top()-5)},ieTryDown:function(t,e){return t.situsFromPoint(e.left(),e.bottom()+5)},getJumpSize:o(5)},Ll=ee.detect(),jl=function(t,e,n,r,o,i){return 0===i?v.none():zl(t,e,n,r,o).bind(function(u){var c=t.fromSitus(u),a=vl.verify(t,n,r,c.finish(),c.foffset(),o.failure,e);return vl.cata(a,function(){return v.none()},function(){return v.some(u)},function(u){return ue(n,u)&&0===r?Fl(t,n,r,Dl.moveUp,o):jl(t,e,u,0,o,i-1)},function(u){return ue(n,u)&&r===gn(u)?Fl(t,n,r,Dl.moveDown,o):jl(t,e,u,gn(u),o,i-1)})})},Fl=function(t,e,n,r,o){return El(t,e,n).bind(function(e){return Hl(t,o,r(e,_l.getJumpSize()))})},Hl=function(t,e,n){return Ll.browser.isChrome()||Ll.browser.isSafari()||Ll.browser.isFirefox()||Ll.browser.isEdge()?e.otherRetry(t,n):Ll.browser.isIE()?e.ieRetry(t,n):v.none()},zl=function(t,e,n,r,o){return El(t,n,r).bind(function(e){return Hl(t,o,e)})},Ul=function(t,e,n){return function(t,e,n){return t.getSelection().bind(function(r){return Sl(e,r.finish(),r.foffset(),n).fold(function(){return v.some(gl(r.finish(),r.foffset()))},function(o){var i=t.fromSitus(o),u=vl.verify(t,r.finish(),r.foffset(),i.finish(),i.foffset(),n.failure,e);return Rl(u)})})}(t,e,n).bind(function(r){return jl(t,e,r.element(),r.offset(),n,20).map(t.fromSitus)})},ql=ee.detect(),Vl=function(t,e){return ze(t,function(t){return fe(t).exists(function(t){return ue(t,e)})},n).isSome();var n},Gl=function(t,e,n,r,i){return Ge(r,"td,th",e).bind(function(r){return Ge(r,"table",e).bind(function(u){return Vl(i,u)?Ul(t,e,n).bind(function(t){return Ge(t.finish(),"td,th",e).map(function(e){return{start:o(r),finish:o(e),range:o(t)}})}):v.none()})})},Yl=function(t,e,n,r,o,i){return ql.browser.isIE()?v.none():i(r,e).orThunk(function(){return Gl(t,e,n,r,o).map(function(t){var e=t.range();return Xa.create(v.some(Ja.makeSitus(e.start(),e.soffset(),e.finish(),e.foffset())),!0)})})},Xl=function(t,e,n,r,o,i,u){return Gl(t,n,r,o,i).bind(function(t){return Qa.detect(e,n,t.start(),t.finish(),u)})},Kl=function(t,e){return Ge(t,"tr",e).bind(function(t){return Ge(t,"table",e).bind(function(n){var r=Fe(n,"tr");return ue(t,r[0])?function(t,e,n){return ll(sl,t,e,n)}(n,function(t){return bn(t).isSome()},e).map(function(t){var e=gn(t);return Xa.create(v.some(Ja.makeSitus(t,e,t,e)),!0)}):v.none()})})},Jl=function(t,e){return Ge(t,"tr",e).bind(function(t){return Ge(t,"table",e).bind(function(n){var r=Fe(n,"tr");return ue(t,r[r.length-1])?function(t,e,n){return fl(sl,t,e,n)}(n,function(t){return vn(t).isSome()},e).map(function(t){return Xa.create(v.some(Ja.makeSitus(t,0,t,0)),!0)}):v.none()})})},$l=function(t,e){return Ge(t,"td,th",e)},Ql={down:{traverse:me,gather:ml,relative:ia.before,otherRetry:_l.tryDown,ieRetry:_l.ieTryDown,failure:vl.failedDown},up:{traverse:de,gather:dl,relative:ia.before,otherRetry:_l.tryUp,ieRetry:_l.ieTryUp,failure:vl.failedUp}},Zl=function(t){return function(e){return e===t}},tf=Zl(38),ef=Zl(40),nf={ltr:{isBackward:Zl(37),isForward:Zl(39)},rtl:{isBackward:Zl(39),isForward:Zl(37)},isUp:tf,isDown:ef,isNavigation:function(t){return t>=37&&t<=40}},rf=(ee.detect().browser.isSafari(),function(e){return{elementFromPoint:function(t,n){return yt.fromPoint(yt.fromDom(e.document),t,n)},getRect:function(t){return t.dom().getBoundingClientRect()},getRangedRect:function(t,n,r,o){var i=ca.exact(t,n,r,o);return La(e,i).map(function(t){return U(t,l)})},getSelection:function(){return _a(e).map(function(t){return Ja.convertToRange(e,t)})},fromSitus:function(t){var n=ca.relative(t.start(),t.finish());return Ja.convertToRange(e,n)},situsFromPoint:function(t,n){return ja(e,t,n).map(function(t){return Ka(t.start(),t.soffset(),t.finish(),t.foffset())})},clearSelection:function(){!function(t){t.getSelection().removeAllRanges()}(e)},setSelection:function(t){!function(t,e,n,r,o){var i=Ea(e,n,r,o);Ia(t,i)}(e,t.start(),t.soffset(),t.finish(),t.foffset())},setRelativeSelection:function(t,n){!function(t,e,n){var r=Aa(e,n);Ia(t,r)}(e,t,n)},selectContents:function(t){Ma(e,t)},getInnerHeight:function(){return e.innerHeight},getScrollY:function(){var n,r,o,i;return(n=yt.fromDom(e.document),r=void 0!==n?n.dom():t.document,o=r.body.scrollLeft||r.documentElement.scrollLeft,i=r.body.scrollTop||r.documentElement.scrollTop,Ur(o,i)).top()},scrollBy:function(n,r){!function(e,n,r){(void 0!==r?r.dom():t.document).defaultView.scrollBy(e,n)}(n,r,yt.fromDom(e.document))}}}),of=V("rows","cols"),uf={mouse:function(t,e,n,r){var o=function(t,e,n,r){var o=v.none(),i=function(){o=v.none()};return{mousedown:function(t){r.clear(e),o=$l(t.target(),n)},mouseover:function(i){o.each(function(o){r.clear(e),$l(i.target(),n).each(function(i){ir.identify(o,i,n).each(function(n){var u=n.boxes().getOr([]);(u.length>1||1===u.length&&!ue(o,i))&&(r.selectRange(e,u,n.start(),n.finish()),t.selectContents(i))})})})},mouseup:function(t){o.each(i)}}}(rf(t),e,n,r);return{mousedown:o.mousedown,mouseover:o.mouseover,mouseup:o.mouseup}},keyboard:function(t,e,n,r){var o=rf(t),i=function(){return r.clear(e),v.none()};return{keydown:function(t,c,a,l,f,s){var d=t.raw(),m=d.which,g=!0===d.shiftKey;return ir.retrieve(e,r.selectedSelector()).fold(function(){return nf.isDown(m)&&g?u(Xl,o,e,n,Ql.down,l,c,r.selectRange):nf.isUp(m)&&g?u(Xl,o,e,n,Ql.up,l,c,r.selectRange):nf.isDown(m)?u(Yl,o,n,Ql.down,l,c,Jl):nf.isUp(m)?u(Yl,o,n,Ql.up,l,c,Kl):v.none},function(t){var n=function(n){return function(){return lo(n,function(n){return Qa.update(n.rows(),n.cols(),e,t,r)}).fold(function(){return ir.getEdges(e,r.firstSelectedSelector(),r.lastSelectedSelector()).map(function(t){var n=nf.isDown(m)||s.isForward(m)?ia.after:ia.before;return o.setRelativeSelection(ia.on(t.first(),0),n(t.table())),r.clear(e),Xa.create(v.none(),!0)})},function(t){return v.some(Xa.create(v.none(),!0))})}};return nf.isDown(m)&&g?n([of(1,0)]):nf.isUp(m)&&g?n([of(-1,0)]):s.isBackward(m)&&g?n([of(0,-1),of(-1,0)]):s.isForward(m)&&g?n([of(0,1),of(1,0)]):nf.isNavigation(m)&&!1===g?i:v.none})()},keyup:function(t,o,i,u,c){return ir.retrieve(e,r.selectedSelector()).fold(function(){var a=t.raw(),l=a.which;return 0==(!0===a.shiftKey)?v.none():nf.isNavigation(l)?Qa.sync(e,n,o,i,u,c,r.selectRange):v.none()},v.none)}}}},cf=function(t,e){E(e,function(e){!function(t,e){ho(t)?t.dom().classList.remove(e):vo(t,e),wo(t)}(t,e)})},af={byClass:function(t){var e,n,r=(e=t.selected(),function(t){bo(t,e)}),o=(n=[t.selected(),t.lastSelected(),t.firstSelected()],function(t){cf(t,n)}),i=function(e){var n=Fe(e,t.selectedSelector());E(n,o)};return{clear:i,selectRange:function(e,n,o,u){i(e),E(n,r),bo(o,t.firstSelected()),bo(u,t.lastSelected())},selectedSelector:t.selectedSelector,firstSelectedSelector:t.firstSelectedSelector,lastSelectedSelector:t.lastSelectedSelector}},byAttr:function(t){var e=function(e){gt(e,t.selected()),gt(e,t.firstSelected()),gt(e,t.lastSelected())},n=function(e){ft(e,t.selected(),"1")},r=function(n){var r=Fe(n,t.selectedSelector());E(r,e)};return{clear:r,selectRange:function(e,o,i,u){r(e),E(o,n),ft(i,t.firstSelected(),"1"),ft(u,t.lastSelected(),"1")},selectedSelector:t.selectedSelector,firstSelectedSelector:t.firstSelectedSelector,lastSelectedSelector:t.lastSelectedSelector}}},lf=function(t){return!1===yo(yt.fromDom(t.target),"ephox-snooker-resizer-bar")},ff=function(t){return{get:function(){var e=Au(t);return ur(e,lr.selectedSelector()).fold(function(){return void 0===t.selection.getStart()?dr.none():dr.single(t.selection)},function(t){return dr.multiple(t)})}}},sf=oc.each,df={addButtons:function(t){var e=[];function n(e){return function(){t.execCommand(e)}}sf("inserttable tableprops deletetable | cell row column".split(" "),function(n){"|"===n?e.push({text:"-"}):e.push(t.menuItems[n])}),t.addButton("table",{type:"menubutton",title:"Table",menu:e}),t.addButton("tableprops",{title:"Table properties",onclick:n("mceTableProps"),icon:"table"}),t.addButton("tabledelete",{title:"Delete table",onclick:n("mceTableDelete")}),t.addButton("tablecellprops",{title:"Cell properties",onclick:n("mceTableCellProps")}),t.addButton("tablemergecells",{title:"Merge cells",onclick:n("mceTableMergeCells")}),t.addButton("tablesplitcells",{title:"Split cell",onclick:n("mceTableSplitCells")}),t.addButton("tableinsertrowbefore",{title:"Insert row before",onclick:n("mceTableInsertRowBefore")}),t.addButton("tableinsertrowafter",{title:"Insert row after",onclick:n("mceTableInsertRowAfter")}),t.addButton("tabledeleterow",{title:"Delete row",onclick:n("mceTableDeleteRow")}),t.addButton("tablerowprops",{title:"Row properties",onclick:n("mceTableRowProps")}),t.addButton("tablecutrow",{title:"Cut row",onclick:n("mceTableCutRow")}),t.addButton("tablecopyrow",{title:"Copy row",onclick:n("mceTableCopyRow")}),t.addButton("tablepasterowbefore",{title:"Paste row before",onclick:n("mceTablePasteRowBefore")}),t.addButton("tablepasterowafter",{title:"Paste row after",onclick:n("mceTablePasteRowAfter")}),t.addButton("tableinsertcolbefore",{title:"Insert column before",onclick:n("mceTableInsertColBefore")}),t.addButton("tableinsertcolafter",{title:"Insert column after",onclick:n("mceTableInsertColAfter")}),t.addButton("tabledeletecol",{title:"Delete column",onclick:n("mceTableDeleteCol")})},addToolbars:function(t){var e=function(t){var e=t.getParam("table_toolbar",_u);return""===e||!1===e?[]:w(e)?e.split(/[ ,]/):y(e)?e:[]}(t);e.length>0&&t.addContextToolbar(function(e){return t.dom.is(e,"table")&&t.getBody().contains(e)},e.join(" "))}},mf={addMenuItems:function(t,e){var n=v.none(),r=[],o=[],i=[],u=[],c=function(t){t.disabled(!0)},a=function(t){t.disabled(!1)},l=function(){var t=this;r.push(t),n.fold(function(){c(t)},function(e){a(t)})},f=function(){var t=this;o.push(t),n.fold(function(){c(t)},function(e){a(t)})};t.on("init",function(){t.on("nodechange",function(l){var f=v.from(t.dom.getParent(t.selection.getStart(),"th,td"));(n=f.bind(function(t){var n=yt.fromDom(t);return tn.table(n).map(function(t){return wr.forMenu(e,t,n)})})).fold(function(){E(r,c),E(o,c),E(i,c),E(u,c)},function(t){E(r,a),E(o,a),E(i,function(e){e.disabled(t.mergable().isNone())}),E(u,function(e){e.disabled(t.unmergable().isNone())})})})});var s=function(t,e,n,r){var o,i,u,c,a,l=r.getEl().getElementsByTagName("table")[0],f=r.isRtl()||"tl-tr"===r.parent().rel;for(l.nextSibling.innerHTML=e+1+" x "+(n+1),f&&(e=9-e),i=0;i<10;i++)for(o=0;o<10;o++)c=l.rows[i].childNodes[o].firstChild,a=(f?o>=e:o<=e)&&i<=n,t.dom.toggleClass(c,"mce-active",a),a&&(u=c);return u.parentNode},d=!1===function(t){return t.getParam("table_grid",!0,"boolean")}(t)?{text:"Table",icon:"table",context:"table",onclick:m("mceInsertTable")}:{text:"Table",icon:"table",context:"table",ariaHideMenu:!0,onclick:function(e){e.aria&&(this.parent().hideAll(),e.stopImmediatePropagation(),t.execCommand("mceInsertTable"))},onshow:function(){s(t,0,0,this.menu.items()[0])},onhide:function(){var e=this.menu.items()[0].getEl().getElementsByTagName("a");t.dom.removeClass(e,"mce-active"),t.dom.addClass(e[0],"mce-active")},menu:[{type:"container",html:function(){var t="";t='<table role="grid" class="mce-grid mce-grid-border" aria-readonly="true">';for(var e=0;e<10;e++){t+="<tr>";for(var n=0;n<10;n++)t+='<td role="gridcell" tabindex="-1"><a id="mcegrid'+(10*e+n)+'" href="#" data-mce-x="'+n+'" data-mce-y="'+e+'"></a></td>';t+="</tr>"}return t+="</table>",t+='<div class="mce-text-center" role="presentation">1 x 1</div>'}(),onPostRender:function(){this.lastX=this.lastY=0},onmousemove:function(e){var n,r,o=e.target;"A"===o.tagName.toUpperCase()&&(n=parseInt(o.getAttribute("data-mce-x"),10),r=parseInt(o.getAttribute("data-mce-y"),10),(this.isRtl()||"tl-tr"===this.parent().rel)&&(n=9-n),n===this.lastX&&r===this.lastY||(s(t,n,r,e.control),this.lastX=n,this.lastY=r))},onclick:function(e){var n=this;"A"===e.target.tagName.toUpperCase()&&(e.preventDefault(),e.stopPropagation(),n.parent().cancel(),t.undoManager.transact(function(){bc(t,n.lastX+1,n.lastY+1)}),t.addVisual())}}]};function m(e){return function(){t.execCommand(e)}}var g={text:"Table properties",context:"table",onPostRender:l,onclick:m("mceTableProps")},h={text:"Delete table",context:"table",onPostRender:l,cmd:"mceTableDelete"},p={text:"Row",context:"table",menu:[{text:"Insert row before",onclick:m("mceTableInsertRowBefore"),onPostRender:f},{text:"Insert row after",onclick:m("mceTableInsertRowAfter"),onPostRender:f},{text:"Delete row",onclick:m("mceTableDeleteRow"),onPostRender:f},{text:"Row properties",onclick:m("mceTableRowProps"),onPostRender:f},{text:"-"},{text:"Cut row",onclick:m("mceTableCutRow"),onPostRender:f},{text:"Copy row",onclick:m("mceTableCopyRow"),onPostRender:f},{text:"Paste row before",onclick:m("mceTablePasteRowBefore"),onPostRender:f},{text:"Paste row after",onclick:m("mceTablePasteRowAfter"),onPostRender:f}]},b={text:"Column",context:"table",menu:[{text:"Insert column before",onclick:m("mceTableInsertColBefore"),onPostRender:f},{text:"Insert column after",onclick:m("mceTableInsertColAfter"),onPostRender:f},{text:"Delete column",onclick:m("mceTableDeleteCol"),onPostRender:f}]},w={separator:"before",text:"Cell",context:"table",menu:[{text:"Cell properties",onclick:m("mceTableCellProps"),onPostRender:f},{text:"Merge cells",onclick:m("mceTableMergeCells"),onPostRender:function(){var t=this;i.push(t),n.fold(function(){c(t)},function(e){t.disabled(e.mergable().isNone())})}},{text:"Split cell",onclick:m("mceTableSplitCells"),onPostRender:function(){var t=this;u.push(t),n.fold(function(){c(t)},function(e){t.disabled(e.unmergable().isNone())})}}]};t.addMenuItem("inserttable",d),t.addMenuItem("tableprops",g),t.addMenuItem("deletetable",h),t.addMenuItem("row",p),t.addMenuItem("column",b),t.addMenuItem("cell",w)}},gf=function(t,e){return{insertTable:function(e,n){return bc(t,e,n)},setClipboardRows:function(t){return function(t,e){var n=A(t,yt.fromDom);e.set(v.from(n))}(t,e)},getClipboardRows:function(){return function(t){return t.get().fold(function(){},function(t){return A(t,function(t){return t.dom()})})}(e)}}};e.add("table",function(t){var e=$c(t),i=function(t,e){var i=$(["mousedown","mouseover","mouseup","keyup","keydown"],[]),u=v.none(),c=af.byAttr(lr);return t.on("init",function(a){var l=t.getWin(),f=Au(t),s=ku(t),d=uf.mouse(l,f,s,c),m=uf.keyboard(l,f,s,c),g=function(e,n){(function(t){return!0===t.raw().shiftKey})(e)&&(n.kill()&&e.kill(),n.selection().each(function(e){var n=ca.relative(e.start(),e.finish()),r=ha(l,n);t.selection.setRng(r)}))},h=function(e){var n=w(e);if(n.raw().shiftKey&&nf.isNavigation(n.raw().which)){var r=t.selection.getRng(),o=yt.fromDom(r.startContainer),i=yt.fromDom(r.endContainer);m.keyup(n,o,r.startOffset,i,r.endOffset).each(function(t){g(n,t)})}},p=function(n){var r=w(n);e().each(function(t){t.hideBars()});var o=t.selection.getRng(),i=yt.fromDom(t.selection.getStart()),u=yt.fromDom(o.startContainer),c=yt.fromDom(o.endContainer),a=Mu.directionAt(i).isRtl()?nf.rtl:nf.ltr;m.keydown(r,u,o.startOffset,c,o.endOffset,a).each(function(t){g(r,t)}),e().each(function(t){t.showBars()})},b=function(t){return t.hasOwnProperty("x")&&t.hasOwnProperty("y")},w=function(t){var e=yt.fromDom(t.target),n=function(){t.stopPropagation()},i=function(){t.preventDefault()},u=r(i,n);return{target:o(e),x:o(b(t)?t.x:null),y:o(b(t)?t.y:null),stop:n,prevent:i,kill:u,raw:o(t)}},y=function(t){return 0===t.button},x=function(t){y(t)&&lf(t)&&d.mousedown(w(t))},C=function(t){var e;void 0!==(e=t).buttons&&0==(1&e.buttons)||!lf(t)||d.mouseover(w(t))},S=function(t){y(t)&&lf(t)&&d.mouseup(w(t))};t.on("mousedown",x),t.on("mouseover",C),t.on("mouseup",S),t.on("keyup",h),t.on("keydown",p),t.on("nodechange",function(){var e=t.selection,r=yt.fromDom(e.getStart()),o=yt.fromDom(e.getEnd());er.sharedOne(tn.table,[r,o]).fold(function(){c.clear(f)},n)}),u=v.some(i({mousedown:x,mouseover:C,mouseup:S,keyup:h,keydown:p}))}),{clear:c.clear,destroy:function(){u.each(function(t){})}}}(t,e.lazyResize),u=nc(t,e.lazyWire),c=ff(t),a=Qi(v.none());return Rc.registerCommands(t,u,i,c,a),yr.registerEvents(t,c,u,i),mf.addMenuItems(t,c),df.addButtons(t),df.addToolbars(t),t.on("PreInit",function(){t.serializer.addTempAttr(lr.firstSelected()),t.serializer.addTempAttr(lr.lastSelected())}),zu(t)&&t.on("keydown",function(n){Ya.handle(n,t,u,e.lazyWire)}),t.on("remove",function(){e.destroy(),i.destroy()}),gf(t,a)})}(window);
