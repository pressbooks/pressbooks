!function(t){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),n=function(){},r=function(t,e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t(e.apply(null,n))}},o=function(t){return function(){return t}},i=function(t){return t};function u(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=e.concat(n);return t.apply(null,o)}}var c=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return!t.apply(null,e)}},a=o(!1),l=o(!0),f=function(){return s},s=function(){var t=function(t){return t.isNone()},e=function(t){return t()},r=function(t){return t},i={fold:function(t,e){return t()},is:a,isSome:a,isNone:l,getOr:r,getOrThunk:e,getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:o(null),getOrUndefined:o(void 0),or:r,orThunk:e,map:f,each:n,bind:f,exists:a,forall:l,filter:f,equals:t,equals_:t,toArray:function(){return[]},toString:o("none()")};return Object.freeze&&Object.freeze(i),i}(),d=function(t){var e=o(t),n=function(){return i},r=function(e){return e(t)},i={fold:function(e,n){return n(t)},is:function(e){return t===e},isSome:l,isNone:a,getOr:e,getOrThunk:e,getOrDie:e,getOrNull:e,getOrUndefined:e,or:n,orThunk:n,map:function(e){return d(e(t))},each:function(e){e(t)},bind:r,exists:r,forall:r,filter:function(e){return e(t)?i:s},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(e){return e.is(t)},equals_:function(e,n){return e.fold(a,(function(e){return n(t,e)}))}};return i},m={some:d,none:f,from:function(t){return null==t?s:d(t)}},g=function(t){return function(e){return function(t){if(null===t)return"null";var e=typeof t;return"object"===e&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"===e&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":e}(e)===t}},h=g("string"),p=g("array"),v=g("boolean"),b=g("function"),w=g("number"),y=Array.prototype.slice,x=Array.prototype.indexOf,C=Array.prototype.push,R=function(t,e){return n=t,r=e,x.call(n,r)>-1;var n,r},S=function(t,e){for(var n=0,r=t.length;n<r;n++)if(e(t[n],n))return!0;return!1},T=function(t,e){for(var n=t.length,r=new Array(n),o=0;o<n;o++){var i=t[o];r[o]=e(i,o)}return r},D=function(t,e){for(var n=0,r=t.length;n<r;n++)e(t[n],n)},O=function(t,e){for(var n=[],r=0,o=t.length;r<o;r++){var i=t[r];e(i,r)&&n.push(i)}return n},N=function(t,e,n){return function(t,e){for(var n=t.length-1;n>=0;n--)e(t[n],n)}(t,(function(t){n=e(n,t)})),n},E=function(t,e,n){return D(t,(function(t){n=e(n,t)})),n},k=function(t,e){for(var n=0,r=t.length;n<r;n++){var o=t[n];if(e(o,n))return m.some(o)}return m.none()},A=function(t,e){for(var n=0,r=t.length;n<r;n++)if(e(t[n],n))return m.some(n);return m.none()},P=function(t){for(var e=[],n=0,r=t.length;n<r;++n){if(!p(t[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+t);C.apply(e,t[n])}return e},I=function(t,e){var n=T(t,e);return P(n)},B=function(t,e){for(var n=0,r=t.length;n<r;++n)if(!0!==e(t[n],n))return!1;return!0},W=function(t){var e=y.call(t,0);return e.reverse(),e},M=(b(Array.from)&&Array.from,Object.keys),_=function(t,e){for(var n=M(t),r=0,o=n.length;r<o;r++){var i=n[r];e(t[i],i)}},L=function(t,e){return F(t,(function(t,n){return{k:n,v:e(t,n)}}))},F=function(t,e){var n={};return _(t,(function(t,r){var o=e(t,r);n[o.k]=o.v})),n},j=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(t.length!==e.length)throw new Error('Wrong number of arguments to struct. Expected "['+t.length+']", got '+e.length+" arguments");var r={};return D(t,(function(t,n){r[t]=o(e[n])})),r}},z=function(t){return t.slice(0).sort()},H=function(t,e){throw new Error("All required keys ("+z(t).join(", ")+") were not specified. Specified keys were: "+z(e).join(", ")+".")},U=function(t){throw new Error("Unsupported keys for object: "+z(t).join(", "))},q=function(t,e){if(!p(e))throw new Error("The "+t+" fields must be an array. Was: "+e+".");D(e,(function(e){if(!h(e))throw new Error("The value "+e+" in the "+t+" fields was not a string.")}))},V=function(t){var e=z(t);k(e,(function(t,n){return n<e.length-1&&t===e[n+1]})).each((function(t){throw new Error("The field: "+t+" occurs more than once in the combined fields: ["+e.join(", ")+"].")}))},G=function(t,e){var n=t.concat(e);if(0===n.length)throw new Error("You must specify at least one required or optional field.");return q("required",t),q("optional",e),V(n),function(r){var i=M(r);B(t,(function(t){return R(i,t)}))||H(t,i);var u=O(i,(function(t){return!R(n,t)}));u.length>0&&U(u);var c={};return D(t,(function(t){c[t]=o(r[t])})),D(e,(function(t){c[t]=o(Object.prototype.hasOwnProperty.call(r,t)?m.some(r[t]):m.none())})),c}},Y=(t.Node.ATTRIBUTE_NODE,t.Node.CDATA_SECTION_NODE,t.Node.COMMENT_NODE),X=t.Node.DOCUMENT_NODE,K=(t.Node.DOCUMENT_TYPE_NODE,t.Node.DOCUMENT_FRAGMENT_NODE,t.Node.ELEMENT_NODE),J=t.Node.TEXT_NODE,$=(t.Node.PROCESSING_INSTRUCTION_NODE,t.Node.ENTITY_REFERENCE_NODE,t.Node.ENTITY_NODE,t.Node.NOTATION_NODE,void 0!==t.window?t.window:Function("return this;")()),Q=function(t,e){return function(t,e){for(var n=null!=e?e:$,r=0;r<t.length&&null!=n;++r)n=n[t[r]];return n}(t.split("."),e)},Z=function(t,e){var n=function(t,e){return Q(t,e)}(t,e);if(null==n)throw new Error(t+" not available on this browser");return n},tt=function(t){return t.dom().nodeName.toLowerCase()},et=function(t){return t.dom().nodeType},nt=function(t){return function(e){return et(e)===t}},rt=function(t){return et(t)===Y||"#comment"===tt(t)},ot=nt(K),it=nt(J),ut=function(e,n,r){if(!(h(r)||v(r)||w(r)))throw t.console.error("Invalid call to Attr.set. Key ",n,":: Value ",r,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(n,r+"")},ct=function(t,e,n){ut(t.dom(),e,n)},at=function(t,e){var n=t.dom();_(e,(function(t,e){ut(n,e,t)}))},lt=function(t,e){var n=t.dom().getAttribute(e);return null===n?void 0:n},ft=function(t,e){var n=t.dom();return!(!n||!n.hasAttribute)&&n.hasAttribute(e)},st=function(t,e){t.dom().removeAttribute(e)},dt=function(t){return E(t.dom().attributes,(function(t,e){return t[e.name]=e.value,t}),{})},mt=function(t,e){return-1!==t.indexOf(e)},gt=function(t){return void 0!==t.style&&b(t.style.getPropertyValue)},ht=function(t){var e,n=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return n||(n=!0,e=t.apply(null,r)),e}},pt=function(t){if(null==t)throw new Error("Node cannot be null or undefined");return{dom:o(t)}},vt={fromHtml:function(e,n){var r=(n||t.document).createElement("div");if(r.innerHTML=e,!r.hasChildNodes()||r.childNodes.length>1)throw t.console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return pt(r.childNodes[0])},fromTag:function(e,n){var r=(n||t.document).createElement(e);return pt(r)},fromText:function(e,n){var r=(n||t.document).createTextNode(e);return pt(r)},fromDom:pt,fromPoint:function(t,e,n){var r=t.dom();return m.from(r.elementFromPoint(e,n)).map(pt)}},bt=function(t){var e=it(t)?t.dom().parentNode:t.dom();return null!=e&&e.ownerDocument.body.contains(e)},wt=ht((function(){return yt(vt.fromDom(t.document))})),yt=function(t){var e=t.dom().body;if(null==e)throw new Error("Body is not available yet");return vt.fromDom(e)},xt=function(e,n,r){if(!h(r))throw t.console.error("Invalid call to CSS.set. Property ",n,":: Value ",r,":: Element ",e),new Error("CSS value must be a string: "+r);gt(e)&&e.style.setProperty(n,r)},Ct=function(t,e,n){var r=t.dom();xt(r,e,n)},Rt=function(t,e){var n=t.dom();_(e,(function(t,e){xt(n,e,t)}))},St=function(e,n){var r=e.dom(),o=t.window.getComputedStyle(r).getPropertyValue(n),i=""!==o||bt(e)?o:Tt(r,n);return null===i?void 0:i},Tt=function(t,e){return gt(t)?t.style.getPropertyValue(e):""},Dt=function(t,e){var n=t.dom(),r=Tt(n,e);return m.from(r).filter((function(t){return t.length>0}))},Ot=function(t,e){!function(t,e){gt(t)&&t.style.removeProperty(e)}(t.dom(),e),ft(t,"style")&&""===lt(t,"style").replace(/^\s+|\s+$/g,"")&&st(t,"style")},Nt=function(){return Z("Node")},Et=function(t,e,n){return 0!=(t.compareDocumentPosition(e)&n)},kt=function(t,e){return Et(t,e,Nt().DOCUMENT_POSITION_CONTAINED_BY)},At=function(){return Pt(0,0)},Pt=function(t,e){return{major:t,minor:e}},It={nu:Pt,detect:function(t,e){var n=String(e).toLowerCase();return 0===t.length?At():function(t,e){var n=function(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(r.test(e))return r}}(t,e);if(!n)return{major:0,minor:0};var r=function(t){return Number(e.replace(n,"$"+t))};return Pt(r(1),r(2))}(t,n)},unknown:At},Bt="Edge",Wt="Chrome",Mt="Opera",_t="Firefox",Lt="Safari",Ft=function(t,e){return function(){return e===t}},jt=function(t){var e=t.current;return{current:e,version:t.version,isEdge:Ft(Bt,e),isChrome:Ft(Wt,e),isIE:Ft("IE",e),isOpera:Ft(Mt,e),isFirefox:Ft(_t,e),isSafari:Ft(Lt,e)}},zt={unknown:function(){return jt({current:void 0,version:It.unknown()})},nu:jt,edge:o(Bt),chrome:o(Wt),ie:o("IE"),opera:o(Mt),firefox:o(_t),safari:o(Lt)},Ht="Windows",Ut="Android",qt="Linux",Vt="Solaris",Gt="FreeBSD",Yt=function(t,e){return function(){return e===t}},Xt=function(t){var e=t.current;return{current:e,version:t.version,isWindows:Yt(Ht,e),isiOS:Yt("iOS",e),isAndroid:Yt(Ut,e),isOSX:Yt("OSX",e),isLinux:Yt(qt,e),isSolaris:Yt(Vt,e),isFreeBSD:Yt(Gt,e)}},Kt={unknown:function(){return Xt({current:void 0,version:It.unknown()})},nu:Xt,windows:o(Ht),ios:o("iOS"),android:o(Ut),linux:o(qt),osx:o("OSX"),solaris:o(Vt),freebsd:o(Gt)},Jt=function(t,e){var n=String(e).toLowerCase();return k(t,(function(t){return t.search(n)}))},$t=function(t,e){return Jt(t,e).map((function(t){var n=It.detect(t.versionRegexes,e);return{current:t.name,version:n}}))},Qt=function(t,e){return Jt(t,e).map((function(t){var n=It.detect(t.versionRegexes,e);return{current:t.name,version:n}}))},Zt=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,te=function(t){return function(e){return mt(e,t)}},ee=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return mt(t,"edge/")&&mt(t,"chrome")&&mt(t,"safari")&&mt(t,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Zt],search:function(t){return mt(t,"chrome")&&!mt(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return mt(t,"msie")||mt(t,"trident")}},{name:"Opera",versionRegexes:[Zt,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:te("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:te("firefox")},{name:"Safari",versionRegexes:[Zt,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return(mt(t,"safari")||mt(t,"mobile/"))&&mt(t,"applewebkit")}}],ne=[{name:"Windows",search:te("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return mt(t,"iphone")||mt(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:te("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:te("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:te("linux"),versionRegexes:[]},{name:"Solaris",search:te("sunos"),versionRegexes:[]},{name:"FreeBSD",search:te("freebsd"),versionRegexes:[]}],re={browsers:o(ee),oses:o(ne)},oe=function(t){var e=re.browsers(),n=re.oses(),r=$t(e,t).fold(zt.unknown,zt.nu),i=Qt(n,t).fold(Kt.unknown,Kt.nu),u=function(t,e,n){var r=t.isiOS()&&!0===/ipad/i.test(n),i=t.isiOS()&&!r,u=t.isAndroid()&&3===t.version.major,c=t.isAndroid()&&4===t.version.major,a=r||u||c&&!0===/mobile/i.test(n),l=t.isiOS()||t.isAndroid(),f=l&&!a,s=e.isSafari()&&t.isiOS()&&!1===/safari/i.test(n);return{isiPad:o(r),isiPhone:o(i),isTablet:o(a),isPhone:o(f),isTouch:o(l),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:o(s)}}(i,r,t);return{browser:r,os:i,deviceType:u}},ie={detect:ht((function(){var e=t.navigator.userAgent;return oe(e)}))},ue=K,ce=X,ae=function(t,e){var n=t.dom();if(n.nodeType!==ue)return!1;var r=n;if(void 0!==r.matches)return r.matches(e);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(e);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(e);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")},le=function(t){return t.nodeType!==ue&&t.nodeType!==ce||0===t.childElementCount},fe=function(t,e){return t.dom()===e.dom()},se=ie.detect().browser.isIE()?function(t,e){return kt(t.dom(),e.dom())}:function(t,e){var n=t.dom(),r=e.dom();return n!==r&&n.contains(r)},de=ae,me=function(t){return vt.fromDom(t.dom().ownerDocument)},ge=function(t){return m.from(t.dom().parentNode).map(vt.fromDom)},he=function(t,e){for(var n=b(e)?e:a,r=t.dom(),o=[];null!==r.parentNode&&void 0!==r.parentNode;){var i=r.parentNode,u=vt.fromDom(i);if(o.push(u),!0===n(u))break;r=i}return o},pe=function(t){return m.from(t.dom().previousSibling).map(vt.fromDom)},ve=function(t){return m.from(t.dom().nextSibling).map(vt.fromDom)},be=function(t){return T(t.dom().childNodes,vt.fromDom)},we=function(t,e){var n=t.dom().childNodes;return m.from(n[e]).map(vt.fromDom)},ye=(j("element","offset"),function(t,e){ge(t).each((function(n){n.dom().insertBefore(e.dom(),t.dom())}))}),xe=function(t,e){ve(t).fold((function(){ge(t).each((function(t){Re(t,e)}))}),(function(t){ye(t,e)}))},Ce=function(t,e){var n=function(t){return we(t,0)}(t);n.fold((function(){Re(t,e)}),(function(n){t.dom().insertBefore(e.dom(),n.dom())}))},Re=function(t,e){t.dom().appendChild(e.dom())},Se=function(t,e){ye(t,e),Re(e,t)},Te=function(t,e){D(e,(function(n,r){var o=0===r?t:e[r-1];xe(o,n)}))},De=function(t,e){D(e,(function(e){Re(t,e)}))},Oe=function(t){t.dom().textContent="",D(be(t),(function(t){Ne(t)}))},Ne=function(t){var e=t.dom();null!==e.parentNode&&e.parentNode.removeChild(e)},Ee=function(t){var e,n=be(t);n.length>0&&(e=t,D(n,(function(t){ye(e,t)}))),Ne(t)},ke=(j("width","height"),j("width","height"),j("rows","columns")),Ae=j("row","column"),Pe=(j("x","y"),j("element","rowspan","colspan")),Ie=j("element","rowspan","colspan","isNew"),Be=j("element","rowspan","colspan","row","column"),We=j("element","cells","section"),Me=j("element","isNew"),_e=j("element","cells","section","isNew"),Le=j("cells","section"),Fe=j("details","section"),je=j("startRow","startCol","finishRow","finishCol"),ze=function(t,e){var n=[];return D(be(t),(function(t){e(t)&&(n=n.concat([t])),n=n.concat(ze(t,e))})),n},He=function(t,e,n){return function(t,e,n){return O(he(t,n),e)}(t,(function(t){return ae(t,e)}),n)},Ue=function(t,e){return function(t,e){return O(be(t),e)}(t,(function(t){return ae(t,e)}))},qe=function(e,n){return function(e,n){var r=void 0===n?t.document:n.dom();return le(r)?[]:T(r.querySelectorAll(e),vt.fromDom)}(n,e)};function Ve(t,e,n,r,o){return t(n,r)?m.some(n):b(o)&&o(n)?m.none():e(n,r,o)}var Ge=function(t,e,n){for(var r=t.dom(),i=b(n)?n:o(!1);r.parentNode;){r=r.parentNode;var u=vt.fromDom(r);if(e(u))return m.some(u);if(i(u))break}return m.none()},Ye=function(t,e,n){return Ge(t,(function(t){return ae(t,e)}),n)},Xe=function(t,e){return function(t,e){var n=k(t.dom().childNodes,(function(t){return e(vt.fromDom(t))}));return n.map(vt.fromDom)}(t,(function(t){return ae(t,e)}))},Ke=function(e,n){return function(e,n){var r=void 0===n?t.document:n.dom();return le(r)?m.none():m.from(r.querySelector(e)).map(vt.fromDom)}(n,e)},Je=function(t,e,n){return Ve(ae,Ye,t,e,n)},$e=function(t,e,n){return I(be(t),(function(t){return ae(t,e)?n(t)?[t]:[]:$e(t,e,n)}))},Qe={firstLayer:function(t,e){return $e(t,e,o(!0))},filterFirstLayer:$e},Ze=function(t,e,n){return void 0===n&&(n=a),n(e)?m.none():R(t,tt(e))?m.some(e):Ye(e,t.join(","),(function(t){return ae(t,"table")||n(t)}))},tn=function(t,e){return ge(e).map((function(e){return Ue(e,t)}))},en=u(tn,"th,td"),nn=u(tn,"tr"),rn=function(t,e){return parseInt(lt(t,e),10)},on={cell:function(t,e){return Ze(["td","th"],t,e)},firstCell:function(t){return Ke(t,"th,td")},cells:function(t){return Qe.firstLayer(t,"th,td")},neighbourCells:en,table:function(t,e){return Je(t,"table",e)},row:function(t,e){return Ze(["tr"],t,e)},rows:function(t){return Qe.firstLayer(t,"tr")},notCell:function(t,e){return Ze(["caption","tr","tbody","tfoot","thead"],t,e)},neighbourRows:nn,attr:rn,grid:function(t,e,n){var r=rn(t,e),o=rn(t,n);return ke(r,o)}},un=function(t){var e=on.rows(t);return T(e,(function(t){var e=t,n=ge(e).map((function(t){var e=tt(t);return"tfoot"===e||"thead"===e||"tbody"===e?e:"tbody"})).getOr("tbody"),r=T(on.cells(t),(function(t){var e=ft(t,"rowspan")?parseInt(lt(t,"rowspan"),10):1,n=ft(t,"colspan")?parseInt(lt(t,"colspan"),10):1;return Pe(t,e,n)}));return We(e,r,n)}))},cn=function(t,e){return T(t,(function(t){var n=T(on.cells(t),(function(t){var e=ft(t,"rowspan")?parseInt(lt(t,"rowspan"),10):1,n=ft(t,"colspan")?parseInt(lt(t,"colspan"),10):1;return Pe(t,e,n)}));return We(t,n,e.section())}))},an=function(t,e){return t+","+e},ln=function(t,e){var n=I(t.all(),(function(t){return t.cells()}));return O(n,e)},fn={generate:function(t){var e={},n=[],r=t.length,i=0;D(t,(function(t,r){var o=[];D(t.cells(),(function(t){for(var n=0;void 0!==e[an(r,n)];)n++;for(var u=Be(t.element(),t.rowspan(),t.colspan(),r,n),c=0;c<t.colspan();c++)for(var a=0;a<t.rowspan();a++){var l=n+c,f=an(r+a,l);e[f]=u,i=Math.max(i,l+1)}o.push(u)})),n.push(We(t.element(),o,t.section()))}));var u=ke(r,i);return{grid:o(u),access:o(e),all:o(n)}},getAt:function(t,e,n){var r=t.access()[an(e,n)];return void 0!==r?m.some(r):m.none()},findItem:function(t,e,n){var r=ln(t,(function(t){return n(e,t.element())}));return r.length>0?m.some(r[0]):m.none()},filterItems:ln,justCells:function(t){var e=T(t.all(),(function(t){return t.cells()}));return P(e)}},sn=j("minRow","minCol","maxRow","maxCol"),dn=function(t,e,n){var r=t[n].element(),o=vt.fromTag("td");Re(o,vt.fromTag("br")),(e?Re:Ce)(r,o)},mn=function(t,e){var n=function(t){return ae(t.element(),e)},r=un(t),o=fn.generate(r),i=function(t,e){var n=t.grid().columns(),r=t.grid().rows(),o=n,i=0,u=0;return _(t.access(),(function(t){if(e(t)){var n=t.row(),c=n+t.rowspan()-1,a=t.column(),l=a+t.colspan()-1;n<r?r=n:c>i&&(i=c),a<o?o=a:l>u&&(u=l)}})),sn(r,o,i,u)}(o,n),u="th:not("+e+"),td:not("+e+")",c=Qe.filterFirstLayer(t,"th,td",(function(t){return ae(t,u)}));return D(c,Ne),function(t,e,n,r){for(var o=e.grid().columns(),i=e.grid().rows(),u=0;u<i;u++)for(var c=!1,a=0;a<o;a++)u<n.minRow()||u>n.maxRow()||a<n.minCol()||a>n.maxCol()||(fn.getAt(e,u,a).filter(r).isNone()?dn(t,c,u):c=!0)}(r,o,i,n),function(t,e){var n=O(Qe.firstLayer(t,"tr"),(function(t){return 0===t.dom().childElementCount}));D(n,Ne),e.minCol()!==e.maxCol()&&e.minRow()!==e.maxRow()||D(Qe.firstLayer(t,"th,td"),(function(t){st(t,"rowspan"),st(t,"colspan")})),st(t,"width"),st(t,"height"),Ot(t,"width"),Ot(t,"height")}(t,i),t},gn=function(t,e){var n=function(e){return t(e)?m.from(e.dom().nodeValue):m.none()};return{get:function(r){if(!t(r))throw new Error("Can only get "+e+" value of a "+e+" node");return n(r).getOr("")},getOption:n,set:function(n,r){if(!t(n))throw new Error("Can only set raw "+e+" value of a "+e+" node");n.dom().nodeValue=r}}}(it,"text"),hn=function(t){return gn.get(t)},pn=function(t){return gn.getOption(t)},vn=function(t,e){gn.set(t,e)},bn=function(t){return"img"===tt(t)?1:pn(t).fold((function(){return be(t).length}),(function(t){return t.length}))},wn=["img","br"],yn=function(t){var e=pn(t).filter((function(t){return 0!==t.trim().length||t.indexOf("Â ")>-1})).isSome();return e||R(wn,tt(t))},xn=function(t){return e=yn,n=function(t){for(var r=0;r<t.childNodes.length;r++){var o=vt.fromDom(t.childNodes[r]);if(e(o))return m.some(o);var i=n(t.childNodes[r]);if(i.isSome())return i}return m.none()},n(t.dom());var e,n},Cn=function(t){return Rn(t,yn)},Rn=function(t,e){var n=function(t){for(var r=be(t),o=r.length-1;o>=0;o--){var i=r[o];if(e(i))return m.some(i);var u=n(i);if(u.isSome())return u}return m.none()};return n(t)},Sn=function(t,e){return vt.fromDom(t.dom().cloneNode(e))},Tn=function(t){return Sn(t,!1)},Dn=function(t){return Sn(t,!0)},On=function(t,e){var n=function(t,e){var n=vt.fromTag(e),r=dt(t);return at(n,r),n}(t,e),r=be(Dn(t));return De(n,r),n},Nn=function(){var t=vt.fromTag("td");return Re(t,vt.fromTag("br")),t},En=function(t,e,n){var r=On(t,e);return _(n,(function(t,e){null===t?st(r,e):ct(r,e,t)})),r},kn=function(t){return t},An=function(t){return function(){return vt.fromTag("tr",t.dom())}},Pn=function(t,e,n){return{row:An(e),cell:function(e){var r,o,i,u,c=me(e.element()),a=vt.fromTag(tt(e.element()),c.dom()),l=n.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),f=l.length>0?function(t,e,n){return xn(t).map((function(r){var o=n.join(","),i=He(r,o,(function(e){return fe(e,t)}));return N(i,(function(t,e){var n=Tn(e);return st(n,"contenteditable"),Re(t,n),n}),e)})).getOr(e)}(e.element(),a,l):a;return Re(f,vt.fromTag("br")),r=e.element(),o=a,i=r.dom(),u=o.dom(),gt(i)&&gt(u)&&(u.style.cssText=i.style.cssText),Ot(a,"height"),1!==e.colspan()&&Ot(e.element(),"width"),t(e.element(),a),a},replace:En,gap:Nn}},In=function(t){return{row:An(t),cell:Nn,replace:kn,gap:Nn}},Bn=function(t,e){return e.column()>=t.startCol()&&e.column()+e.colspan()-1<=t.finishCol()&&e.row()>=t.startRow()&&e.row()+e.rowspan()-1<=t.finishRow()},Wn=function(t,e){var n=e.column(),r=e.column()+e.colspan()-1,o=e.row(),i=e.row()+e.rowspan()-1;return n<=t.finishCol()&&r>=t.startCol()&&o<=t.finishRow()&&i>=t.startRow()},Mn=function(t,e){for(var n=!0,r=u(Bn,e),o=e.startRow();o<=e.finishRow();o++)for(var i=e.startCol();i<=e.finishCol();i++)n=n&&fn.getAt(t,o,i).exists(r);return n?m.some(e):m.none()},_n=function(t,e,n){var r=fn.findItem(t,e,fe),o=fn.findItem(t,n,fe);return r.bind((function(t){return o.map((function(e){return n=t,r=e,je(Math.min(n.row(),r.row()),Math.min(n.column(),r.column()),Math.max(n.row()+n.rowspan()-1,r.row()+r.rowspan()-1),Math.max(n.column()+n.colspan()-1,r.column()+r.colspan()-1));var n,r}))}))},Ln=_n,Fn=function(t,e,n){return _n(t,e,n).bind((function(e){return Mn(t,e)}))},jn=function(t,e,n,r){return fn.findItem(t,e,fe).bind((function(e){var o=n>0?e.row()+e.rowspan()-1:e.row(),i=r>0?e.column()+e.colspan()-1:e.column();return fn.getAt(t,o+n,i+r).map((function(t){return t.element()}))}))},zn=function(t,e,n){return Ln(t,e,n).map((function(e){var n=fn.filterItems(t,u(Wn,e));return T(n,(function(t){return t.element()}))}))},Hn=function(t,e){return fn.findItem(t,e,(function(t,e){return se(e,t)})).map((function(t){return t.element()}))},Un=function(t){var e=un(t);return fn.generate(e)},qn=function(t,e,n){return on.table(t).bind((function(r){var o=Un(r);return jn(o,t,e,n)}))},Vn=function(t,e,n){var r=Un(t);return zn(r,e,n)},Gn=function(t,e,n,r,o){var i=Un(t),u=fe(t,n)?m.some(e):Hn(i,e),c=fe(t,o)?m.some(r):Hn(i,r);return u.bind((function(t){return c.bind((function(e){return zn(i,t,e)}))}))},Yn=function(t,e,n){var r=Un(t);return Fn(r,e,n)},Xn=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function Kn(){return{up:o({selector:Ye,closest:Je,predicate:Ge,all:he}),down:o({selector:qe,predicate:ze}),styles:o({get:St,getRaw:Dt,set:Ct,remove:Ot}),attrs:o({get:lt,set:ct,remove:st,copyTo:function(t,e){var n=dt(t);at(e,n)}}),insert:o({before:ye,after:xe,afterAll:Te,append:Re,appendAll:De,prepend:Ce,wrap:Se}),remove:o({unwrap:Ee,remove:Ne}),create:o({nu:vt.fromTag,clone:function(t){return vt.fromDom(t.dom().cloneNode(!1))},text:vt.fromText}),query:o({comparePosition:function(t,e){return t.dom().compareDocumentPosition(e.dom())},prevSibling:pe,nextSibling:ve}),property:o({children:be,name:tt,parent:ge,document:function(t){return t.dom().ownerDocument},isText:it,isComment:rt,isElement:ot,getText:hn,setText:vn,isBoundary:function(t){return!!ot(t)&&("body"===tt(t)||R(Xn,tt(t)))},isEmptyTag:function(t){return!!ot(t)&&R(["br","img","hr","input"],tt(t))}}),eq:fe,is:de}}var Jn=j("left","right"),$n=j("first","second","splits"),Qn=function(t,e,n){var r=t.property().children(e);return A(r,u(t.eq,n)).map((function(t){return{before:o(r.slice(0,t)),after:o(r.slice(t+1))}}))},Zn=function(t,e,n,r){var o=e(t,n);return N(r,(function(n,r){var o=e(t,r);return tr(t,n,o)}),o)},tr=function(t,e,n){return e.bind((function(e){return n.filter(u(t.eq,e))}))},er=function(t,e){return u(t.eq,e)},nr=function(t,e,n,r){void 0===r&&(r=a);var i=[e].concat(t.up().all(e)),u=[n].concat(t.up().all(n)),c=function(t){return A(t,r).fold((function(){return t}),(function(e){return t.slice(0,e+1)}))},l=c(i),f=c(u),s=k(l,(function(e){return S(f,er(t,e))}));return{firstpath:o(l),secondpath:o(f),shared:o(s)}},rr=function(t,e,n){var r=nr(t,e,n);return r.shared().bind((function(e){return function(t,e,n,r){var o=t.property().children(e);if(t.eq(e,n[0]))return m.some([n[0]]);if(t.eq(e,r[0]))return m.some([r[0]]);var i=function(n){var r=W(n),i=A(r,er(t,e)).getOr(-1),u=i<r.length-1?r[i+1]:r[i];return A(o,er(t,u))},u=i(n),c=i(r);return u.bind((function(t){return c.map((function(e){var n=Math.min(t,e),r=Math.max(t,e);return o.slice(n,r+1)}))}))}(t,e,r.firstpath(),r.secondpath())}))},or=function(t,e,n){return n.length>0?function(t,e,n,r){return r(t,e,n[0],n.slice(1))}(t,e,n,Zn):m.none()},ir=function(t,e,n){return Qn(t,e,n).map((function(r){var o=t.create().clone(e);return t.insert().appendAll(o,r.before().concat([n])),t.insert().appendAll(e,r.after()),t.insert().before(e,o),Jn(o,e)}))},ur=function(t,e,n){return Qn(t,e,n).map((function(n){var r=t.create().clone(e);return t.insert().appendAll(r,n.after()),t.insert().after(e,r),Jn(e,r)}))},cr=function(t,e,n,r){var o=function(e,i,u){var c=$n(e,m.none(),u);return n(e)?$n(e,i,u):t.property().parent(e).bind((function(i){return r(t,i,e).map((function(t){var e=[{first:t.left,second:t.right}],r=n(i)?i:t.left();return o(r,m.some(t.right()),u.concat(e))}))})).getOr(c)};return o(e,m.none(),[])},ar={sharedOne:or,subset:rr,ancestors:nr,breakToLeft:ir,breakToRight:ur,breakPath:cr},lr=Kn(),fr={sharedOne:function(t,e){return ar.sharedOne(lr,(function(e,n){return t(n)}),e)},subset:function(t,e){return ar.subset(lr,t,e)},ancestors:function(t,e,n){return ar.ancestors(lr,t,e,n)},breakToLeft:function(t,e){return ar.breakToLeft(lr,t,e)},breakToRight:function(t,e){return ar.breakToRight(lr,t,e)},breakPath:function(t,e,n){return ar.breakPath(lr,t,e,(function(t,e,r){return n(e,r)}))}},sr={create:G(["boxes","start","finish"],[])},dr=function(t){return Ye(t,"table")},mr=function(t,e,n){var r=function(t){return function(e){return void 0!==n&&n(e)||fe(e,t)}};return fe(t,e)?m.some(sr.create({boxes:m.some([t]),start:t,finish:e})):dr(t).bind((function(o){return dr(e).bind((function(i){if(fe(o,i))return m.some(sr.create({boxes:Vn(o,t,e),start:t,finish:e}));if(se(o,i)){var u=(c=He(e,"td,th",r(o))).length>0?c[c.length-1]:e;return m.some(sr.create({boxes:Gn(o,t,o,e,i),start:t,finish:u}))}if(se(i,o)){var c,a=(c=He(t,"td,th",r(i))).length>0?c[c.length-1]:t;return m.some(sr.create({boxes:Gn(i,t,o,e,i),start:t,finish:a}))}return fr.ancestors(t,e).shared().bind((function(u){return Je(u,"table",n).bind((function(n){var u=He(e,"td,th",r(n)),c=u.length>0?u[u.length-1]:e,a=He(t,"td,th",r(n)),l=a.length>0?a[a.length-1]:t;return m.some(sr.create({boxes:Gn(n,t,o,e,i),start:l,finish:c}))}))}))}))}))},gr=mr,hr=function(t,e){var n=qe(t,e);return n.length>0?m.some(n):m.none()},pr=function(t,e,n,r,i){return function(t,e){return k(t,(function(t){return ae(t,e)}))}(t,i).bind((function(t){return qn(t,e,n).bind((function(t){return function(t,e){return Ye(t,"table").bind((function(n){return Ke(n,e).bind((function(e){return mr(e,t).bind((function(t){return t.boxes().map((function(e){return{boxes:o(e),start:o(t.start()),finish:o(t.finish())}}))}))}))}))}(t,r)}))}))},vr=function(t,e,n){return Ke(t,e).bind((function(e){return Ke(t,n).bind((function(t){return fr.sharedOne(dr,[e,t]).map((function(n){return{first:o(e),last:o(t),table:o(n)}}))}))}))},br=function(t,e){return hr(t,e)},wr=function(t,e,n){return vr(t,e,n).bind((function(e){var n=function(e){return fe(t,e)},r=Ye(e.first(),"thead,tfoot,tbody,table",n),o=Ye(e.last(),"thead,tfoot,tbody,table",n);return r.bind((function(t){return o.bind((function(n){return fe(t,n)?Yn(e.table(),e.first(),e.last()):m.none()}))}))}))},yr="data-mce-selected",xr="td["+yr+"],th["+yr+"]",Cr="["+yr+"]",Rr="data-mce-first-selected",Sr="td["+Rr+"],th["+Rr+"]",Tr="data-mce-last-selected",Dr="td["+Tr+"],th["+Tr+"]",Or={selected:o(yr),selectedSelector:o(xr),attributeSelector:o(Cr),firstSelected:o(Rr),firstSelectedSelector:o(Sr),lastSelected:o(Tr),lastSelectedSelector:o(Dr)},Nr=function(e){if(!p(e))throw new Error("cases must be an array");if(0===e.length)throw new Error("there must be at least one case");var n=[],r={};return D(e,(function(o,i){var u=M(o);if(1!==u.length)throw new Error("one and only one name per case");var c=u[0],a=o[c];if(void 0!==r[c])throw new Error("duplicate key detected:"+c);if("cata"===c)throw new Error("cannot have a case named cata (sorry)");if(!p(a))throw new Error("case arguments must be an array");n.push(c),r[c]=function(){var r=arguments.length;if(r!==a.length)throw new Error("Wrong number of arguments to case "+c+". Expected "+a.length+" ("+a+"), got "+r);for(var o=new Array(r),u=0;u<o.length;u++)o[u]=arguments[u];return{fold:function(){if(arguments.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+arguments.length);return arguments[i].apply(null,o)},match:function(t){var e=M(t);if(n.length!==e.length)throw new Error("Wrong number of arguments to match. Expected: "+n.join(",")+"\nActual: "+e.join(","));if(!B(n,(function(t){return R(e,t)})))throw new Error("Not all branches were specified when using match. Specified: "+e.join(", ")+"\nRequired: "+n.join(", "));return t[c].apply(null,o)},log:function(e){t.console.log(e,{constructors:n,constructor:c,params:o})}}}})),r},Er=Nr([{none:[]},{multiple:["elements"]},{single:["selection"]}]),kr={cata:function(t,e,n,r){return t.fold(e,n,r)},none:Er.none,multiple:Er.multiple,single:Er.single},Ar=function(t,e){return kr.cata(e.get(),o([]),i,o([t]))},Pr=function(t,e){return kr.cata(e.get(),m.none,(function(e,n){return 0===e.length?m.none():wr(t,Or.firstSelectedSelector(),Or.lastSelectedSelector()).bind((function(t){return e.length>1?m.some({bounds:o(t),cells:o(e)}):m.none()}))}),m.none)},Ir=function(t,e){var n=Ar(t,e);return n.length>0&&B(n,(function(t){return ft(t,"rowspan")&&parseInt(lt(t,"rowspan"),10)>1||ft(t,"colspan")&&parseInt(lt(t,"colspan"),10)>1}))?m.some(n):m.none()},Br=Ar,Wr=function(t){return{element:o(t),mergable:m.none,unmergable:m.none,selection:o([t])}},Mr=j("element","clipboard","generators"),_r={noMenu:Wr,forMenu:function(t,e,n){return{element:o(n),mergable:o(Pr(e,t)),unmergable:o(Ir(n,t)),selection:o(Br(n,t))}},notCell:function(t){return Wr(t)},paste:Mr,pasteRows:function(t,e,n,r,i){return{element:o(n),mergable:m.none,unmergable:m.none,selection:o(Br(n,t)),clipboard:o(r),generators:o(i)}}},Lr=function(e,r,o,i){e.on("BeforeGetContent",(function(t){!0===t.selection&&kr.cata(r.get(),n,(function(n){t.preventDefault(),function(t){return on.table(t[0]).map(Dn).map((function(t){return[mn(t,Or.attributeSelector())]}))}(n).each((function(n){t.content="text"===t.format?function(t){return T(t,(function(t){return t.dom().innerText})).join("")}(n):function(t,e){return T(e,(function(e){return t.selection.serializer.serialize(e.dom(),{})})).join("")}(e,n)}))}),n)})),e.on("BeforeSetContent",(function(n){!0===n.selection&&!0===n.paste&&m.from(e.dom.getParent(e.selection.getStart(),"th,td")).each((function(r){var u=vt.fromDom(r);on.table(u).each((function(r){var c,a,l,f=O((c=n.content,(l=(a||t.document).createElement("div")).innerHTML=c,be(vt.fromDom(l))),(function(t){return"meta"!==tt(t)}));if(1===f.length&&"table"===tt(f[0])){n.preventDefault();var s=vt.fromDom(e.getDoc()),d=In(s),m=_r.paste(u,f[0],d);o.pasteCells(r,m).each((function(t){e.selection.setRng(t),e.focus(),i.clear(r)}))}}))}))}))};function Fr(t,e){var n=function(n){var r=e(n);if(r<=0||null===r){var o=St(n,t);return parseFloat(o)||0}return r},r=function(t,e){return E(e,(function(e,n){var r=St(t,n),o=void 0===r?0:parseInt(r,10);return isNaN(o)?e:e+o}),0)};return{set:function(e,n){if(!w(n)&&!n.match(/^[0-9]+$/))throw new Error(t+".set accepts only positive integer values. Value was "+n);var r=e.dom();gt(r)&&(r.style[t]=n+"px")},get:n,getOuter:n,aggregate:r,max:function(t,e,n){var o=r(t,n);return e>o?e-o:0}}}var jr=Fr("height",(function(t){var e=t.dom();return bt(t)?e.getBoundingClientRect().height:e.offsetHeight})),zr=function(t){return jr.get(t)},Hr=function(t){return jr.getOuter(t)},Ur=Fr("width",(function(t){return t.dom().offsetWidth})),qr=function(t){return Ur.get(t)},Vr=function(t){return Ur.getOuter(t)},Gr=ie.detect(),Yr=function(t,e,n){return function(t,e){var n=parseFloat(t);return isNaN(n)?e:n}(St(t,e),n)},Xr=function(t){return Gr.browser.isIE()||Gr.browser.isEdge()?function(t){var e=Yr(t,"padding-top",0),n=Yr(t,"padding-bottom",0),r=Yr(t,"border-top-width",0),o=Yr(t,"border-bottom-width",0),i=t.dom().getBoundingClientRect().height;return"border-box"===St(t,"box-sizing")?i:i-e-n-(r+o)}(t):Yr(t,"height",zr(t))},Kr=/(\d+(\.\d+)?)(\w|%)*/,Jr=/(\d+(\.\d+)?)%/,$r=/(\d+(\.\d+)?)px|em/,Qr=function(t,e){Ct(t,"height",e+"px")},Zr=function(t,e,n,r){var o,i,u=parseInt(t,10);return function(t,e,n){return""===e||!(t.length<e.length)&&t.substr(n,n+e.length)===e}(o=t,i="%",o.length-i.length)&&"table"!==tt(e)?function(t,e,n,r){var o=on.table(t).map((function(t){var r=n(t);return Math.floor(e/100*r)})).getOr(e);return r(t,o),o}(e,u,n,r):u},to=function(t){var e=function(t){return Dt(t,"height").getOrThunk((function(){return Xr(t)+"px"}))}(t);return e?Zr(e,t,zr,Qr):zr(t)},eo=function(t,e){return ft(t,e)?parseInt(lt(t,e),10):1},no=function(t){return Dt(t,"width").fold((function(){return m.from(lt(t,"width"))}),(function(t){return m.some(t)}))},ro=function(t,e){return t/e.pixelWidth()*100},oo={percentageBasedSizeRegex:o(Jr),pixelBasedSizeRegex:o($r),setPixelWidth:function(t,e){Ct(t,"width",e+"px")},setPercentageWidth:function(t,e){Ct(t,"width",e+"%")},setHeight:Qr,getPixelWidth:function(t,e){return no(t).fold((function(){return qr(t)}),(function(n){return function(t,e,n){var r=$r.exec(e);if(null!==r)return parseInt(r[1],10);var o=Jr.exec(e);return null!==o?function(t,e){return t/100*e.pixelWidth()}(parseFloat(o[1]),n):qr(t)}(t,n,e)}))},getPercentageWidth:function(t,e){return no(t).fold((function(){var n=qr(t);return ro(n,e)}),(function(n){return function(t,e,n){var r=Jr.exec(e);if(null!==r)return parseFloat(r[1]);var o=qr(t);return ro(o,n)}(t,n,e)}))},getGenericWidth:function(t){return no(t).bind((function(t){var e=Kr.exec(t);return null!==e?m.some({width:o(parseFloat(e[1])),unit:o(e[3])}):m.none()}))},setGenericWidth:function(t,e,n){Ct(t,"width",e+n)},getHeight:function(t){return function(t,e,n){return n(t)/eo(t,e)}(t,"rowspan",to)},getRawWidth:no},io=function(t,e){oo.getGenericWidth(t).each((function(n){var r=n.width()/2;oo.setGenericWidth(t,r,n.unit()),oo.setGenericWidth(e,r,n.unit())}))},uo=function(t,e){return{left:o(t),top:o(e),translate:function(n,r){return uo(t+n,e+r)}}},co=uo,ao=function(t,e){return void 0!==t?t:void 0!==e?e:0},lo=function(t){var e=t.dom().ownerDocument,n=e.body,r=e.defaultView,o=e.documentElement,i=ao(r.pageYOffset,o.scrollTop),u=ao(r.pageXOffset,o.scrollLeft),c=ao(o.clientTop,n.clientTop),a=ao(o.clientLeft,n.clientLeft);return fo(t).translate(u-a,i-c)},fo=function(t){var e=t.dom(),n=e.ownerDocument.body;return n===e?co(n.offsetLeft,n.offsetTop):bt(t)?function(t){var e=t.getBoundingClientRect();return co(e.left,e.top)}(e):co(0,0)},so=j("row","y"),mo=j("col","x"),go=function(t){return lo(t).left()+Vr(t)},ho=function(t){return lo(t).left()},po=function(t,e){return mo(t,ho(e))},vo=function(t,e){return mo(t,go(e))},bo=function(t){return lo(t).top()},wo=function(t,e){return so(t,bo(e))},yo=function(t,e){return so(t,bo(e)+Hr(e))},xo=function(t,e,n){if(0===n.length)return[];var r=T(n.slice(1),(function(e,n){return e.map((function(e){return t(n,e)}))})),o=n[n.length-1].map((function(t){return e(n.length-1,t)}));return r.concat([o])},Co={height:{delta:i,positions:function(t){return xo(wo,yo,t)},edge:bo},rtl:{delta:function(t){return-t},edge:go,positions:function(t){return xo(vo,po,t)}},ltr:{delta:i,edge:ho,positions:function(t){return xo(po,vo,t)}}},Ro={ltr:Co.ltr,rtl:Co.rtl};function So(t){var e=function(e){return t(e).isRtl()?Ro.rtl:Ro.ltr};return{delta:function(t,n){return e(n).delta(t,n)},edge:function(t){return e(t).edge(t)},positions:function(t,n){return e(n).positions(t,n)}}}var To=function(t){var e=un(t);return fn.generate(e).grid()},Do=function(){return Do=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},Do.apply(this,arguments)},Oo=function(t){for(var e=[],n=function(t){e.push(t)},r=0;r<t.length;r++)t[r].each(n);return e},No=function(t,e){for(var n=0;n<t.length;n++){var r=e(t[n],n);if(r.isSome())return r}return m.none()},Eo=function(t,e,n,r){n===r?st(t,e):ct(t,e,n)},ko=function(t,e){var n=[],r=[],i=function(e,o){e.length>0?function(e,o){var i=Xe(t,o).getOrThunk((function(){var e=vt.fromTag(o,me(t).dom());return Re(t,e),e}));Oe(i);var u=T(e,(function(t){t.isNew()&&n.push(t.element());var e=t.element();return Oe(e),D(t.cells(),(function(t){t.isNew()&&r.push(t.element()),Eo(t.element(),"colspan",t.colspan(),1),Eo(t.element(),"rowspan",t.rowspan(),1),Re(e,t.element())})),e}));De(i,u)}(e,o):function(e){Xe(t,e).each(Ne)}(o)},u=[],c=[],a=[];return D(e,(function(t){switch(t.section()){case"thead":u.push(t);break;case"tbody":c.push(t);break;case"tfoot":a.push(t)}})),i(u,"thead"),i(c,"tbody"),i(a,"tfoot"),{newRows:o(n),newCells:o(r)}},Ao=function(t){var e=T(t,(function(t){var e=Tn(t.element());return D(t.cells(),(function(t){var n=Dn(t.element());Eo(n,"colspan",t.colspan(),1),Eo(n,"rowspan",t.rowspan(),1),Re(e,n)})),e}));return e},Po=function(t,e){var n=lt(t,e);return void 0===n||""===n?[]:n.split(" ")},Io=function(t){return void 0!==t.dom().classList},Bo=function(t,e){return function(t,e,n){var r=Po(t,e).concat([n]);return ct(t,e,r.join(" ")),!0}(t,"class",e)},Wo=function(t,e){return function(t,e,n){var r=O(Po(t,e),(function(t){return t!==n}));return r.length>0?ct(t,e,r.join(" ")):st(t,e),!1}(t,"class",e)},Mo=function(t,e){Io(t)?t.dom().classList.add(e):Bo(t,e)},_o=function(t){0===(Io(t)?t.dom().classList:function(t){return Po(t,"class")}(t)).length&&st(t,"class")},Lo=function(t,e){return Io(t)&&t.dom().classList.contains(e)},Fo=function(t,e){for(var n=[],r=t;r<e;r++)n.push(r);return n},jo=function(t,e){if(e<0||e>=t.length-1)return m.none();var n=t[e].fold((function(){var n=W(t.slice(0,e));return No(n,(function(t,e){return t.map((function(t){return{value:t,delta:e+1}}))}))}),(function(t){return m.some({value:t,delta:0})})),r=t[e+1].fold((function(){var n=t.slice(e+1);return No(n,(function(t,e){return t.map((function(t){return{value:t,delta:e+1}}))}))}),(function(t){return m.some({value:t,delta:1})}));return n.bind((function(t){return r.map((function(e){var n=e.delta+t.delta;return Math.abs(e.value-t.value)/n}))}))},zo=function(t,e,n){var r=t();return k(r,e).orThunk((function(){return m.from(r[0]).orThunk(n)})).map((function(t){return t.element()}))},Ho=function(t){var e=t.grid(),n=Fo(0,e.columns()),r=Fo(0,e.rows());return T(n,(function(e){return zo((function(){return I(r,(function(n){return fn.getAt(t,n,e).filter((function(t){return t.column()===e})).fold(o([]),(function(t){return[t]}))}))}),(function(t){return 1===t.colspan()}),(function(){return fn.getAt(t,0,e)}))}))},Uo=function(t){var e=t.grid(),n=Fo(0,e.rows()),r=Fo(0,e.columns());return T(n,(function(e){return zo((function(){return I(r,(function(n){return fn.getAt(t,e,n).filter((function(t){return t.row()===e})).fold(o([]),(function(t){return[t]}))}))}),(function(t){return 1===t.rowspan()}),(function(){return fn.getAt(t,e,0)}))}))},qo=function(t){var e=t.replace(/\./g,"-");return{resolve:function(t){return e+"-"+t}}},Vo=qo("ephox-snooker"),Go={resolve:Vo.resolve},Yo=function(t,e,n,r,o){var i=vt.fromTag("div");return Rt(i,{position:"absolute",left:e-r/2+"px",top:n+"px",height:o+"px",width:r+"px"}),at(i,{"data-column":t,role:"presentation"}),i},Xo=function(t,e,n,r,o){var i=vt.fromTag("div");return Rt(i,{position:"absolute",left:e+"px",top:n-o/2+"px",height:o+"px",width:r+"px"}),at(i,{"data-row":t,role:"presentation"}),i},Ko=Go.resolve("resizer-bar"),Jo=Go.resolve("resizer-rows"),$o=Go.resolve("resizer-cols"),Qo=function(t){var e=qe(t.parent(),"."+Ko);D(e,Ne)},Zo=function(t,e,n){var r=t.origin();D(e,(function(e,o){e.each((function(e){var o=n(r,e);Mo(o,Ko),Re(t.parent(),o)}))}))},ti=function(t,e,n,r,o,i){var u=lo(e);!function(t,e,n,r){Zo(t,e,(function(t,e){var o=Xo(e.row(),n.left()-t.left(),e.y()-t.top(),r,7);return Mo(o,Jo),o}))}(t,n.length>0?o.positions(n,e):[],u,Vr(e)),function(t,e,n,r){Zo(t,e,(function(t,e){var o=Yo(e.col(),e.x()-t.left(),n.top()-t.top(),7,r);return Mo(o,$o),o}))}(t,r.length>0?i.positions(r,e):[],u,Hr(e))},ei=function(t,e){var n=qe(t.parent(),"."+Ko);D(n,e)},ni=function(t,e,n,r){Qo(t);var o=un(e),i=fn.generate(o),u=Uo(i),c=Ho(i);ti(t,e,u,c,n,r)},ri=function(t){ei(t,(function(t){Ct(t,"display","none")}))},oi=function(t){ei(t,(function(t){Ct(t,"display","block")}))},ii=Qo,ui=function(t){return Lo(t,Jo)},ci=function(t){return Lo(t,$o)},ai=function(t,e){return Le(e,t.section())},li=function(t,e){return t.cells()[e]},fi={addCell:function(t,e,n){var r=t.cells(),o=r.slice(0,e),i=r.slice(e),u=o.concat([n]).concat(i);return ai(t,u)},setCells:ai,mutateCell:function(t,e,n){t.cells()[e]=n},getCell:li,getCellElement:function(t,e){return li(t,e).element()},mapCells:function(t,e){var n=t.cells(),r=T(n,e);return Le(r,t.section())},cellLength:function(t){return t.cells().length}},si=function(t,e){if(0===t.length)return 0;var n=t[0];return A(t,(function(t){return!e(n.element(),t.element())})).fold((function(){return t.length}),(function(t){return t}))},di=function(t,e,n,r){var i=function(t,e){return t[e]}(t,e).cells().slice(n),u=si(i,r),c=function(t,e){return T(t,(function(t){return fi.getCell(t,e)}))}(t,n).slice(e),a=si(c,r);return{colspan:o(u),rowspan:o(a)}},mi=function(t,e){var n=T(t,(function(t,e){return T(t.cells(),(function(t,e){return!1}))}));return T(t,(function(r,o){var i=I(r.cells(),(function(r,i){if(!1===n[o][i]){var u=di(t,o,i,e);return function(t,e,r,o){for(var i=t;i<t+r;i++)for(var u=e;u<e+o;u++)n[i][u]=!0}(o,i,u.rowspan(),u.colspan()),[Ie(r.element(),u.rowspan(),u.colspan(),r.isNew())]}return[]}));return Fe(i,r.section())}))},gi=function(t,e,n){for(var r=[],o=0;o<t.grid().rows();o++){for(var i=[],u=0;u<t.grid().columns();u++){var c=fn.getAt(t,o,u).map((function(t){return Me(t.element(),n)})).getOrThunk((function(){return Me(e.gap(),!0)}));i.push(c)}var a=Le(i,t.all()[o].section());r.push(a)}return r},hi=function(t,e){return T(t,(function(t){var n=function(t){var n=No(t,(function(t){return ge(t.element()).map((function(t){var e=ge(t).isNone();return Me(t,e)}))}));return n.getOrThunk((function(){return Me(e.row(),!0)}))}(t.details());return _e(n.element(),t.details(),t.section(),n.isNew())}))},pi=function(t,e){var n=mi(t,fe);return hi(n,e)},vi=function(t,e){var n=P(T(t.all(),(function(t){return t.cells()})));return k(n,(function(t){return fe(e,t.element())}))},bi=function(t,e,n,r,i){return function(u,c,a,l,f){var s=un(c),d=fn.generate(s),g=e(d,a).map((function(e){var n=function(t,e){return gi(t,e,!1)}(d,l),r=t(n,e,fe,i(l)),u=pi(r.grid(),l);return{grid:o(u),cursor:r.cursor}}));return g.fold((function(){return m.none()}),(function(t){var e=ko(c,t.grid());return n(c,t.grid(),f),r(c),ni(u,c,Co.height,f),m.some({cursor:t.cursor,newRows:e.newRows,newCells:e.newCells})}))}},wi=function(t,e){return on.cell(e.element()).bind((function(e){return vi(t,e)}))},yi=function(t,e){var n=T(e.selection(),(function(e){return on.cell(e).bind((function(e){return vi(t,e)}))})),r=Oo(n);return r.length>0?m.some({cells:r,generators:e.generators,clipboard:e.clipboard}):m.none()},xi=function(t,e){var n=T(e.selection(),(function(e){return on.cell(e).bind((function(e){return vi(t,e)}))})),r=Oo(n);return r.length>0?m.some(r):m.none()},Ci=function(t){return{is:function(e){return t===e},isValue:l,isError:a,getOr:o(t),getOrThunk:o(t),getOrDie:o(t),or:function(e){return Ci(t)},orThunk:function(e){return Ci(t)},fold:function(e,n){return n(t)},map:function(e){return Ci(e(t))},mapError:function(e){return Ci(t)},each:function(e){e(t)},bind:function(e){return e(t)},exists:function(e){return e(t)},forall:function(e){return e(t)},toOption:function(){return m.some(t)}}},Ri=function(t){return{is:a,isValue:a,isError:l,getOr:i,getOrThunk:function(t){return t()},getOrDie:function(){return(e=String(t),function(){throw new Error(e)})();var e},or:function(t){return t},orThunk:function(t){return t()},fold:function(e,n){return e(t)},map:function(e){return Ri(t)},mapError:function(e){return Ri(e(t))},each:n,bind:function(e){return Ri(t)},exists:a,forall:l,toOption:m.none}},Si={value:Ci,error:Ri,fromOption:function(t,e){return t.fold((function(){return Ri(e)}),Ci)}},Ti=function(t,e){return T(t,(function(){return Me(e.cell(),!0)}))},Di=function(t,e,n){return t.concat(function(t,e){for(var n=[],r=0;r<t;r++)n.push(e(r));return n}(e,(function(e){return fi.setCells(t[t.length-1],Ti(t[t.length-1].cells(),n))})))},Oi=function(t,e,n){return T(t,(function(t){return fi.setCells(t,t.cells().concat(Ti(Fo(0,e),n)))}))},Ni=function(t,e,n){if(t.row()>=e.length||t.column()>fi.cellLength(e[0]))return Si.error("invalid start address out of table bounds, row: "+t.row()+", column: "+t.column());var r=e.slice(t.row()),i=r[0].cells().slice(t.column()),u=fi.cellLength(n[0]),c=n.length;return Si.value({rowDelta:o(r.length-c),colDelta:o(i.length-u)})},Ei=function(t,e){var n=fi.cellLength(t[0]),r=fi.cellLength(e[0]);return{rowDelta:o(0),colDelta:o(n-r)}},ki=function(t,e,n){var r=e.colDelta()<0?Oi:i;return(e.rowDelta()<0?Di:i)(r(t,Math.abs(e.colDelta()),n),Math.abs(e.rowDelta()),n)},Ai=function(t,e,n,r){if(0===t.length)return t;for(var o=e.startRow();o<=e.finishRow();o++)for(var i=e.startCol();i<=e.finishCol();i++)fi.mutateCell(t[o],i,Me(r(),!1));return t},Pi=function(t,e,n,r){for(var o=!0,i=0;i<t.length;i++)for(var u=0;u<fi.cellLength(t[0]);u++){var c=n(fi.getCellElement(t[i],u),e);!0===c&&!1===o?fi.mutateCell(t[i],u,Me(r(),!0)):!0===c&&(o=!1)}return t},Ii=function(t,e,n,r){if(e>0&&e<t.length){var o=function(t,e){return E(t,(function(t,n){return S(t,(function(t){return e(t.element(),n.element())}))?t:t.concat([n])}),[])}(t[e-1].cells(),n);D(o,(function(o){for(var i=m.none(),u=function(e){for(var u=function(u){var c=t[e].cells()[u];n(c.element(),o.element())&&(i.isNone()&&(i=m.some(r())),i.each((function(n){fi.mutateCell(t[e],u,Me(n,!0))})))},c=0;c<fi.cellLength(t[0]);c++)u(c)},c=e;c<t.length;c++)u(c)}))}return t},Bi=function(t,e,n,r){var o=u(r,fi.getCell(t[e],n).element()),i=t[e];return t.length>1&&fi.cellLength(i)>1&&(n>0&&o(fi.getCellElement(i,n-1))||n<i.cells().length-1&&o(fi.getCellElement(i,n+1))||e>0&&o(fi.getCellElement(t[e-1],n))||e<t.length-1&&o(fi.getCellElement(t[e+1],n)))},Wi=function(t,e,n,r,o){return Ni(t,e,n).map((function(i){var u=ki(e,i,r);return function(t,e,n,r,o){for(var i=t.row(),u=t.column(),c=i+n.length,a=u+fi.cellLength(n[0]),l=i;l<c;l++)for(var f=u;f<a;f++){Bi(e,l,f,o)&&Pi(e,fi.getCellElement(e[l],f),o,r.cell);var s=fi.getCellElement(n[l-i],f-u),d=r.replace(s);fi.mutateCell(e[l],f,Me(d,!0))}return e}(t,u,n,r,o)}))},Mi=function(t,e,n,r,o){Ii(e,t,o,r.cell);var i=Ei(n,e),u=ki(n,i,r),c=Ei(e,u),a=ki(e,c,r);return a.slice(0,t).concat(u).concat(a.slice(t,a.length))},_i=function(t,e,n,r,o){var i=t.slice(0,e),u=t.slice(e),c=fi.mapCells(t[n],(function(n,i){return e>0&&e<t.length&&r(fi.getCellElement(t[e-1],i),fi.getCellElement(t[e],i))?fi.getCell(t[e],i):Me(o(n.element(),r),!0)}));return i.concat([c]).concat(u)},Li=function(t,e,n,r,o){return T(t,(function(t){var i=e>0&&e<fi.cellLength(t)&&r(fi.getCellElement(t,e-1),fi.getCellElement(t,e))?fi.getCell(t,e):Me(o(fi.getCellElement(t,n),r),!0);return fi.addCell(t,e,i)}))},Fi=function(t,e,n,r,o){var i=n+1;return T(t,(function(t,u){var c=u===e?Me(o(fi.getCellElement(t,n),r),!0):fi.getCell(t,n);return fi.addCell(t,i,c)}))},ji=function(t,e,n,r,o){var i=e+1,u=t.slice(0,i),c=t.slice(i),a=fi.mapCells(t[e],(function(t,e){return e===n?Me(o(t.element(),r),!0):t}));return u.concat([a]).concat(c)},zi=function(t,e,n){return t.slice(0,e).concat(t.slice(n+1))},Hi=function(t,e,n){var r=T(t,(function(t){var r=t.cells().slice(0,e).concat(t.cells().slice(n+1));return Le(r,t.section())}));return O(r,(function(t){return t.cells().length>0}))},Ui=function(t,e,n,r){return T(t,(function(t){return fi.mapCells(t,(function(t){return function(t){return S(e,(function(e){return n(t.element(),e.element())}))}(t)?Me(r(t.element(),n),!0):t}))}))},qi=function(t,e,n,r){return void 0!==fi.getCellElement(t[e],n)&&e>0&&r(fi.getCellElement(t[e-1],n),fi.getCellElement(t[e],n))},Vi=function(t,e,n){return e>0&&n(fi.getCellElement(t,e-1),fi.getCellElement(t,e))},Gi=function(t,e,n,r){var o=I(t,(function(r,o){return qi(t,o,e,n)||Vi(r,e,n)?[]:[fi.getCell(r,e)]}));return Ui(t,o,n,r)},Yi=function(t,e,n,r){var o=t[e],i=I(o.cells(),(function(r,i){return qi(t,e,i,n)||Vi(o,i,n)?[]:[r]}));return Ui(t,i,n,r)},Xi=Nr([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}]),Ki=Do({},Xi),Ji=function(t,e,n,r){var i=t.slice(0),u=function(t,e){return 0===t.length?Ki.none():1===t.length?Ki.only(0):0===e?Ki.left(0,1):e===t.length-1?Ki.right(e-1,e):e>0&&e<t.length-1?Ki.middle(e-1,e,e+1):Ki.none()}(t,e),c=function(t){return T(t,o(0))},a=o(c(i)),l=function(t,e){if(n>=0){var o=Math.max(r.minCellWidth(),i[e]-n);return c(i.slice(0,t)).concat([n,o-i[e]]).concat(c(i.slice(e+1)))}var u=Math.max(r.minCellWidth(),i[t]+n),a=i[t]-u;return c(i.slice(0,t)).concat([u-i[t],a]).concat(c(i.slice(e+1)))},f=l;return u.fold(a,(function(t){return r.singleColumnWidth(i[t],n)}),f,(function(t,e,n){return l(e,n)}),(function(t,e){if(n>=0)return c(i.slice(0,e)).concat([n]);var o=Math.max(r.minCellWidth(),i[e]+n);return c(i.slice(0,e)).concat([o-i[e]])}))},$i=function(t,e){return ft(t,e)&&parseInt(lt(t,e),10)>1},Qi={hasColspan:function(t){return $i(t,"colspan")},hasRowspan:function(t){return $i(t,"rowspan")},minWidth:o(10),minHeight:o(10),getInt:function(t,e){return parseInt(St(t,e),10)}},Zi=function(t,e,n){return Dt(t,e).fold((function(){return n(t)+"px"}),(function(t){return t}))},tu=function(t,e){return Zi(t,"width",(function(t){return oo.getPixelWidth(t,e)}))},eu=function(t){return Zi(t,"height",oo.getHeight)},nu=function(t,e,n,r,o){var i=Ho(t),u=T(i,(function(t){return t.map(e.edge)}));return T(i,(function(t,e){return t.filter(c(Qi.hasColspan)).fold((function(){var t=jo(u,e);return r(t)}),(function(t){return n(t,o)}))}))},ru=function(t){return t.map((function(t){return t+"px"})).getOr("")},ou=function(t,e,n,r){var o=Uo(t),i=T(o,(function(t){return t.map(e.edge)}));return T(o,(function(t,e){return t.filter(c(Qi.hasRowspan)).fold((function(){var t=jo(i,e);return r(t)}),(function(t){return n(t)}))}))},iu={getRawWidths:function(t,e,n){return nu(t,e,tu,ru,n)},getPixelWidths:function(t,e,n){return nu(t,e,oo.getPixelWidth,(function(t){return t.getOrThunk(n.minCellWidth)}),n)},getPercentageWidths:function(t,e,n){return nu(t,e,oo.getPercentageWidth,(function(t){return t.fold((function(){return n.minCellWidth()}),(function(t){return t/n.pixelWidth()*100}))}),n)},getPixelHeights:function(t,e){return ou(t,e,oo.getHeight,(function(t){return t.getOrThunk(Qi.minHeight)}))},getRawHeights:function(t,e){return ou(t,e,eu,ru)}},uu=function(t,e,n){for(var r=0,o=t;o<e;o++)r+=void 0!==n[o]?n[o]:0;return r},cu=function(t,e){var n=fn.justCells(t);return T(n,(function(t){var n=uu(t.column(),t.column()+t.colspan(),e);return{element:t.element,width:o(n),colspan:t.colspan}}))},au=function(t,e){var n=fn.justCells(t);return T(n,(function(t){var n=uu(t.row(),t.row()+t.rowspan(),e);return{element:t.element,height:o(n),rowspan:t.rowspan}}))},lu=function(t,e){return T(t.all(),(function(t,n){return{element:t.element,height:o(e[n])}}))},fu=function(t){var e=i;return{width:o(t),pixelWidth:o(t),getWidths:iu.getPixelWidths,getCellDelta:e,singleColumnWidth:function(t,e){return[Math.max(Qi.minWidth(),t+e)-t]},minCellWidth:Qi.minWidth,setElementWidth:oo.setPixelWidth,setTableWidth:function(t,e,n){var r=N(e,(function(t,e){return t+e}),0);oo.setPixelWidth(t,r)}}},su=function(t,e){var n=oo.percentageBasedSizeRegex().exec(e);if(null!==n)return function(t,e){var n=parseFloat(t),r=qr(e);return{width:o(n),pixelWidth:o(r),getWidths:iu.getPercentageWidths,getCellDelta:function(t){return t/r*100},singleColumnWidth:function(t,e){return[100-t]},minCellWidth:function(){return Qi.minWidth()/r*100},setElementWidth:oo.setPercentageWidth,setTableWidth:function(t,e,r){var o=r/100*n;oo.setPercentageWidth(t,n+o)}}}(n[1],t);var r=oo.pixelBasedSizeRegex().exec(e);if(null!==r){var i=parseInt(r[1],10);return fu(i)}var u=qr(t);return fu(u)},du=function(t){return oo.getRawWidth(t).fold((function(){var e=qr(t);return fu(e)}),(function(e){return su(t,e)}))},mu=function(t){return fn.generate(t)},gu=function(t){var e=un(t);return mu(e)},hu=function(t,e,n,r){var o=du(t),i=o.getCellDelta(e),u=gu(t),c=o.getWidths(u,r,o),a=Ji(c,n,i,o),l=T(a,(function(t,e){return t+c[e]})),f=cu(u,l);D(f,(function(t){o.setElementWidth(t.element(),t.width())})),n===u.grid().columns()-1&&o.setTableWidth(t,l,i)},pu=function(t,e,n,r){var o=gu(t),i=iu.getPixelHeights(o,r),u=T(i,(function(t,r){return n===r?Math.max(e+t,Qi.minHeight()):t})),c=au(o,u),a=lu(o,u);D(a,(function(t){oo.setHeight(t.element(),t.height())})),D(c,(function(t){oo.setHeight(t.element(),t.height())}));var l=N(u,(function(t,e){return t+e}),0);oo.setHeight(t,l)},vu=function(t,e,n){var r=du(t),o=mu(e),i=r.getWidths(o,n,r),u=cu(o,i);D(u,(function(t){r.setElementWidth(t.element(),t.width())})),u.length>0&&r.setTableWidth(t,i,r.getCellDelta(0))},bu=function(t){var e=t,n=function(){return e};return{get:n,set:function(t){e=t},clone:function(){return bu(n())}}},wu=function(t,e,n){if(0===e.length)throw new Error("You must specify at least one required field.");return q("required",e),V(e),function(r){var o=M(r);B(e,(function(t){return R(o,t)}))||H(e,o),t(e,o);var i=O(e,(function(t){return!n.validate(r[t],t)}));return i.length>0&&function(t,e){throw new Error("All values need to be of type: "+e+". Keys ("+z(t).join(", ")+") were not.")}(i,n.label),r}},yu=function(t,e){var n=O(e,(function(e){return!R(t,e)}));n.length>0&&U(n)},xu=function(t){return function(t,e){return wu(t,e,{validate:b,label:"function"})}(yu,t)},Cu=xu(["cell","row","replace","gap"]),Ru=function(t){var e=ft(t,"colspan")?parseInt(lt(t,"colspan"),10):1,n=ft(t,"rowspan")?parseInt(lt(t,"rowspan"),10):1;return{element:o(t),colspan:o(e),rowspan:o(n)}},Su=function(t,e){void 0===e&&(e=Ru),Cu(t);var n=bu(m.none()),r=function(n){return function(e){return t.cell(e)}(e(n))},o=function(t){var e=r(t);return n.get().isNone()&&n.set(m.some(e)),i=m.some({item:t,replacement:e}),e},i=m.none();return{getOrInit:function(t,e){return i.fold((function(){return o(t)}),(function(n){return e(t,n.item)?n.replacement:o(t)}))},cursor:n.get}},Tu=function(t,e){return function(n){var r=bu(m.none());Cu(n);var o=[],i=function(i){var u={scope:t},c=n.replace(i,e,u);return o.push({item:i,sub:c}),r.get().isNone()&&r.set(m.some(c)),c};return{replaceOrInit:function(t,e){return function(t,e){return k(o,(function(n){return e(n.item,t)}))}(t,e).fold((function(){return i(t)}),(function(n){return e(t,n.item)?n.sub:i(t)}))},cursor:r.get}}},Du=function(t){Cu(t);var e=bu(m.none());return{combine:function(n){return e.get().isNone()&&e.set(m.some(n)),function(){var e=t.cell({element:o(n),colspan:o(1),rowspan:o(1)});return Ot(e,"width"),Ot(n,"width"),e}},cursor:e.get}},Ou=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],Nu=function(t,e){var n=t.property().name(e);return R(Ou,n)},Eu=function(t,e){return R(["br","img","hr","input"],t.property().name(e))},ku=Nu,Au=function(t,e){var n=t.property().name(e);return R(["ol","ul"],n)},Pu=Eu,Iu=Kn(),Bu=function(t){return ku(Iu,t)},Wu=function(t){return Au(Iu,t)},Mu=function(t){return Pu(Iu,t)},_u=function(t){var e,n=function(t){return"br"===tt(t)},r=function(t){return Cn(t).bind((function(e){var r=ve(e).map((function(t){return!!Bu(t)||!!Mu(t)&&"img"!==tt(t)})).getOr(!1);return ge(e).map((function(o){return!0===r||function(t){return"li"===tt(t)||Ge(t,Wu).isSome()}(o)||n(e)||Bu(o)&&!fe(t,o)?[]:[vt.fromTag("br")]}))})).getOr([])},o=(e=I(t,(function(t){var e=be(t);return function(t){return B(t,(function(t){return n(t)||it(t)&&0===hn(t).trim().length}))}(e)?[]:e.concat(r(t))})),0===e.length?[vt.fromTag("br")]:e);Oe(t[0]),De(t[0],o)},Lu=function(t){0===on.cells(t).length&&Ne(t)},Fu=j("grid","cursor"),ju=function(t,e,n){return zu(t,e,n).orThunk((function(){return zu(t,0,0)}))},zu=function(t,e,n){return m.from(t[e]).bind((function(t){return m.from(t.cells()[n]).bind((function(t){return m.from(t.element())}))}))},Hu=function(t,e,n){return Fu(t,zu(t,e,n))},Uu=function(t){return E(t,(function(t,e){return S(t,(function(t){return t.row()===e.row()}))?t:t.concat([e])}),[]).sort((function(t,e){return t.row()-e.row()}))},qu=function(t){return E(t,(function(t,e){return S(t,(function(t){return t.column()===e.column()}))?t:t.concat([e])}),[]).sort((function(t,e){return t.column()-e.column()}))},Vu=function(t,e,n){var r=cn(t,n),o=fn.generate(r);return gi(o,e,!0)},Gu=vu,Yu={insertRowBefore:bi((function(t,e,n,r){var o=e.row(),i=e.row(),u=_i(t,i,o,n,r.getOrInit);return Hu(u,i,e.column())}),wi,n,n,Su),insertRowsBefore:bi((function(t,e,n,r){var o=e[0].row(),i=e[0].row(),u=Uu(e),c=E(u,(function(t,e){return _i(t,i,o,n,r.getOrInit)}),t);return Hu(c,i,e[0].column())}),xi,n,n,Su),insertRowAfter:bi((function(t,e,n,r){var o=e.row(),i=e.row()+e.rowspan(),u=_i(t,i,o,n,r.getOrInit);return Hu(u,i,e.column())}),wi,n,n,Su),insertRowsAfter:bi((function(t,e,n,r){var o=Uu(e),i=o[o.length-1].row(),u=o[o.length-1].row()+o[o.length-1].rowspan(),c=E(o,(function(t,e){return _i(t,u,i,n,r.getOrInit)}),t);return Hu(c,u,e[0].column())}),xi,n,n,Su),insertColumnBefore:bi((function(t,e,n,r){var o=e.column(),i=e.column(),u=Li(t,i,o,n,r.getOrInit);return Hu(u,e.row(),i)}),wi,Gu,n,Su),insertColumnsBefore:bi((function(t,e,n,r){var o=qu(e),i=o[0].column(),u=o[0].column(),c=E(o,(function(t,e){return Li(t,u,i,n,r.getOrInit)}),t);return Hu(c,e[0].row(),u)}),xi,Gu,n,Su),insertColumnAfter:bi((function(t,e,n,r){var o=e.column(),i=e.column()+e.colspan(),u=Li(t,i,o,n,r.getOrInit);return Hu(u,e.row(),i)}),wi,Gu,n,Su),insertColumnsAfter:bi((function(t,e,n,r){var o=e[e.length-1].column(),i=e[e.length-1].column()+e[e.length-1].colspan(),u=qu(e),c=E(u,(function(t,e){return Li(t,i,o,n,r.getOrInit)}),t);return Hu(c,e[0].row(),i)}),xi,Gu,n,Su),splitCellIntoColumns:bi((function(t,e,n,r){var o=Fi(t,e.row(),e.column(),n,r.getOrInit);return Hu(o,e.row(),e.column())}),wi,Gu,n,Su),splitCellIntoRows:bi((function(t,e,n,r){var o=ji(t,e.row(),e.column(),n,r.getOrInit);return Hu(o,e.row(),e.column())}),wi,n,n,Su),eraseColumns:bi((function(t,e,n,r){var o=qu(e),i=Hi(t,o[0].column(),o[o.length-1].column()),u=ju(i,e[0].row(),e[0].column());return Fu(i,u)}),xi,Gu,Lu,Su),eraseRows:bi((function(t,e,n,r){var o=Uu(e),i=zi(t,o[0].row(),o[o.length-1].row()),u=ju(i,e[0].row(),e[0].column());return Fu(i,u)}),xi,n,Lu,Su),makeColumnHeader:bi((function(t,e,n,r){var o=Gi(t,e.column(),n,r.replaceOrInit);return Hu(o,e.row(),e.column())}),wi,n,n,Tu("row","th")),unmakeColumnHeader:bi((function(t,e,n,r){var o=Gi(t,e.column(),n,r.replaceOrInit);return Hu(o,e.row(),e.column())}),wi,n,n,Tu(null,"td")),makeRowHeader:bi((function(t,e,n,r){var o=Yi(t,e.row(),n,r.replaceOrInit);return Hu(o,e.row(),e.column())}),wi,n,n,Tu("col","th")),unmakeRowHeader:bi((function(t,e,n,r){var o=Yi(t,e.row(),n,r.replaceOrInit);return Hu(o,e.row(),e.column())}),wi,n,n,Tu(null,"td")),mergeCells:bi((function(t,e,n,r){var i=e.cells();_u(i);var u=Ai(t,e.bounds(),n,o(i[0]));return Fu(u,m.from(i[0]))}),(function(t,e){return e.mergable()}),n,n,Du),unmergeCells:bi((function(t,e,n,r){var o=N(e,(function(t,e){return Pi(t,e,n,r.combine(e))}),t);return Fu(o,m.from(e[0]))}),(function(t,e){return e.unmergable()}),Gu,n,Du),pasteCells:bi((function(t,e,n,r){var o=function(t,e){var n=un(t),r=fn.generate(n);return gi(r,e,!0)}(e.clipboard(),e.generators()),i=Ae(e.row(),e.column());return Wi(i,t,o,e.generators(),n).fold((function(){return Fu(t,m.some(e.element()))}),(function(t){var n=ju(t,e.row(),e.column());return Fu(t,n)}))}),(function(t,e){return on.cell(e.element()).bind((function(n){return vi(t,n).map((function(t){return Do(Do({},t),{generators:e.generators,clipboard:e.clipboard})}))}))}),Gu,n,Su),pasteRowsBefore:bi((function(t,e,n,r){var o=t[e.cells[0].row()],i=e.cells[0].row(),u=Vu(e.clipboard(),e.generators(),o),c=Mi(i,t,u,e.generators(),n),a=ju(c,e.cells[0].row(),e.cells[0].column());return Fu(c,a)}),yi,n,n,Su),pasteRowsAfter:bi((function(t,e,n,r){var o=t[e.cells[0].row()],i=e.cells[e.cells.length-1].row()+e.cells[e.cells.length-1].rowspan(),u=Vu(e.clipboard(),e.generators(),o),c=Mi(i,t,u,e.generators(),n),a=ju(c,e.cells[0].row(),e.cells[0].column());return Fu(c,a)}),yi,n,n,Su)},Xu=function(t){return vt.fromDom(t.getBody())},Ku=function(t){return t.getBoundingClientRect().width},Ju=function(t){return t.getBoundingClientRect().height},$u=function(t){return function(e){return fe(e,Xu(t))}},Qu=function(t){return/^[0-9]+$/.test(t)&&(t+="px"),t},Zu=function(t){var e=qe(t,"td[data-mce-style],th[data-mce-style]");st(t,"data-mce-style"),D(e,(function(t){st(t,"data-mce-style")}))},tc={isRtl:o(!1)},ec={isRtl:o(!0)},nc={directionAt:function(t){var e=function(t){return"rtl"===St(t,"direction")?"rtl":"ltr"}(t);return"rtl"===e?ec:tc}},rc=["tableprops","tabledelete","|","tableinsertrowbefore","tableinsertrowafter","tabledeleterow","|","tableinsertcolbefore","tableinsertcolafter","tabledeletecol"],oc={"border-collapse":"collapse",width:"100%"},ic={border:"1"},uc=function(t){return t.getParam("table_default_attributes",ic,"object")},cc=function(t){return t.getParam("table_default_styles",oc,"object")},ac=function(t){return t.getParam("table_cell_advtab",!0,"boolean")},lc=function(t){return t.getParam("table_row_advtab",!0,"boolean")},fc=function(t){return t.getParam("table_advtab",!0,"boolean")},sc=function(t){return t.getParam("table_appearance_options",!0,"boolean")},dc=function(t){return t.getParam("table_style_by_css",!1,"boolean")},mc=function(t){return t.getParam("table_cell_class_list",[],"array")},gc=function(t){return t.getParam("table_row_class_list",[],"array")},hc=function(t){return t.getParam("table_class_list",[],"array")},pc=function(t){return!1===t.getParam("table_responsive_width")},vc=function(t,e){return t.fire("newrow",{node:e})},bc=function(t,e){return t.fire("newcell",{node:e})},wc=function(t,e,n,r){t.fire("ObjectResizeStart",{target:e,width:n,height:r})},yc=function(t,e,n,r){t.fire("ObjectResized",{target:e,width:n,height:r})},xc=function(t,e){var r=function(t){return"table"===tt(Xu(t))},o=function(t){var e=t.getParam("table_clone_elements");return h(e)?m.some(e.split(/[ ,]/)):Array.isArray(e)?m.some(e):m.none()}(t),i=function(e,n,r,i){return function(u,c){Zu(u);var a=i(),l=vt.fromDom(t.getDoc()),f=So(nc.directionAt),s=Pn(r,l,o);return n(u)?e(a,u,c,s,f).bind((function(e){return D(e.newRows(),(function(e){vc(t,e.dom())})),D(e.newCells(),(function(e){bc(t,e.dom())})),e.cursor().map((function(e){var n=t.dom.createRng();return n.setStart(e.dom(),0),n.setEnd(e.dom(),0),n}))})):m.none()}},u=i(Yu.eraseRows,(function(e){var n=To(e);return!1===r(t)||n.rows()>1}),n,e),c=i(Yu.eraseColumns,(function(e){var n=To(e);return!1===r(t)||n.columns()>1}),n,e);return{deleteRow:u,deleteColumn:c,insertRowsBefore:i(Yu.insertRowsBefore,l,n,e),insertRowsAfter:i(Yu.insertRowsAfter,l,n,e),insertColumnsBefore:i(Yu.insertColumnsBefore,l,io,e),insertColumnsAfter:i(Yu.insertColumnsAfter,l,io,e),mergeCells:i(Yu.mergeCells,l,n,e),unmergeCells:i(Yu.unmergeCells,l,n,e),pasteRowsBefore:i(Yu.pasteRowsBefore,l,n,e),pasteRowsAfter:i(Yu.pasteRowsAfter,l,n,e),pasteCells:i(Yu.pasteCells,l,n,e)}},Cc=function(t,e,n){var r=un(t),o=fn.generate(r);return xi(o,e).map((function(t){var e=gi(o,n,!1).slice(t[0].row(),t[t.length-1].row()+t[t.length-1].rowspan()),r=pi(e,n);return Ao(r)}))},Rc=tinymce.util.Tools.resolve("tinymce.util.Tools"),Sc=function(t,e,n){n&&t.formatter.apply("align"+n,{},e)},Tc=function(t,e,n){n&&t.formatter.apply("valign"+n,{},e)},Dc=function(t,e){Rc.each("left center right".split(" "),(function(n){t.formatter.remove("align"+n,{},e)}))},Oc=function(t,e){Rc.each("top middle bottom".split(" "),(function(n){t.formatter.remove("valign"+n,{},e)}))},Nc=function(t,e,n){var r;return r=function(e,r){for(var o=0;o<r.length;o++){var i=t.getStyle(r[o],n);if(void 0===e&&(e=i),e!==i)return""}return e}(r,t.select("td,th",e))},Ec=function(t,e){var n=t.dom,r=e.control.rootControl,o=r.toJSON(),i=n.parseStyle(o.style);i["border-style"]=o.borderStyle,i["border-color"]=o.borderColor,i["background-color"]=o.backgroundColor,i.width=o.width?Qu(o.width):"",i.height=o.height?Qu(o.height):"",r.find("#style").value(n.serializeStyle(n.parseStyle(n.serializeStyle(i))))},kc=function(t,e){var n=t.dom,r=e.control.rootControl,o=r.toJSON(),i=n.parseStyle(o.style);r.find("#borderStyle").value(i["border-style"]||""),r.find("#borderColor").value(i["border-color"]||""),r.find("#backgroundColor").value(i["background-color"]||""),r.find("#width").value(i.width||""),r.find("#height").value(i.height||"")},Ac={createStyleForm:function(t){var e=function(){var e=function(t){return t.getParam("color_picker_callback")}(t);if(e)return function(n){return e.call(t,(function(t){n.control.value(t).fire("change")}),n.control.value())}};return{title:"Advanced",type:"form",defaults:{onchange:u(Ec,t)},items:[{label:"Style",name:"style",type:"textbox",onchange:u(kc,t)},{type:"form",padding:0,formItemDefaults:{layout:"grid",alignH:["start","right"]},defaults:{size:7},items:[{label:"Border style",type:"listbox",name:"borderStyle",width:90,onselect:u(Ec,t),values:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{label:"Border color",type:"colorbox",name:"borderColor",onaction:e()},{label:"Background color",type:"colorbox",name:"backgroundColor",onaction:e()}]}]}},buildListItems:function(t,e,n){var r=function(t,n){return n=n||[],Rc.each(t,(function(t){var o={text:t.text||t.title};t.menu?o.menu=r(t.menu):(o.value=t.value,e&&e(o)),n.push(o)})),n};return r(t,n||[])},updateStyleField:Ec,extractAdvancedStyles:function(t,e){var n=t.parseStyle(t.getAttrib(e,"style")),r={};return n["border-style"]&&(r.borderStyle=n["border-style"]),n["border-color"]&&(r.borderColor=n["border-color"]),n["background-color"]&&(r.backgroundColor=n["background-color"]),r.style=t.serializeStyle(n),r},updateAdvancedFields:kc,syncAdvancedStyleFields:function(e,n){n.control.rootControl.find("#style")[0].getEl().isEqualNode(t.document.activeElement)?kc(e,n):Ec(e,n)}},Pc=function(t,e,n){var r,o=t.dom;function i(t,n,r){(1===e.length||r)&&o.setAttrib(t,n,r)}function u(t,n,r){(1===e.length||r)&&o.setStyle(t,n,r)}ac(t)&&Ac.syncAdvancedStyleFields(t,n),r=n.control.rootControl.toJSON(),t.undoManager.transact((function(){Rc.each(e,(function(n){var c,a;i(n,"scope",r.scope),1===e.length?i(n,"style",r.style):(c=n,a=r.style,delete c.dataset.mceStyle,c.style.cssText+=";"+a),i(n,"class",r.class),u(n,"width",Qu(r.width)),u(n,"height",Qu(r.height)),r.type&&n.nodeName.toLowerCase()!==r.type&&(n=o.rename(n,r.type)),1===e.length&&(Dc(t,n),Oc(t,n)),r.align&&Sc(t,n,r.align),r.valign&&Tc(t,n,r.valign)})),t.focus()}))},Ic=function(t){var e,n,r,o=[];if(o=t.dom.select("td[data-mce-selected],th[data-mce-selected]"),e=t.dom.getParent(t.selection.getStart(),"td,th"),!o.length&&e&&o.push(e),e=e||o[0]){n=o.length>1?{width:"",height:"",scope:"",class:"",align:"",valign:"",style:"",type:e.nodeName.toLowerCase()}:function(t,e){var n=t.dom,r={width:n.getStyle(e,"width")||n.getAttrib(e,"width"),height:n.getStyle(e,"height")||n.getAttrib(e,"height"),scope:n.getAttrib(e,"scope"),class:n.getAttrib(e,"class"),type:e.nodeName.toLowerCase(),style:"",align:"",valign:""};return Rc.each("left center right".split(" "),(function(n){t.formatter.matchNode(e,"align"+n)&&(r.align=n)})),Rc.each("top middle bottom".split(" "),(function(n){t.formatter.matchNode(e,"valign"+n)&&(r.valign=n)})),ac(t)&&Rc.extend(r,Ac.extractAdvancedStyles(n,e)),r}(t,e),mc(t).length>0&&(r={name:"class",type:"listbox",label:"Class",values:Ac.buildListItems(mc(t),(function(e){e.value&&(e.textStyle=function(){return t.formatter.getCssText({block:"td",classes:[e.value]})})}))});var i={type:"form",layout:"flex",direction:"column",labelGapCalc:"children",padding:0,items:[{type:"form",layout:"grid",columns:2,labelGapCalc:!1,padding:0,defaults:{type:"textbox",maxWidth:50},items:[{label:"Width",name:"width",onchange:u(Ac.updateStyleField,t)},{label:"Height",name:"height",onchange:u(Ac.updateStyleField,t)},{label:"Cell type",name:"type",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{label:"Scope",name:"scope",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{label:"H Align",name:"align",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"V Align",name:"valign",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}]},r]};ac(t)?t.windowManager.open({title:"Cell properties",bodyType:"tabpanel",data:n,body:[{title:"General",type:"form",items:i},Ac.createStyleForm(t)],onsubmit:u(Pc,t,o)}):t.windowManager.open({title:"Cell properties",data:n,body:i,onsubmit:u(Pc,t,o)})}};function Bc(t,e,n,r){var o=t.dom;function i(t,n,r){(1===e.length||r)&&o.setAttrib(t,n,r)}lc(t)&&Ac.syncAdvancedStyleFields(t,r);var u=r.control.rootControl.toJSON();t.undoManager.transact((function(){Rc.each(e,(function(r){i(r,"scope",u.scope),i(r,"style",u.style),i(r,"class",u.class),function(t,n,r){(1===e.length||r)&&o.setStyle(t,n,r)}(r,"height",Qu(u.height)),u.type!==r.parentNode.nodeName.toLowerCase()&&function(t,e,n){var r=t.getParent(e,"table"),o=e.parentNode,i=t.select(n,r)[0];i||(i=t.create(n),r.firstChild?"CAPTION"===r.firstChild.nodeName?t.insertAfter(i,r.firstChild):r.insertBefore(i,r.firstChild):r.appendChild(i)),i.appendChild(e),o.hasChildNodes()||t.remove(o)}(t.dom,r,u.type),u.align!==n.align&&(Dc(t,r),Sc(t,r,u.align))})),t.focus()}))}var Wc=function(t){var e,n,r,o,i,c,a=t.dom,l=[];e=a.getParent(t.selection.getStart(),"table"),n=a.getParent(t.selection.getStart(),"td,th"),Rc.each(e.rows,(function(t){Rc.each(t.cells,(function(e){if(a.getAttrib(e,"data-mce-selected")||e===n)return l.push(t),!1}))})),(r=l[0])&&(i=l.length>1?{height:"",scope:"",style:"",class:"",align:"",type:r.parentNode.nodeName.toLowerCase()}:function(t,e){var n=t.dom,r={height:n.getStyle(e,"height")||n.getAttrib(e,"height"),scope:n.getAttrib(e,"scope"),class:n.getAttrib(e,"class"),align:"",style:"",type:e.parentNode.nodeName.toLowerCase()};return Rc.each("left center right".split(" "),(function(n){t.formatter.matchNode(e,"align"+n)&&(r.align=n)})),lc(t)&&Rc.extend(r,Ac.extractAdvancedStyles(n,e)),r}(t,r),gc(t).length>0&&(o={name:"class",type:"listbox",label:"Class",values:Ac.buildListItems(gc(t),(function(e){e.value&&(e.textStyle=function(){return t.formatter.getCssText({block:"tr",classes:[e.value]})})}))}),c={type:"form",columns:2,padding:0,defaults:{type:"textbox"},items:[{type:"listbox",name:"type",label:"Row type",text:"Header",maxWidth:null,values:[{text:"Header",value:"thead"},{text:"Body",value:"tbody"},{text:"Footer",value:"tfoot"}]},{type:"listbox",name:"align",label:"Alignment",text:"None",maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height"},o]},lc(t)?t.windowManager.open({title:"Row properties",data:i,bodyType:"tabpanel",body:[{title:"General",type:"form",items:c},Ac.createStyleForm(t)],onsubmit:u(Bc,t,l,i)}):t.windowManager.open({title:"Row properties",data:i,body:c,onsubmit:u(Bc,t,l,i)}))},Mc=tinymce.util.Tools.resolve("tinymce.Env"),_c={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},percentages:!0},Lc=function(t,e,n,r,o){void 0===o&&(o=_c);var i=vt.fromTag("table");Rt(i,o.styles),at(i,o.attributes);var u=vt.fromTag("tbody");Re(i,u);for(var c=[],a=0;a<t;a++){for(var l=vt.fromTag("tr"),f=0;f<e;f++){var s=a<n||f<r?vt.fromTag("th"):vt.fromTag("td");f<r&&ct(s,"scope","row"),a<n&&ct(s,"scope","col"),Re(s,vt.fromTag("br")),o.percentages&&Ct(s,"width",100/e+"%"),Re(l,s)}c.push(l)}return De(u,c),i},Fc=function(t,e){t.selection.select(e.dom(),!0),t.selection.collapse(!0)},jc=function(t,e,n){var r,o=cc(t),i={styles:o,attributes:uc(t),percentages:(r=o.width,h(r)&&-1!==r.indexOf("%")&&!pc(t))},c=Lc(n,e,0,0,i);ct(c,"data-mce-id","__mce");var a=function(t){var e=vt.fromTag("div"),n=vt.fromDom(t.dom().cloneNode(!0));return Re(e,n),function(t){return t.dom().innerHTML}(e)}(c);return t.insertContent(a),Ke(Xu(t),'table[data-mce-id="__mce"]').map((function(e){return pc(t)&&Ct(e,"width",St(e,"width")),st(e,"data-mce-id"),function(t,e){D(qe(e,"tr"),(function(e){vc(t,e.dom()),D(qe(e,"th,td"),(function(e){bc(t,e.dom())}))}))}(t,e),function(t,e){Ke(e,"td,th").each(u(Fc,t))}(t,e),e.dom()})).getOr(null)};function zc(t,e,n,r){if("TD"===e.tagName||"TH"===e.tagName)t.setStyle(e,n,r);else if(e.children)for(var o=0;o<e.children.length;o++)zc(t,e.children[o],n,r)}var Hc,Uc=function(t,e,n){var r,o,i=t.dom;fc(t)&&Ac.syncAdvancedStyleFields(t,n),!1===(o=n.control.rootControl.toJSON()).class&&delete o.class,t.undoManager.transact((function(){e||(e=jc(t,o.cols||1,o.rows||1)),function(t,e,n){var r,o=t.dom,i={},u={};if(i.class=n.class,u.height=Qu(n.height),o.getAttrib(e,"width")&&!dc(t)?i.width=(r=n.width)?r.replace(/px$/,""):"":u.width=Qu(n.width),dc(t)?(u["border-width"]=Qu(n.border),u["border-spacing"]=Qu(n.cellspacing),Rc.extend(i,{"data-mce-border-color":n.borderColor,"data-mce-cell-padding":n.cellpadding,"data-mce-border":n.border})):Rc.extend(i,{border:n.border,cellpadding:n.cellpadding,cellspacing:n.cellspacing}),dc(t)&&e.children)for(var c=0;c<e.children.length;c++)zc(o,e.children[c],{"border-width":Qu(n.border),"border-color":n.borderColor,padding:Qu(n.cellpadding)});n.style?Rc.extend(u,o.parseStyle(n.style)):u=Rc.extend({},o.parseStyle(o.getAttrib(e,"style")),u),i.style=o.serializeStyle(u),o.setAttribs(e,i)}(t,e,o),(r=i.select("caption",e)[0])&&!o.caption&&i.remove(r),!r&&o.caption&&((r=i.create("caption")).innerHTML=Mc.ie?"Â ":'<br data-mce-bogus="1"/>',e.insertBefore(r,e.firstChild)),Dc(t,e),o.align&&Sc(t,e,o.align),t.focus(),t.addVisual()}))},qc=function(t,e){var n,r,o,i,c,a=t.dom,l={};!0===e?(n=a.getParent(t.selection.getStart(),"table"))&&(l=function(t,e){var n=t.dom,r={width:n.getStyle(e,"width")||n.getAttrib(e,"width"),height:n.getStyle(e,"height")||n.getAttrib(e,"height"),cellspacing:n.getStyle(e,"border-spacing")||n.getAttrib(e,"cellspacing"),cellpadding:n.getAttrib(e,"data-mce-cell-padding")||n.getAttrib(e,"cellpadding")||Nc(t.dom,e,"padding"),border:n.getAttrib(e,"data-mce-border")||n.getAttrib(e,"border")||Nc(t.dom,e,"border"),borderColor:n.getAttrib(e,"data-mce-border-color"),caption:!!n.select("caption",e)[0],class:n.getAttrib(e,"class")};return Rc.each("left center right".split(" "),(function(n){t.formatter.matchNode(e,"align"+n)&&(r.align=n)})),fc(t)&&Rc.extend(r,Ac.extractAdvancedStyles(n,e)),r}(t,n)):(r={label:"Cols",name:"cols"},o={label:"Rows",name:"rows"}),hc(t).length>0&&(l.class&&(l.class=l.class.replace(/\s*mce\-item\-table\s*/g,"")),i={name:"class",type:"listbox",label:"Class",values:Ac.buildListItems(hc(t),(function(e){e.value&&(e.textStyle=function(){return t.formatter.getCssText({block:"table",classes:[e.value]})})}))}),c={type:"form",layout:"flex",direction:"column",labelGapCalc:"children",padding:0,items:[{type:"form",labelGapCalc:!1,padding:0,layout:"grid",columns:2,defaults:{type:"textbox",maxWidth:50},items:sc(t)?[r,o,{label:"Width",name:"width",onchange:u(Ac.updateStyleField,t)},{label:"Height",name:"height",onchange:u(Ac.updateStyleField,t)},{label:"Cell spacing",name:"cellspacing"},{label:"Cell padding",name:"cellpadding"},{label:"Border",name:"border"},{label:"Caption",name:"caption",type:"checkbox"}]:[r,o,{label:"Width",name:"width",onchange:u(Ac.updateStyleField,t)},{label:"Height",name:"height",onchange:u(Ac.updateStyleField,t)}]},{label:"Alignment",name:"align",type:"listbox",text:"None",values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},i]},fc(t)?t.windowManager.open({title:"Table properties",data:l,bodyType:"tabpanel",body:[{title:"General",type:"form",items:c},Ac.createStyleForm(t)],onsubmit:u(Uc,t,n)}):t.windowManager.open({title:"Table properties",data:l,body:c,onsubmit:u(Uc,t,n)})},Vc=Rc.each,Gc=function(t,e,r,o,i){var a=$u(t),l=function(e){return function(){return m.from(t.dom.getParent(t.selection.getStart(),e)).map(vt.fromDom)}},f=l("caption"),s=l("th,td"),d=function(t){return on.table(t,a)},g=function(t){return{width:Ku(t.dom()),height:Ku(t.dom())}},h=function(e){s().each((function(n){d(n).each((function(i){var u=_r.forMenu(o,i,n),c=g(i);e(i,u).each((function(e){!function(t,e,n){var r=g(n);e.width===r.width&&e.height===r.height||(wc(t,n.dom(),e.width,e.height),yc(t,n.dom(),r.width,r.height))}(t,c,i),t.selection.setRng(e),t.focus(),r.clear(i),Zu(i)}))}))}))},p=function(e){return s().bind((function(e){return d(e).bind((function(r){var i=vt.fromDom(t.getDoc()),u=_r.forMenu(o,r,e),c=Pn(n,i,m.none());return Cc(r,u,c)}))}))},v=function(e){i.get().each((function(n){var i=T(n,(function(t){return Dn(t)}));s().each((function(n){d(n).each((function(u){var c=vt.fromDom(t.getDoc()),a=In(c),l=_r.pasteRows(o,u,n,i,a);e(u,l).each((function(e){t.selection.setRng(e),t.focus(),r.clear(u)}))}))}))}))};Vc({mceTableSplitCells:function(){h(e.unmergeCells)},mceTableMergeCells:function(){h(e.mergeCells)},mceTableInsertRowBefore:function(){h(e.insertRowsBefore)},mceTableInsertRowAfter:function(){h(e.insertRowsAfter)},mceTableInsertColBefore:function(){h(e.insertColumnsBefore)},mceTableInsertColAfter:function(){h(e.insertColumnsAfter)},mceTableDeleteCol:function(){h(e.deleteColumn)},mceTableDeleteRow:function(){h(e.deleteRow)},mceTableCutRow:function(t){i.set(p()),h(e.deleteRow)},mceTableCopyRow:function(t){i.set(p())},mceTablePasteRowBefore:function(t){v(e.pasteRowsBefore)},mceTablePasteRowAfter:function(t){v(e.pasteRowsAfter)},mceTableDelete:function(){s().orThunk(f).each((function(e){on.table(e,a).filter(c(a)).each((function(e){var n=vt.fromText("");xe(e,n),Ne(e);var r=t.dom.createRng();r.setStart(n.dom(),0),r.setEnd(n.dom(),0),t.selection.setRng(r)}))}))}},(function(e,n){t.addCommand(n,e)})),Vc({mceInsertTable:u(qc,t),mceTableProps:u(qc,t,!0),mceTableRowProps:u(Wc,t),mceTableCellProps:u(Ic,t)},(function(e,n){t.addCommand(n,(function(t,n){e(n)}))}))},Yc=function(t){var e=m.from(t.dom().documentElement).map(vt.fromDom).getOr(t);return{parent:o(e),view:o(t),origin:o(co(0,0))}},Xc=function(t,e){return{parent:o(e),view:o(t),origin:o(co(0,0))}},Kc=function(t){var e=j.apply(null,t),n=[];return{bind:function(t){if(void 0===t)throw new Error("Event bind error: undefined handler");n.push(t)},unbind:function(t){n=O(n,(function(e){return e!==t}))},trigger:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var o=e.apply(null,t);D(n,(function(t){t(o)}))}}},Jc={create:function(t){return{registry:L(t,(function(t){return{bind:t.bind,unbind:t.unbind}})),trigger:L(t,(function(t){return t.trigger}))}}},$c=function(t,e){return function(n){if(t(n)){var i=vt.fromDom(n.target),u=function(){n.stopPropagation()},c=function(){n.preventDefault()},a=r(c,u),l=function(t,e,n,r,i,u,c){return{target:o(t),x:o(e),y:o(n),stop:r,prevent:i,kill:u,raw:o(c)}}(i,n.clientX,n.clientY,u,c,a,n);e(l)}}},Qc=function(t,e,n,r){return function(t,e,n,r,o){var i=$c(n,r);return t.dom().addEventListener(e,i,o),{unbind:u(Zc,t,e,i,o)}}(t,e,n,r,!1)},Zc=function(t,e,n,r){t.dom().removeEventListener(e,n,r)},ta=o(!0),ea=function(t,e,n){return Qc(t,e,ta,n)},na=Object.prototype.hasOwnProperty,ra=(Hc=function(t,e){return e},function(){for(var t=new Array(arguments.length),e=0;e<t.length;e++)t[e]=arguments[e];if(0===t.length)throw new Error("Can't merge zero objects");for(var n={},r=0;r<t.length;r++){var o=t[r];for(var i in o)na.call(o,i)&&(n[i]=Hc(n[i],o[i]))}return n}),oa={resolve:qo("ephox-dragster").resolve},ia=xu(["compare","extract","mutate","sink"]),ua=xu(["element","start","stop","destroy"]),ca=xu(["forceDrop","drop","move","delayDrop"]),aa=ia({compare:function(t,e){return co(e.left()-t.left(),e.top()-t.top())},extract:function(t){return m.some(co(t.x(),t.y()))},sink:function(t,e){var n=function(t){var e=ra({layerClass:oa.resolve("blocker")},t),n=vt.fromTag("div");return ct(n,"role","presentation"),Rt(n,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),Mo(n,oa.resolve("blocker")),Mo(n,e.layerClass),{element:function(){return n},destroy:function(){Ne(n)}}}(e),r=ea(n.element(),"mousedown",t.forceDrop),o=ea(n.element(),"mouseup",t.drop),i=ea(n.element(),"mousemove",t.move),u=ea(n.element(),"mouseout",t.delayDrop);return ua({element:n.element,start:function(t){Re(t,n.element())},stop:function(){Ne(n.element())},destroy:function(){n.destroy(),o.unbind(),i.unbind(),u.unbind(),r.unbind()}})},mutate:function(t,e){t.mutate(e.left(),e.top())}});function la(){var t=m.none(),e=Jc.create({move:Kc(["info"])});return{onEvent:function(n,r){r.extract(n).each((function(n){var o=function(e,n){var r=t.map((function(t){return e.compare(t,n)}));return t=m.some(n),r}(r,n);o.each((function(t){e.trigger.move(t)}))}))},reset:function(){t=m.none()},events:e.registry}}function fa(){var t={onEvent:n,reset:n},e=la(),r=t;return{on:function(){r.reset(),r=e},off:function(){r.reset(),r=t},isOn:function(){return r===e},onEvent:function(t,e){r.onEvent(t,e)},events:e.events}}var sa=function(e,n,r){var o,i,u,c=!1,a=Jc.create({start:Kc([]),stop:Kc([])}),l=fa(),f=function(){m.stop(),l.isOn()&&(l.off(),a.trigger.stop())},s=(o=f,i=200,u=null,{cancel:function(){null!==u&&(t.clearTimeout(u),u=null)},throttle:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];null!==u&&t.clearTimeout(u),u=t.setTimeout((function(){o.apply(null,e),u=null}),i)}});l.events.move.bind((function(t){n.mutate(e,t.info())}));var d=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];c&&t.apply(null,e)}},m=n.sink(ca({forceDrop:f,drop:d(f),move:d((function(t){s.cancel(),l.onEvent(t,n)})),delayDrop:d(s.throttle)}),r);return{element:m.element,go:function(t){m.start(t),l.on(),a.trigger.start()},on:function(){c=!0},off:function(){c=!1},destroy:function(){m.destroy()},events:a.registry}},da=function(t,e){void 0===e&&(e={});var n=void 0!==e.mode?e.mode:aa;return sa(t,n,e)},ma=function(){var t=Jc.create({drag:Kc(["xDelta","yDelta","target"])}),e=m.none(),n=function(){var t=Jc.create({drag:Kc(["xDelta","yDelta"])});return{mutate:function(e,n){t.trigger.drag(e,n)},events:t.registry}}();return n.events.drag.bind((function(n){e.each((function(e){t.trigger.drag(n.xDelta(),n.yDelta(),e)}))})),{assign:function(t){e=m.some(t)},get:function(){return e},mutate:n.mutate,events:t.registry}},ga=function(t){return"true"===lt(t,"contenteditable")},ha=Go.resolve("resizer-bar-dragging"),pa=function(t,e,n){var r=ma(),o=da(r,{}),i=m.none(),c=function(t,e){return m.from(lt(t,e))};r.events.drag.bind((function(t){c(t.target(),"data-row").each((function(e){var n=Qi.getInt(t.target(),"top");Ct(t.target(),"top",n+t.yDelta()+"px")})),c(t.target(),"data-column").each((function(e){var n=Qi.getInt(t.target(),"left");Ct(t.target(),"left",n+t.xDelta()+"px")}))}));var a=function(t,e){return Qi.getInt(t,e)-parseInt(lt(t,"data-initial-"+e),10)};o.events.stop.bind((function(){r.get().each((function(r){i.each((function(o){c(r,"data-row").each((function(t){var e=a(r,"top");st(r,"data-initial-top"),h.trigger.adjustHeight(o,e,parseInt(t,10))})),c(r,"data-column").each((function(t){var e=a(r,"left");st(r,"data-initial-left"),h.trigger.adjustWidth(o,e,parseInt(t,10))})),ni(t,o,n,e)}))}))}));var l=function(e,n){h.trigger.startAdjust(),r.assign(e),ct(e,"data-initial-"+n,parseInt(St(e,n),10)),Mo(e,ha),Ct(e,"opacity","0.2"),o.go(t.parent())},f=ea(t.parent(),"mousedown",(function(t){ui(t.target())&&l(t.target(),"top"),ci(t.target())&&l(t.target(),"left")})),s=function(e){return fe(e,t.view())},d=function(t){return Je(t,"table",s).filter((function(t){return function(t,e){return Je(t,"[contenteditable]",e)}(t,s).exists(ga)}))},g=ea(t.view(),"mouseover",(function(r){d(r.target()).fold((function(){bt(r.target())&&ii(t)}),(function(r){i=m.some(r),ni(t,r,n,e)}))})),h=Jc.create({adjustHeight:Kc(["table","delta","row"]),adjustWidth:Kc(["table","delta","column"]),startAdjust:Kc([])});return{destroy:function(){f.unbind(),g.unbind(),o.destroy(),ii(t)},refresh:function(r){ni(t,r,n,e)},on:o.on,off:o.off,hideBars:u(ri,t),showBars:u(oi,t),events:h.registry}},va=function(t,e){var n=Co.height,r=pa(t,e,n),o=Jc.create({beforeResize:Kc(["table"]),afterResize:Kc(["table"]),startDrag:Kc([])});return r.events.adjustHeight.bind((function(t){o.trigger.beforeResize(t.table());var e=n.delta(t.delta(),t.table());pu(t.table(),e,t.row(),n),o.trigger.afterResize(t.table())})),r.events.startAdjust.bind((function(t){o.trigger.startDrag()})),r.events.adjustWidth.bind((function(t){o.trigger.beforeResize(t.table());var n=e.delta(t.delta(),t.table());hu(t.table(),n,t.column(),e),o.trigger.afterResize(t.table())})),{on:r.on,off:r.off,hideBars:r.hideBars,showBars:r.showBars,destroy:r.destroy,events:o.registry}},ba=function(t,e){return t.inline?Xc(Xu(t),function(){var t=vt.fromTag("div");return Rt(t,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),Re(wt(),t),t}()):Yc(vt.fromDom(t.getDoc()))},wa=function(t,e){t.inline&&Ne(e.parent())},ya=function(t){var e,n,r=m.none(),o=m.none(),i=m.none(),u=/(\d+(\.\d+)?)%/,c=function(t){return"TABLE"===t.nodeName};return t.on("init",(function(){var e=So(nc.directionAt),n=ba(t);if(i=m.some(n),function(t){var e=t.getParam("object_resizing",!0);return"table"===e||e}(t)&&function(t){return t.getParam("table_resize_bars",!0,"boolean")}(t)){var u=va(n,e);u.on(),u.events.startDrag.bind((function(e){r=m.some(t.selection.getRng())})),u.events.beforeResize.bind((function(e){var n=e.table().dom();wc(t,n,Ku(n),Ju(n))})),u.events.afterResize.bind((function(e){var n=e.table(),o=n.dom();Zu(n),r.each((function(e){t.selection.setRng(e),t.focus()})),yc(t,o,Ku(o),Ju(o)),t.undoManager.add()})),o=m.some(u)}})),t.on("ObjectResizeStart",(function(r){var o,i=r.target;c(i)&&(e=r.width,o=i,n=t.dom.getStyle(o,"width")||t.dom.getAttrib(o,"width"))})),t.on("ObjectResized",(function(r){var o=r.target;if(c(o)){var i=o;if(u.test(n)){var a=parseFloat(u.exec(n)[1]),l=r.width*a/e;t.dom.setStyle(i,"width",l+"%")}else{var f=[];Rc.each(i.rows,(function(e){Rc.each(e.cells,(function(e){var n=t.dom.getStyle(e,"width",!0);f.push({cell:e,width:n})}))})),Rc.each(f,(function(e){t.dom.setStyle(e.cell,"width",e.width),t.dom.setAttrib(e.cell,"width",null)}))}}})),{lazyResize:function(){return o},lazyWire:function(){return i.getOr(Yc(vt.fromDom(t.getBody())))},destroy:function(){o.each((function(t){t.destroy()})),i.each((function(e){wa(t,e)}))}}},xa=Nr([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),Ca=Do(Do({},xa),{none:function(t){return void 0===t&&(t=void 0),xa.none(t)}}),Ra=function(t,e){return on.table(t,e).bind((function(e){var n=on.cells(e);return A(n,(function(e){return fe(t,e)})).map((function(t){return{index:o(t),all:o(n)}}))}))},Sa=function(t,e){return Ra(t,e).fold((function(){return Ca.none(t)}),(function(e){return e.index()+1<e.all().length?Ca.middle(t,e.all()[e.index()+1]):Ca.last(t)}))},Ta=function(t,e){return Ra(t,e).fold((function(){return Ca.none()}),(function(e){return e.index()-1>=0?Ca.middle(t,e.all()[e.index()-1]):Ca.first(t)}))},Da={create:j("start","soffset","finish","foffset")},Oa=Nr([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Na={before:Oa.before,on:Oa.on,after:Oa.after,cata:function(t,e,n,r){return t.fold(e,n,r)},getStart:function(t){return t.fold(i,i,i)}},Ea=Nr([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),ka={domRange:Ea.domRange,relative:Ea.relative,exact:Ea.exact,exactFromRange:function(t){return Ea.exact(t.start(),t.soffset(),t.finish(),t.foffset())},getWin:function(t){var e,n=function(t){return t.match({domRange:function(t){return vt.fromDom(t.startContainer)},relative:function(t,e){return Na.getStart(t)},exact:function(t,e,n,r){return t}})}(t);return e=n,vt.fromDom(e.dom().ownerDocument.defaultView)},range:Da.create},Aa=function(t,e){t.selectNodeContents(e.dom())},Pa=function(t,e,n){var r,o=t.document.createRange();return r=o,e.fold((function(t){r.setStartBefore(t.dom())}),(function(t,e){r.setStart(t.dom(),e)}),(function(t){r.setStartAfter(t.dom())})),function(t,e){e.fold((function(e){t.setEndBefore(e.dom())}),(function(e,n){t.setEnd(e.dom(),n)}),(function(e){t.setEndAfter(e.dom())}))}(o,n),o},Ia=function(t,e,n,r,o){var i=t.document.createRange();return i.setStart(e.dom(),n),i.setEnd(r.dom(),o),i},Ba=function(t){return{left:o(t.left),top:o(t.top),right:o(t.right),bottom:o(t.bottom),width:o(t.width),height:o(t.height)}},Wa=Nr([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Ma=function(t,e,n){return e(vt.fromDom(n.startContainer),n.startOffset,vt.fromDom(n.endContainer),n.endOffset)},_a=function(t,e){var n=function(t,e){return e.match({domRange:function(t){return{ltr:o(t),rtl:m.none}},relative:function(e,n){return{ltr:ht((function(){return Pa(t,e,n)})),rtl:ht((function(){return m.some(Pa(t,n,e))}))}},exact:function(e,n,r,o){return{ltr:ht((function(){return Ia(t,e,n,r,o)})),rtl:ht((function(){return m.some(Ia(t,r,o,e,n))}))}}})}(t,e);return function(t,e){var n=e.ltr();return n.collapsed?e.rtl().filter((function(t){return!1===t.collapsed})).map((function(t){return Wa.rtl(vt.fromDom(t.endContainer),t.endOffset,vt.fromDom(t.startContainer),t.startOffset)})).getOrThunk((function(){return Ma(0,Wa.ltr,n)})):Ma(0,Wa.ltr,n)}(0,n)},La=function(t,e){return _a(t,e).match({ltr:function(e,n,r,o){var i=t.document.createRange();return i.setStart(e.dom(),n),i.setEnd(r.dom(),o),i},rtl:function(e,n,r,o){var i=t.document.createRange();return i.setStart(r.dom(),o),i.setEnd(e.dom(),n),i}})},Fa=function(t,e,n){return e>=t.left&&e<=t.right&&n>=t.top&&n<=t.bottom},ja=function(t,e,n,r,o){var i=function(n){var r=t.dom().createRange();return r.setStart(e.dom(),n),r.collapse(!0),r},u=hn(e).length,c=function(t,e,n,r,o){if(0===o)return 0;if(e===r)return o-1;for(var i=r,u=1;u<o;u++){var c=t(u),a=Math.abs(e-c.left);if(n<=c.bottom){if(n<c.top||a>i)return u-1;i=a}}return 0}((function(t){return i(t).getBoundingClientRect()}),n,r,o.right,u);return i(c)},za=function(t,e,n,r){return it(e)?function(t,e,n,r){var o=t.dom().createRange();o.selectNode(e.dom());var i=o.getClientRects();return No(i,(function(t){return Fa(t,n,r)?m.some(t):m.none()})).map((function(o){return ja(t,e,n,r,o)}))}(t,e,n,r):function(t,e,n,r){var o=t.dom().createRange(),i=be(e);return No(i,(function(e){return o.selectNode(e.dom()),Fa(o.getBoundingClientRect(),n,r)?za(t,e,n,r):m.none()}))}(t,e,n,r)},Ha=function(t,e){return e-t.left<t.right-e},Ua=function(t,e,n){var r=t.dom().createRange();return r.selectNode(e.dom()),r.collapse(n),r},qa=function(t,e,n){var r=t.dom().createRange();r.selectNode(e.dom());var o=r.getBoundingClientRect(),i=Ha(o,n);return(!0===i?xn:Cn)(e).map((function(e){return Ua(t,e,i)}))},Va=function(t,e,n){var r=e.dom().getBoundingClientRect(),o=Ha(r,n);return m.some(Ua(t,e,o))},Ga=function(t,e,n,r){var o=t.dom().createRange();o.selectNode(e.dom());var i=o.getBoundingClientRect();return function(t,e,n,r){var o=t.dom().createRange();o.selectNode(e.dom());var i=o.getBoundingClientRect(),u=Math.max(i.left,Math.min(i.right,n)),c=Math.max(i.top,Math.min(i.bottom,r));return za(t,e,u,c)}(t,e,Math.max(i.left,Math.min(i.right,n)),Math.max(i.top,Math.min(i.bottom,r)))},Ya=document.caretPositionFromPoint?function(t,e,n){return m.from(t.dom().caretPositionFromPoint(e,n)).bind((function(e){if(null===e.offsetNode)return m.none();var n=t.dom().createRange();return n.setStart(e.offsetNode,e.offset),n.collapse(),m.some(n)}))}:document.caretRangeFromPoint?function(t,e,n){return m.from(t.dom().caretRangeFromPoint(e,n))}:function(t,e,n){return vt.fromPoint(t,e,n).bind((function(r){var o=function(){return function(t,e,n){return(0===be(e).length?Va:qa)(t,e,n)}(t,r,e)};return 0===be(r).length?o():Ga(t,r,e,n).orThunk(o)}))},Xa=function(t,e){var n=tt(t);return"input"===n?Na.after(t):R(["br","img"],n)?0===e?Na.before(t):Na.after(t):Na.on(t,e)},Ka=function(t,e){var n=t.fold(Na.before,Xa,Na.after),r=e.fold(Na.before,Xa,Na.after);return ka.relative(n,r)},Ja=function(t,e,n,r){var o=Xa(t,e),i=Xa(n,r);return ka.relative(o,i)},$a=function(t,e,n,r){var o=function(t,e,n,r){var o=me(t).dom().createRange();return o.setStart(t.dom(),e),o.setEnd(n.dom(),r),o}(t,e,n,r),i=fe(t,n)&&e===r;return o.collapsed&&!i},Qa=function(t,e){m.from(t.getSelection()).each((function(t){t.removeAllRanges(),t.addRange(e)}))},Za=function(t,e,n,r,o){var i=Ia(t,e,n,r,o);Qa(t,i)},tl=function(t,e){return _a(t,e).match({ltr:function(e,n,r,o){Za(t,e,n,r,o)},rtl:function(e,n,r,o){var i=t.getSelection();if(i.setBaseAndExtent)i.setBaseAndExtent(e.dom(),n,r.dom(),o);else if(i.extend)try{!function(t,e,n,r,o,i){e.collapse(n.dom(),r),e.extend(o.dom(),i)}(0,i,e,n,r,o)}catch(i){Za(t,r,o,e,n)}else Za(t,r,o,e,n)}})},el=function(t){var e=ka.getWin(t).dom(),n=function(t,n,r,o){return Ia(e,t,n,r,o)},r=function(t){return t.match({domRange:function(t){var e=vt.fromDom(t.startContainer),n=vt.fromDom(t.endContainer);return Ja(e,t.startOffset,n,t.endOffset)},relative:Ka,exact:Ja})}(t);return _a(e,r).match({ltr:n,rtl:n})},nl=function(t){var e=vt.fromDom(t.anchorNode),n=vt.fromDom(t.focusNode);return $a(e,t.anchorOffset,n,t.focusOffset)?m.some(Da.create(e,t.anchorOffset,n,t.focusOffset)):function(t){if(t.rangeCount>0){var e=t.getRangeAt(0),n=t.getRangeAt(t.rangeCount-1);return m.some(Da.create(vt.fromDom(e.startContainer),e.startOffset,vt.fromDom(n.endContainer),n.endOffset))}return m.none()}(t)},rl=function(t,e){var n=function(t,e){var n=t.document.createRange();return Aa(n,e),n}(t,e);Qa(t,n)},ol=function(t){return function(t){return m.from(t.getSelection()).filter((function(t){return t.rangeCount>0})).bind(nl)}(t).map((function(t){return ka.exact(t.start(),t.soffset(),t.finish(),t.foffset())}))},il=function(t,e){return function(t){var e=t.getClientRects(),n=e.length>0?e[0]:t.getBoundingClientRect();return n.width>0||n.height>0?m.some(n).map(Ba):m.none()}(La(t,e))},ul=function(t,e,n){return function(t,e,n){var r=vt.fromDom(t.document);return Ya(r,e,n).map((function(t){return Da.create(vt.fromDom(t.startContainer),t.startOffset,vt.fromDom(t.endContainer),t.endOffset)}))}(t,e,n)},cl=tinymce.util.Tools.resolve("tinymce.util.VK"),al=function(t,e,n,r){return dl(t,e,Sa(n),r)},ll=function(t,e,n,r){return dl(t,e,Ta(n),r)},fl=function(t,e){var n=ka.exact(e,0,e,0);return el(n)},sl=function(t,e){var n,r=qe(e,"tr");return(n=r,0===n.length?m.none():m.some(n[n.length-1])).bind((function(t){return Ke(t,"td,th").map((function(t){return fl(0,t)}))}))},dl=function(t,e,n,r,o){return n.fold(m.none,m.none,(function(t,e){return xn(e).map((function(t){return fl(0,t)}))}),(function(n){return on.table(n,e).bind((function(e){var o=_r.noMenu(n);return t.undoManager.transact((function(){r.insertRowsAfter(e,o)})),sl(0,e)}))}))},ml=["table","li","dl"],gl=function(t,e,n,r){if(t.keyCode===cl.TAB){var o=Xu(e),i=function(t){var e=tt(t);return fe(t,o)||R(ml,e)},u=e.selection.getRng();if(u.collapsed){var c=vt.fromDom(u.startContainer);on.cell(c,i).each((function(o){t.preventDefault(),(t.shiftKey?ll:al)(e,i,o,n,r).each((function(t){e.selection.setRng(t)}))}))}}},hl={create:j("selection","kill")},pl=function(t,e,n,r){return{start:o(Na.on(t,e)),finish:o(Na.on(n,r))}},vl={convertToRange:function(t,e){var n=La(t,e);return Da.create(vt.fromDom(n.startContainer),n.startOffset,vt.fromDom(n.endContainer),n.endOffset)},makeSitus:pl},bl=function(t,e,n,r,o){return fe(n,r)?m.none():gr(n,r,e).bind((function(e){var r=e.boxes().getOr([]);return r.length>0?(o(t,r,e.start(),e.finish()),m.some(hl.create(m.some(vl.makeSitus(n,0,n,bn(n))),!0))):m.none()}))},wl={sync:function(t,e,n,r,o,i,u){return fe(n,o)&&r===i?m.none():Je(n,"td,th",e).bind((function(n){return Je(o,"td,th",e).bind((function(r){return bl(t,e,n,r,u)}))}))},detect:bl,update:function(t,e,n,r,o){return pr(r,t,e,o.firstSelectedSelector(),o.lastSelectedSelector()).map((function(t){return o.clear(n),o.selectRange(n,t.boxes(),t.start(),t.finish()),t.boxes()}))}},yl=j("item","mode"),xl=function(t,e,n,r){return void 0===r&&(r=Cl),t.property().parent(e).map((function(t){return yl(t,r)}))},Cl=function(t,e,n,r){return void 0===r&&(r=Rl),n.sibling(t,e).map((function(t){return yl(t,r)}))},Rl=function(t,e,n,r){void 0===r&&(r=Rl);var o=t.property().children(e);return n.first(o).map((function(t){return yl(t,r)}))},Sl=[{current:xl,next:Cl,fallback:m.none()},{current:Cl,next:Rl,fallback:m.some(xl)},{current:Rl,next:Rl,fallback:m.some(Cl)}],Tl=function(t,e,n,r,o){return void 0===o&&(o=Sl),k(o,(function(t){return t.current===n})).bind((function(n){return n.current(t,e,r,n.next).orThunk((function(){return n.fallback.bind((function(n){return Tl(t,e,n,r)}))}))}))},Dl=function(){return{sibling:function(t,e){return t.query().prevSibling(e)},first:function(t){return t.length>0?m.some(t[t.length-1]):m.none()}}},Ol=function(){return{sibling:function(t,e){return t.query().nextSibling(e)},first:function(t){return t.length>0?m.some(t[0]):m.none()}}},Nl=function(t,e,n,r,o,i){return Tl(t,e,r,o).bind((function(e){return i(e.item())?m.none():n(e.item())?m.some(e.item()):Nl(t,e.item(),n,e.mode(),o,i)}))},El=function(t){return function(e){return 0===t.property().children(e).length}},kl=function(t,e,n,r){return Nl(t,e,n,Cl,Dl(),r)},Al=function(t,e,n,r){return Nl(t,e,n,Cl,Ol(),r)},Pl=Kn(),Il=function(t,e){return function(t,e,n){return kl(t,e,El(t),n)}(Pl,t,e)},Bl=function(t,e){return function(t,e,n){return Al(t,e,El(t),n)}(Pl,t,e)},Wl=j("element","offset"),Ml=(j("element","deltaOffset"),j("element","start","finish"),j("begin","end"),j("element","text"),Nr([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}])),_l=function(t){return Je(t,"tr")},Ll=Do(Do({},Ml),{verify:function(t,e,n,r,o,i,u){return Je(r,"td,th",u).bind((function(n){return Je(e,"td,th",u).map((function(e){return fe(n,e)?fe(r,n)&&bn(n)===o?i(e):Ml.none("in same cell"):fr.sharedOne(_l,[n,e]).fold((function(){return function(t,e,n){var r=t.getRect(e),o=t.getRect(n);return o.right>r.left&&o.left<r.right}(t,e,n)?Ml.success():i(e)}),(function(t){return i(e)}))}))})).getOr(Ml.none("default"))},cata:function(t,e,n,r,o){return t.fold(e,n,r,o)}}),Fl=(j("ancestor","descendants","element","index"),j("parent","children","element","index")),jl=function(t,e){return A(t,u(fe,e))},zl=function(t){return"br"===tt(t)},Hl=function(t,e,n){return e(t,n).bind((function(t){return it(t)&&0===hn(t).trim().length?Hl(t,e,n):m.some(t)}))},Ul=function(t,e,n,r){return function(t,e){return we(t,e).filter(zl).orThunk((function(){return we(t,e-1).filter(zl)}))}(e,n).bind((function(e){return r.traverse(e).fold((function(){return Hl(e,r.gather,t).map(r.relative)}),(function(t){return function(t){return ge(t).bind((function(e){var n=be(e);return jl(n,t).map((function(r){return Fl(e,n,t,r)}))}))}(t).map((function(t){return Na.on(t.parent(),t.index())}))}))}))},ql=function(t,e,n,r){var i=zl(e)?function(t,e,n){return n.traverse(e).orThunk((function(){return Hl(e,n.gather,t)})).map(n.relative)}(t,e,r):Ul(t,e,n,r);return i.map((function(t){return{start:o(t),finish:o(t)}}))},Vl=function(t){return Ll.cata(t,(function(t){return m.none()}),(function(){return m.none()}),(function(t){return m.some(Wl(t,0))}),(function(t){return m.some(Wl(t,bn(t)))}))},Gl=G(["left","top","right","bottom"],[]),Yl={nu:Gl,moveUp:function(t,e){return Gl({left:t.left(),top:t.top()-e,right:t.right(),bottom:t.bottom()-e})},moveDown:function(t,e){return Gl({left:t.left(),top:t.top()+e,right:t.right(),bottom:t.bottom()+e})},moveBottomTo:function(t,e){var n=t.bottom()-t.top();return Gl({left:t.left(),top:e-n,right:t.right(),bottom:e})},moveTopTo:function(t,e){var n=t.bottom()-t.top();return Gl({left:t.left(),top:e,right:t.right(),bottom:e+n})},getTop:function(t){return t.top()},getBottom:function(t){return t.bottom()},translate:function(t,e,n){return Gl({left:t.left()+e,top:t.top()+n,right:t.right()+e,bottom:t.bottom()+n})},toString:function(t){return"("+t.left()+", "+t.top()+") -> ("+t.right()+", "+t.bottom()+")"}},Xl=function(t){return Yl.nu({left:t.left,top:t.top,right:t.right,bottom:t.bottom})},Kl=function(t,e){return m.some(t.getRect(e))},Jl=function(t,e,n){return ot(e)?Kl(t,e).map(Xl):it(e)?function(t,e,n){return n>=0&&n<bn(e)?t.getRangedRect(e,n,e,n+1):n>0?t.getRangedRect(e,n-1,e,n):m.none()}(t,e,n).map(Xl):m.none()},$l=function(t,e){return ot(e)?Kl(t,e).map(Xl):it(e)?t.getRangedRect(e,0,e,bn(e)).map(Xl):m.none()},Ql=Nr([{none:[]},{retry:["caret"]}]),Zl=function(t,e,n){return(r=e,i=Bu,Ve((function(t,e){return e(t)}),Ge,r,i,u)).fold(o(!1),(function(e){return $l(t,e).exists((function(t){return function(t,e){return t.left()<e.left()||Math.abs(e.right()-t.left())<1||t.left()>e.right()}(n,t)}))}));var r,i,u},tf={point:Yl.getTop,adjuster:function(t,e,n,r,o){var i=Yl.moveUp(o,5);return Math.abs(n.top()-r.top())<1||n.bottom()<o.top()?Ql.retry(i):n.bottom()===o.top()?Ql.retry(Yl.moveUp(o,1)):Zl(t,e,o)?Ql.retry(Yl.translate(i,5,0)):Ql.none()},move:Yl.moveUp,gather:Il},ef={point:Yl.getBottom,adjuster:function(t,e,n,r,o){var i=Yl.moveDown(o,5);return Math.abs(n.bottom()-r.bottom())<1||n.top()>o.bottom()?Ql.retry(i):n.top()===o.bottom()?Ql.retry(Yl.moveDown(o,1)):Zl(t,e,o)?Ql.retry(Yl.translate(i,5,0)):Ql.none()},move:Yl.moveDown,gather:Bl},nf=function(t,e,n,r,o){return 0===o?m.some(r):function(t,e,n){return t.elementFromPoint(e,n).filter((function(t){return"table"===tt(t)})).isSome()}(t,r.left(),e.point(r))?function(t,e,n,r,o){return nf(t,e,n,e.move(r,5),o)}(t,e,n,r,o-1):t.situsFromPoint(r.left(),e.point(r)).bind((function(i){return i.start().fold(m.none,(function(i){return $l(t,i).bind((function(u){return e.adjuster(t,i,u,n,r).fold(m.none,(function(r){return nf(t,e,n,r,o-1)}))})).orThunk((function(){return m.some(r)}))}),m.none)}))},rf=function(t,e,n){var r=t.move(n,5),o=nf(e,t,n,r,100).getOr(r);return function(t,e,n){return t.point(e)>n.getInnerHeight()?m.some(t.point(e)-n.getInnerHeight()):t.point(e)<0?m.some(-t.point(e)):m.none()}(t,o,e).fold((function(){return e.situsFromPoint(o.left(),t.point(o))}),(function(n){return e.scrollBy(0,n),e.situsFromPoint(o.left(),t.point(o)-n)}))},of={tryUp:u(rf,tf),tryDown:u(rf,ef),ieTryUp:function(t,e){return t.situsFromPoint(e.left(),e.top()-5)},ieTryDown:function(t,e){return t.situsFromPoint(e.left(),e.bottom()+5)},getJumpSize:o(5)},uf=ie.detect(),cf=function(t,e,n,r,o,i){return 0===i?m.none():ff(t,e,n,r,o).bind((function(u){var c=t.fromSitus(u),a=Ll.verify(t,n,r,c.finish(),c.foffset(),o.failure,e);return Ll.cata(a,(function(){return m.none()}),(function(){return m.some(u)}),(function(u){return fe(n,u)&&0===r?af(t,n,r,Yl.moveUp,o):cf(t,e,u,0,o,i-1)}),(function(u){return fe(n,u)&&r===bn(u)?af(t,n,r,Yl.moveDown,o):cf(t,e,u,bn(u),o,i-1)}))}))},af=function(t,e,n,r,o){return Jl(t,e,n).bind((function(e){return lf(t,o,r(e,of.getJumpSize()))}))},lf=function(t,e,n){return uf.browser.isChrome()||uf.browser.isSafari()||uf.browser.isFirefox()||uf.browser.isEdge()?e.otherRetry(t,n):uf.browser.isIE()?e.ieRetry(t,n):m.none()},ff=function(t,e,n,r,o){return Jl(t,n,r).bind((function(e){return lf(t,o,e)}))},sf=function(t,e,n){return function(t,e,n){return t.getSelection().bind((function(r){return ql(e,r.finish(),r.foffset(),n).fold((function(){return m.some(Wl(r.finish(),r.foffset()))}),(function(o){var i=t.fromSitus(o),u=Ll.verify(t,r.finish(),r.foffset(),i.finish(),i.foffset(),n.failure,e);return Vl(u)}))}))}(t,e,n).bind((function(r){return cf(t,e,r.element(),r.offset(),n,20).map(t.fromSitus)}))},df=ie.detect(),mf=function(t,e){return Ge(t,(function(t){return ge(t).exists((function(t){return fe(t,e)}))}),n).isSome();var n},gf=function(t,e,n,r,i){return Je(r,"td,th",e).bind((function(r){return Je(r,"table",e).bind((function(u){return mf(i,u)?sf(t,e,n).bind((function(t){return Je(t.finish(),"td,th",e).map((function(e){return{start:o(r),finish:o(e),range:o(t)}}))})):m.none()}))}))},hf=function(t,e,n,r,o,i){return df.browser.isIE()?m.none():i(r,e).orThunk((function(){return gf(t,e,n,r,o).map((function(t){var e=t.range();return hl.create(m.some(vl.makeSitus(e.start(),e.soffset(),e.finish(),e.foffset())),!0)}))}))},pf=function(t,e,n,r,o,i,u){return gf(t,n,r,o,i).bind((function(t){return wl.detect(e,n,t.start(),t.finish(),u)}))},vf=function(t,e){return Je(t,"tr",e).bind((function(t){return Je(t,"table",e).bind((function(n){var r=qe(n,"tr");return fe(t,r[0])?function(t,e,n){return kl(Pl,t,e,n)}(n,(function(t){return Cn(t).isSome()}),e).map((function(t){var e=bn(t);return hl.create(m.some(vl.makeSitus(t,e,t,e)),!0)})):m.none()}))}))},bf=function(t,e){return Je(t,"tr",e).bind((function(t){return Je(t,"table",e).bind((function(n){var r=qe(n,"tr");return fe(t,r[r.length-1])?function(t,e,n){return Al(Pl,t,e,n)}(n,(function(t){return xn(t).isSome()}),e).map((function(t){return hl.create(m.some(vl.makeSitus(t,0,t,0)),!0)})):m.none()}))}))},wf=function(t,e){return Je(t,"td,th",e)},yf={down:{traverse:ve,gather:Bl,relative:Na.before,otherRetry:of.tryDown,ieRetry:of.ieTryDown,failure:Ll.failedDown},up:{traverse:pe,gather:Il,relative:Na.before,otherRetry:of.tryUp,ieRetry:of.ieTryUp,failure:Ll.failedUp}},xf=function(t){return function(e){return e===t}},Cf=xf(38),Rf=xf(40),Sf={ltr:{isBackward:xf(37),isForward:xf(39)},rtl:{isBackward:xf(39),isForward:xf(37)},isUp:Cf,isDown:Rf,isNavigation:function(t){return t>=37&&t<=40}},Tf=function(t){return{left:t.left(),top:t.top(),right:t.right(),bottom:t.bottom(),width:t.width(),height:t.height()}},Df=(ie.detect().browser.isSafari(),function(e){return{elementFromPoint:function(t,n){return vt.fromPoint(vt.fromDom(e.document),t,n)},getRect:function(t){return t.dom().getBoundingClientRect()},getRangedRect:function(t,n,r,o){var i=ka.exact(t,n,r,o);return il(e,i).map(Tf)},getSelection:function(){return ol(e).map((function(t){return vl.convertToRange(e,t)}))},fromSitus:function(t){var n=ka.relative(t.start(),t.finish());return vl.convertToRange(e,n)},situsFromPoint:function(t,n){return ul(e,t,n).map((function(t){return pl(t.start(),t.soffset(),t.finish(),t.foffset())}))},clearSelection:function(){!function(t){t.getSelection().removeAllRanges()}(e)},setSelection:function(t){!function(t,e,n,r,o){var i=Ja(e,n,r,o);tl(t,i)}(e,t.start(),t.soffset(),t.finish(),t.foffset())},setRelativeSelection:function(t,n){!function(t,e,n){var r=Ka(e,n);tl(t,r)}(e,t,n)},selectContents:function(t){rl(e,t)},getInnerHeight:function(){return e.innerHeight},getScrollY:function(){var n,r,o,i;return(n=vt.fromDom(e.document),r=void 0!==n?n.dom():t.document,o=r.body.scrollLeft||r.documentElement.scrollLeft,i=r.body.scrollTop||r.documentElement.scrollTop,co(o,i)).top()},scrollBy:function(n,r){!function(e,n,r){(void 0!==r?r.dom():t.document).defaultView.scrollBy(e,n)}(n,r,vt.fromDom(e.document))}}}),Of=j("rows","cols"),Nf={mouse:function(t,e,n,r){var o=function(t,e,n,r){var o=m.none(),i=function(){o=m.none()};return{mousedown:function(t){r.clear(e),o=wf(t.target(),n)},mouseover:function(i){o.each((function(o){r.clear(e),wf(i.target(),n).each((function(i){gr(o,i,n).each((function(n){var u=n.boxes().getOr([]);(u.length>1||1===u.length&&!fe(o,i))&&(r.selectRange(e,u,n.start(),n.finish()),t.selectContents(i))}))}))}))},mouseup:function(t){o.each(i)}}}(Df(t),e,n,r);return{mousedown:o.mousedown,mouseover:o.mouseover,mouseup:o.mouseup}},keyboard:function(t,e,n,r){var o=Df(t),i=function(){return r.clear(e),m.none()};return{keydown:function(t,c,a,l,f,s){var d=t.raw(),g=d.which,h=!0===d.shiftKey,p=hr(e,r.selectedSelector()).fold((function(){return Sf.isDown(g)&&h?u(pf,o,e,n,yf.down,l,c,r.selectRange):Sf.isUp(g)&&h?u(pf,o,e,n,yf.up,l,c,r.selectRange):Sf.isDown(g)?u(hf,o,n,yf.down,l,c,bf):Sf.isUp(g)?u(hf,o,n,yf.up,l,c,vf):m.none}),(function(t){var n=function(n){return function(){var i=No(n,(function(n){return wl.update(n.rows(),n.cols(),e,t,r)}));return i.fold((function(){return vr(e,r.firstSelectedSelector(),r.lastSelectedSelector()).map((function(t){var n=Sf.isDown(g)||s.isForward(g)?Na.after:Na.before;return o.setRelativeSelection(Na.on(t.first(),0),n(t.table())),r.clear(e),hl.create(m.none(),!0)}))}),(function(t){return m.some(hl.create(m.none(),!0))}))}};return Sf.isDown(g)&&h?n([Of(1,0)]):Sf.isUp(g)&&h?n([Of(-1,0)]):s.isBackward(g)&&h?n([Of(0,-1),Of(-1,0)]):s.isForward(g)&&h?n([Of(0,1),Of(1,0)]):Sf.isNavigation(g)&&!1===h?i:m.none}));return p()},keyup:function(t,o,i,u,c){return hr(e,r.selectedSelector()).fold((function(){var a=t.raw(),l=a.which;return!1==(!0===a.shiftKey)?m.none():Sf.isNavigation(l)?wl.sync(e,n,o,i,u,c,r.selectRange):m.none()}),m.none)}}}},Ef=function(t,e){D(e,(function(e){!function(t,e){Io(t)?t.dom().classList.remove(e):Wo(t,e),_o(t)}(t,e)}))},kf={byClass:function(t){var e,n,r=(e=t.selected(),function(t){Mo(t,e)}),o=(n=[t.selected(),t.lastSelected(),t.firstSelected()],function(t){Ef(t,n)}),i=function(e){var n=qe(e,t.selectedSelector());D(n,o)};return{clear:i,selectRange:function(e,n,o,u){i(e),D(n,r),Mo(o,t.firstSelected()),Mo(u,t.lastSelected())},selectedSelector:t.selectedSelector,firstSelectedSelector:t.firstSelectedSelector,lastSelectedSelector:t.lastSelectedSelector}},byAttr:function(t){var e=function(e){st(e,t.selected()),st(e,t.firstSelected()),st(e,t.lastSelected())},n=function(e){ct(e,t.selected(),"1")},r=function(n){var r=qe(n,t.selectedSelector());D(r,e)};return{clear:r,selectRange:function(e,o,i,u){r(e),D(o,n),ct(i,t.firstSelected(),"1"),ct(u,t.lastSelected(),"1")},selectedSelector:t.selectedSelector,firstSelectedSelector:t.firstSelectedSelector,lastSelectedSelector:t.lastSelectedSelector}}},Af=function(t){return!1===Lo(vt.fromDom(t.target),"ephox-snooker-resizer-bar")};function Pf(t,e){var i=G(["mousedown","mouseover","mouseup","keyup","keydown"],[]),u=m.none(),c=kf.byAttr(Or);return t.on("init",(function(a){var l=t.getWin(),f=Xu(t),s=$u(t),d=Nf.mouse(l,f,s,c),g=Nf.keyboard(l,f,s,c),h=function(e,n){(function(t){return!0===t.raw().shiftKey})(e)&&(n.kill()&&e.kill(),n.selection().each((function(e){var n=ka.relative(e.start(),e.finish()),r=La(l,n);t.selection.setRng(r)})))},p=function(e){var n=w(e);if(n.raw().shiftKey&&Sf.isNavigation(n.raw().which)){var r=t.selection.getRng(),o=vt.fromDom(r.startContainer),i=vt.fromDom(r.endContainer);g.keyup(n,o,r.startOffset,i,r.endOffset).each((function(t){h(n,t)}))}},v=function(n){var r=w(n);e().each((function(t){t.hideBars()}));var o=t.selection.getRng(),i=vt.fromDom(t.selection.getStart()),u=vt.fromDom(o.startContainer),c=vt.fromDom(o.endContainer),a=nc.directionAt(i).isRtl()?Sf.rtl:Sf.ltr;g.keydown(r,u,o.startOffset,c,o.endOffset,a).each((function(t){h(r,t)})),e().each((function(t){t.showBars()}))},b=function(t){return t.hasOwnProperty("x")&&t.hasOwnProperty("y")},w=function(t){var e=vt.fromDom(t.target),n=function(){t.stopPropagation()},i=function(){t.preventDefault()},u=r(i,n);return{target:o(e),x:o(b(t)?t.x:null),y:o(b(t)?t.y:null),stop:n,prevent:i,kill:u,raw:o(t)}},y=function(t){return 0===t.button},x=function(t){y(t)&&Af(t)&&d.mousedown(w(t))},C=function(t){var e;(void 0===(e=t).buttons||Mc.ie&&Mc.ie>=12&&0===e.buttons||0!=(1&e.buttons))&&Af(t)&&d.mouseover(w(t))},R=function(t){y(t)&&Af(t)&&d.mouseup(w(t))};t.on("mousedown",x),t.on("mouseover",C),t.on("mouseup",R),t.on("keyup",p),t.on("keydown",v),t.on("nodechange",(function(){var e=t.selection,r=vt.fromDom(e.getStart()),o=vt.fromDom(e.getEnd());fr.sharedOne(on.table,[r,o]).fold((function(){c.clear(f)}),n)})),u=m.some(i({mousedown:x,mouseover:C,mouseup:R,keyup:p,keydown:v}))})),{clear:c.clear,destroy:function(){u.each((function(t){}))}}}var If=Rc.each,Bf=function(t){var e=[];function n(e){return function(){t.execCommand(e)}}If("inserttable tableprops deletetable | cell row column".split(" "),(function(n){"|"===n?e.push({text:"-"}):e.push(t.menuItems[n])})),t.addButton("table",{type:"menubutton",title:"Table",menu:e}),t.addButton("tableprops",{title:"Table properties",onclick:n("mceTableProps"),icon:"table"}),t.addButton("tabledelete",{title:"Delete table",onclick:n("mceTableDelete")}),t.addButton("tablecellprops",{title:"Cell properties",onclick:n("mceTableCellProps")}),t.addButton("tablemergecells",{title:"Merge cells",onclick:n("mceTableMergeCells")}),t.addButton("tablesplitcells",{title:"Split cell",onclick:n("mceTableSplitCells")}),t.addButton("tableinsertrowbefore",{title:"Insert row before",onclick:n("mceTableInsertRowBefore")}),t.addButton("tableinsertrowafter",{title:"Insert row after",onclick:n("mceTableInsertRowAfter")}),t.addButton("tabledeleterow",{title:"Delete row",onclick:n("mceTableDeleteRow")}),t.addButton("tablerowprops",{title:"Row properties",onclick:n("mceTableRowProps")}),t.addButton("tablecutrow",{title:"Cut row",onclick:n("mceTableCutRow")}),t.addButton("tablecopyrow",{title:"Copy row",onclick:n("mceTableCopyRow")}),t.addButton("tablepasterowbefore",{title:"Paste row before",onclick:n("mceTablePasteRowBefore")}),t.addButton("tablepasterowafter",{title:"Paste row after",onclick:n("mceTablePasteRowAfter")}),t.addButton("tableinsertcolbefore",{title:"Insert column before",onclick:n("mceTableInsertColBefore")}),t.addButton("tableinsertcolafter",{title:"Insert column after",onclick:n("mceTableInsertColAfter")}),t.addButton("tabledeletecol",{title:"Delete column",onclick:n("mceTableDeleteCol")})},Wf=function(t){var e=function(t){var e=t.getParam("table_toolbar",rc);return""===e||!1===e?[]:h(e)?e.split(/[ ,]/):p(e)?e:[]}(t);e.length>0&&t.addContextToolbar((function(e){return t.dom.is(e,"table")&&t.getBody().contains(e)}),e.join(" "))},Mf=function(t,e){var n=m.none(),r=[],o=[],i=[],u=[],c=function(t){t.disabled(!0)},a=function(t){t.disabled(!1)},l=function(){var t=this;r.push(t),n.fold((function(){c(t)}),(function(e){a(t)}))},f=function(){var t=this;o.push(t),n.fold((function(){c(t)}),(function(e){a(t)}))};t.on("init",(function(){t.on("nodechange",(function(l){var f=m.from(t.dom.getParent(t.selection.getStart(),"th,td"));n=f.bind((function(t){var n=vt.fromDom(t);return on.table(n).map((function(t){return _r.forMenu(e,t,n)}))})),n.fold((function(){D(r,c),D(o,c),D(i,c),D(u,c)}),(function(t){D(r,a),D(o,a),D(i,(function(e){e.disabled(t.mergable().isNone())})),D(u,(function(e){e.disabled(t.unmergable().isNone())}))}))}))}));var s=function(t,e,n,r){var o,i,u,c,a,l=r.getEl().getElementsByTagName("table")[0],f=r.isRtl()||"tl-tr"===r.parent().rel;for(l.nextSibling.innerHTML=e+1+" x "+(n+1),f&&(e=9-e),i=0;i<10;i++)for(o=0;o<10;o++)c=l.rows[i].childNodes[o].firstChild,a=(f?o>=e:o<=e)&&i<=n,t.dom.toggleClass(c,"mce-active",a),a&&(u=c);return u.parentNode},d=!1===function(t){return t.getParam("table_grid",!0,"boolean")}(t)?{text:"Table",icon:"table",context:"table",onclick:g("mceInsertTable")}:{text:"Table",icon:"table",context:"table",ariaHideMenu:!0,onclick:function(e){e.aria&&(this.parent().hideAll(),e.stopImmediatePropagation(),t.execCommand("mceInsertTable"))},onshow:function(){s(t,0,0,this.menu.items()[0])},onhide:function(){var e=this.menu.items()[0].getEl().getElementsByTagName("a");t.dom.removeClass(e,"mce-active"),t.dom.addClass(e[0],"mce-active")},menu:[{type:"container",html:function(){var t="";t='<table role="grid" class="mce-grid mce-grid-border" aria-readonly="true">';for(var e=0;e<10;e++){t+="<tr>";for(var n=0;n<10;n++)t+='<td role="gridcell" tabindex="-1"><a id="mcegrid'+(10*e+n)+'" href="#" data-mce-x="'+n+'" data-mce-y="'+e+'"></a></td>';t+="</tr>"}return t+="</table>",t+='<div class="mce-text-center" role="presentation">1 x 1</div>'}(),onPostRender:function(){this.lastX=this.lastY=0},onmousemove:function(e){var n,r,o=e.target;"A"===o.tagName.toUpperCase()&&(n=parseInt(o.getAttribute("data-mce-x"),10),r=parseInt(o.getAttribute("data-mce-y"),10),(this.isRtl()||"tl-tr"===this.parent().rel)&&(n=9-n),n===this.lastX&&r===this.lastY||(s(t,n,r,e.control),this.lastX=n,this.lastY=r))},onclick:function(e){var n=this;"A"===e.target.tagName.toUpperCase()&&(e.preventDefault(),e.stopPropagation(),n.parent().cancel(),t.undoManager.transact((function(){jc(t,n.lastX+1,n.lastY+1)})),t.addVisual())}}]};function g(e){return function(){t.execCommand(e)}}var h={text:"Table properties",context:"table",onPostRender:l,onclick:g("mceTableProps")},p={text:"Delete table",context:"table",onPostRender:l,cmd:"mceTableDelete"},v={text:"Row",context:"table",menu:[{text:"Insert row before",onclick:g("mceTableInsertRowBefore"),onPostRender:f},{text:"Insert row after",onclick:g("mceTableInsertRowAfter"),onPostRender:f},{text:"Delete row",onclick:g("mceTableDeleteRow"),onPostRender:f},{text:"Row properties",onclick:g("mceTableRowProps"),onPostRender:f},{text:"-"},{text:"Cut row",onclick:g("mceTableCutRow"),onPostRender:f},{text:"Copy row",onclick:g("mceTableCopyRow"),onPostRender:f},{text:"Paste row before",onclick:g("mceTablePasteRowBefore"),onPostRender:f},{text:"Paste row after",onclick:g("mceTablePasteRowAfter"),onPostRender:f}]},b={text:"Column",context:"table",menu:[{text:"Insert column before",onclick:g("mceTableInsertColBefore"),onPostRender:f},{text:"Insert column after",onclick:g("mceTableInsertColAfter"),onPostRender:f},{text:"Delete column",onclick:g("mceTableDeleteCol"),onPostRender:f}]},w={separator:"before",text:"Cell",context:"table",menu:[{text:"Cell properties",onclick:g("mceTableCellProps"),onPostRender:f},{text:"Merge cells",onclick:g("mceTableMergeCells"),onPostRender:function(){var t=this;i.push(t),n.fold((function(){c(t)}),(function(e){t.disabled(e.mergable().isNone())}))}},{text:"Split cell",onclick:g("mceTableSplitCells"),onPostRender:function(){var t=this;u.push(t),n.fold((function(){c(t)}),(function(e){t.disabled(e.unmergable().isNone())}))}}]};t.addMenuItem("inserttable",d),t.addMenuItem("tableprops",h),t.addMenuItem("deletetable",p),t.addMenuItem("row",v),t.addMenuItem("column",b),t.addMenuItem("cell",w)},_f=function(t,e){return{insertTable:function(e,n){return jc(t,e,n)},setClipboardRows:function(t){return function(t,e){var n=T(t,vt.fromDom);e.set(m.from(n))}(t,e)},getClipboardRows:function(){return function(t){return t.get().fold((function(){}),(function(t){return T(t,(function(t){return t.dom()}))}))}(e)}}};e.add("table",(function(t){var e=ya(t),n=Pf(t,e.lazyResize),r=xc(t,e.lazyWire),o=function(t){return{get:function(){var e=Xu(t);return br(e,Or.selectedSelector()).fold((function(){return void 0===t.selection.getStart()?kr.none():kr.single(t.selection)}),(function(t){return kr.multiple(t)}))}}}(t),i=bu(m.none());return Gc(t,r,n,o,i),Lr(t,o,r,n),Mf(t,o),Bf(t),Wf(t),t.on("PreInit",(function(){t.serializer.addTempAttr(Or.firstSelected()),t.serializer.addTempAttr(Or.lastSelected())})),function(t){return t.getParam("table_tab_navigation",!0,"boolean")}(t)&&t.on("keydown",(function(n){gl(n,t,r,e.lazyWire)})),t.on("remove",(function(){e.destroy(),n.destroy()})),_f(t,i)}))}(window);
