!function(){!function(){"use strict";function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(e.length!==t.length)throw new Error('Wrong number of arguments to struct. Expected "['+e.length+']", got '+t.length+" arguments");var r={};return Ae.each(e,function(e,n){r[e]=F.constant(t[n])}),r}}function t(e,t){var n=e.concat(t);if(0===n.length)throw new Error("You must specify at least one required or optional field.");return _e.validateStrArr("required",e),_e.validateStrArr("optional",t),_e.checkDupes(n),function(r){var o=Me.keys(r);Ae.forall(e,function(e){return Ae.contains(o,e)})||_e.reqMessage(e,o);var i=Ae.filter(o,function(e){return!Ae.contains(n,e)});i.length>0&&_e.unsuppMessage(i);var u={};return Ae.each(e,function(e){u[e]=F.constant(r[e])}),Ae.each(t,function(e){u[e]=F.constant(Object.prototype.hasOwnProperty.call(r,e)?V.some(r[e]):V.none())}),u}}function n(e,t,n){var r=e.isiOS()&&!0===/ipad/i.test(n),o=e.isiOS()&&!r,i=e.isAndroid()&&3===e.version.major,u=e.isAndroid()&&4===e.version.major,a=r||i||u&&!0===/mobile/i.test(n),c=e.isiOS()||e.isAndroid(),l=c&&!a,s=t.isSafari()&&e.isiOS()&&!1===/safari/i.test(n);return{isiPad:F.constant(r),isiPhone:F.constant(o),isTablet:F.constant(a),isPhone:F.constant(l),isTouch:F.constant(c),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:F.constant(s)}}function r(e,t,n,r,o){return e(n,r)?V.some(n):X.isFunction(o)&&o(n)?V.none():t(n,r,o)}function o(){var e=function(e){return st.fromDom(e.dom().cloneNode(!1))},t=function(e){return!!Cr.isElement(e)&&("body"===Cr.name(e)||Ae.contains(iu,Cr.name(e)))},n=function(e){return!!Cr.isElement(e)&&Ae.contains(["br","img","hr","input"],Cr.name(e))},r=function(e,t){return e.dom().compareDocumentPosition(t.dom())},o=function(e,t){var n=Pr.clone(e);Pr.setAll(t,n)};return{up:F.constant({selector:lo.ancestor,closest:lo.closest,predicate:no.ancestor,all:sr.parents}),down:F.constant({selector:Kr.descendants,predicate:_r.descendants}),styles:F.constant({get:Zo.get,getRaw:Zo.getRaw,set:Zo.set,remove:Zo.remove}),attrs:F.constant({get:Pr.get,set:Pr.set,remove:Pr.remove,copyTo:o}),insert:F.constant({before:ui.before,after:ui.after,afterAll:fi.after,append:ui.append,appendAll:fi.append,prepend:ui.prepend,wrap:ui.wrap}),remove:F.constant({unwrap:pi.unwrap,remove:pi.remove}),create:F.constant({nu:st.fromTag,clone:e,text:st.fromText}),query:F.constant({comparePosition:r,prevSibling:sr.prevSibling,nextSibling:sr.nextSibling}),property:F.constant({children:sr.children,name:Cr.name,parent:sr.parent,isText:Cr.isText,isComment:Cr.isComment,isElement:Cr.isElement,getText:Ii.get,setText:Ii.set,isBoundary:t,isEmptyTag:n}),eq:_n.eq,is:_n.is}}function i(e,t){var n=function(t,n){if(!X.isNumber(n)&&!n.match(/^[0-9]+$/))throw e+".set accepts only positive integer values. Value was "+n;var r=t.dom();Mo.isSupported(r)&&(r.style[e]=n+"px")},r=function(n){var r=t(n);if(r<=0||null===r){var o=Zo.get(n,e);return parseFloat(o)||0}return r},o=r,i=function(e,t){return Ae.foldl(t,function(t,n){var r=Zo.get(e,n),o=void 0===r?0:parseInt(r,10);return isNaN(o)?t:t+o},0)};return{set:n,get:r,getOuter:o,aggregate:i,max:function(e,t,n){var r=i(e,n);return t>r?t-r:0}}}function u(e){var t=function(t){return e(t).isRtl()?$c.rtl:$c.ltr},n=function(e,n){return t(n).delta(e,n)},r=function(e,n){return t(n).positions(e,n)};return{delta:n,edge:function(e){return t(e).edge(e)},positions:r}}function a(e,t,n){var r=n||!1,o=function(){t(),r=!0},i=function(){e(),r=!1};return{on:o,off:i,toggle:function(){(r?i:o)()},isOn:function(){return r}}}function c(e,t,n,r){function o(e,t,n){n&&u.setAttrib(e,t,n)}function i(e,t,n){n&&u.setStyle(e,t,n)}var u=e.dom;fg.updateStyleField(e,r);var a=r.control.rootControl.toJSON();e.undoManager.transact(function(){eg.each(t,function(t){o(t,"scope",a.scope),o(t,"style",a.style),o(t,"class",a.class),i(t,"height",ym.addSizeSuffix(a.height)),a.type!==t.parentNode.nodeName.toLowerCase()&&bg(e.dom,t,a.type),a.align!==n.align&&(ug.unApplyAlign(e,t),ug.applyAlign(e,t,a.align))}),e.focus()})}function l(e,t,n,r){if("TD"===t.tagName||"TH"===t.tagName)e.setStyle(t,n,r);else if(t.children)for(var o=0;o<t.children.length;o++)l(e,t.children[o],n,r)}function s(e){var t=Ue.immutable.apply(null,e),n=[];return{bind:function(e){if(void 0===e)throw"Event bind error: undefined handler";n.push(e)},unbind:function(e){n=Ae.filter(n,function(t){return t!==e})},trigger:function(){var e=t.apply(null,arguments);Ae.each(n,function(t){t(e)})}}}function f(e){var t=Fl.merge({layerClass:op.resolve("blocker")},e),n=st.fromTag("div");return Pr.set(n,"role","presentation"),Zo.setAll(n,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),Hs.add(n,op.resolve("blocker")),Hs.add(n,t.layerClass),{element:function(){return n},destroy:function(){pi.remove(n)}}}function d(){var e=V.none(),t=function(){e=V.none()},n=function(t,n){var r=e.map(function(e){return t.compare(e,n)});return e=V.some(n),r},r=function(e,t){t.extract(e).each(function(e){n(t,e).each(function(e){o.trigger.move(e)})})},o=Qg.create({move:s(["info"])});return{onEvent:r,reset:t,events:o.registry}}function m(e){return{onEvent:function(e,t){},reset:F.noop}}function g(){var e=m(),t=d(),n=e,r=function(){n.reset(),n=t},o=function(){n.reset(),n=e},i=function(e,t){n.onEvent(e,t)};return{on:r,off:o,isOn:function(){return n===t},onEvent:i,events:t.events}}function p(){var e=Qg.create({drag:s(["xDelta","yDelta"])});return{mutate:function(t,n){e.trigger.drag(t,n)},events:e.registry}}function h(){var e=Qg.create({drag:s(["xDelta","yDelta","target"])}),t=V.none(),n=p();return n.events.drag.bind(function(n){t.each(function(t){e.trigger.drag(n.xDelta(),n.yDelta(),t)})}),{assign:function(e){t=V.some(e)},get:function(){return t},mutate:n.mutate,events:e.registry}}function v(e,t,n){var r=h(),o=Ep.transform(r,{}),i=V.none(),u=function(e,t){return V.from(Pr.get(e,t))};r.events.drag.bind(function(e){u(e.target(),"data-row").each(function(t){var n=ld.getInt(e.target(),"top");Zo.set(e.target(),"top",n+e.yDelta()+"px")}),u(e.target(),"data-column").each(function(t){var n=ld.getInt(e.target(),"left");Zo.set(e.target(),"left",n+e.xDelta()+"px")})});var a=function(e,t){return ld.getInt(e,t)-parseInt(Pr.get(e,"data-initial-"+t),10)};o.events.stop.bind(function(){r.get().each(function(r){i.each(function(o){u(r,"data-row").each(function(e){var t=a(r,"top");Pr.remove(r,"data-initial-top"),p.trigger.adjustHeight(o,t,parseInt(e,10))}),u(r,"data-column").each(function(e){var t=a(r,"left");Pr.remove(r,"data-initial-left"),p.trigger.adjustWidth(o,t,parseInt(e,10))}),nf.refresh(e,o,n,t)})})});var c=function(t,n){p.trigger.startAdjust(),r.assign(t),Pr.set(t,"data-initial-"+n,parseInt(Zo.get(t,n),10)),Hs.add(t,Mp),Zo.set(t,"opacity","0.2"),o.go(e.parent())},l=pp.bind(e.parent(),"mousedown",function(e){nf.isRowBar(e.target())&&c(e.target(),"top"),nf.isColBar(e.target())&&c(e.target(),"left")}),f=function(t){return _n.eq(t,e.view())},d=pp.bind(e.view(),"mouseover",function(r){"table"===Cr.name(r.target())||Wp.closest(r.target(),"table",f)?(i="table"===Cr.name(r.target())?V.some(r.target()):lo.ancestor(r.target(),"table",f),i.each(function(r){nf.refresh(e,r,n,t)})):Lr.inBody(r.target())&&nf.destroy(e)}),m=function(){l.unbind(),d.unbind(),o.destroy(),nf.destroy(e)},g=function(r){nf.refresh(e,r,n,t)},p=Qg.create({adjustHeight:s(["table","delta","row"]),adjustWidth:s(["table","delta","column"]),startAdjust:s([])});return{destroy:m,refresh:g,on:o.on,off:o.off,hideBars:F.curry(nf.hide,e),showBars:F.curry(nf.show,e),events:p.registry}}function b(e,t){var n=Kc.height,r=v(e,t,n),o=Qg.create({beforeResize:s(["table"]),afterResize:s(["table"]),startDrag:s([])});return r.events.adjustHeight.bind(function(e){o.trigger.beforeResize(e.table());var t=n.delta(e.delta(),e.table());Fd.adjustHeight(e.table(),t,e.row(),n),o.trigger.afterResize(e.table())}),r.events.startAdjust.bind(function(e){o.trigger.startDrag()}),r.events.adjustWidth.bind(function(e){o.trigger.beforeResize(e.table());var n=t.delta(e.delta(),e.table());Fd.adjustWidth(e.table(),n,e.column(),t),o.trigger.afterResize(e.table())}),{on:r.on,off:r.off,hideBars:r.hideBars,showBars:r.showBars,destroy:r.destroy,events:o.registry}}function w(e){var t=function(t,n){return V.from(e.document.elementFromPoint(t,n)).map(st.fromDom)},n=function(e){return e.dom().getBoundingClientRect()},r=function(t,n,r,o){var i=ah.exact(t,n,r,o);return Mv.getFirstRect(e,i).map(function(e){return Me.map(e,F.apply)})},o=function(){return Mv.get(e).map(function(t){return tb.convertToRange(e,t)})},i=function(t){var n=ah.relative(t.start(),t.finish());return tb.convertToRange(e,n)},u=function(t,n){return Mv.getAtPoint(e,t,n).map(function(e){return{start:F.constant(th.on(e.start(),e.soffset())),finish:F.constant(th.on(e.finish(),e.foffset()))}})},a=function(){Mv.clear(e)},c=function(t){Mv.setToElement(e,t)};return{elementFromPoint:t,getRect:n,getRangedRect:r,getSelection:o,fromSitus:i,situsFromPoint:u,clearSelection:a,setSelection:function(t){Mv.setExact(e,t.start(),t.soffset(),t.finish(),t.foffset())},setRelativeSelection:function(t,n){Mv.setRelative(e,t,n)},selectContents:c,getInnerHeight:function(){return e.innerHeight},getScrollY:function(){return db.get(st.fromDom(e.document)).top()},scrollBy:function(t,n){db.by(t,n,st.fromDom(e.document))}}}function y(e,t,n,r){var o=V.none(),i=function(){o=V.none()};return{mousedown:function(e){r.clear(t),o=Cy(e.target(),n)},mouseover:function(i){o.each(function(o){r.clear(t),Cy(i.target(),n).each(function(i){la.identify(o,i,n).each(function(n){var u=n.boxes().getOr([]);(u.length>1||1===u.length&&!_n.eq(o,i))&&(r.selectRange(t,u,n.start(),n.finish()),e.selectContents(i))})})})},mouseup:function(){o.each(i)}}}function x(e,t){var n=Ue.immutableBag(["mousedown","mouseover","mouseup","keyup","keydown"],[]),r=V.none(),o=_y.byAttr(ga);e.on("init",function(i){var u=e.getWin(),a=ym.getBody(e),c=ym.getIsRoot(e),l=function(){var t=e.selection,n=st.fromDom(t.getStart()),r=st.fromDom(t.getEnd()),i=Ro.table(n),u=Ro.table(r);i.bind(function(e){return u.bind(function(t){return _n.eq(e,t)?V.some(!0):V.none()})}).fold(function(){o.clear(a)},F.noop)},s=Dy.mouse(u,a,c,o),f=Dy.keyboard(u,a,c,o),d=function(e){return!0===e.raw().shiftKey},m=function(t,n){d(t)&&(n.kill()&&t.kill(),n.selection().each(function(t){var n=ah.relative(t.start(),t.finish()),r=Mh.asLtrRange(u,n);e.selection.setRng(r)}))},g=function(t){var n=v(t);if(n.raw().shiftKey&&Qv.isNavigation(n.raw().which)){var r=e.selection.getRng(),o=st.fromDom(r.startContainer),i=st.fromDom(r.endContainer);f.keyup(n,o,r.startOffset,i,r.endOffset).each(function(e){m(n,e)})}},p=function(n){var r=v(n);t().each(function(e){e.hideBars()});var o=e.selection.getRng(),i=st.fromDom(e.selection.getStart()),u=st.fromDom(o.startContainer),a=st.fromDom(o.endContainer),c=Dm.directionAt(i).isRtl()?Qv.rtl:Qv.ltr;f.keydown(r,u,o.startOffset,a,o.endOffset,c).each(function(e){m(r,e)}),t().each(function(e){e.showBars()})},h=function(e){return e.hasOwnProperty("x")&&e.hasOwnProperty("y")},v=function(e){var t=st.fromDom(e.target),n=function(){e.stopPropagation()},r=function(){e.preventDefault()},o=F.compose(r,n);return{target:F.constant(t),x:F.constant(h(e)?e.x:null),y:F.constant(h(e)?e.y:null),stop:n,prevent:r,kill:o,raw:F.constant(e)}},b=function(e){return 0===e.button},w=function(e){return void 0===e.buttons||0!=(1&e.buttons)},y=function(e){b(e)&&s.mousedown(v(e))},x=function(e){w(e)&&s.mouseover(v(e))},C=function(e){b(e)&&s.mouseup(v(e))};e.on("mousedown",y),e.on("mouseover",x),e.on("mouseup",C),e.on("keyup",g),e.on("keydown",p),e.on("nodechange",l),r=V.some(n({mousedown:y,mouseover:x,mouseup:C,keyup:g,keydown:p}))});var i=function(){r.each(function(e){})};return{clear:o.clear,destroy:i}}function C(e){var t=Hp(e),n=x(e,t.lazyResize),r=Jm(e,t.lazyWire),o=Uy(e),i=Zc(V.none());return Gg.registerCommands(e,r,n,o,i),Pa.registerEvents(e,o,r,n),$y.addMenuItems(e,o),Xy.addButtons(e),Xy.addToolbars(e),e.on("PreInit",function(){e.serializer.addTempAttr(ga.firstSelected()),e.serializer.addTempAttr(ga.lastSelected())}),Im(e)&&e.on("keydown",function(n){Vv.handle(n,e,r,t.lazyWire)}),e.on("remove",function(){t.destroy(),n.destroy()}),Zy(e,i)}function S(){}var R=tinymce.util.Tools.resolve("tinymce.PluginManager"),T=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},A=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e()}},D=function(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return e(t.apply(null,arguments))}},E=function(e){return function(){return e}},k=function(e){return e},O=function(e,t){return e===t},N=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=new Array(arguments.length-1),o=1;o<arguments.length;o++)r[o-1]=arguments[o];return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var o=new Array(arguments.length),i=0;i<o.length;i++)o[i]=arguments[i];var u=r.concat(o);return e.apply(null,u)}},B=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return!e.apply(null,arguments)}},P=function(e){return function(){throw new Error(e)}},I=function(e){return e()},W=function(e){e()},M=E(!1),L=E(!0),F={noop:T,noarg:A,compose:D,constant:E,identity:k,tripleEquals:O,curry:N,not:B,die:P,apply:I,call:W,never:M,always:L},q=F.never,z=F.always,H=function(){return j},j=function(){var e=function(e){return e.isNone()},t=function(e){return e()},n=function(e){return e},r=function(){},o={fold:function(e,t){return e()},is:q,isSome:q,isNone:z,getOr:n,getOrThunk:t,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},or:n,orThunk:t,map:H,ap:H,each:r,bind:H,flatten:H,exists:q,forall:z,filter:H,equals:e,equals_:e,toArray:function(){return[]},toString:F.constant("none()")};return Object.freeze&&Object.freeze(o),o}(),_=function(e){var t=function(){return e},n=function(){return i},r=function(t){return _(t(e))},o=function(t){return t(e)},i={fold:function(t,n){return n(e)},is:function(t){return e===t},isSome:z,isNone:q,getOr:t,getOrThunk:t,getOrDie:t,or:n,orThunk:n,map:r,ap:function(t){return t.fold(H,function(t){return _(t(e))})},each:function(t){t(e)},bind:o,flatten:t,exists:o,forall:o,filter:function(t){return t(e)?i:j},equals:function(t){return t.is(e)},equals_:function(t,n){return t.fold(q,function(t){return n(e,t)})},toArray:function(){return[e]},toString:function(){return"some("+e+")"}};return i},U=function(e){return null===e||void 0===e?j:_(e)},V={some:_,none:H,from:U},G=function(e){if(null===e)return"null";var t=typeof e;return"object"===t&&Array.prototype.isPrototypeOf(e)?"array":"object"===t&&String.prototype.isPrototypeOf(e)?"string":t},Y=function(e){return function(t){return G(t)===e}},X={isString:Y("string"),isObject:Y("object"),isArray:Y("array"),isNull:Y("null"),isBoolean:Y("boolean"),isUndefined:Y("undefined"),isFunction:Y("function"),isNumber:Y("number")},K=function(){var e=Array.prototype.indexOf,t=function(t,n){return e.call(t,n)},n=function(e,t){return fe(e,t)};return void 0===e?n:t}(),$=function(e,t){var n=K(e,t);return-1===n?V.none():V.some(n)},J=function(e,t){return K(e,t)>-1},Q=function(e,t){return se(e,t).isSome()},Z=function(e,t){for(var n=[],r=0;r<e;r++)n.push(t(r));return n},ee=function(e,t){for(var n=[],r=0;r<e.length;r+=t){var o=e.slice(r,r+t);n.push(o)}return n},te=function(e,t){for(var n=e.length,r=new Array(n),o=0;o<n;o++){var i=e[o];r[o]=t(i,o,e)}return r},ne=function(e,t){for(var n=0,r=e.length;n<r;n++){t(e[n],n,e)}},re=function(e,t){for(var n=e.length-1;n>=0;n--){t(e[n],n,e)}},oe=function(e,t){for(var n=[],r=[],o=0,i=e.length;o<i;o++){var u=e[o];(t(u,o,e)?n:r).push(u)}return{pass:n,fail:r}},ie=function(e,t){for(var n=[],r=0,o=e.length;r<o;r++){var i=e[r];t(i,r,e)&&n.push(i)}return n},ue=function(e,t){if(0===e.length)return[];for(var n=t(e[0]),r=[],o=[],i=0,u=e.length;i<u;i++){var a=e[i],c=t(a);c!==n&&(r.push(o),o=[]),n=c,o.push(a)}return 0!==o.length&&r.push(o),r},ae=function(e,t,n){return re(e,function(e){n=t(n,e)}),n},ce=function(e,t,n){return ne(e,function(e){n=t(n,e)}),n},le=function(e,t){for(var n=0,r=e.length;n<r;n++){var o=e[n];if(t(o,n,e))return V.some(o)}return V.none()},se=function(e,t){for(var n=0,r=e.length;n<r;n++){if(t(e[n],n,e))return V.some(n)}return V.none()},fe=function(e,t){for(var n=0,r=e.length;n<r;++n)if(e[n]===t)return n;return-1},de=Array.prototype.push,me=function(e){for(var t=[],n=0,r=e.length;n<r;++n){if(!Array.prototype.isPrototypeOf(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);de.apply(t,e[n])}return t},ge=function(e,t){var n=te(e,t);return me(n)},pe=function(e,t){for(var n=0,r=e.length;n<r;++n){if(!0!==t(e[n],n,e))return!1}return!0},he=function(e,t){return e.length===t.length&&pe(e,function(e,n){return e===t[n]})},ve=Array.prototype.slice,be=function(e){var t=ve.call(e,0);return t.reverse(),t},we=function(e,t){return ie(e,function(e){return!J(t,e)})},ye=function(e,t){for(var n={},r=0,o=e.length;r<o;r++){var i=e[r];n[String(i)]=t(i,r)}return n},xe=function(e){return[e]},Ce=function(e,t){var n=ve.call(e,0);return n.sort(t),n},Se=function(e){return 0===e.length?V.none():V.some(e[0])},Re=function(e){return 0===e.length?V.none():V.some(e[e.length-1])},Te=X.isFunction(Array.from)?Array.from:function(e){return ve.call(e)},Ae={map:te,each:ne,eachr:re,partition:oe,filter:ie,groupBy:ue,indexOf:$,foldr:ae,foldl:ce,find:le,findIndex:se,flatten:me,bind:ge,forall:pe,exists:Q,contains:J,equal:he,reverse:be,chunk:ee,difference:we,mapToObject:ye,pure:xe,sort:Ce,range:Z,head:Se,last:Re,from:Te},De=function(){var e=Object.keys,t=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t};return void 0===e?t:e}(),Ee=function(e,t){for(var n=De(e),r=0,o=n.length;r<o;r++){var i=n[r];t(e[i],i,e)}},ke=function(e,t){return Oe(e,function(e,n,r){return{k:n,v:t(e,n,r)}})},Oe=function(e,t){var n={};return Ee(e,function(r,o){var i=t(r,o,e);n[i.k]=i.v}),n},Ne=function(e,t){var n={},r={};return Ee(e,function(e,o){(t(e,o)?n:r)[o]=e}),{t:n,f:r}},Be=function(e,t){var n=[];return Ee(e,function(e,r){n.push(t(e,r))}),n},Pe=function(e,t){for(var n=De(e),r=0,o=n.length;r<o;r++){var i=n[r],u=e[i];if(t(u,i,e))return V.some(u)}return V.none()},Ie=function(e){return Be(e,function(e){return e})},We=function(e){return Ie(e).length},Me={bifilter:Ne,each:Ee,map:ke,mapToArray:Be,tupleMap:Oe,find:Pe,keys:De,values:Ie,size:We},Le=function(e){return e.slice(0).sort()},Fe=function(e,t){throw new Error("All required keys ("+Le(e).join(", ")+") were not specified. Specified keys were: "+Le(t).join(", ")+".")},qe=function(e){throw new Error("Unsupported keys for object: "+Le(e).join(", "))},ze=function(e,t){if(!X.isArray(t))throw new Error("The "+e+" fields must be an array. Was: "+t+".");Ae.each(t,function(t){if(!X.isString(t))throw new Error("The value "+t+" in the "+e+" fields was not a string.")})},He=function(e,t){throw new Error("All values need to be of type: "+t+". Keys ("+Le(e).join(", ")+") were not.")},je=function(e){var t=Le(e);Ae.find(t,function(e,n){return n<t.length-1&&e===t[n+1]}).each(function(e){throw new Error("The field: "+e+" occurs more than once in the combined fields: ["+t.join(", ")+"].")})},_e={sort:Le,reqMessage:Fe,unsuppMessage:qe,validateStrArr:ze,invalidTypeMessage:He,checkDupes:je},Ue={immutable:e,immutableBag:t},Ve=Ue.immutable("width","height"),Ge=Ue.immutable("rows","columns"),Ye=Ue.immutable("row","column"),Xe=Ue.immutable("x","y"),Ke=Ue.immutable("element","rowspan","colspan"),$e=Ue.immutable("element","rowspan","colspan","isNew"),Je=Ue.immutable("element","rowspan","colspan","row","column"),Qe=Ue.immutable("element","cells","section"),Ze=Ue.immutable("element","isNew"),et=Ue.immutable("element","cells","section","isNew"),tt=Ue.immutable("cells","section"),nt=Ue.immutable("details","section"),rt=Ue.immutable("startRow","startCol","finishRow","finishCol"),ot={dimensions:Ve,grid:Ge,address:Ye,coords:Xe,extended:Je,detail:Ke,detailnew:$e,rowdata:Qe,elementnew:Ze,rowdatanew:et,rowcells:tt,rowdetails:nt,bounds:rt},it=function(e,t){var n=t||document,r=n.createElement("div");if(r.innerHTML=e,!r.hasChildNodes()||r.childNodes.length>1)throw console.error("HTML does not have a single root node",e),"HTML must have a single root node";return ct(r.childNodes[0])},ut=function(e,t){var n=t||document,r=n.createElement(e);return ct(r)},at=function(e,t){var n=t||document,r=n.createTextNode(e);return ct(r)},ct=function(e){if(null===e||void 0===e)throw new Error("Node cannot be null or undefined");return{dom:F.constant(e)}},lt=function(e,t,n){return V.from(e.dom().elementFromPoint(t,n)).map(ct)},st={fromHtml:it,fromTag:ut,fromText:at,fromDom:ct,fromPoint:lt},ft={ATTRIBUTE:2,CDATA_SECTION:4,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,ELEMENT:1,TEXT:3,PROCESSING_INSTRUCTION:7,ENTITY_REFERENCE:5,ENTITY:6,NOTATION:12},dt=ft.ELEMENT,mt=ft.DOCUMENT,gt=function(e,t){var n=e.dom();if(n.nodeType!==dt)return!1;if(void 0!==n.matches)return n.matches(t);if(void 0!==n.msMatchesSelector)return n.msMatchesSelector(t);if(void 0!==n.webkitMatchesSelector)return n.webkitMatchesSelector(t);if(void 0!==n.mozMatchesSelector)return n.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},pt=function(e){return e.nodeType!==dt&&e.nodeType!==mt||0===e.childElementCount},ht=function(e,t){var n=void 0===t?document:t.dom();return pt(n)?[]:Ae.map(n.querySelectorAll(e),st.fromDom)},vt=function(e,t){var n=void 0===t?document:t.dom();return pt(n)?V.none():V.from(n.querySelector(e)).map(st.fromDom)},bt={all:ht,is:gt,one:vt},wt=function(e,t){var n=[],r=function(e){return n.push(e),t(e)},o=t(e);do{o=o.bind(r)}while(o.isSome());return n},yt={toArray:wt},xt="undefined"!=typeof window?window:Function("return this;")(),Ct=function(e,t){for(var n=void 0!==t&&null!==t?t:xt,r=0;r<e.length&&void 0!==n&&null!==n;++r)n=n[e[r]];return n},St=function(e,t){var n=e.split(".");return Ct(n,t)},Rt=function(e,t){return void 0!==e[t]&&null!==e[t]||(e[t]={}),e[t]},Tt=function(e,t){for(var n=void 0!==t?t:xt,r=0;r<e.length;++r)n=Rt(n,e[r]);return n},At=function(e,t){var n=e.split(".");return Tt(n,t)},Dt={path:Ct,resolve:St,forge:Tt,namespace:At},Et=function(e,t){return Dt.resolve(e,t)},kt=function(e,t){var n=Et(e,t);if(void 0===n||null===n)throw e+" not available on this browser";return n},Ot={getOrDie:kt},Nt=function(){return Ot.getOrDie("Node")},Bt=function(e,t,n){return 0!=(e.compareDocumentPosition(t)&n)},Pt=function(e,t){return Bt(e,t,Nt().DOCUMENT_POSITION_PRECEDING)},It=function(e,t){return Bt(e,t,Nt().DOCUMENT_POSITION_CONTAINED_BY)},Wt={documentPositionPreceding:Pt,documentPositionContainedBy:It},Mt=function(e){var t,n=!1;return function(){return n||(n=!0,t=e.apply(null,arguments)),t}},Lt={cached:Mt},Ft=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.test(t))return r}},qt=function(e,t){var n=Ft(e,t);if(!n)return{major:0,minor:0};var r=function(e){return Number(t.replace(n,"$"+e))};return jt(r(1),r(2))},zt=function(e,t){var n=String(t).toLowerCase();return 0===e.length?Ht():qt(e,n)},Ht=function(){return jt(0,0)},jt=function(e,t){return{major:e,minor:t}},_t={nu:jt,detect:zt,unknown:Ht},Ut=function(e,t){return function(){return t===e}},Vt=function(){return Gt({current:void 0,version:_t.unknown()})},Gt=function(e){var t=e.current;return{current:t,version:e.version,isEdge:Ut("Edge",t),isChrome:Ut("Chrome",t),isIE:Ut("IE",t),isOpera:Ut("Opera",t),isFirefox:Ut("Firefox",t),isSafari:Ut("Safari",t)}},Yt={unknown:Vt,nu:Gt,edge:F.constant("Edge"),chrome:F.constant("Chrome"),ie:F.constant("IE"),opera:F.constant("Opera"),firefox:F.constant("Firefox"),safari:F.constant("Safari")},Xt=function(e,t){return function(){return t===e}},Kt=function(){return $t({current:void 0,version:_t.unknown()})},$t=function(e){var t=e.current;return{current:t,version:e.version,isWindows:Xt("Windows",t),isiOS:Xt("iOS",t),isAndroid:Xt("Android",t),isOSX:Xt("OSX",t),isLinux:Xt("Linux",t),isSolaris:Xt("Solaris",t),isFreeBSD:Xt("FreeBSD",t)}},Jt={unknown:Kt,nu:$t,windows:F.constant("Windows"),ios:F.constant("iOS"),android:F.constant("Android"),linux:F.constant("Linux"),osx:F.constant("OSX"),solaris:F.constant("Solaris"),freebsd:F.constant("FreeBSD")},Qt=function(e,t){var n=String(t).toLowerCase();return Ae.find(e,function(e){return e.search(n)})},Zt=function(e,t){return Qt(e,t).map(function(e){var n=_t.detect(e.versionRegexes,t);return{current:e.name,version:n}})},en=function(e,t){return Qt(e,t).map(function(e){var n=_t.detect(e.versionRegexes,t);return{current:e.name,version:n}})},tn={detectBrowser:Zt,detectOs:en},nn=function(e,t){return t+e},rn=function(e,t){return e+t},on=function(e,t){return e.substring(t)},un=function(e,t){return e.substring(0,e.length-t)},an={addToStart:nn,addToEnd:rn,removeFromStart:on,removeFromEnd:un},cn=function(e,t){return e.substr(0,t)},ln=function(e,t){return e.substr(e.length-t,e.length)},sn=function(e){return""===e?V.none():V.some(e.substr(0,1))},fn=function(e){return""===e?V.none():V.some(e.substring(1))},dn={first:cn,last:ln,head:sn,tail:fn},mn=function(e,t,n){return""===t||!(e.length<t.length)&&e.substr(n,n+t.length)===t},gn=function(e,t){var n=function(e){var t=typeof e;return"string"===t||"number"===t};return e.replace(/\${([^{}]*)}/g,function(e,r){var o=t[r];return n(o)?o:e})},pn=function(e,t){return xn(e,t)?an.removeFromStart(e,t.length):e},hn=function(e,t){return Cn(e,t)?an.removeFromEnd(e,t.length):e},vn=function(e,t){return xn(e,t)?e:an.addToStart(e,t)},bn=function(e,t){return Cn(e,t)?e:an.addToEnd(e,t)},wn=function(e,t){return-1!==e.indexOf(t)},yn=function(e){return dn.head(e).bind(function(t){return dn.tail(e).map(function(e){return t.toUpperCase()+e})}).getOr(e)},xn=function(e,t){return mn(e,t,0)},Cn=function(e,t){return mn(e,t,e.length-t.length)},Sn=function(e){return e.replace(/^\s+|\s+$/g,"")},Rn=function(e){return e.replace(/^\s+/g,"")},Tn=function(e){return e.replace(/\s+$/g,"")},An={supplant:gn,startsWith:xn,removeLeading:pn,removeTrailing:hn,ensureLeading:vn,ensureTrailing:bn,endsWith:Cn,contains:wn,trim:Sn,lTrim:Rn,rTrim:Tn,capitalize:yn},Dn=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,En=function(e){return function(t){return An.contains(t,e)}},kn=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return An.contains(e,"edge/")&&An.contains(e,"chrome")&&An.contains(e,"safari")&&An.contains(e,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Dn],search:function(e){return An.contains(e,"chrome")&&!An.contains(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return An.contains(e,"msie")||An.contains(e,"trident")}},{name:"Opera",versionRegexes:[Dn,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:En("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:En("firefox")},{name:"Safari",versionRegexes:[Dn,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(An.contains(e,"safari")||An.contains(e,"mobile/"))&&An.contains(e,"applewebkit")}}],On=[{name:"Windows",search:En("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return An.contains(e,"iphone")||An.contains(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:En("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:En("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:En("linux"),versionRegexes:[]},{name:"Solaris",search:En("sunos"),versionRegexes:[]},{name:"FreeBSD",search:En("freebsd"),versionRegexes:[]}],Nn={browsers:F.constant(kn),oses:F.constant(On)},Bn=function(e){var t=Nn.browsers(),r=Nn.oses(),o=tn.detectBrowser(t,e).fold(Yt.unknown,Yt.nu),i=tn.detectOs(r,e).fold(Jt.unknown,Jt.nu);return{browser:o,os:i,deviceType:n(i,o,e)}},Pn={detect:Bn},In=Lt.cached(function(){var e=navigator.userAgent;return Pn.detect(e)}),Wn={detect:In},Mn=function(e,t){return e.dom()===t.dom()},Ln=function(e,t){return e.dom().isEqualNode(t.dom())},Fn=function(e,t){return Ae.exists(t,F.curry(Mn,e))},qn=function(e,t){var n=e.dom(),r=t.dom();return n!==r&&n.contains(r)},zn=function(e,t){return Wt.documentPositionContainedBy(e.dom(),t.dom())},Hn=Wn.detect().browser,jn=Hn.isIE()?zn:qn,_n={eq:Mn,isEqualNode:Ln,member:Fn,contains:jn,is:bt.is},Un=function(e){return st.fromDom(e.dom().ownerDocument)},Vn=function(e){var t=Un(e);return st.fromDom(t.dom().documentElement)},Gn=function(e){var t=e.dom(),n=t.ownerDocument.defaultView;return st.fromDom(n)},Yn=function(e){var t=e.dom();return V.from(t.parentNode).map(st.fromDom)},Xn=function(e){return Yn(e).bind(function(t){var n=nr(t);return Ae.findIndex(n,function(t){return _n.eq(e,t)})})},Kn=function(e,t){for(var n=X.isFunction(t)?t:F.constant(!1),r=e.dom(),o=[];null!==r.parentNode&&void 0!==r.parentNode;){var i=r.parentNode,u=st.fromDom(i);if(o.push(u),!0===n(u))break;r=i}return o},$n=function(e){var t=function(t){return Ae.filter(t,function(t){return!_n.eq(e,t)})};return Yn(e).map(nr).map(t).getOr([])},Jn=function(e){var t=e.dom();return V.from(t.offsetParent).map(st.fromDom)},Qn=function(e){var t=e.dom();return V.from(t.previousSibling).map(st.fromDom)},Zn=function(e){var t=e.dom();return V.from(t.nextSibling).map(st.fromDom)},er=function(e){return Ae.reverse(yt.toArray(e,Qn))},tr=function(e){return yt.toArray(e,Zn)},nr=function(e){var t=e.dom();return Ae.map(t.childNodes,st.fromDom)},rr=function(e,t){var n=e.dom().childNodes;return V.from(n[t]).map(st.fromDom)},or=function(e){return rr(e,0)},ir=function(e){return rr(e,e.dom().childNodes.length-1)},ur=function(e){return e.dom().childNodes.length},ar=function(e){return e.dom().hasChildNodes()},cr=Ue.immutable("element","offset"),lr=function(e,t){var n=nr(e);return n.length>0&&t<n.length?cr(n[t],0):cr(e,t)},sr={owner:Un,defaultView:Gn,documentElement:Vn,parent:Yn,findIndex:Xn,parents:Kn,siblings:$n,prevSibling:Qn,offsetParent:Jn,prevSiblings:er,nextSibling:Zn,nextSiblings:tr,children:nr,child:rr,firstChild:or,lastChild:ir,childNodesCount:ur,hasChildNodes:ar,leaf:lr},fr=function(e,t){return dr(e,t,F.constant(!0))},dr=function(e,t,n){return Ae.bind(sr.children(e),function(e){return bt.is(e,t)?n(e)?[e]:[]:dr(e,t,n)})},mr={firstLayer:fr,filterFirstLayer:dr},gr=function(e){return e.dom().nodeName.toLowerCase()},pr=function(e){return e.dom().nodeType},hr=function(e){return e.dom().nodeValue},vr=function(e){return function(t){return pr(t)===e}},br=function(e){return pr(e)===ft.COMMENT||"#comment"===gr(e)},wr=vr(ft.ELEMENT),yr=vr(ft.TEXT),xr=vr(ft.DOCUMENT),Cr={name:gr,type:pr,value:hr,isElement:wr,isText:yr,isDocument:xr,isComment:br},Sr=function(e,t,n){if(!(X.isString(n)||X.isBoolean(n)||X.isNumber(n)))throw console.error("Invalid call to Attr.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")},Rr=function(e,t,n){Sr(e.dom(),t,n)},Tr=function(e,t){var n=e.dom();Me.each(t,function(e,t){Sr(n,t,e)})},Ar=function(e,t){var n=e.dom().getAttribute(t);return null===n?void 0:n},Dr=function(e,t){var n=e.dom();return!(!n||!n.hasAttribute)&&n.hasAttribute(t)},Er=function(e,t){e.dom().removeAttribute(t)},kr=function(e){var t=e.dom().attributes;return void 0===t||null===t||0===t.length},Or=function(e){return Ae.foldl(e.dom().attributes,function(e,t){return e[t.name]=t.value,e},{})},Nr=function(e,t,n){Dr(e,n)&&!Dr(t,n)&&Rr(t,n,Ar(e,n))},Br=function(e,t,n){Cr.isElement(e)&&Cr.isElement(t)&&Ae.each(n,function(n){Nr(e,t,n)})},Pr={clone:Or,set:Rr,setAll:Tr,get:Ar,has:Dr,remove:Er,hasNone:kr,transfer:Br},Ir=function(e){var t=Cr.isText(e)?e.dom().parentNode:e.dom();return void 0!==t&&null!==t&&t.ownerDocument.body.contains(t)},Wr=Lt.cached(function(){return Mr(st.fromDom(document))}),Mr=function(e){var t=e.dom().body
;if(null===t||void 0===t)throw"Body is not available yet";return st.fromDom(t)},Lr={body:Wr,getBody:Mr,inBody:Ir},Fr=function(e){return jr(Lr.body(),e)},qr=function(e,t,n){return Ae.filter(sr.parents(e,n),t)},zr=function(e,t){return Ae.filter(sr.siblings(e),t)},Hr=function(e,t){return Ae.filter(sr.children(e),t)},jr=function(e,t){var n=[];return Ae.each(sr.children(e),function(e){t(e)&&(n=n.concat([e])),n=n.concat(jr(e,t))}),n},_r={all:Fr,ancestors:qr,siblings:zr,children:Hr,descendants:jr},Ur=function(e){return bt.all(e)},Vr=function(e,t,n){return _r.ancestors(e,function(e){return bt.is(e,t)},n)},Gr=function(e,t){return _r.siblings(e,function(e){return bt.is(e,t)})},Yr=function(e,t){return _r.children(e,function(e){return bt.is(e,t)})},Xr=function(e,t){return bt.all(t,e)},Kr={all:Ur,ancestors:Vr,siblings:Gr,children:Yr,descendants:Xr},$r=function(e){return to(Lr.body(),e)},Jr=function(e,t,n){for(var r=e.dom(),o=X.isFunction(n)?n:F.constant(!1);r.parentNode;){r=r.parentNode;var i=st.fromDom(r);if(t(i))return V.some(i);if(o(i))break}return V.none()},Qr=function(e,t,n){return r(function(e){return t(e)},Jr,e,t,n)},Zr=function(e,t){var n=e.dom();return n.parentNode?eo(st.fromDom(n.parentNode),function(n){return!_n.eq(e,n)&&t(n)}):V.none()},eo=function(e,t){return Ae.find(e.dom().childNodes,F.compose(t,st.fromDom)).map(st.fromDom)},to=function(e,t){var n=function(e){for(var r=0;r<e.childNodes.length;r++){if(t(st.fromDom(e.childNodes[r])))return V.some(st.fromDom(e.childNodes[r]));var o=n(e.childNodes[r]);if(o.isSome())return o}return V.none()};return n(e.dom())},no={first:$r,ancestor:Jr,closest:Qr,sibling:Zr,child:eo,descendant:to},ro=function(e){return bt.one(e)},oo=function(e,t,n){return no.ancestor(e,function(e){return bt.is(e,t)},n)},io=function(e,t){return no.sibling(e,function(e){return bt.is(e,t)})},uo=function(e,t){return no.child(e,function(e){return bt.is(e,t)})},ao=function(e,t){return bt.one(t,e)},co=function(e,t,n){return r(bt.is,oo,e,t,n)},lo={first:ro,ancestor:oo,sibling:io,child:uo,descendant:ao,closest:co},so=function(e,t,n){var r=void 0!==n?n:F.constant(!1);if(r(t))return V.none();if(Ae.contains(e,Cr.name(t)))return V.some(t);var o=function(e){return bt.is(e,"table")||r(e)};return lo.ancestor(t,e.join(","),o)},fo=function(e,t){return so(["td","th"],e,t)},mo=function(e){return mr.firstLayer(e,"th,td")},go=function(e,t){return so(["caption","tr","tbody","tfoot","thead"],e,t)},po=function(e,t){return sr.parent(t).map(function(t){return Kr.children(t,e)})},ho=F.curry(po,"th,td"),vo=F.curry(po,"tr"),bo=function(e){return lo.descendant(e,"th,td")},wo=function(e,t){return lo.closest(e,"table",t)},yo=function(e,t){return so(["tr"],e,t)},xo=function(e){return mr.firstLayer(e,"tr")},Co=function(e,t){return parseInt(Pr.get(e,t),10)},So=function(e,t,n){var r=Co(e,t),o=Co(e,n);return ot.grid(r,o)},Ro={cell:fo,firstCell:bo,cells:mo,neighbourCells:ho,table:wo,row:yo,rows:xo,notCell:go,neighbourRows:vo,attr:Co,grid:So},To=function(e){var t=Ro.rows(e);return Ae.map(t,function(e){var t=e,n=sr.parent(t),r=n.bind(function(e){var t=Cr.name(e);return"tfoot"===t||"thead"===t||"tbody"===t?t:"tbody"}),o=Ae.map(Ro.cells(e),function(e){var t=Pr.has(e,"rowspan")?parseInt(Pr.get(e,"rowspan"),10):1,n=Pr.has(e,"colspan")?parseInt(Pr.get(e,"colspan"),10):1;return ot.detail(e,t,n)});return ot.rowdata(t,o,r)})},Ao=function(e,t){return Ae.map(e,function(e){var n=Ae.map(Ro.cells(e),function(e){var t=Pr.has(e,"rowspan")?parseInt(Pr.get(e,"rowspan"),10):1,n=Pr.has(e,"colspan")?parseInt(Pr.get(e,"colspan"),10):1;return ot.detail(e,t,n)});return ot.rowdata(e,n,t.section())})},Do={fromTable:To,fromPastedRows:Ao},Eo=function(e,t){return e+","+t},ko=function(e,t,n){var r=e.access()[Eo(t,n)];return void 0!==r?V.some(r):V.none()},Oo=function(e,t,n){var r=No(e,function(e){return n(t,e.element())});return r.length>0?V.some(r[0]):V.none()},No=function(e,t){var n=Ae.bind(e.all(),function(e){return e.cells()});return Ae.filter(n,t)},Bo=function(e){var t={},n=[],r=e.length,o=0;Ae.each(e,function(e,r){var i=[];Ae.each(e.cells(),function(e,n){for(var u=0;void 0!==t[Eo(r,u)];)u++;for(var a=ot.extended(e.element(),e.rowspan(),e.colspan(),r,u),c=0;c<e.colspan();c++)for(var l=0;l<e.rowspan();l++){var s=r+l,f=u+c,d=Eo(s,f);t[d]=a,o=Math.max(o,f+1)}i.push(a)}),n.push(ot.rowdata(e.element(),i,e.section()))});var i=ot.grid(r,o);return{grid:F.constant(i),access:F.constant(t),all:F.constant(n)}},Po=function(e){var t=Ae.map(e.all(),function(e){return e.cells()});return Ae.flatten(t)},Io={generate:Bo,getAt:ko,findItem:Oo,filterItems:No,justCells:Po},Wo=function(e){return void 0!==e.style},Mo={isSupported:Wo},Lo=function(e,t,n){if(!X.isString(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);Mo.isSupported(e)&&e.style.setProperty(t,n)},Fo=function(e,t){Mo.isSupported(e)&&e.style.removeProperty(t)},qo=function(e,t,n){var r=e.dom();Lo(r,t,n)},zo=function(e,t){var n=e.dom();Me.each(t,function(e,t){Lo(n,t,e)})},Ho=function(e,t){var n=e.dom();Me.each(t,function(e,t){e.fold(function(){Fo(n,t)},function(e){Lo(n,t,e)})})},jo=function(e,t){var n=e.dom(),r=window.getComputedStyle(n),o=r.getPropertyValue(t),i=""!==o||Lr.inBody(e)?o:_o(n,t);return null===i?void 0:i},_o=function(e,t){return Mo.isSupported(e)?e.style.getPropertyValue(t):""},Uo=function(e,t){var n=e.dom(),r=_o(n,t);return V.from(r).filter(function(e){return e.length>0})},Vo=function(e){var t={},n=e.dom();if(Mo.isSupported(n))for(var r=0;r<n.style.length;r++){var o=n.style.item(r);t[o]=n.style[o]}return t},Go=function(e,t,n){var r=st.fromTag(e);return qo(r,t,n),Uo(r,t).isSome()},Yo=function(e,t){var n=e.dom();Fo(n,t),Pr.has(e,"style")&&""===An.trim(Pr.get(e,"style"))&&Pr.remove(e,"style")},Xo=function(e,t){var n=Pr.get(e,"style"),r=t(e);return(void 0===n?Pr.remove:Pr.set)(e,"style",n),r},Ko=function(e,t){var n=e.dom(),r=t.dom();Mo.isSupported(n)&&Mo.isSupported(r)&&(r.style.cssText=n.style.cssText)},$o=function(e){return e.dom().offsetWidth},Jo=function(e,t,n){Uo(e,n).each(function(e){Uo(t,n).isNone()&&qo(t,n,e)})},Qo=function(e,t,n){Cr.isElement(e)&&Cr.isElement(t)&&Ae.each(n,function(n){Jo(e,t,n)})},Zo={copy:Ko,set:qo,preserve:Xo,setAll:zo,setOptions:Ho,remove:Yo,get:jo,getRaw:Uo,getAllRaw:Vo,isValidValue:Go,reflow:$o,transfer:Qo},ei=function(e,t){sr.parent(e).each(function(n){n.dom().insertBefore(t.dom(),e.dom())})},ti=function(e,t){sr.nextSibling(e).fold(function(){sr.parent(e).each(function(e){ri(e,t)})},function(e){ei(e,t)})},ni=function(e,t){sr.firstChild(e).fold(function(){ri(e,t)},function(n){e.dom().insertBefore(t.dom(),n.dom())})},ri=function(e,t){e.dom().appendChild(t.dom())},oi=function(e,t,n){sr.child(e,n).fold(function(){ri(e,t)},function(e){ei(e,t)})},ii=function(e,t){ei(e,t),ri(t,e)},ui={before:ei,after:ti,prepend:ni,append:ri,appendAt:oi,wrap:ii},ai=function(e,t){Ae.each(t,function(t){ui.before(e,t)})},ci=function(e,t){Ae.each(t,function(n,r){var o=0===r?e:t[r-1];ui.after(o,n)})},li=function(e,t){Ae.each(t.slice().reverse(),function(t){ui.prepend(e,t)})},si=function(e,t){Ae.each(t,function(t){ui.append(e,t)})},fi={before:ai,after:ci,prepend:li,append:si},di=function(e){e.dom().textContent="",Ae.each(sr.children(e),function(e){mi(e)})},mi=function(e){var t=e.dom();null!==t.parentNode&&t.parentNode.removeChild(t)},gi=function(e){var t=sr.children(e);t.length>0&&fi.before(e,t),mi(e)},pi={empty:di,remove:mi,unwrap:gi},hi=Ue.immutable("minRow","minCol","maxRow","maxCol"),vi=function(e,t){var n=e.grid().columns(),r=e.grid().rows(),o=r,i=n,u=0,a=0;return Me.each(e.access(),function(e){if(t(e)){var n=e.row(),r=n+e.rowspan()-1,c=e.column(),l=c+e.colspan()-1;n<o?o=n:r>u&&(u=r),c<i?i=c:l>a&&(a=l)}}),hi(o,i,u,a)},bi=function(e,t,n){var r=e[n].element(),o=st.fromTag("td");ui.append(o,st.fromTag("br")),(t?ui.append:ui.prepend)(r,o)},wi=function(e,t,n,r){for(var o=t.grid().columns(),i=t.grid().rows(),u=0;u<i;u++)for(var a=!1,c=0;c<o;c++)if(!(u<n.minRow()||u>n.maxRow()||c<n.minCol()||c>n.maxCol())){var l=Io.getAt(t,u,c).filter(r).isNone();l?bi(e,a,u):a=!0}},yi=function(e,t){var n=Ae.filter(mr.firstLayer(e,"tr"),function(e){return 0===e.dom().childElementCount});Ae.each(n,pi.remove),t.minCol()!==t.maxCol()&&t.minRow()!==t.maxRow()||Ae.each(mr.firstLayer(e,"th,td"),function(e){Pr.remove(e,"rowspan"),Pr.remove(e,"colspan")}),Pr.remove(e,"width"),Pr.remove(e,"height"),Zo.remove(e,"width"),Zo.remove(e,"height")},xi=function(e,t){var n=function(e){return bt.is(e.element(),t)},r=Do.fromTable(e),o=Io.generate(r),i=vi(o,n),u="th:not("+t+"),td:not("+t+")",a=mr.filterFirstLayer(e,"th,td",function(e){return bt.is(e,u)});return Ae.each(a,pi.remove),wi(r,o,i,n),yi(e,i),e},Ci={extract:xi},Si=function(e,t){return st.fromDom(e.dom().cloneNode(t))},Ri=function(e){return Si(e,!1)},Ti=function(e){return Si(e,!0)},Ai=function(e,t){var n=st.fromTag(t),r=Pr.clone(e);return Pr.setAll(n,r),n},Di=function(e,t){var n=Ai(e,t),r=sr.children(Ti(e));return fi.append(n,r),n},Ei=function(e,t){var n=Ai(e,t);ui.before(e,n);var r=sr.children(e);return fi.append(n,r),pi.remove(e),n},ki={shallow:Ri,shallowAs:Ai,deep:Ti,copy:Di,mutate:Ei},Oi=function(e,t){var n=function(n){if(!e(n))throw new Error("Can only get "+t+" value of a "+t+" node");return u(n).getOr("")},r=function(e){try{return o(e)}catch(e){return V.none()}},o=function(t){return e(t)?V.from(t.dom().nodeValue):V.none()},i=Wn.detect().browser,u=i.isIE()&&10===i.version.major?r:o;return{get:n,getOption:u,set:function(n,r){if(!e(n))throw new Error("Can only set raw "+t+" value of a "+t+" node");n.dom().nodeValue=r}}}(Cr.isText,"text"),Ni=function(e){return Oi.get(e)},Bi=function(e){return Oi.getOption(e)},Pi=function(e,t){Oi.set(e,t)},Ii={get:Ni,getOption:Bi,set:Pi},Wi=function(e){return"img"===Cr.name(e)?1:Ii.getOption(e).fold(function(){return sr.children(e).length},function(e){return e.length})},Mi=function(e,t){return Wi(e)===t},Li=function(e,t){return 0===t},Fi=function(e){return Ii.getOption(e).filter(function(e){return 0!==e.trim().length||e.indexOf(" ")>-1}).isSome()},qi=["img","br"],zi=function(e){return Fi(e)||Ae.contains(qi,Cr.name(e))},Hi={getEnd:Wi,isEnd:Mi,isStart:Li,isCursorPosition:zi},ji=function(e){return no.descendant(e,Hi.isCursorPosition)},_i=function(e){return Ui(e,Hi.isCursorPosition)},Ui=function(e,t){var n=function(e){for(var r=sr.children(e),o=r.length-1;o>=0;o--){var i=r[o];if(t(i))return V.some(i);var u=n(i);if(u.isSome())return u}return V.none()};return n(e)},Vi={first:ji,last:_i},Gi=function(){var e=st.fromTag("td");return ui.append(e,st.fromTag("br")),e},Yi=function(e,t,n){var r=ki.copy(e,t);return Me.each(n,function(e,t){null===e?Pr.remove(r,t):Pr.set(r,t,e)}),r},Xi=function(e){return e},Ki=function(e){return function(){return st.fromTag("tr",e.dom())}},$i=function(e,t,n){return Vi.first(e).map(function(r){var o=n.join(","),i=Kr.ancestors(r,o,function(t){return _n.eq(t,e)});return Ae.foldr(i,function(e,t){var n=ki.shallow(t);return ui.append(e,n),n},t)}).getOr(t)},Ji=function(e,t,n){var r=function(t){var r=sr.owner(t.element()),o=st.fromTag(Cr.name(t.element()),r.dom()),i=n.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),u=i.length>0?$i(t.element(),o,i):o;return ui.append(u,st.fromTag("br")),Zo.copy(t.element(),o),Zo.remove(o,"height"),1!==t.colspan()&&Zo.remove(t.element(),"width"),e(t.element(),o),o};return{row:Ki(t),cell:r,replace:Yi,gap:Gi}},Qi=function(e){return{row:Ki(e),cell:Gi,replace:Xi,gap:Gi}},Zi={cellOperations:Ji,paste:Qi},eu=function(e,t){var n=t||document,r=n.createElement("div");return r.innerHTML=e,sr.children(st.fromDom(r))},tu=function(e,t){return Ae.map(e,function(e){return st.fromTag(e,t)})},nu=function(e,t){return Ae.map(e,function(e){return st.fromText(e,t)})},ru=function(e){return Ae.map(e,st.fromDom)},ou={fromHtml:eu,fromTags:tu,fromText:nu,fromDom:ru},iu=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],uu=Ue.immutable("left","right"),au=function(e,t,n){var r=e.property().children(t);return Ae.findIndex(r,F.curry(e.eq,n)).map(function(e){return{before:F.constant(r.slice(0,e)),after:F.constant(r.slice(e+1))}})},cu=function(e,t,n){return au(e,t,n).map(function(n){var r=e.create().clone(t);return e.insert().appendAll(r,n.after()),e.insert().after(t,r),uu(t,r)})},lu=function(e,t,n){return au(e,t,n).map(function(r){var o=e.create().clone(t);return e.insert().appendAll(o,r.before().concat([n])),e.insert().appendAll(t,r.after()),e.insert().before(t,o),uu(o,t)})},su=function(e,t,n,r){var o=Ue.immutable("first","second","splits"),i=function(t,u,a){var c=o(t,V.none(),a);return n(t)?o(t,u,a):e.property().parent(t).bind(function(o){return r(e,o,t).map(function(e){var t=[{first:e.left,second:e.right}],r=n(o)?o:e.left();return i(r,V.some(e.right()),a.concat(t))}).getOr(c)})};return i(t,V.none(),[])},fu={breakToLeft:lu,breakToRight:cu,breakPath:su},du=function(e,t,n,r){return r(e,t,n[0],n.slice(1))},mu=function(e,t,n){return n.length>0?du(e,t,n,gu):V.none()},gu=function(e,t,n,r){var o=t(e,n);return Ae.foldr(r,function(n,r){var o=t(e,r);return pu(e,n,o)},o)},pu=function(e,t,n){return t.bind(function(t){return n.filter(F.curry(e.eq,t))})},hu={oneAll:mu},vu=function(e,t){return F.curry(e.eq,t)},bu=function(e,t,n,r){var o=e.property().children(t);if(e.eq(t,n[0]))return V.some([n[0]]);if(e.eq(t,r[0]))return V.some([r[0]]);var i=function(n){var r=Ae.reverse(n),i=Ae.findIndex(r,vu(e,t)).getOr(-1),u=i<r.length-1?r[i+1]:r[i];return Ae.findIndex(o,vu(e,u))},u=i(n),a=i(r);return u.bind(function(e){return a.map(function(t){var n=Math.min(e,t),r=Math.max(e,t);return o.slice(n,r+1)})})},wu=function(e,t,n,r){var o=void 0!==r?r:F.constant(!1),i=[t].concat(e.up().all(t)),u=[n].concat(e.up().all(n)),a=function(e){return Ae.findIndex(e,o).fold(function(){return e},function(t){return e.slice(0,t+1)})},c=a(i),l=a(u),s=Ae.find(c,function(t){return Ae.exists(l,vu(e,t))});return{firstpath:F.constant(c),secondpath:F.constant(l),shared:F.constant(s)}},yu=function(e,t,n){var r=wu(e,t,n);return r.shared().bind(function(t){return bu(e,t,r.firstpath(),r.secondpath())})},xu={subset:yu,ancestors:wu},Cu=function(e,t,n){return hu.oneAll(e,t,n)},Su=function(e,t,n){return xu.subset(e,t,n)},Ru=function(e,t,n,r){return xu.ancestors(e,t,n,r)},Tu=function(e,t,n){return fu.breakToLeft(e,t,n)},Au=function(e,t,n){return fu.breakToRight(e,t,n)},Du=function(e,t,n,r){return fu.breakPath(e,t,n,r)},Eu={sharedOne:Cu,subset:Su,ancestors:Ru,breakToLeft:Tu,breakToRight:Au,breakPath:Du},ku=o(),Ou=function(e,t){return Eu.sharedOne(ku,function(t,n){return e(n)},t)},Nu=function(e,t){return Eu.subset(ku,e,t)},Bu=function(e,t,n){return Eu.ancestors(ku,e,t,n)},Pu=function(e,t){return Eu.breakToLeft(ku,e,t)},Iu=function(e,t){return Eu.breakToRight(ku,e,t)},Wu=function(e,t,n){return Eu.breakPath(ku,e,t,function(e,t,r){return n(t,r)})},Mu={sharedOne:Ou,subset:Nu,ancestors:Bu,breakToLeft:Pu,breakToRight:Iu,breakPath:Wu},Lu=function(e,t){var n=t.column(),r=t.column()+t.colspan()-1,o=t.row(),i=t.row()+t.rowspan()-1;return n<=e.finishCol()&&r>=e.startCol()&&o<=e.finishRow()&&i>=e.startRow()},Fu=function(e,t){return t.column()>=e.startCol()&&t.column()+t.colspan()-1<=e.finishCol()&&t.row()>=e.startRow()&&t.row()+t.rowspan()-1<=e.finishRow()},qu=function(e,t){for(var n=!0,r=F.curry(Fu,t),o=t.startRow();o<=t.finishRow();o++)for(var i=t.startCol();i<=t.finishCol();i++)n=n&&Io.getAt(e,o,i).exists(r);return n?V.some(t):V.none()},zu={inSelection:Lu,isWithin:Fu,isRectangular:qu},Hu=function(e,t){return ot.bounds(Math.min(e.row(),t.row()),Math.min(e.column(),t.column()),Math.max(e.row()+e.rowspan()-1,t.row()+t.rowspan()-1),Math.max(e.column()+e.colspan()-1,t.column()+t.colspan()-1))},ju=function(e,t,n){var r=Io.findItem(e,t,_n.eq),o=Io.findItem(e,n,_n.eq);return r.bind(function(e){return o.map(function(t){return Hu(e,t)})})},_u=function(e,t,n){return ju(e,t,n).bind(function(t){return zu.isRectangular(e,t)})},Uu={getAnyBox:ju,getBox:_u},Vu=function(e,t,n,r){return Io.findItem(e,t,_n.eq).bind(function(t){var o=n>0?t.row()+t.rowspan()-1:t.row(),i=r>0?t.column()+t.colspan()-1:t.column();return Io.getAt(e,o+n,i+r).map(function(e){return e.element()})})},Gu=function(e,t,n){return Uu.getAnyBox(e,t,n).map(function(t){var n=Io.filterItems(e,F.curry(zu.inSelection,t));return Ae.map(n,function(e){return e.element()})})},Yu=function(e,t){var n=function(e,t){return _n.contains(t,e)};return Io.findItem(e,t,n).bind(function(e){return e.element()})},Xu={moveBy:Vu,intercepts:Gu,parentCell:Yu},Ku=function(e,t,n){return Ro.table(e).bind(function(r){var o=Zu(r);return Xu.moveBy(o,e,t,n)})},$u=function(e,t,n){var r=Zu(e);return Xu.intercepts(r,t,n)},Ju=function(e,t,n,r,o){var i=Zu(e),u=_n.eq(e,n)?t:Xu.parentCell(i,t),a=_n.eq(e,o)?r:Xu.parentCell(i,r);return Xu.intercepts(i,u,a)},Qu=function(e,t,n){var r=Zu(e);return Uu.getBox(r,t,n)},Zu=function(e){var t=Do.fromTable(e);return Io.generate(t)},ea={moveBy:Ku,intercepts:$u,nestedIntercepts:Ju,getBox:Qu},ta=function(e,t){return lo.ancestor(e,"table")},na=Ue.immutableBag(["boxes","start","finish"],[]),ra=function(e,t,n){var r=function(e){return function(t){return n(t)||_n.eq(t,e)}};return _n.eq(e,t)?V.some(na({boxes:V.some([e]),start:e,finish:t})):ta(e).bind(function(o){return ta(t).bind(function(i){if(_n.eq(o,i))return V.some(na({boxes:ea.intercepts(o,e,t),start:e,finish:t}));if(_n.contains(o,i)){var u=Kr.ancestors(t,"td,th",r(o)),a=u.length>0?u[u.length-1]:t;return V.some(na({boxes:ea.nestedIntercepts(o,e,o,t,i),start:e,finish:a}))}if(_n.contains(i,o)){var u=Kr.ancestors(e,"td,th",r(i)),c=u.length>0?u[u.length-1]:e;return V.some(na({boxes:ea.nestedIntercepts(i,e,o,t,i),start:e,finish:c}))}return Mu.ancestors(e,t).shared().bind(function(u){return lo.closest(u,"table",n).bind(function(n){var u=Kr.ancestors(t,"td,th",r(n)),a=u.length>0?u[u.length-1]:t,c=Kr.ancestors(e,"td,th",r(n)),l=c.length>0?c[c.length-1]:e;return V.some(na({boxes:ea.nestedIntercepts(n,e,o,t,i),start:l,finish:a}))})})})})},oa=function(e,t){var n=Kr.descendants(e,t);return n.length>0?V.some(n):V.none()},ia=function(e,t){return Ae.find(e,function(e){return bt.is(e,t)})},ua=function(e,t,n){return lo.descendant(e,t).bind(function(t){return lo.descendant(e,n).bind(function(e){return Mu.sharedOne(ta,[t,e]).map(function(n){return{first:F.constant(t),last:F.constant(e),table:F.constant(n)}})})})},aa=function(e,t){return lo.ancestor(e,"table").bind(function(n){return lo.descendant(n,t).bind(function(t){return ra(t,e).bind(function(e){return e.boxes().map(function(t){return{boxes:F.constant(t),start:F.constant(e.start()),finish:F.constant(e.finish())}})})})})},ca=function(e,t,n,r,o){return ia(e,o).bind(function(e){return ea.moveBy(e,t,n).bind(function(e){return aa(e,r)})})},la={identify:ra,retrieve:oa,shiftSelection:ca,getEdges:ua},sa=function(e,t){return la.retrieve(e,t)},fa=function(e,t,n){return la.getEdges(e,t,n).bind(function(t){var n=function(t){return _n.eq(e,t)},r=lo.ancestor(t.first(),"thead,tfoot,tbody,table",n),o=lo.ancestor(t.last(),"thead,tfoot,tbody,table",n);return r.bind(function(e){return o.bind(function(n){return _n.eq(e,n)?ea.getBox(t.table(),t.first(),t.last()):V.none()})})})},da={retrieve:sa,retrieveBox:fa},ma="data-mce-selected",ga={selected:F.constant(ma),selectedSelector:F.constant("td[data-mce-selected],th[data-mce-selected]"),attributeSelector:F.constant("[data-mce-selected]"),firstSelected:F.constant("data-mce-first-selected"),firstSelectedSelector:F.constant("td[data-mce-first-selected],th[data-mce-first-selected]"),lastSelected:F.constant("data-mce-last-selected"),lastSelectedSelector:F.constant("td[data-mce-last-selected],th[data-mce-last-selected]")},pa=function(e){if(!X.isArray(e))throw new Error("cases must be an array");if(0===e.length)throw new Error("there must be at least one case");var t=[],n={};return Ae.each(e,function(r,o){var i=Me.keys(r);if(1!==i.length)throw new Error("one and only one name per case");var u=i[0],a=r[u];if(void 0!==n[u])throw new Error("duplicate key detected:"+u);if("cata"===u)throw new Error("cannot have a case named cata (sorry)");if(!X.isArray(a))throw new Error("case arguments must be an array");t.push(u),n[u]=function(){var n=arguments.length;if(n!==a.length)throw new Error("Wrong number of arguments to case "+u+". Expected "+a.length+" ("+a+"), got "+n);for(var r=new Array(n),i=0;i<r.length;i++)r[i]=arguments[i];var c=function(e){var n=Me.keys(e);if(t.length!==n.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+n.join(","));if(!Ae.forall(t,function(e){return Ae.contains(n,e)}))throw new Error("Not all branches were specified when using match. Specified: "+n.join(", ")+"\nRequired: "+t.join(", "));return e[u].apply(null,r)};return{fold:function(){if(arguments.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+arguments.length);return arguments[o].apply(null,r)},match:c,log:function(e){console.log(e,{constructors:t,constructor:u,params:r})}}}}),n},ha={generate:pa},va=ha.generate([{none:[]},{multiple:["elements"]},{single:["selection"]}]),ba=function(e,t,n,r){return e.fold(t,n,r)},wa={cata:ba,none:va.none,multiple:va.multiple,single:va.single},ya=function(e,t){return wa.cata(t.get(),F.constant([]),F.identity,F.constant([e]))},xa=function(e,t){var n=function(e){return Pr.has(e,"rowspan")&&parseInt(Pr.get(e,"rowspan"),10)>1||Pr.has(e,"colspan")&&parseInt(Pr.get(e,"colspan"),10)>1},r=ya(e,t);return r.length>0&&Ae.forall(r,n)?V.some(r):V.none()},Ca=function(e,t){return wa.cata(t.get(),V.none,function(t,n){return 0===t.length?V.none():da.retrieveBox(e,ga.firstSelectedSelector(),ga.lastSelectedSelector()).bind(function(e){return t.length>1?V.some({bounds:F.constant(e),cells:F.constant(t)}):V.none()})},V.none)},Sa={mergable:Ca,unmergable:xa,selection:ya},Ra=function(e){return{element:F.constant(e),mergable:V.none,unmergable:V.none,selection:F.constant([e])}},Ta=function(e,t,n){return{element:F.constant(n),mergable:F.constant(Sa.mergable(t,e)),unmergable:F.constant(Sa.unmergable(n,e)),selection:F.constant(Sa.selection(n,e))}},Aa=function(e){return Ra(e)},Da=Ue.immutable("element","clipboard","generators"),Ea=function(e,t,n,r,o){return{element:F.constant(n),mergable:V.none,unmergable:V.none,selection:F.constant(Sa.selection(n,e)),clipboard:F.constant(r),generators:F.constant(o)}},ka={noMenu:Ra,forMenu:Ta,notCell:Aa,paste:Da,pasteRows:Ea},Oa=function(e){return Ro.table(e[0]).map(ki.deep).map(function(e){return[Ci.extract(e,ga.attributeSelector())]})},Na=function(e,t){return e.selection.serializer.serialize(t.dom(),{})},Ba=function(e,t,n,r){e.on("BeforeGetContent",function(n){var r=function(t){n.preventDefault(),Oa(t).each(function(t){n.content=Ae.map(t,function(t){return Na(e,t)}).join("")})};!0===n.selection&&wa.cata(t.get(),F.noop,r,F.noop)}),e.on("BeforeSetContent",function(t){if(!0===t.selection&&!0===t.paste){V.from(e.dom.getParent(e.selection.getStart(),"th,td")).each(function(o){var i=st.fromDom(o);Ro.table(i).bind(function(o){var u=Ae.filter(ou.fromHtml(t.content),function(e){return"meta"!==Cr.name(e)});if(1===u.length&&"table"===Cr.name(u[0])){t.preventDefault();var a=st.fromDom(e.getDoc()),c=Zi.paste(a),l=ka.paste(i,u[0],c);n.pasteCells(o,l).each(function(t){e.selection.setRng(t),e.focus(),r.clear(o)})}})})}})},Pa={registerEvents:Ba},Ia=i("height",function(e){return Lr.inBody(e)?e.dom().getBoundingClientRect().height:e.dom().offsetHeight}),Wa=function(e,t){Ia.set(e,t)},Ma=function(e){return Ia.get(e)},La=function(e){return Ia.getOuter(e)},Fa=function(e,t){var n=["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"],r=Ia.max(e,t,n);Zo.set(e,"max-height",r+"px")},qa={set:Wa,get:Ma,getOuter:La,setMax:Fa},za=i("width",function(e){return e.dom().offsetWidth}),Ha=function(e,t){za.set(e,t)},ja=function(e){return za.get(e)},_a=function(e){return za.getOuter(e)},Ua=function(e,t){var n=["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"],r=za.max(e,t,n);Zo.set(e,"max-width",r+"px")},Va={set:Ha,get:ja,getOuter:_a,setMax:Ua},Ga=Wn.detect(),Ya=function(){return Ga.browser.isIE()||Ga.browser.isEdge()},Xa=function(e,t){var n=parseFloat(e);return isNaN(n)?t:n},Ka=function(e,t,n){return Xa(Zo.get(e,t),n)},$a=function(e){var t=Ka(e,"padding-top",0),n=Ka(e,"padding-bottom",0),r=Ka(e,"border-top-width",0),o=Ka(e,"border-bottom-width",0),i=e.dom().getBoundingClientRect().height,u=Zo.get(e,"box-sizing"),a=r+o;return"border-box"===u?i:i-t-n-a},Ja=function(e){return Ka(e,"width",Va.get(e))},Qa=function(e){return Ya()?$a(e):Ka(e,"height",qa.get(e))},Za={getWidth:Ja,getHeight:Qa},ec=/(\d+(\.\d+)?)(\w|%)*/,tc=/(\d+(\.\d+)?)%/,nc=/(\d+(\.\d+)?)px|em/,rc=function(e,t){Zo.set(e,"width",t+"px")},oc=function(e,t){Zo.set(e,"width",t+"%")},ic=function(e,t){Zo.set(e,"height",t+"px")},uc=function(e){return Zo.getRaw(e,"height").getOrThunk(function(){return Za.getHeight(e)+"px"})},ac=function(e,t,n,r){var o=Ro.table(e).map(function(e){var r=n(e);return Math.floor(t/100*r)}).getOr(t);return r(e,o),o},cc=function(e,t,n,r){var o=parseInt(e,10);return An.endsWith(e,"%")&&"table"!==Cr.name(t)?ac(t,o,n,r):o},lc=function(e){var t=uc(e);return t?cc(t,e,qa.get,ic):qa.get(e)},sc=function(e,t,n){return n(e)/fc(e,t)},fc=function(e,t){return Pr.has(e,t)?parseInt(Pr.get(e,t),10):1},dc=function(e){return Zo.getRaw(e,"width").fold(function(){return V.from(Pr.get(e,"width"))},function(e){return V.some(e)})},mc=function(e,t){return e/t.pixelWidth()*100},gc=function(e,t,n){if(tc.test(t)){var r=tc.exec(t);return parseFloat(r[1])}var o=Va.get(e),i=parseInt(o,10);return mc(i,n)},pc=function(e,t){return dc(e).fold(function(){var n=Va.get(e),r=parseInt(n,10);return mc(r,t)},function(n){return gc(e,n,t)})},hc=function(e,t){return e/100*t.pixelWidth()},vc=function(e,t,n){if(nc.test(t)){var r=nc.exec(t);return parseInt(r[1],10)}if(tc.test(t)){var o=tc.exec(t),i=parseFloat(o[1]);return hc(i,n)}var u=Va.get(e);return parseInt(u,10)},bc=function(e,t){return dc(e).fold(function(){var t=Va.get(e);return parseInt(t,10)},function(n){return vc(e,n,t)})},wc=function(e){return sc(e,"rowspan",lc)},yc=function(e){return dc(e).bind(function(e){if(ec.test(e)){var t=ec.exec(e);return V.some({width:F.constant(t[1]),unit:F.constant(t[3])})}return V.none()})},xc=function(e,t,n){Zo.set(e,"width",t+n)},Cc={percentageBasedSizeRegex:F.constant(tc),pixelBasedSizeRegex:F.constant(nc),setPixelWidth:rc,setPercentageWidth:oc,setHeight:ic,getPixelWidth:bc,getPercentageWidth:pc,getGenericWidth:yc,setGenericWidth:xc,getHeight:wc,getRawWidth:dc},Sc=function(e,t){Cc.getGenericWidth(e).each(function(n){var r=n.width()/2;Cc.setGenericWidth(e,r,n.unit()),Cc.setGenericWidth(t,r,n.unit())})},Rc={halve:Sc},Tc=function(e,t){var n=t||st.fromDom(document.documentElement);return no.ancestor(e,F.curry(_n.eq,n)).isSome()},Ac=function(e){var t=e.dom();return t===t.window?e:Cr.isDocument(e)?t.defaultView||t.parentWindow:null},Dc={attached:Tc,windowOf:Ac},Ec=function(e,t){var n=function(n,r){return Ec(e+n,t+r)};return{left:F.constant(e),top:F.constant(t),translate:n}},kc=function(e){var t=e.getBoundingClientRect();return Ec(t.left,t.top)},Oc=function(e,t){return void 0!==e?e:void 0!==t?t:0},Nc=function(e){var t=e.dom().ownerDocument,n=t.body,r=Dc.windowOf(st.fromDom(t)),o=t.documentElement,i=Oc(r.pageYOffset,o.scrollTop),u=Oc(r.pageXOffset,o.scrollLeft),a=Oc(o.clientTop,n.clientTop),c=Oc(o.clientLeft,n.clientLeft);return Pc(e).translate(u-c,i-a)},Bc=function(e){var t=e.dom();return Ec(t.offsetLeft,t.offsetTop)},Pc=function(e){var t=e.dom(),n=t.ownerDocument,r=n.body,o=st.fromDom(n.documentElement);return r===t?Ec(r.offsetLeft,r.offsetTop):Dc.attached(e,o)?kc(t):Ec(0,0)},Ic={absolute:Nc,relative:Bc,viewport:Pc},Wc=Ue.immutable("row","y"),Mc=Ue.immutable("col","x"),Lc=function(e){return Ic.absolute(e).left()+Va.getOuter(e)},Fc=function(e){return Ic.absolute(e).left()},qc=function(e,t){return Mc(e,Fc(t))},zc=function(e,t){return Mc(e,Lc(t))},Hc=function(e){return Ic.absolute(e).top()},jc=function(e,t){return Wc(e,Hc(t))},_c=function(e,t){return Wc(e,Hc(t)+qa.getOuter(t))},Uc=function(e,t,n){if(0===n.length)return[];var r=Ae.map(n.slice(1),function(t,n){return t.map(function(t){return e(n,t)})}),o=n[n.length-1].map(function(e){return t(n.length-1,e)});return r.concat([o])},Vc=function(e,t){return-e},Gc={delta:F.identity,positions:F.curry(Uc,jc,_c),edge:Hc},Yc={delta:F.identity,edge:Fc,positions:F.curry(Uc,qc,zc)},Xc={delta:Vc,edge:Lc,positions:F.curry(Uc,zc,qc)},Kc={height:Gc,rtl:Xc,ltr:Yc},$c={ltr:Kc.ltr,rtl:Kc.rtl},Jc=function(e){var t=Do.fromTable(e);return Io.generate(t).grid()},Qc={getGridSize:Jc},Zc=function(e){var t=e,n=function(){return t};return{get:n,set:function(e){t=e},clone:function(){return Zc(n())}}},el=function(e,t){return tl(e,t,{validate:X.isFunction,label:"function"})},tl=function(e,t,n){if(0===t.length)throw new Error("You must specify at least one required field.");return _e.validateStrArr("required",t),_e.checkDupes(t),function(r){var o=Me.keys(r);Ae.forall(t,function(e){return Ae.contains(o,e)})||_e.reqMessage(t,o),e(t,o);var i=Ae.filter(t,function(e){return!n.validate(r[e],e)});return i.length>0&&_e.invalidTypeMessage(i,n.label),r}},nl=function(e,t){var n=Ae.filter(t,function(t){return!Ae.contains(e,t)});n.length>0&&_e.unsuppMessage(n)},rl=F.noop,ol={exactly:F.curry(el,nl),ensure:F.curry(el,rl),ensureWith:F.curry(tl,rl)},il=function(e){var t=Pr.has(e,"colspan")?parseInt(Pr.get(e,"colspan"),10):1,n=Pr.has(e,"rowspan")?parseInt(Pr.get(e,"rowspan"),10):1;return{element:F.constant(e),colspan:F.constant(t),rowspan:F.constant(n)}},ul=function(e,t){ll(e);var n=Zc(V.none()),r=void 0!==t?t:il,o=function(t){return e.cell(t)},i=function(e){var t=r(e);return o(t)},u=function(e){var t=i(e);return n.get().isNone()&&n.set(V.some(t)),a=V.some({item:e,replacement:t}),t},a=V.none();return{getOrInit:function(e,t){return a.fold(function(){return u(e)},function(n){return t(e,n.item)?n.replacement:u(e)})},cursor:n.get}},al=function(e,t){return function(n){var r=Zc(V.none());ll(n);var o=[],i=function(e,t){return Ae.find(o,function(n){return t(n.item,e)})},u=function(i){var u=n.replace(i,t,{scope:e});return o.push({item:i,sub:u}),r.get().isNone()&&r.set(V.some(u)),u};return{replaceOrInit:function(e,t){return i(e,t).fold(function(){return u(e)},function(n){return t(e,n.item)?n.sub:u(e)})},cursor:r.get}}},cl=function(e){ll(e);var t=Zc(V.none());return{combine:function(n){return t.get().isNone()&&t.set(V.some(n)),function(){var t=e.cell({element:F.constant(n),colspan:F.constant(1),rowspan:F.constant(1)});return Zo.remove(t,"width"),Zo.remove(n,"width"),t}},cursor:t.get}},ll=ol.exactly(["cell","row","replace","gap"]),sl={modification:ul,transform:al,merging:cl},fl=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],dl=function(e,t){var n=e.property().name(t);return Ae.contains(["ol","ul"],n)},ml=function(e,t){var n=e.property().name(t);return Ae.contains(fl,n)},gl=function(e,t){var n=e.property().name(t);return Ae.contains(["address","pre","p","h1","h2","h3","h4","h5","h6"],n)},pl=function(e,t){var n=e.property().name(t);return Ae.contains(["h1","h2","h3","h4","h5","h6"],n)},hl=function(e,t){return Ae.contains(["div","li","td","th","blockquote","body","caption"],e.property().name(t))},vl=function(e,t){return Ae.contains(["br","img","hr","input"],e.property().name(t))},bl=function(e,t){return"iframe"===e.property().name(t)},wl=function(e,t){return!(ml(e,t)||vl(e,t))&&"li"!==e.property().name(t)},yl={isBlock:ml,isList:dl,isFormatting:gl,isHeading:pl,isContainer:hl,isEmptyTag:vl,isFrame:bl,isInline:wl
},xl=o(),Cl=function(e){return yl.isBlock(xl,e)},Sl=function(e){return yl.isList(xl,e)},Rl=function(e){return yl.isFormatting(xl,e)},Tl=function(e){return yl.isHeading(xl,e)},Al=function(e){return yl.isContainer(xl,e)},Dl=function(e){return yl.isEmptyTag(xl,e)},El=function(e){return yl.isFrame(xl,e)},kl=function(e){return yl.isInline(xl,e)},Ol={isBlock:Cl,isList:Sl,isFormatting:Rl,isHeading:Tl,isContainer:Al,isEmptyTag:Dl,isFrame:El,isInline:kl},Nl=function(e){var t=function(e){return"br"===Cr.name(e)},n=function(e){return Ae.forall(e,function(e){return t(e)||Cr.isText(e)&&0===Ii.get(e).trim().length})},r=function(e){return"li"===Cr.name(e)||no.ancestor(e,Ol.isList).isSome()},o=function(e){return sr.nextSibling(e).map(function(e){return!!Ol.isBlock(e)||(Ol.isEmptyTag(e)?"img"!==Cr.name(e):void 0)}).getOr(!1)},i=function(e){return Vi.last(e).bind(function(n){var i=o(n);return sr.parent(n).map(function(o){return!0===i||r(o)||t(n)||Ol.isBlock(o)&&!_n.eq(e,o)?[]:[st.fromTag("br")]})}).getOr([])},u=function(){var t=Ae.bind(e,function(e){var t=sr.children(e);return n(t)?[]:t.concat(i(e))});return 0===t.length?[st.fromTag("br")]:t}();pi.empty(e[0]),fi.append(e[0],u)},Bl={merge:Nl},Pl=function(e,t){return t},Il=function(e,t){return X.isObject(e)&&X.isObject(t)?Ml(e,t):t},Wl=function(e){return function(){for(var t=new Array(arguments.length),n=0;n<t.length;n++)t[n]=arguments[n];if(0===t.length)throw new Error("Can't merge zero objects");for(var r={},o=0;o<t.length;o++){var i=t[o];for(var u in i)i.hasOwnProperty(u)&&(r[u]=e(r[u],i[u]))}return r}},Ml=Wl(Il),Ll=Wl(Pl),Fl={deepMerge:Ml,merge:Ll},ql=function(e){for(var t=[],n=function(e){t.push(e)},r=0;r<e.length;r++)e[r].each(n);return t},zl=function(e,t){for(var n=0;n<e.length;n++){var r=t(e[n],n);if(r.isSome())return r}return V.none()},Hl=function(e,t){for(var n=[],r=0;r<e.length;r++){var o=e[r];if(!o.isSome())return V.none();n.push(o.getOrDie())}return V.some(t.apply(null,n))},jl={cat:ql,findMap:zl,liftN:Hl},_l=function(e,t,n){var r=e.cells(),o=r.slice(0,t),i=r.slice(t),u=o.concat([n]).concat(i);return Vl(e,u)},Ul=function(e,t,n){e.cells()[t]=n},Vl=function(e,t){return ot.rowcells(t,e.section())},Gl=function(e,t){var n=e.cells(),r=Ae.map(n,t);return ot.rowcells(r,e.section())},Yl=function(e,t){return e.cells()[t]},Xl=function(e,t){return Yl(e,t).element()},Kl=function(e){return e.cells().length},$l={addCell:_l,setCells:Vl,mutateCell:Ul,getCell:Yl,getCellElement:Xl,mapCells:Gl,cellLength:Kl},Jl=function(e,t){return Ae.map(e,function(e){return $l.getCell(e,t)})},Ql=function(e,t){return e[t]},Zl=function(e,t){if(0===e.length)return 0;var n=e[0];return Ae.findIndex(e,function(e){return!t(n.element(),e.element())}).fold(function(){return e.length},function(e){return e})},es=function(e,t,n,r){var o=Ql(e,t).cells().slice(n),i=Zl(o,r),u=Jl(e,n).slice(t),a=Zl(u,r);return{colspan:F.constant(i),rowspan:F.constant(a)}},ts={subgrid:es},ns=function(e,t){var n=Ae.map(e,function(e,t){return Ae.map(e.cells(),function(e,t){return!1})}),r=function(e,t,r,o){for(var i=e;i<e+r;i++)for(var u=t;u<t+o;u++)n[i][u]=!0};return Ae.map(e,function(o,i){var u=Ae.bind(o.cells(),function(o,u){if(!1===n[i][u]){var a=ts.subgrid(e,i,u,t);return r(i,u,a.rowspan(),a.colspan()),[ot.detailnew(o.element(),a.rowspan(),a.colspan(),o.isNew())]}return[]});return ot.rowdetails(u,o.section())})},rs=function(e,t,n){for(var r=[],o=0;o<e.grid().rows();o++){for(var i=[],u=0;u<e.grid().columns();u++){var a=Io.getAt(e,o,u).map(function(e){return ot.elementnew(e.element(),n)}).getOrThunk(function(){return ot.elementnew(t.gap(),!0)});i.push(a)}var c=ot.rowcells(i,e.all()[o].section());r.push(c)}return r},os={toDetails:ns,toGrid:rs},is=function(e,t,n,r){n===r?Pr.remove(e,t):Pr.set(e,t,n)},us=function(e,t){var n=[],r=[],o=function(t,o){var i=lo.child(e,o).getOrThunk(function(){var t=st.fromTag(o,sr.owner(e).dom());return ui.append(e,t),t});pi.empty(i);var u=Ae.map(t,function(e){e.isNew()&&n.push(e.element());var t=e.element();return pi.empty(t),Ae.each(e.cells(),function(e){e.isNew()&&r.push(e.element()),is(e.element(),"colspan",e.colspan(),1),is(e.element(),"rowspan",e.rowspan(),1),ui.append(t,e.element())}),t});fi.append(i,u)},i=function(t){lo.child(e,t).bind(pi.remove)},u=function(e,t){e.length>0?o(e,t):i(t)},a=[],c=[],l=[];return Ae.each(t,function(e){switch(e.section()){case"thead":a.push(e);break;case"tbody":c.push(e);break;case"tfoot":l.push(e)}}),u(a,"thead"),u(c,"tbody"),u(l,"tfoot"),{newRows:F.constant(n),newCells:F.constant(r)}},as=function(e){return Ae.map(e,function(e){var t=ki.shallow(e.element());return Ae.each(e.cells(),function(e){var n=ki.deep(e.element());is(n,"colspan",e.colspan(),1),is(n,"rowspan",e.rowspan(),1),ui.append(t,n)}),t})},cs={render:us,copy:as},ls=function(e,t){for(var n=[],r=0;r<e;r++)n.push(t(r));return n},ss=function(e,t){for(var n=[],r=e;r<t;r++)n.push(r);return n},fs=function(e,t){var n=[];return Ae.each(e,function(r,o){o<e.length-1&&!t(r,e[o+1])?n.push(r):o===e.length-1&&n.push(r)}),n},ds=function(e,t){if(t<0||t>=e.length-1)return V.none();var n=e[t].fold(function(){var n=Ae.reverse(e.slice(0,t));return jl.findMap(n,function(e,t){return e.map(function(e){return{value:e,delta:t+1}})})},function(e){return V.some({value:e,delta:0})}),r=e[t+1].fold(function(){var n=e.slice(t+1);return jl.findMap(n,function(e,t){return e.map(function(e){return{value:e,delta:t+1}})})},function(e){return V.some({value:e,delta:1})});return n.bind(function(e){return r.map(function(t){var n=t.delta+e.delta;return Math.abs(t.value-e.value)/n})})},ms={repeat:ls,range:ss,unique:fs,deduce:ds},gs=function(e){var t=e.grid(),n=ms.range(0,t.columns()),r=ms.range(0,t.rows());return Ae.map(n,function(t){return ps(function(){return Ae.bind(r,function(n){return Io.getAt(e,n,t).filter(function(e){return e.column()===t}).fold(F.constant([]),function(e){return[e]})})},function(e){return 1===e.colspan()},function(){return Io.getAt(e,0,t)})})},ps=function(e,t,n){var r=e();return Ae.find(r,t).orThunk(function(){return V.from(r[0]).orThunk(n)}).map(function(e){return e.element()})},hs=function(e){var t=e.grid(),n=ms.range(0,t.rows()),r=ms.range(0,t.columns());return Ae.map(n,function(t){return ps(function(){return Ae.bind(r,function(n){return Io.getAt(e,t,n).filter(function(e){return e.row()===t}).fold(F.constant([]),function(e){return[e]})})},function(e){return 1===e.rowspan()},function(){return Io.getAt(e,t,0)})})},vs={columns:gs,rows:hs},bs=function(e,t,n,r,o){var i=st.fromTag("div");return Zo.setAll(i,{position:"absolute",left:t-r/2+"px",top:n+"px",height:o+"px",width:r+"px"}),Pr.setAll(i,{"data-column":e,role:"presentation"}),i},ws=function(e,t,n,r,o){var i=st.fromTag("div");return Zo.setAll(i,{position:"absolute",left:t+"px",top:n-o/2+"px",height:o+"px",width:r+"px"}),Pr.setAll(i,{"data-row":e,role:"presentation"}),i},ys={col:bs,row:ws},xs=function(e){var t=e.replace(/\./g,"-");return{resolve:function(e){return t+"-"+e}}},Cs={css:xs},Ss=Cs.css("ephox-snooker"),Rs={resolve:Ss.resolve},Ts=function(e,t){var n=Pr.get(e,t);return void 0===n||""===n?[]:n.split(" ")},As=function(e,t,n){var r=Ts(e,t),o=r.concat([n]);Pr.set(e,t,o.join(" "))},Ds=function(e,t,n){var r=Ae.filter(Ts(e,t),function(e){return e!==n});r.length>0?Pr.set(e,t,r.join(" ")):Pr.remove(e,t)},Es={read:Ts,add:As,remove:Ds},ks=function(e){return void 0!==e.dom().classList},Os=function(e){return Es.read(e,"class")},Ns=function(e,t){return Es.add(e,"class",t)},Bs=function(e,t){return Es.remove(e,"class",t)},Ps=function(e,t){Ae.contains(Os(e),t)?Bs(e,t):Ns(e,t)},Is={get:Os,add:Ns,remove:Bs,toggle:Ps,supports:ks},Ws=function(e,t){Is.supports(e)?e.dom().classList.add(t):Is.add(e,t)},Ms=function(e){0===(Is.supports(e)?e.dom().classList:Is.get(e)).length&&Pr.remove(e,"class")},Ls=function(e,t){if(Is.supports(e)){e.dom().classList.remove(t)}else Is.remove(e,t);Ms(e)},Fs=function(e,t){return Is.supports(e)?e.dom().classList.toggle(t):Is.toggle(e,t)},qs=function(e,t){var n=Is.supports(e),r=e.dom().classList;return a(function(){n?r.remove(t):Is.remove(e,t)},function(){n?r.add(t):Is.add(e,t)},zs(e,t))},zs=function(e,t){return Is.supports(e)&&e.dom().classList.contains(t)},Hs={add:Ws,remove:Ls,toggle:Fs,toggler:qs,has:zs},js=Rs.resolve("resizer-bar"),_s=Rs.resolve("resizer-rows"),Us=Rs.resolve("resizer-cols"),Vs=function(e){var t=Kr.descendants(e.parent(),"."+js);Ae.each(t,pi.remove)},Gs=function(e,t,n){var r=e.origin();Ae.each(t,function(t,o){t.each(function(t){var o=n(r,t);Hs.add(o,js),ui.append(e.parent(),o)})})},Ys=function(e,t,n,r){Gs(e,t,function(e,t){var o=ys.col(t.col(),t.x()-e.left(),n.top()-e.top(),7,r);return Hs.add(o,Us),o})},Xs=function(e,t,n,r){Gs(e,t,function(e,t){var o=ys.row(t.row(),n.left()-e.left(),t.y()-e.top(),r,7);return Hs.add(o,_s),o})},Ks=function(e,t,n,r,o,i){var u=Ic.absolute(t),a=n.length>0?o.positions(n,t):[];Xs(e,a,u,Va.getOuter(t));var c=r.length>0?i.positions(r,t):[];Ys(e,c,u,qa.getOuter(t))},$s=function(e,t,n,r){Vs(e);var o=Do.fromTable(t),i=Io.generate(o),u=vs.rows(i),a=vs.columns(i);Ks(e,t,u,a,n,r)},Js=function(e,t){var n=Kr.descendants(e.parent(),"."+js);Ae.each(n,t)},Qs=function(e){Js(e,function(e){Zo.set(e,"display","none")})},Zs=function(e){Js(e,function(e){Zo.set(e,"display","block")})},ef=function(e){return Hs.has(e,_s)},tf=function(e){return Hs.has(e,Us)},nf={refresh:$s,hide:Qs,show:Zs,destroy:Vs,isRowBar:ef,isColBar:tf},rf=function(e,t){return os.toGrid(e,t,!1)},of=function(e,t){var n=function(e){return jl.findMap(e,function(e){return sr.parent(e.element()).map(function(e){var t=sr.parent(e).isNone();return ot.elementnew(e,t)})}).getOrThunk(function(){return ot.elementnew(t.row(),!0)})};return Ae.map(e,function(e){var t=n(e.details());return ot.rowdatanew(t.element(),e.details(),e.section(),t.isNew())})},uf=function(e,t){var n=os.toDetails(e,_n.eq);return of(n,t)},af=function(e,t){var n=Ae.flatten(Ae.map(e.all(),function(e){return e.cells()}));return Ae.find(n,function(e){return _n.eq(t,e.element())})},cf=function(e,t,n,r,o){return function(i,u,a,c,l){var s=Do.fromTable(u),f=Io.generate(s);return t(f,a).map(function(t){var n=rf(f,c),r=e(n,t,_n.eq,o(c)),i=uf(r.grid(),c);return{grid:F.constant(i),cursor:r.cursor}}).fold(function(){return V.none()},function(e){var t=cs.render(u,e.grid());return n(u,e.grid(),l),r(u),nf.refresh(i,u,Kc.height,l),V.some({cursor:e.cursor,newRows:t.newRows,newCells:t.newCells})})}},lf=function(e,t){return Ro.cell(t.element()).bind(function(t){return af(e,t)})},sf=function(e,t){return Ro.cell(t.element()).bind(function(n){return af(e,n).map(function(e){return Fl.merge(e,{generators:t.generators,clipboard:t.clipboard})})})},ff=function(e,t){var n=Ae.map(t.selection(),function(t){return Ro.cell(t).bind(function(t){return af(e,t)})}),r=jl.cat(n);return r.length>0?V.some(Fl.merge({cells:r},{generators:t.generators,clipboard:t.clipboard})):V.none()},df=function(e,t){return t.mergable()},mf=function(e,t){return t.unmergable()},gf=function(e,t){var n=Ae.map(t.selection(),function(t){return Ro.cell(t).bind(function(t){return af(e,t)})}),r=jl.cat(n);return r.length>0?V.some(r):V.none()},pf={run:cf,toDetailList:uf,onCell:lf,onCells:gf,onPaste:sf,onPasteRows:ff,onMergable:df,onUnmergable:mf},hf=function(e){var t=function(t){return e===t},n=function(t){return hf(e)},r=function(t){return hf(e)},o=function(t){return hf(t(e))},i=function(t){t(e)},u=function(t){return t(e)},a=function(t,n){return n(e)},c=function(t){return t(e)},l=function(t){return t(e)},s=function(){return V.some(e)};return{is:t,isValue:F.always,isError:F.never,getOr:F.constant(e),getOrThunk:F.constant(e),getOrDie:F.constant(e),or:n,orThunk:r,fold:a,map:o,each:i,bind:u,exists:c,forall:l,toOption:s}},vf=function(e){var t=function(e){return e()},n=function(){return F.die(String(e))()},r=function(e){return e},o=function(e){return e()},i=function(t){return vf(e)},u=function(t){return vf(e)},a=function(t,n){return t(e)};return{is:F.never,isValue:F.never,isError:F.always,getOr:F.identity,getOrThunk:t,getOrDie:n,or:r,orThunk:o,fold:a,map:i,each:F.noop,bind:u,exists:F.never,forall:F.always,toOption:V.none}},bf={value:hf,error:vf},wf=function(e,t,n){if(e.row()>=t.length||e.column()>$l.cellLength(t[0]))return bf.error("invalid start address out of table bounds, row: "+e.row()+", column: "+e.column());var r=t.slice(e.row()),o=r[0].cells().slice(e.column()),i=$l.cellLength(n[0]),u=n.length;return bf.value({rowDelta:F.constant(r.length-u),colDelta:F.constant(o.length-i)})},yf=function(e,t){var n=$l.cellLength(e[0]),r=$l.cellLength(t[0]);return{rowDelta:F.constant(0),colDelta:F.constant(n-r)}},xf=function(e,t){return Ae.map(e,function(){return ot.elementnew(t.cell(),!0)})},Cf=function(e,t,n){return e.concat(ms.repeat(t,function(t){return $l.setCells(e[e.length-1],xf(e[e.length-1].cells(),n))}))},Sf=function(e,t,n){return Ae.map(e,function(e){return $l.setCells(e,e.cells().concat(xf(ms.range(0,t),n)))})},Rf=function(e,t,n){var r=t.colDelta()<0?Sf:F.identity;return(t.rowDelta()<0?Cf:F.identity)(r(e,Math.abs(t.colDelta()),n),Math.abs(t.rowDelta()),n)},Tf={measure:wf,measureWidth:yf,tailor:Rf},Af=function(e,t,n,r){if(0===e.length)return e;for(var o=t.startRow();o<=t.finishRow();o++)for(var i=t.startCol();i<=t.finishCol();i++)$l.mutateCell(e[o],i,ot.elementnew(r(),!1));return e},Df=function(e,t,n,r){for(var o=!0,i=0;i<e.length;i++)for(var u=0;u<$l.cellLength(e[0]);u++){var a=$l.getCellElement(e[i],u),c=n(a,t);!0===c&&!1===o?$l.mutateCell(e[i],u,ot.elementnew(r(),!0)):!0===c&&(o=!1)}return e},Ef=function(e,t){return Ae.foldl(e,function(e,n){return Ae.exists(e,function(e){return t(e.element(),n.element())})?e:e.concat([n])},[])},kf=function(e,t,n,r){if(t>0&&t<e.length){var o=e[t-1].cells(),i=Ef(o,n);Ae.each(i,function(o){for(var i=V.none(),u=t;u<e.length;u++)for(var a=0;a<$l.cellLength(e[0]);a++){var c=e[u].cells()[a],l=n(c.element(),o.element());l&&(i.isNone()&&(i=V.some(r())),i.each(function(t){$l.mutateCell(e[u],a,ot.elementnew(t,!0))}))}})}return e},Of={merge:Af,unmerge:Df,splitRows:kf},Nf=function(e,t,n,r){var o=$l.getCell(e[t],n),i=F.curry(r,o.element()),u=e[t];return e.length>1&&$l.cellLength(u)>1&&(n>0&&i($l.getCellElement(u,n-1))||n<u.length-1&&i($l.getCellElement(u,n+1))||t>0&&i($l.getCellElement(e[t-1],n))||t<e.length-1&&i($l.getCellElement(e[t+1],n)))},Bf=function(e,t,n,r,o){for(var i=e.row(),u=e.column(),a=n.length,c=$l.cellLength(n[0]),l=i+a,s=u+c,f=i;f<l;f++)for(var d=u;d<s;d++){Nf(t,f,d,o)&&Of.unmerge(t,$l.getCellElement(t[f],d),o,r.cell);var m=$l.getCellElement(n[f-i],d-u),g=r.replace(m);$l.mutateCell(t[f],d,ot.elementnew(g,!0))}return t},Pf=function(e,t,n,r,o){return Tf.measure(e,t,n).map(function(i){var u=Tf.tailor(t,i,r);return Bf(e,u,n,r,o)})},If=function(e,t,n,r,o){Of.splitRows(t,e,o,r.cell);var i=Tf.measureWidth(n,t),u=Tf.tailor(n,i,r),a=Tf.measureWidth(t,u),c=Tf.tailor(t,a,r);return c.slice(0,e).concat(u).concat(c.slice(e,c.length))},Wf={merge:Pf,insert:If},Mf=function(e,t,n,r,o){var i=e.slice(0,t),u=e.slice(t),a=$l.mapCells(e[n],function(n,i){return t>0&&t<e.length&&r($l.getCellElement(e[t-1],i),$l.getCellElement(e[t],i))?$l.getCell(e[t],i):ot.elementnew(o(n.element(),r),!0)});return i.concat([a]).concat(u)},Lf=function(e,t,n,r,o){return Ae.map(e,function(e){var i=t>0&&t<$l.cellLength(e)&&r($l.getCellElement(e,t-1),$l.getCellElement(e,t)),u=i?$l.getCell(e,t):ot.elementnew(o($l.getCellElement(e,n),r),!0);return $l.addCell(e,t,u)})},Ff=function(e,t,n,r,o){var i=n+1;return Ae.map(e,function(e,u){var a=u===t,c=a?ot.elementnew(o($l.getCellElement(e,n),r),!0):$l.getCell(e,n);return $l.addCell(e,i,c)})},qf=function(e,t,n,r,o){var i=t+1,u=e.slice(0,i),a=e.slice(i),c=$l.mapCells(e[t],function(e,t){return t===n?ot.elementnew(o(e.element(),r),!0):e});return u.concat([c]).concat(a)},zf=function(e,t,n){var r=Ae.map(e,function(e){var r=e.cells().slice(0,t).concat(e.cells().slice(n+1));return ot.rowcells(r,e.section())});return Ae.filter(r,function(e){return e.cells().length>0})},Hf=function(e,t,n){return e.slice(0,t).concat(e.slice(n+1))},jf={insertRowAt:Mf,insertColumnAt:Lf,splitCellIntoColumns:Ff,splitCellIntoRows:qf,deleteRowsAt:Hf,deleteColumnsAt:zf},_f=function(e,t,n,r){var o=function(e){return Ae.exists(t,function(t){return n(e.element(),t.element())})};return Ae.map(e,function(e){return $l.mapCells(e,function(e){return o(e)?ot.elementnew(r(e.element(),n),!0):e})})},Uf=function(e,t,n,r){return void 0!==$l.getCellElement(e[t],n)&&t>0&&r($l.getCellElement(e[t-1],n),$l.getCellElement(e[t],n))},Vf=function(e,t,n){return t>0&&n($l.getCellElement(e,t-1),$l.getCellElement(e,t))},Gf=function(e,t,n,r){var o=Ae.bind(e,function(r,o){return Uf(e,o,t,n)||Vf(r,t,n)?[]:[$l.getCell(r,t)]});return _f(e,o,n,r)},Yf=function(e,t,n,r){var o=e[t],i=Ae.bind(o.cells(),function(r,i){return Uf(e,t,i,n)||Vf(o,i,n)?[]:[r]});return _f(e,i,n,r)},Xf={replaceColumn:Gf,replaceRow:Yf},Kf=function(){return ed(function(e,t,n,r,o){return e()})},$f=function(e){return ed(function(t,n,r,o,i){return n(e)})},Jf=function(e,t){return ed(function(n,r,o,i,u){return o(e,t)})},Qf=function(e,t,n){return ed(function(r,o,i,u,a){return u(e,t,n)})},Zf=function(e,t){return ed(function(n,r,o,i,u){return u(e,t)})},ed=function(e){return{fold:e}},td={none:Kf,only:$f,left:Jf,middle:Qf,right:Zf},nd=function(e,t){return 0===e.length?td.none():1===e.length?td.only(0):0===t?td.left(0,1):t===e.length-1?td.right(t-1,t):t>0&&t<e.length-1?td.middle(t-1,t,t+1):td.none()},rd=function(e,t,n,r){var o=e.slice(0),i=nd(e,t),u=function(e){return Ae.map(e,F.constant(0))},a=F.constant(u(o)),c=function(e){return r.singleColumnWidth(o[e],n)},l=function(e,t){if(n>=0){var i=Math.max(r.minCellWidth(),o[t]-n);return u(o.slice(0,e)).concat([n,i-o[t]]).concat(u(o.slice(t+1)))}var a=Math.max(r.minCellWidth(),o[e]+n),c=o[e]-a;return u(o.slice(0,e)).concat([a-o[e],c]).concat(u(o.slice(t+1)))},s=l,f=function(e,t,n){return l(t,n)},d=function(e,t){if(n>=0)return u(o.slice(0,t)).concat([n]);var i=Math.max(r.minCellWidth(),o[t]+n);return u(o.slice(0,t)).concat([i-o[t]])};return i.fold(a,c,s,f,d)},od={determine:rd},id=function(e,t){return Pr.has(e,t)&&parseInt(Pr.get(e,t),10)>1},ud=function(e){return id(e,"colspan")},ad=function(e){return id(e,"rowspan")},cd=function(e,t){return parseInt(Zo.get(e,t),10)},ld={hasColspan:ud,hasRowspan:ad,minWidth:F.constant(10),minHeight:F.constant(10),getInt:cd},sd=function(e,t,n){return Zo.getRaw(e,t).fold(function(){return n(e)+"px"},function(e){return e})},fd=function(e){return sd(e,"width",Cc.getPixelWidth)},dd=function(e){return sd(e,"height",Cc.getHeight)},md=function(e,t,n,r,o){var i=vs.columns(e),u=Ae.map(i,function(e){return e.map(t.edge)});return Ae.map(i,function(e,t){return e.filter(F.not(ld.hasColspan)).fold(function(){var e=ms.deduce(u,t);return r(e)},function(e){return n(e,o)})})},gd=function(e){return e.map(function(e){return e+"px"}).getOr("")},pd=function(e,t){return md(e,t,fd,gd)},hd=function(e,t,n){return md(e,t,Cc.getPercentageWidth,function(e){return e.fold(function(){return n.minCellWidth()},function(e){return e/n.pixelWidth()*100})},n)},vd=function(e,t,n){return md(e,t,Cc.getPixelWidth,function(e){return e.getOrThunk(n.minCellWidth)},n)},bd=function(e,t,n,r){var o=vs.rows(e),i=Ae.map(o,function(e){return e.map(t.edge)});return Ae.map(o,function(e,t){return e.filter(F.not(ld.hasRowspan)).fold(function(){var e=ms.deduce(i,t);return r(e)},function(e){return n(e)})})},wd=function(e,t){return bd(e,t,Cc.getHeight,function(e){return e.getOrThunk(ld.minHeight)})},yd=function(e,t){return bd(e,t,dd,gd)},xd={getRawWidths:pd,getPixelWidths:vd,getPercentageWidths:hd,getPixelHeights:wd,getRawHeights:yd},Cd=function(e,t,n){for(var r=0,o=e;o<t;o++)r+=void 0!==n[o]?n[o]:0;return r},Sd=function(e,t){var n=Io.justCells(e);return Ae.map(n,function(e){var n=Cd(e.column(),e.column()+e.colspan(),t);return{element:e.element,width:F.constant(n),colspan:e.colspan}})},Rd=function(e,t){var n=Io.justCells(e);return Ae.map(n,function(e){var n=Cd(e.row(),e.row()+e.rowspan(),t);return{element:e.element,height:F.constant(n),rowspan:e.rowspan}})},Td=function(e,t){return Ae.map(e.all(),function(e,n){return{element:e.element,height:F.constant(t[n])}})},Ad={recalculateWidth:Sd,recalculateHeight:Rd,matchRowHeight:Td},Dd=function(e,t){var n=parseFloat(e),r=Va.get(t),o=function(e){return e/r*100},i=function(e,t){return[100-e]},u=function(){return ld.minWidth()/r*100},a=function(e,t,r){var o=n+r;Cc.setPercentageWidth(e,o)};return{width:F.constant(n),pixelWidth:F.constant(r),getWidths:xd.getPercentageWidths,getCellDelta:o,singleColumnWidth:i,minCellWidth:u,setElementWidth:Cc.setPercentageWidth,setTableWidth:a}},Ed=function(e){var t=parseInt(e,10),n=F.identity,r=function(e,t){return[Math.max(ld.minWidth(),e+t)-e]},o=function(e,t,n){var r=Ae.foldr(t,function(e,t){return e+t},0);Cc.setPixelWidth(e,r)};return{width:F.constant(t),pixelWidth:F.constant(t),getWidths:xd.getPixelWidths,getCellDelta:n,singleColumnWidth:r,minCellWidth:ld.minWidth,setElementWidth:Cc.setPixelWidth,setTableWidth:o}},kd=function(e,t){if(Cc.percentageBasedSizeRegex().test(t)){var n=Cc.percentageBasedSizeRegex().exec(t);return Dd(n[1],e)}if(Cc.pixelBasedSizeRegex().test(t)){var r=Cc.pixelBasedSizeRegex().exec(t);return Ed(r[1])}var o=Va.get(e);return Ed(o)},Od=function(e){return Cc.getRawWidth(e).fold(function(){var t=Va.get(e);return Ed(t)},function(t){return kd(e,t)})},Nd={getTableSize:Od},Bd=function(e){return Io.generate(e)},Pd=function(e){return Ae.foldr(e,function(e,t){return e+t},0)},Id=function(e){var t=Do.fromTable(e);return Bd(t)},Wd=function(e,t,n,r){var o=Nd.getTableSize(e),i=o.getCellDelta(t),u=Id(e),a=o.getWidths(u,r,o),c=od.determine(a,n,i,o),l=Ae.map(c,function(e,t){return e+a[t]}),s=Ad.recalculateWidth(u,l);Ae.each(s,function(e){o.setElementWidth(e.element(),e.width())}),n===u.grid().columns()-1&&o.setTableWidth(e,l,i)},Md=function(e,t,n,r){var o=Id(e),i=xd.getPixelHeights(o,r),u=Ae.map(i,function(e,r){return n===r?Math.max(t+e,ld.minHeight()):e}),a=Ad.recalculateHeight(o,u),c=Ad.matchRowHeight(o,u);Ae.each(c,function(e){Cc.setHeight(e.element(),e.height())}),Ae.each(a,function(e){Cc.setHeight(e.element(),e.height())});var l=Pd(u);Cc.setHeight(e,l)},Ld=function(e,t,n){var r=Nd.getTableSize(e),o=Bd(t),i=r.getWidths(o,n,r),u=Ad.recalculateWidth(o,i);Ae.each(u,function(e){r.setElementWidth(e.element(),e.width())});var a=Ae.foldr(i,function(e,t){return t+e},0);u.length>0&&r.setElementWidth(e,a)},Fd={adjustWidth:Wd,adjustHeight:Md,adjustWidthTo:Ld},qd=function(e){0===Ro.cells(e).length&&pi.remove(e)},zd=Ue.immutable("grid","cursor"),Hd=function(e,t,n){return jd(e,t,n).orThunk(function(){return jd(e,0,0)})},jd=function(e,t,n){return V.from(e[t]).bind(function(e){return V.from(e.cells()[n]).bind(function(e){return V.from(e.element())})})},_d=function(e,t,n){return zd(e,jd(e,t,n))},Ud=function(e){return Ae.foldl(e,function(e,t){return Ae.exists(e,function(e){return e.row()===t.row()})?e:e.concat([t])},[]).sort(function(e,t){return e.row()-t.row()})},Vd=function(e){return Ae.foldl(e,function(e,t){return Ae.exists(e,function(e){return e.column()===t.column()})?e:e.concat([t])},[]).sort(function(e,t){return e.column()-t.column()})},Gd=function(e,t,n,r){var o=t.row(),i=t.row(),u=jf.insertRowAt(e,i,o,n,r.getOrInit);return _d(u,i,t.column())},Yd=function(e,t,n,r){var o=t[0].row(),i=t[0].row(),u=Ud(t),a=Ae.foldl(u,function(e,t){return jf.insertRowAt(e,i,o,n,r.getOrInit)},e);return _d(a,i,t[0].column())},Xd=function(e,t,n,r){var o=t.row(),i=t.row()+t.rowspan(),u=jf.insertRowAt(e,i,o,n,r.getOrInit);return _d(u,i,t.column())},Kd=function(e,t,n,r){var o=Ud(t),i=o[o.length-1].row(),u=o[o.length-1].row()+o[o.length-1].rowspan(),a=Ae.foldl(o,function(e,t){return jf.insertRowAt(e,u,i,n,r.getOrInit)},e);return _d(a,u,t[0].column())},$d=function(e,t,n,r){var o=t.column(),i=t.column(),u=jf.insertColumnAt(e,i,o,n,r.getOrInit);return _d(u,t.row(),i)},Jd=function(e,t,n,r){var o=Vd(t),i=o[0].column(),u=o[0].column(),a=Ae.foldl(o,function(e,t){return jf.insertColumnAt(e,u,i,n,r.getOrInit)},e);return _d(a,t[0].row(),u)},Qd=function(e,t,n,r){var o=t.column(),i=t.column()+t.colspan(),u=jf.insertColumnAt(e,i,o,n,r.getOrInit);return _d(u,t.row(),i)},Zd=function(e,t,n,r){var o=t[t.length-1].column(),i=t[t.length-1].column()+t[t.length-1].colspan(),u=Vd(t),a=Ae.foldl(u,function(e,t){return jf.insertColumnAt(e,i,o,n,r.getOrInit)},e);return _d(a,t[0].row(),i)},em=function(e,t,n,r){var o=Xf.replaceRow(e,t.row(),n,r.replaceOrInit);return _d(o,t.row(),t.column())},tm=function(e,t,n,r){var o=Xf.replaceColumn(e,t.column(),n,r.replaceOrInit);return _d(o,t.row(),t.column())},nm=function(e,t,n,r){var o=Xf.replaceRow(e,t.row(),n,r.replaceOrInit);return _d(o,t.row(),t.column())},rm=function(e,t,n,r){var o=Xf.replaceColumn(e,t.column(),n,r.replaceOrInit);return _d(o,t.row(),t.column())},om=function(e,t,n,r){var o=jf.splitCellIntoColumns(e,t.row(),t.column(),n,r.getOrInit);return _d(o,t.row(),t.column())},im=function(e,t,n,r){var o=jf.splitCellIntoRows(e,t.row(),t.column(),n,r.getOrInit);return _d(o,t.row(),t.column())},um=function(e,t,n,r){var o=Vd(t),i=jf.deleteColumnsAt(e,o[0].column(),o[o.length-1].column()),u=Hd(i,t[0].row(),t[0].column());return zd(i,u)},am=function(e,t,n,r){var o=Ud(t),i=jf.deleteRowsAt(e,o[0].row(),o[o.length-1].row()),u=Hd(i,t[0].row(),t[0].column());return zd(i,u)},cm=function(e,t,n,r){var o=t.cells();Bl.merge(o);var i=Of.merge(e,t.bounds(),n,F.constant(o[0]));return zd(i,V.from(o[0]))},lm=function(e,t,n,r){var o=Ae.foldr(t,function(e,t){return Of.unmerge(e,t,n,r.combine(t))},e);return zd(o,V.from(t[0]))},sm=function(e,t,n,r){var o=function(e,t){var n=Do.fromTable(e),r=Io.generate(n);return os.toGrid(r,t,!0)}(t.clipboard(),t.generators()),i=ot.address(t.row(),t.column());return Wf.merge(i,e,o,t.generators(),n).fold(function(){return zd(e,V.some(t.element()))},function(e){var n=Hd(e,t.row(),t.column());return zd(e,n)})},fm=function(e,t,n){var r=Do.fromPastedRows(e,n),o=Io.generate(r);return os.toGrid(o,t,!0)},dm=function(e,t,n,r){var o=e[t.cells[0].row()],i=t.cells[0].row(),u=fm(t.clipboard(),t.generators(),o),a=Wf.insert(i,e,u,t.generators(),n),c=Hd(a,t.cells[0].row(),t.cells[0].column());return zd(a,c)},mm=function(e,t,n,r){var o=e[t.cells[0].row()],i=t.cells[t.cells.length-1].row()+t.cells[t.cells.length-1].rowspan(),u=fm(t.clipboard(),t.generators(),o),a=Wf.insert(i,e,u,t.generators(),n),c=Hd(a,t.cells[0].row(),t.cells[0].column());return zd(a,c)},gm=Fd.adjustWidthTo,pm={insertRowBefore:pf.run(Gd,pf.onCell,F.noop,F.noop,sl.modification),insertRowsBefore:pf.run(Yd,pf.onCells,F.noop,F.noop,sl.modification),insertRowAfter:pf.run(Xd,pf.onCell,F.noop,F.noop,sl.modification),insertRowsAfter:pf.run(Kd,pf.onCells,F.noop,F.noop,sl.modification),insertColumnBefore:pf.run($d,pf.onCell,gm,F.noop,sl.modification),insertColumnsBefore:pf.run(Jd,pf.onCells,gm,F.noop,sl.modification),insertColumnAfter:pf.run(Qd,pf.onCell,gm,F.noop,sl.modification),insertColumnsAfter:pf.run(Zd,pf.onCells,gm,F.noop,sl.modification),splitCellIntoColumns:pf.run(om,pf.onCell,gm,F.noop,sl.modification),splitCellIntoRows:pf.run(im,pf.onCell,F.noop,F.noop,sl.modification),eraseColumns:pf.run(um,pf.onCells,gm,qd,sl.modification),eraseRows:pf.run(am,pf.onCells,F.noop,qd,sl.modification),makeColumnHeader:pf.run(tm,pf.onCell,F.noop,F.noop,sl.transform("row","th")),unmakeColumnHeader:pf.run(rm,pf.onCell,F.noop,F.noop,sl.transform(null,"td")),makeRowHeader:pf.run(em,pf.onCell,F.noop,F.noop,sl.transform("col","th")),unmakeRowHeader:pf.run(nm,pf.onCell,F.noop,F.noop,sl.transform(null,"td")),mergeCells:pf.run(cm,pf.onMergable,F.noop,F.noop,sl.merging),unmergeCells:pf.run(lm,pf.onUnmergable,gm,F.noop,sl.merging),pasteCells:pf.run(sm,pf.onPaste,gm,F.noop,sl.modification),pasteRowsBefore:pf.run(dm,pf.onPasteRows,F.noop,F.noop,sl.modification),pasteRowsAfter:pf.run(mm,pf.onPasteRows,F.noop,F.noop,sl.modification)},hm=function(e){return st.fromDom(e.getBody())},vm=function(e){return function(t){return _n.eq(t,hm(e))}},bm=function(e){return e?e.replace(/px$/,""):""},wm=function(e){return/^[0-9]+$/.test(e)&&(e+="px"),e},ym={getBody:hm,getIsRoot:vm,addSizeSuffix:wm,removePxSuffix:bm},xm=function(e,t){return function(n){return"rtl"===Cm(n)?t:e}},Cm=function(e){return"rtl"===Zo.get(e,"direction")?"rtl":"ltr"},Sm={onDirection:xm,getDirection:Cm},Rm={isRtl:F.constant(!1)},Tm={isRtl:F.constant(!0)},Am=function(e){return"rtl"===Sm.getDirection(e)?Tm:Rm},Dm={directionAt:Am},Em=["tableprops","tabledelete","|","tableinsertrowbefore","tableinsertrowafter","tabledeleterow","|","tableinsertcolbefore","tableinsertcolafter","tabledeletecol"],km={"border-collapse":"collapse",width:"100%"},Om={border:"1"},Nm=function(e){return e.getParam("table_default_attributes",Om,"object")},Bm=function(e){return e.getParam("table_default_styles",km,"object")},Pm=function(e){return e.getParam("table_resize_bars",!0,"boolean")},Im=function(e){return e.getParam("table_tab_navigation",!0,"boolean")},Wm=function(e){return e.getParam("table_cell_advtab",!0,"boolean")},Mm=function(e){return e.getParam("table_row_advtab",!0,"boolean")},Lm=function(e){return e.getParam("table_advtab",!0,"boolean")},Fm=function(e){return e.getParam("table_appearance_options",!0,"boolean")},qm=function(e){return e.getParam("table_grid",!0,"boolean")},zm=function(e){return e.getParam("table_style_by_css",!1,"boolean")},Hm=function(e){return e.getParam("table_cell_class_list",[],"array")},jm=function(e){return e.getParam("table_row_class_list",[],"array")},_m=function(e){return e.getParam("table_class_list",[],"array")},Um=function(e){return e.getParam("color_picker_callback")},Vm=function(e){return!1===e.getParam("table_responsive_width")},Gm=function(e){var t=e.getParam("table_clone_elements");return X.isString(t)?V.some(t.split(/[ ,]/)):Array.isArray(t)?V.some(t):V.none()},Ym=function(e){var t=e.getParam("object_resizing",!0);return"table"===t||t},Xm=function(e){var t=e.getParam("table_toolbar",Em);return""===t||!1===t?[]:X.isString(t)?t.split(/[ ,]/):X.isArray(t)?t:[]},Km=function(e,t){return e.fire("newrow",{node:t})},$m=function(e,t){return e.fire("newcell",{node:t})},Jm=function(e,t){var n=function(e){return"table"===Cr.name(ym.getBody(e))},r=function(t){var r=Qc.getGridSize(t);return!1===n(e)||r.rows()>1},o=function(t){var r=Qc.getGridSize(t);return!1===n(e)||r.columns()>1},i=Gm(e),a=function(t,n,r,o){return function(a,c){var l=Kr.descendants(a,"td[data-mce-style],th[data-mce-style]");Ae.each(l,function(e){Pr.remove(e,"data-mce-style")});var s=o(),f=st.fromDom(e.getDoc()),d=u(Dm.directionAt),m=Zi.cellOperations(r,f,i);return n(a)?t(s,a,c,m,d).bind(function(t){return Ae.each(t.newRows(),function(t){Km(e,t.dom())}),Ae.each(t.newCells(),function(t){$m(e,t.dom())}),t.cursor().map(function(t){var n=e.dom.createRng();return n.setStart(t.dom(),0),n.setEnd(t.dom(),0),n})}):V.none()}};return{deleteRow:a(pm.eraseRows,r,F.noop,t),deleteColumn:a(pm.eraseColumns,o,F.noop,t),insertRowsBefore:a(pm.insertRowsBefore,F.always,F.noop,t),insertRowsAfter:a(pm.insertRowsAfter,F.always,F.noop,t),insertColumnsBefore:a(pm.insertColumnsBefore,F.always,Rc.halve,t),insertColumnsAfter:a(pm.insertColumnsAfter,F.always,Rc.halve,t),mergeCells:a(pm.mergeCells,F.always,F.noop,t),unmergeCells:a(pm.unmergeCells,F.always,F.noop,t),pasteRowsBefore:a(pm.pasteRowsBefore,F.always,F.noop,t),pasteRowsAfter:a(pm.pasteRowsAfter,F.always,F.noop,t),pasteCells:a(pm.pasteCells,F.always,F.noop,t)}},Qm=function(e,t,n){var r=Do.fromTable(e),o=Io.generate(r);return pf.onCells(o,t).map(function(e){var t=os.toGrid(o,n,!1),r=t.slice(e[0].row(),e[e.length-1].row()+e[e.length-1].rowspan()),i=pf.toDetailList(r,n);return cs.copy(i)})},Zm={copyRows:Qm},eg=tinymce.util.Tools.resolve("tinymce.util.Tools"),tg=function(e,t,n){var r,o=e.select("td,th",t);return r=function(t,r){for(var o=0;o<r.length;o++){var i=e.getStyle(r[o],n);if(void 0===t&&(t=i),t!==i)return""}return t}(r,o)},ng=function(e,t,n){n&&e.formatter.apply("align"+n,{},t)},rg=function(e,t,n){n&&e.formatter.apply("valign"+n,{},t)},og=function(e,t){
eg.each("left center right".split(" "),function(n){e.formatter.remove("align"+n,{},t)})},ig=function(e,t){eg.each("top middle bottom".split(" "),function(n){e.formatter.remove("valign"+n,{},t)})},ug={applyAlign:ng,applyVAlign:rg,unApplyAlign:og,unApplyVAlign:ig,getTDTHOverallStyle:tg},ag=function(e,t,n){var r=function(e,n){return n=n||[],eg.each(e,function(e){var o={text:e.text||e.title};e.menu?o.menu=r(e.menu):(o.value=e.value,t&&t(o)),n.push(o)}),n};return r(e,n||[])},cg=function(e,t){var n=e.dom,r=t.control.rootControl,o=r.toJSON(),i=n.parseStyle(o.style);"style"===t.control.name()?(r.find("#borderStyle").value(i["border-style"]||"")[0].fire("select"),r.find("#borderColor").value(i["border-color"]||"")[0].fire("change"),r.find("#backgroundColor").value(i["background-color"]||"")[0].fire("change"),r.find("#width").value(i.width||"").fire("change"),r.find("#height").value(i.height||"").fire("change")):(i["border-style"]=o.borderStyle,i["border-color"]=o.borderColor,i["background-color"]=o.backgroundColor,i.width=o.width?ym.addSizeSuffix(o.width):"",i.height=o.height?ym.addSizeSuffix(o.height):""),r.find("#style").value(n.serializeStyle(n.parseStyle(n.serializeStyle(i))))},lg=function(e,t){var n=e.parseStyle(e.getAttrib(t,"style")),r={};return n["border-style"]&&(r.borderStyle=n["border-style"]),n["border-color"]&&(r.borderColor=n["border-color"]),n["background-color"]&&(r.backgroundColor=n["background-color"]),r.style=e.serializeStyle(n),r},sg=function(e){var t=function(){var t=Um(e);if(t)return function(n){return t.call(e,function(e){n.control.value(e).fire("change")},n.control.value())}};return{title:"Advanced",type:"form",defaults:{onchange:F.curry(cg,e)},items:[{label:"Style",name:"style",type:"textbox"},{type:"form",padding:0,formItemDefaults:{layout:"grid",alignH:["start","right"]},defaults:{size:7},items:[{label:"Border style",type:"listbox",name:"borderStyle",width:90,onselect:F.curry(cg,e),values:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{label:"Border color",type:"colorbox",name:"borderColor",onaction:t()},{label:"Background color",type:"colorbox",name:"backgroundColor",onaction:t()}]}]}},fg={createStyleForm:sg,buildListItems:ag,updateStyleField:cg,extractAdvancedStyles:lg},dg=function(e,t){delete e.dataset.mceStyle,e.style.cssText+=";"+t},mg=function(e,t){var n=e.dom,r={width:n.getStyle(t,"width")||n.getAttrib(t,"width"),height:n.getStyle(t,"height")||n.getAttrib(t,"height"),scope:n.getAttrib(t,"scope"),class:n.getAttrib(t,"class"),type:t.nodeName.toLowerCase(),style:"",align:"",valign:""};return eg.each("left center right".split(" "),function(n){e.formatter.matchNode(t,"align"+n)&&(r.align=n)}),eg.each("top middle bottom".split(" "),function(n){e.formatter.matchNode(t,"valign"+n)&&(r.valign=n)}),Wm(e)&&eg.extend(r,fg.extractAdvancedStyles(n,t)),r},gg=function(e,t,n){function r(e,t,n){n&&u.setAttrib(e,t,n)}function o(e,t,n){n&&u.setStyle(e,t,n)}var i,u=e.dom;fg.updateStyleField(e,n),i=n.control.rootControl.toJSON(),e.undoManager.transact(function(){eg.each(t,function(n){r(n,"scope",i.scope),1===t.length?r(n,"style",i.style):dg(n,i.style),r(n,"class",i.class),o(n,"width",ym.addSizeSuffix(i.width)),o(n,"height",ym.addSizeSuffix(i.height)),i.type&&n.nodeName.toLowerCase()!==i.type&&(n=u.rename(n,i.type)),1===t.length&&(ug.unApplyAlign(e,n),ug.unApplyVAlign(e,n)),i.align&&ug.applyAlign(e,n,i.align),i.valign&&ug.applyVAlign(e,n,i.valign)}),e.focus()})},pg=function(e){var t,n,r,o=[];if(o=e.dom.select("td[data-mce-selected],th[data-mce-selected]"),t=e.dom.getParent(e.selection.getStart(),"td,th"),!o.length&&t&&o.push(t),t=t||o[0]){n=o.length>1?{width:"",height:"",scope:"",class:"",align:"",valign:"",style:"",type:t.nodeName.toLowerCase()}:mg(e,t),Hm(e).length>0&&(r={name:"class",type:"listbox",label:"Class",values:fg.buildListItems(Hm(e),function(t){t.value&&(t.textStyle=function(){return e.formatter.getCssText({block:"td",classes:[t.value]})})})});var i={type:"form",layout:"flex",direction:"column",labelGapCalc:"children",padding:0,items:[{type:"form",layout:"grid",columns:2,labelGapCalc:!1,padding:0,defaults:{type:"textbox",maxWidth:50},items:[{label:"Width",name:"width",onchange:F.curry(fg.updateStyleField,e)},{label:"Height",name:"height",onchange:F.curry(fg.updateStyleField,e)},{label:"Cell type",name:"type",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{label:"Scope",name:"scope",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{label:"H Align",name:"align",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"V Align",name:"valign",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}]},r]};Wm(e)?e.windowManager.open({title:"Cell properties",bodyType:"tabpanel",data:n,body:[{title:"General",type:"form",items:i},fg.createStyleForm(e)],onsubmit:F.curry(gg,e,o)}):e.windowManager.open({title:"Cell properties",data:n,body:i,onsubmit:F.curry(gg,e,o)})}},hg={open:pg},vg=function(e,t){var n=e.dom,r={height:n.getStyle(t,"height")||n.getAttrib(t,"height"),scope:n.getAttrib(t,"scope"),class:n.getAttrib(t,"class"),align:"",style:"",type:t.parentNode.nodeName.toLowerCase()};return eg.each("left center right".split(" "),function(n){e.formatter.matchNode(t,"align"+n)&&(r.align=n)}),Mm(e)&&eg.extend(r,fg.extractAdvancedStyles(n,t)),r},bg=function(e,t,n){var r=e.getParent(t,"table"),o=t.parentNode,i=e.select(n,r)[0];i||(i=e.create(n),r.firstChild?"CAPTION"===r.firstChild.nodeName?e.insertAfter(i,r.firstChild):r.insertBefore(i,r.firstChild):r.appendChild(i)),i.appendChild(t),o.hasChildNodes()||e.remove(o)},wg=function(e){var t,n,r,o,i,u,a=e.dom,l=[];t=a.getParent(e.selection.getStart(),"table"),n=a.getParent(e.selection.getStart(),"td,th"),eg.each(t.rows,function(e){eg.each(e.cells,function(t){if(a.getAttrib(t,"data-mce-selected")||t===n)return l.push(e),!1})}),(r=l[0])&&(i=l.length>1?{height:"",scope:"",style:"",class:"",align:"",type:r.parentNode.nodeName.toLowerCase()}:vg(e,r),jm(e).length>0&&(o={name:"class",type:"listbox",label:"Class",values:fg.buildListItems(jm(e),function(t){t.value&&(t.textStyle=function(){return e.formatter.getCssText({block:"tr",classes:[t.value]})})})}),u={type:"form",columns:2,padding:0,defaults:{type:"textbox"},items:[{type:"listbox",name:"type",label:"Row type",text:"Header",maxWidth:null,values:[{text:"Header",value:"thead"},{text:"Body",value:"tbody"},{text:"Footer",value:"tfoot"}]},{type:"listbox",name:"align",label:"Alignment",text:"None",maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height"},o]},Mm(e)?e.windowManager.open({title:"Row properties",data:i,bodyType:"tabpanel",body:[{title:"General",type:"form",items:u},fg.createStyleForm(e)],onsubmit:F.curry(c,e,l,i)}):e.windowManager.open({title:"Row properties",data:i,body:u,onsubmit:F.curry(c,e,l,i)}))},yg={open:wg},xg=tinymce.util.Tools.resolve("tinymce.Env"),Cg={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},percentages:!0},Sg=function(){return st.fromTag("table")},Rg=function(){return st.fromTag("tbody")},Tg=function(){return st.fromTag("tr")},Ag=function(){return st.fromTag("th")},Dg=function(){return st.fromTag("td")},Eg=function(e,t,n,r,o){void 0===o&&(o=Cg);var i=Sg();Zo.setAll(i,o.styles),Pr.setAll(i,o.attributes);var u=Rg();ui.append(i,u);for(var a=[],c=0;c<e;c++){for(var l=Tg(),s=0;s<t;s++){var f=c<n||s<r?Ag():Dg();s<r&&Pr.set(f,"scope","row"),c<n&&Pr.set(f,"scope","col"),ui.append(f,st.fromTag("br")),o.percentages&&Zo.set(f,"width",100/t+"%"),ui.append(l,f)}a.push(l)}return fi.append(u,a),i},kg=function(e){return e.dom().innerHTML},Og=function(e,t){var n=sr.owner(e),r=n.dom(),o=st.fromDom(r.createDocumentFragment()),i=ou.fromHtml(t,r);fi.append(o,i),pi.empty(e),ui.append(e,o)},Ng=function(e){var t=st.fromTag("div"),n=st.fromDom(e.dom().cloneNode(!0));return ui.append(t,n),kg(t)},Bg={get:kg,set:Og,getOuter:Ng},Pg=function(e,t){e.selection.select(t.dom(),!0),e.selection.collapse(!0)},Ig=function(e,t){lo.descendant(t,"td,th").each(F.curry(Pg,e))},Wg=function(e,t){Ae.each(Kr.descendants(t,"tr"),function(t){Km(e,t.dom()),Ae.each(Kr.descendants(t,"th,td"),function(t){$m(e,t.dom())})})},Mg=function(e){return X.isString(e)&&-1!==e.indexOf("%")},Lg=function(e,t,n){var r=Bm(e),o={styles:r,attributes:Nm(e),percentages:Mg(r.width)&&!Vm(e)},i=Eg(n,t,0,0,o);Pr.set(i,"data-mce-id","__mce");var u=Bg.getOuter(i);return e.insertContent(u),lo.descendant(ym.getBody(e),'table[data-mce-id="__mce"]').map(function(t){return Vm(e)&&Zo.set(t,"width",Zo.get(t,"width")),Pr.remove(t,"data-mce-id"),Wg(e,t),Ig(e,t),t.dom()}).getOr(null)},Fg={insert:Lg},qg=function(e,t){var n=e.dom,r={width:n.getStyle(t,"width")||n.getAttrib(t,"width"),height:n.getStyle(t,"height")||n.getAttrib(t,"height"),cellspacing:n.getStyle(t,"border-spacing")||n.getAttrib(t,"cellspacing"),cellpadding:n.getAttrib(t,"data-mce-cell-padding")||n.getAttrib(t,"cellpadding")||ug.getTDTHOverallStyle(e.dom,t,"padding"),border:n.getAttrib(t,"data-mce-border")||n.getAttrib(t,"border")||ug.getTDTHOverallStyle(e.dom,t,"border"),borderColor:n.getAttrib(t,"data-mce-border-color"),caption:!!n.select("caption",t)[0],class:n.getAttrib(t,"class")};return eg.each("left center right".split(" "),function(n){e.formatter.matchNode(t,"align"+n)&&(r.align=n)}),Lm(e)&&eg.extend(r,fg.extractAdvancedStyles(n,t)),r},zg=function(e,t,n){var r=e.dom,o={},i={};if(o.class=n.class,i.height=ym.addSizeSuffix(n.height),r.getAttrib(t,"width")&&!zm(e)?o.width=ym.removePxSuffix(n.width):i.width=ym.addSizeSuffix(n.width),zm(e)?(i["border-width"]=ym.addSizeSuffix(n.border),i["border-spacing"]=ym.addSizeSuffix(n.cellspacing),eg.extend(o,{"data-mce-border-color":n.borderColor,"data-mce-cell-padding":n.cellpadding,"data-mce-border":n.border})):eg.extend(o,{border:n.border,cellpadding:n.cellpadding,cellspacing:n.cellspacing}),zm(e)&&t.children)for(var u=0;u<t.children.length;u++)l(r,t.children[u],{"border-width":ym.addSizeSuffix(n.border),"border-color":n.borderColor,padding:ym.addSizeSuffix(n.cellpadding)});n.style?eg.extend(i,r.parseStyle(n.style)):i=eg.extend({},r.parseStyle(r.getAttrib(t,"style")),i),o.style=r.serializeStyle(i),r.setAttribs(t,o)},Hg=function(e,t,n){var r,o,i=e.dom;fg.updateStyleField(e,n),o=n.control.rootControl.toJSON(),!1===o.class&&delete o.class,e.undoManager.transact(function(){t||(t=Fg.insert(e,o.cols||1,o.rows||1)),zg(e,t,o),r=i.select("caption",t)[0],r&&!o.caption&&i.remove(r),!r&&o.caption&&(r=i.create("caption"),r.innerHTML=xg.ie?" ":'<br data-mce-bogus="1"/>',t.insertBefore(r,t.firstChild)),ug.unApplyAlign(e,t),o.align&&ug.applyAlign(e,t,o.align),e.focus(),e.addVisual()})},jg=function(e,t){var n,r,o,i,u,a=e.dom,c={};!0===t?(n=a.getParent(e.selection.getStart(),"table"))&&(c=qg(e,n)):(r={label:"Cols",name:"cols"},o={label:"Rows",name:"rows"}),_m(e).length>0&&(c.class&&(c.class=c.class.replace(/\s*mce\-item\-table\s*/g,"")),i={name:"class",type:"listbox",label:"Class",values:fg.buildListItems(_m(e),function(t){t.value&&(t.textStyle=function(){return e.formatter.getCssText({block:"table",classes:[t.value]})})})}),u={type:"form",layout:"flex",direction:"column",labelGapCalc:"children",padding:0,items:[{type:"form",labelGapCalc:!1,padding:0,layout:"grid",columns:2,defaults:{type:"textbox",maxWidth:50},items:Fm(e)?[r,o,{label:"Width",name:"width",onchange:F.curry(fg.updateStyleField,e)},{label:"Height",name:"height",onchange:F.curry(fg.updateStyleField,e)},{label:"Cell spacing",name:"cellspacing"},{label:"Cell padding",name:"cellpadding"},{label:"Border",name:"border"},{label:"Caption",name:"caption",type:"checkbox"}]:[r,o,{label:"Width",name:"width",onchange:F.curry(fg.updateStyleField,e)},{label:"Height",name:"height",onchange:F.curry(fg.updateStyleField,e)}]},{label:"Alignment",name:"align",type:"listbox",text:"None",values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},i]},Lm(e)?e.windowManager.open({title:"Table properties",data:c,bodyType:"tabpanel",body:[{title:"General",type:"form",items:u},fg.createStyleForm(e)],onsubmit:F.curry(Hg,e,n)}):e.windowManager.open({title:"Table properties",data:c,body:u,onsubmit:F.curry(Hg,e,n)})},_g={open:jg},Ug=eg.each,Vg=function(e,t,n,r,o){var i=ym.getIsRoot(e),u=function(){var t=st.fromDom(e.dom.getParent(e.selection.getStart(),"th,td"));Ro.table(t,i).filter(F.not(i)).each(function(t){var n=st.fromText("");ui.after(t,n),pi.remove(t);var r=e.dom.createRng();r.setStart(n.dom(),0),r.setEnd(n.dom(),0),e.selection.setRng(r)})},a=function(){return st.fromDom(e.dom.getParent(e.selection.getStart(),"th,td"))},c=function(e){return Ro.table(e,i)},l=function(t){var o=a();c(o).each(function(i){var u=ka.forMenu(r,i,o);t(i,u).each(function(t){e.selection.setRng(t),e.focus(),n.clear(i)})})},s=function(t){var n=a();return c(n).bind(function(t){var o=st.fromDom(e.getDoc()),i=ka.forMenu(r,t,n),u=Zi.cellOperations(F.noop,o,V.none());return Zm.copyRows(t,i,u)})},f=function(t){o.get().each(function(o){var i=Ae.map(o,function(e){return ki.deep(e)}),u=a();c(u).bind(function(o){var a=st.fromDom(e.getDoc()),c=Zi.paste(a),l=ka.pasteRows(r,o,u,i,c);t(o,l).each(function(t){e.selection.setRng(t),e.focus(),n.clear(o)})})})};Ug({mceTableSplitCells:function(){l(t.unmergeCells)},mceTableMergeCells:function(){l(t.mergeCells)},mceTableInsertRowBefore:function(){l(t.insertRowsBefore)},mceTableInsertRowAfter:function(){l(t.insertRowsAfter)},mceTableInsertColBefore:function(){l(t.insertColumnsBefore)},mceTableInsertColAfter:function(){l(t.insertColumnsAfter)},mceTableDeleteCol:function(){l(t.deleteColumn)},mceTableDeleteRow:function(){l(t.deleteRow)},mceTableCutRow:function(e){o.set(s()),l(t.deleteRow)},mceTableCopyRow:function(e){o.set(s())},mceTablePasteRowBefore:function(e){f(t.pasteRowsBefore)},mceTablePasteRowAfter:function(e){f(t.pasteRowsAfter)},mceTableDelete:u},function(t,n){e.addCommand(n,t)}),Ug({mceInsertTable:F.curry(_g.open,e),mceTableProps:F.curry(_g.open,e,!0),mceTableRowProps:F.curry(yg.open,e),mceTableCellProps:F.curry(hg.open,e)},function(t,n){e.addCommand(n,function(e,n){t(n)})})},Gg={registerCommands:Vg},Yg=function(e){var t=V.from(e.dom().documentElement).map(st.fromDom).getOr(e);return{parent:F.constant(t),view:F.constant(e),origin:F.constant(Ec(0,0))}},Xg=function(e,t){var n=F.curry(Ic.absolute,t);return{parent:F.constant(t),view:F.constant(e),origin:n}},Kg=function(e,t){return{parent:F.constant(t),view:F.constant(e),origin:F.constant(Ec(0,0))}},$g={only:Yg,detached:Xg,body:Kg},Jg=function(e){return{registry:Me.map(e,function(e){return{bind:e.bind,unbind:e.unbind}}),trigger:Me.map(e,function(e){return e.trigger})}},Qg={create:Jg},Zg=ol.exactly(["compare","extract","mutate","sink"]),ep=ol.exactly(["element","start","stop","destroy"]),tp=ol.exactly(["forceDrop","drop","move","delayDrop"]),np={mode:Zg,sink:ep,api:tp},rp=Cs.css("ephox-dragster"),op={resolve:rp.resolve},ip=function(e,t,n,r,o,i,u){return{target:F.constant(e),x:F.constant(t),y:F.constant(n),stop:r,prevent:o,kill:i,raw:F.constant(u)}},up=function(e,t){return function(n){if(e(n)){var r=st.fromDom(n.target),o=function(){n.stopPropagation()},i=function(){n.preventDefault()},u=F.compose(i,o),a=ip(r,n.clientX,n.clientY,o,i,u,n);t(a)}}},ap=function(e,t,n,r,o){var i=up(n,r);return e.dom().addEventListener(t,i,o),{unbind:F.curry(sp,e,t,i,o)}},cp=function(e,t,n,r){return ap(e,t,n,r,!1)},lp=function(e,t,n,r){return ap(e,t,n,r,!0)},sp=function(e,t,n,r){e.dom().removeEventListener(t,n,r)},fp={bind:cp,capture:lp},dp=F.constant(!0),mp=function(e,t,n){return fp.bind(e,t,dp,n)},gp=function(e,t,n){return fp.capture(e,t,dp,n)},pp={bind:mp,capture:gp},hp=function(e,t){return Ec(t.left()-e.left(),t.top()-e.top())},vp=function(e){return V.some(Ec(e.x(),e.y()))},bp=function(e,t){e.mutate(t.left(),t.top())},wp=function(e,t){var n=f(t),r=pp.bind(n.element(),"mousedown",e.forceDrop),o=pp.bind(n.element(),"mouseup",e.drop),i=pp.bind(n.element(),"mousemove",e.move),u=pp.bind(n.element(),"mouseout",e.delayDrop),a=function(){n.destroy(),o.unbind(),i.unbind(),u.unbind(),r.unbind()},c=function(e){ui.append(e,n.element())},l=function(){pi.remove(n.element())};return np.sink({element:n.element,start:c,stop:l,destroy:a})},yp=np.mode({compare:hp,extract:vp,sink:wp,mutate:bp}),xp=function(e,t){var n=null,r=null;return{cancel:function(){null!==n&&(clearTimeout(n),n=null,r=null)},throttle:function(){r=arguments,null===n&&(n=setTimeout(function(){e.apply(null,r),n=null,r=null},t))}}},Cp=function(e,t){var n=null;return{cancel:function(){null!==n&&(clearTimeout(n),n=null)},throttle:function(){var r=arguments;null===n&&(n=setTimeout(function(){e.apply(null,r),n=null,r=null},t))}}},Sp=function(e,t){var n=null;return{cancel:function(){null!==n&&(clearTimeout(n),n=null)},throttle:function(){var r=arguments;null!==n&&clearTimeout(n),n=setTimeout(function(){e.apply(null,r),n=null,r=null},t)}}},Rp={adaptable:xp,first:Cp,last:Sp},Tp=function(e,t,n){var r=!1,o=Qg.create({start:s([]),stop:s([])}),i=g(),u=function(){p.stop(),i.isOn()&&(i.off(),o.trigger.stop())},a=Rp.last(u,200),c=function(e){p.start(e),i.on(),o.trigger.start()},l=function(e,n){a.cancel(),i.onEvent(e,t)};i.events.move.bind(function(n){t.mutate(e,n.info())});var f=function(){r=!0},d=function(){r=!1},m=function(e){return function(){var t=Array.prototype.slice.call(arguments,0);if(r)return e.apply(null,t)}},p=t.sink(np.api({forceDrop:u,drop:m(u),move:m(l),delayDrop:m(a.throttle)}),n),h=function(){p.destroy()};return{element:p.element,go:c,on:f,off:d,destroy:h,events:o.registry}},Ap={setup:Tp},Dp=function(e,t){var n=void 0!==t?t:{},r=void 0!==n.mode?n.mode:yp;return Ap.setup(e,r,t)},Ep={transform:Dp},kp=function(e){return lo.first(e).isSome()},Op=function(e,t,n){return lo.ancestor(e,t,n).isSome()},Np=function(e,t){return lo.sibling(e,t).isSome()},Bp=function(e,t){return lo.child(e,t).isSome()},Pp=function(e,t){return lo.descendant(e,t).isSome()},Ip=function(e,t,n){return lo.closest(e,t,n).isSome()},Wp={any:kp,ancestor:Op,sibling:Np,child:Bp,descendant:Pp,closest:Ip},Mp=Rs.resolve("resizer-bar-dragging"),Lp=function(){var e=st.fromTag("div");return Zo.setAll(e,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),ui.append(Lr.body(),e),e},Fp=function(e,t){return e.inline?$g.body(ym.getBody(e),Lp()):$g.only(st.fromDom(e.getDoc()))},qp=function(e,t){e.inline&&pi.remove(t.parent())},zp={get:Fp,remove:qp},Hp=function(e){var t,n,r=V.none(),o=V.none(),i=V.none(),a=/(\d+(\.\d+)?)%/,c=function(e){return"TABLE"===e.nodeName},l=function(t){return e.dom.getStyle(t,"width")||e.dom.getAttrib(t,"width")},s=function(){return o},f=function(){return i.getOr($g.only(st.fromDom(e.getBody())))},d=function(){o.each(function(e){e.destroy()}),i.each(function(t){zp.remove(e,t)})};return e.on("init",function(){var t=u(Dm.directionAt),n=zp.get(e);if(i=V.some(n),Ym(e)&&Pm(e)){var a=b(n,t);a.on(),a.events.startDrag.bind(function(t){r=V.some(e.selection.getRng())}),a.events.afterResize.bind(function(t){var n=t.table(),o=Kr.descendants(n,"td[data-mce-style],th[data-mce-style]");Ae.each(o,function(e){Pr.remove(e,"data-mce-style")}),r.each(function(t){e.selection.setRng(t),e.focus()}),e.undoManager.add()}),o=V.some(a)}}),e.on("ObjectResizeStart",function(e){var r=e.target;c(r)&&(t=e.width,n=l(r))}),e.on("ObjectResized",function(r){var o=r.target;if(c(o)){var i=o;if(a.test(n)){var u=parseFloat(a.exec(n)[1]),l=r.width*u/t;e.dom.setStyle(i,"width",l+"%")}else{var s=[];eg.each(i.rows,function(t){eg.each(t.cells,function(t){var n=e.dom.getStyle(t,"width",!0);s.push({cell:t,width:n})})}),eg.each(s,function(t){e.dom.setStyle(t.cell,"width",t.width),e.dom.setAttrib(t.cell,"width",null)})}}}),{lazyResize:s,lazyWire:f,destroy:d}},jp=function(e){return Gp(function(t,n,r,o){return t(e)})},_p=function(e){return Gp(function(t,n,r,o){return n(e)})},Up=function(e,t){return Gp(function(n,r,o,i){return o(e,t)})},Vp=function(e){return Gp(function(t,n,r,o){return o(e)})},Gp=function(e){return{fold:e}},Yp={none:jp,first:_p,middle:Up,last:Vp},Xp=function(e,t){return Ro.table(e,t).bind(function(t){var n=Ro.cells(t);return Ae.findIndex(n,function(t){return _n.eq(e,t)}).map(function(e){return{index:F.constant(e),all:F.constant(n)}})})},Kp=function(e,t){return Xp(e,t).fold(function(){return Yp.none(e)},function(t){return t.index()+1<t.all().length?Yp.middle(e,t.all()[t.index()+1]):Yp.last(e)})},$p=function(e,t){return Xp(e,t).fold(function(){return Yp.none()},function(t){return t.index()-1>=0?Yp.middle(e,t.all()[t.index()-1]):Yp.first(e)})},Jp={next:Kp,prev:$p},Qp=ha.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Zp=function(e,t,n,r){return e.fold(t,n,r)},eh=function(e){return e.fold(F.identity,F.identity,F.identity)},th={before:Qp.before,on:Qp.on,after:Qp.after,cata:Zp,getStart:eh},nh=ha.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),rh=Ue.immutable("start","soffset","finish","foffset"),oh=function(e){return nh.exact(e.start(),e.soffset(),e.finish(),e.foffset())},ih=function(e){return e.match({domRange:function(e){return st.fromDom(e.startContainer)},relative:function(e,t){return th.getStart(e)},exact:function(e,t,n,r){return e}})},uh=function(e){var t=ih(e);return sr.defaultView(t)},ah={domRange:nh.domRange,relative:nh.relative,exact:nh.exact,exactFromRange:oh,range:rh,getWin:uh},ch=function(e,t,n,r){var o=sr.owner(e),i=o.dom().createRange();return i.setStart(e.dom(),t),i.setEnd(n.dom(),r),i},lh=function(e,t,n,r){var o=ch(e,t,n,r);return st.fromDom(o.commonAncestorContainer)},sh=function(e,t,n,r){var o=ch(e,t,n,r),i=_n.eq(e,n)&&t===r;return o.collapsed&&!i},fh={after:sh,commonAncestorContainer:lh},dh=function(e,t){var n=t||document,r=n.createDocumentFragment();return Ae.each(e,function(e){r.appendChild(e.dom())}),st.fromDom(r)},mh={fromElements:dh},gh=function(e,t){var n=e.document.createRange();return ph(n,t),n},ph=function(e,t){e.selectNodeContents(t.dom())},hh=function(e,t){return t.compareBoundaryPoints(e.END_TO_START,e)<1&&t.compareBoundaryPoints(e.START_TO_END,e)>-1},vh=function(e){return e.document.createRange()},bh=function(e,t){t.fold(function(t){e.setStartBefore(t.dom())},function(t,n){e.setStart(t.dom(),n)},function(t){e.setStartAfter(t.dom())})},wh=function(e,t){t.fold(function(t){e.setEndBefore(t.dom())},function(t,n){e.setEnd(t.dom(),n)},function(t){e.setEndAfter(t.dom())})},yh=function(e,t){Sh(e),e.insertNode(t.dom())},xh=function(e,t,n){var r=e.document.createRange();return bh(r,t),wh(r,n),r},Ch=function(e,t,n,r,o){var i=e.document.createRange();return i.setStart(t.dom(),n),i.setEnd(r.dom(),o),i},Sh=function(e){e.deleteContents()},Rh=function(e){var t=e.cloneContents();return st.fromDom(t)},Th=function(e){return{left:F.constant(e.left),top:F.constant(e.top),right:F.constant(e.right),bottom:F.constant(e.bottom),width:F.constant(e.width),height:F.constant(e.height)}},Ah=function(e){var t=e.getClientRects(),n=t.length>0?t[0]:e.getBoundingClientRect();return n.width>0||n.height>0?V.some(n).map(Th):V.none()},Dh=function(e){var t=e.getBoundingClientRect();return t.width>0||t.height>0?V.some(t).map(Th):V.none()},Eh=function(e){return e.toString()},kh={create:vh,replaceWith:yh,selectNodeContents:gh,selectNodeContentsUsing:ph,relativeToNative:xh,exactToNative:Ch,deleteContents:Sh,cloneFragment:Rh,getFirstRect:Ah,getBounds:Dh,isWithin:hh,toString:Eh},Oh=ha.generate([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Nh=function(e,t,n){return t(st.fromDom(n.startContainer),n.startOffset,st.fromDom(n.endContainer),n.endOffset)},Bh=function(e,t){return t.match({domRange:function(e){return{ltr:F.constant(e),rtl:V.none}},relative:function(t,n){return{ltr:Lt.cached(function(){return kh.relativeToNative(e,t,n)}),rtl:Lt.cached(function(){return V.some(kh.relativeToNative(e,n,t))})}},exact:function(t,n,r,o){return{ltr:Lt.cached(function(){return kh.exactToNative(e,t,n,r,o)}),rtl:Lt.cached(function(){return V.some(kh.exactToNative(e,r,o,t,n))})}}})},Ph=function(e,t){var n=t.ltr();if(n.collapsed){return t.rtl().filter(function(e){return!1===e.collapsed}).map(function(e){return Oh.rtl(st.fromDom(e.endContainer),e.endOffset,st.fromDom(e.startContainer),e.startOffset)}).getOrThunk(function(){return Nh(0,Oh.ltr,n)})}return Nh(0,Oh.ltr,n)},Ih=function(e,t){var n=Bh(e,t);return Ph(0,n)},Wh=function(e,t){return Ih(e,t).match({ltr:function(t,n,r,o){var i=e.document.createRange();return i.setStart(t.dom(),n),i.setEnd(r.dom(),o),i},rtl:function(t,n,r,o){var i=e.document.createRange();return i.setStart(r.dom(),o),i.setEnd(t.dom(),n),i}})},Mh={ltr:Oh.ltr,rtl:Oh.rtl,diagnose:Ih,asLtrRange:Wh},Lh=function(e,t,n,r,o){if(0===o)return 0;if(t===r)return o-1;for(var i=r,u=1;u<o;u++){var a=e(u),c=Math.abs(t-a.left);if(n>a.bottom);else{if(n<a.top||c>i)return u-1;i=c}}return 0},Fh=function(e,t,n){return t>=e.left&&t<=e.right&&n>=e.top&&n<=e.bottom},qh={inRect:Fh,searchForPoint:Lh},zh=function(e,t,n,r,o){var i=function(n){var r=e.dom().createRange();return r.setStart(t.dom(),n),r.collapse(!0),r},u=function(e){return i(e).getBoundingClientRect()},a=Ii.get(t).length,c=qh.searchForPoint(u,n,r,o.right,a);return i(c)},Hh=function(e,t,n,r){var o=e.dom().createRange();o.selectNode(t.dom());var i=o.getClientRects();return jl.findMap(i,function(e){return qh.inRect(e,n,r)?V.some(e):V.none()}).map(function(o){return zh(e,t,n,r,o)})},jh={locate:Hh},_h=function(e,t,n,r){var o=e.dom().createRange(),i=sr.children(t);return jl.findMap(i,function(t){return o.selectNode(t.dom()),qh.inRect(o.getBoundingClientRect(),n,r)?Uh(e,t,n,r):V.none()})},Uh=function(e,t,n,r){return(Cr.isText(t)?jh.locate:_h)(e,t,n,r)},Vh=function(e,t,n,r){var o=e.dom().createRange();o.selectNode(t.dom());var i=o.getBoundingClientRect(),u=Math.max(i.left,Math.min(i.right,n)),a=Math.max(i.top,Math.min(i.bottom,r));return Uh(e,t,u,a)},Gh={locate:Vh},Yh=function(e,t){return t-e.left<e.right-t},Xh=function(e,t,n){var r=e.dom().createRange();return r.selectNode(t.dom()),r.collapse(n),r},Kh=function(e,t,n){var r=e.dom().createRange();r.selectNode(t.dom());var o=r.getBoundingClientRect(),i=Yh(o,n);return(!0===i?Vi.first:Vi.last)(t).map(function(t){return Xh(e,t,i)})},$h=function(e,t,n){var r=t.dom().getBoundingClientRect(),o=Yh(r,n);return V.some(Xh(e,t,o))},Jh=function(e,t,n){return(0===sr.children(t).length?$h:Kh)(e,t,n)},Qh={search:Jh},Zh=function(e,t,n){return V.from(e.dom().caretPositionFromPoint(t,n)).bind(function(t){if(null===t.offsetNode)return V.none();var n=e.dom().createRange();return n.setStart(t.offsetNode,t.offset),n.collapse(),V.some(n)})},ev=function(e,t,n){return V.from(e.dom().caretRangeFromPoint(t,n))},tv=function(e,t,n,r){var o=e.dom().createRange();o.selectNode(t.dom());var i=o.getBoundingClientRect(),u=Math.max(i.left,Math.min(i.right,n)),a=Math.max(i.top,Math.min(i.bottom,r));return Gh.locate(e,t,u,a)},nv=function(e,t,n){return st.fromPoint(e,t,n).bind(function(r){var o=function(){return Qh.search(e,r,t)};return 0===sr.children(r).length?o():tv(e,r,t,n).orThunk(o)})},rv=document.caretPositionFromPoint?Zh:document.caretRangeFromPoint?ev:nv,ov=function(e,t,n){var r=st.fromDom(e.document);return rv(r,t,n).map(function(e){return ah.range(st.fromDom(e.startContainer),e.startOffset,st.fromDom(e.endContainer),e.endOffset)})},iv={fromPoint:ov},uv=function(e,t,n,r){var o=kh.create(e),i=bt.is(t,r)?[t]:[],u=i.concat(Kr.descendants(t,r));return Ae.filter(u,function(e){return kh.selectNodeContentsUsing(o,e),kh.isWithin(n,o)})},av=function(e,t,n){var r=Mh.asLtrRange(e,t),o=st.fromDom(r.commonAncestorContainer);return Cr.isElement(o)?uv(e,o,r,n):[]},cv={find:av},lv=function(e,t){var n=Cr.name(e);return"input"===n?th.after(e):Ae.contains(["br","img"],n)?0===t?th.before(e):th.after(e):th.on(e,t)},sv=function(e,t){var n=e.fold(th.before,lv,th.after),r=t.fold(th.before,lv,th.after);return ah.relative(n,r)},fv=function(e,t,n,r){var o=lv(e,t),i=lv(n,r);return ah.relative(o,i)},dv=function(e){return e.match({domRange:function(e){var t=st.fromDom(e.startContainer),n=st.fromDom(e.endContainer);return fv(t,e.startOffset,n,e.endOffset)},relative:sv,exact:fv})},mv={beforeSpecial:lv,preprocess:dv,preprocessRelative:sv,preprocessExact:fv},gv=function(e,t){V.from(e.getSelection()).each(function(e){e.removeAllRanges(),e.addRange(t)})},pv=function(e,t,n,r,o){var i=kh.exactToNative(e,t,n,r,o);gv(e,i)},hv=function(e,t,n){return cv.find(e,t,n)},vv=function(e,t){return Mh.diagnose(e,t).match({ltr:function(t,n,r,o){pv(e,t,n,r,o)},rtl:function(t,n,r,o){var i=e.getSelection();i.setBaseAndExtent?i.setBaseAndExtent(t.dom(),n,r.dom(),o):i.extend?(i.collapse(t.dom(),n),i.extend(r.dom(),o)):pv(e,r,o,t,n)}})},bv=function(e,t,n,r,o){var i=mv.preprocessExact(t,n,r,o);vv(e,i)},wv=function(e,t,n){var r=mv.preprocessRelative(t,n);vv(e,r)},yv=function(e){var t=ah.getWin(e).dom(),n=function(e,n,r,o){return kh.exactToNative(t,e,n,r,o)},r=mv.preprocess(e);return Mh.diagnose(t,r).match({ltr:n,rtl:n})},xv=function(e){if(e.rangeCount>0){var t=e.getRangeAt(0),n=e.getRangeAt(e.rangeCount-1);return V.some(ah.range(st.fromDom(t.startContainer),t.startOffset,st.fromDom(n.endContainer),n.endOffset))}return V.none()},Cv=function(e){var t=st.fromDom(e.anchorNode),n=st.fromDom(e.focusNode);return fh.after(t,e.anchorOffset,n,e.focusOffset)?V.some(ah.range(st.fromDom(e.anchorNode),e.anchorOffset,st.fromDom(e.focusNode),e.focusOffset)):xv(e)},Sv=function(e,t){var n=kh.selectNodeContents(e,t);gv(e,n)},Rv=function(e,t){var n=kh.selectNodeContents(e,t);return ah.range(st.fromDom(n.startContainer),n.startOffset,st.fromDom(n.endContainer),n.endOffset)},Tv=function(e){var t=e.getSelection();return t.rangeCount>0?Cv(t):V.none()},Av=function(e){return Tv(e).map(function(e){return ah.exact(e.start(),e.soffset(),e.finish(),e.foffset())})},Dv=function(e,t){var n=Mh.asLtrRange(e,t);return kh.getFirstRect(n)},Ev=function(e,t){var n=Mh.asLtrRange(e,t);return kh.getBounds(n)},kv=function(e,t,n){return iv.fromPoint(e,t,n)},Ov=function(e,t){var n=Mh.asLtrRange(e,t);return kh.toString(n)},Nv=function(e){e.getSelection().removeAllRanges()},Bv=function(e,t){var n=Mh.asLtrRange(e,t);return kh.cloneFragment(n)},Pv=function(e,t,n){var r=Mh.asLtrRange(e,t),o=mh.fromElements(n,e.document);kh.replaceWith(r,o)},Iv=function(e,t){var n=Mh.asLtrRange(e,t);kh.deleteContents(n)},Wv=function(e,t,n,r){return _n.eq(e,n)&&t===r},Mv={setExact:bv,getExact:Tv,get:Av,setRelative:wv,toNative:yv,setToElement:Sv,clear:Nv,clone:Bv,replace:Pv,deleteAt:Iv,forElement:Rv,getFirstRect:Dv,getBounds:Ev,getAtPoint:kv,findWithin:hv,getAsString:Ov,isCollapsed:Wv},Lv=tinymce.util.Tools.resolve("tinymce.util.VK"),Fv=function(e,t,n,r){return jv(e,t,Jp.next(n),r)},qv=function(e,t,n,r){return jv(e,t,Jp.prev(n),r)},zv=function(e,t){var n=ah.exact(t,0,t,0);return Mv.toNative(n)},Hv=function(e,t){var n=Kr.descendants(t,"tr");return Ae.last(n).bind(function(e){return lo.descendant(e,"td,th").map(function(e){return zv(0,e)})})},jv=function(e,t,n,r,o){return n.fold(V.none,V.none,function(e,t){return Vi.first(t).map(function(e){return zv(0,e)})},function(n){return Ro.table(n,t).bind(function(t){var o=ka.noMenu(n);return e.undoManager.transact(function(){r.insertRowsAfter(t,o)}),Hv(0,t)})})
},_v=["table","li","dl"],Uv=function(e,t,n,r){if(e.keyCode===Lv.TAB){var o=ym.getBody(t),i=function(e){var t=Cr.name(e);return _n.eq(e,o)||Ae.contains(_v,t)},u=t.selection.getRng();if(u.collapsed){var a=st.fromDom(u.startContainer);Ro.cell(a,i).each(function(o){e.preventDefault(),(e.shiftKey?qv:Fv)(t,i,o,n,r).each(function(e){t.selection.setRng(e)})})}}},Vv={handle:Uv},Gv=Ue.immutable("selection","kill"),Yv={response:Gv},Xv=function(e){return function(t){return t===e}},Kv=Xv(38),$v=Xv(40),Jv=function(e){return e>=37&&e<=40},Qv={ltr:{isBackward:Xv(37),isForward:Xv(39)},rtl:{isBackward:Xv(39),isForward:Xv(37)},isUp:Kv,isDown:$v,isNavigation:Jv},Zv=function(e,t){var n=Mh.asLtrRange(e,t);return{start:F.constant(st.fromDom(n.startContainer)),soffset:F.constant(n.startOffset),finish:F.constant(st.fromDom(n.endContainer)),foffset:F.constant(n.endOffset)}},eb=function(e,t,n,r){return{start:F.constant(th.on(e,t)),finish:F.constant(th.on(n,r))}},tb={convertToRange:Zv,makeSitus:eb},nb=Wn.detect().browser.isSafari(),rb=function(e){var t=void 0!==e?e.dom():document,n=t.body.scrollLeft||t.documentElement.scrollLeft,r=t.body.scrollTop||t.documentElement.scrollTop;return Ec(n,r)},ob=function(e,t,n){(void 0!==n?n.dom():document).defaultView.scrollTo(e,t)},ib=function(e,t,n){(void 0!==n?n.dom():document).defaultView.scrollBy(e,t)},ub=function(e,t){var n=Ic.absolute(t),r=st.fromDom(e.document);ob(n.left(),n.top(),r)},ab=function(e,t){var n=rb(e);t();var r=rb(e);n.top()===r.top()&&n.left()===r.left()||ob(n.left(),n.top(),e)},cb=function(e){var t=V.none(),n=function(){t=V.some(rb(e))},r=function(){t.each(function(t){ob(t.left(),t.top(),e)})};return n(),{save:n,restore:r}},lb=function(e,t){nb&&X.isFunction(e.dom().scrollIntoViewIfNeeded)?e.dom().scrollIntoViewIfNeeded(!1):e.dom().scrollIntoView(t)},sb=function(e,t){var n=t.dom().getBoundingClientRect(),r=e.dom().getBoundingClientRect();r.top<n.top?lb(e,!0):r.bottom>n.bottom&&lb(e,!1)},fb=function(){var e=st.fromHtml('<div style="width: 100px; height: 100px; overflow: scroll; position: absolute; top: -9999px;"></div>');ui.after(Lr.body(),e);var t=e.dom().offsetWidth-e.dom().clientWidth;return pi.remove(e),t},db={get:rb,to:ob,by:ib,preserve:ab,capture:cb,intoView:lb,intoViewIfNeeded:sb,setToElement:ub,scrollBarWidth:fb},mb=function(e,t,n,r,o,i,u){return _n.eq(n,o)&&r===i?V.none():lo.closest(n,"td,th",t).bind(function(n){return lo.closest(o,"td,th",t).bind(function(r){return gb(e,t,n,r,u)})})},gb=function(e,t,n,r,o){return _n.eq(n,r)?V.none():la.identify(n,r,t).bind(function(t){var r=t.boxes().getOr([]);return r.length>0?(o(e,r,t.start(),t.finish()),V.some(Yv.response(V.some(tb.makeSitus(n,0,n,Hi.getEnd(n))),!0))):V.none()})},pb=function(e,t,n,r,o){var i=function(e){return o.clear(n),o.selectRange(n,e.boxes(),e.start(),e.finish()),e.boxes()};return la.shiftSelection(r,e,t,o.firstSelectedSelector(),o.lastSelectedSelector()).map(i)},hb={sync:mb,detect:gb,update:pb},vb=Ue.immutableBag(["left","top","right","bottom"],[]),bb=function(e,t){return vb({left:e.left(),top:e.top()+t,right:e.right(),bottom:e.bottom()+t})},wb=function(e,t){return vb({left:e.left(),top:e.top()-t,right:e.right(),bottom:e.bottom()-t})},yb=function(e,t){var n=e.bottom()-e.top();return vb({left:e.left(),top:t-n,right:e.right(),bottom:t})},xb=function(e,t){var n=e.bottom()-e.top();return vb({left:e.left(),top:t,right:e.right(),bottom:t+n})},Cb=function(e,t,n){return vb({left:e.left()+t,top:e.top()+n,right:e.right()+t,bottom:e.bottom()+n})},Sb=function(e){return e.top()},Rb=function(e){return e.bottom()},Tb=function(e){return"("+e.left()+", "+e.top()+") -> ("+e.right()+", "+e.bottom()+")"},Ab={nu:vb,moveUp:wb,moveDown:bb,moveBottomTo:yb,moveTopTo:xb,getTop:Sb,getBottom:Rb,translate:Cb,toString:Tb},Db=function(e,t,n){return n>=0&&n<Hi.getEnd(t)?e.getRangedRect(t,n,t,n+1):n>0?e.getRangedRect(t,n-1,t,n):V.none()},Eb=function(e){return Ab.nu({left:e.left,top:e.top,right:e.right,bottom:e.bottom})},kb=function(e,t){return V.some(e.getRect(t))},Ob=function(e,t,n){return Cr.isElement(t)?kb(e,t).map(Eb):Cr.isText(t)?Db(e,t,n).map(Eb):V.none()},Nb=function(e,t){return Cr.isElement(t)?kb(e,t).map(Eb):Cr.isText(t)?e.getRangedRect(t,0,t,Hi.getEnd(t)).map(Eb):V.none()},Bb={getBoxAt:Ob,getEntireBox:Nb},Pb=Ue.immutable("item","mode"),Ib=function(e,t,n,r){var o=void 0!==r?r:Wb;return e.property().parent(t).map(function(e){return Pb(e,o)})},Wb=function(e,t,n,r){var o=void 0!==r?r:Mb;return n.sibling(e,t).map(function(e){return Pb(e,o)})},Mb=function(e,t,n,r){var o=void 0!==r?r:Mb,i=e.property().children(t);return n.first(i).map(function(e){return Pb(e,o)})},Lb=[{current:Ib,next:Wb,fallback:V.none()},{current:Wb,next:Mb,fallback:V.some(Ib)},{current:Mb,next:Mb,fallback:V.some(Wb)}],Fb=function(e,t,n,r,o){var o=void 0!==o?o:Lb;return Ae.find(o,function(e){return e.current===n}).bind(function(n){return n.current(e,t,r,n.next).orThunk(function(){return n.fallback.bind(function(n){return Fb(e,t,n,r)})})})},qb={backtrack:Ib,sidestep:Wb,advance:Mb,go:Fb},zb=function(){return{sibling:function(e,t){return e.query().prevSibling(t)},first:function(e){return e.length>0?V.some(e[e.length-1]):V.none()}}},Hb=function(){return{sibling:function(e,t){return e.query().nextSibling(t)},first:function(e){return e.length>0?V.some(e[0]):V.none()}}},jb={left:zb,right:Hb},_b=function(e,t,n,r,o,i){return qb.go(e,t,r,o).bind(function(t){return i(t.item())?V.none():n(t.item())?V.some(t.item()):_b(e,t.item(),n,t.mode(),o,i)})},Ub=function(e,t,n,r){return _b(e,t,n,qb.sidestep,jb.left(),r)},Vb=function(e,t,n,r){return _b(e,t,n,qb.sidestep,jb.right(),r)},Gb={left:Ub,right:Vb},Yb=function(e,t){return 0===e.property().children(t).length},Xb=function(e,t,n){return $b(e,t,F.curry(Yb,e),n)},Kb=function(e,t,n){return Jb(e,t,F.curry(Yb,e),n)},$b=function(e,t,n,r){return Gb.left(e,t,n,r)},Jb=function(e,t,n,r){return Gb.right(e,t,n,r)},Qb=function(){return{left:jb.left,right:jb.right}},Zb=function(e,t,n,r,o){return qb.go(e,t,n,r,o)},ew={before:Xb,after:Kb,seekLeft:$b,seekRight:Jb,walkers:Qb,walk:Zb,backtrack:qb.backtrack,sidestep:qb.sidestep,advance:qb.advance},tw=o(),nw=function(e,t,n){return ew.gather(tw,e,t,n)},rw=function(e,t){return ew.before(tw,e,t)},ow=function(e,t){return ew.after(tw,e,t)},iw=function(e,t,n){return ew.seekLeft(tw,e,t,n)},uw=function(e,t,n){return ew.seekRight(tw,e,t,n)},aw=function(){return ew.walkers()},cw=function(e,t,n,r){return ew.walk(tw,e,t,n,r)},lw={gather:nw,before:rw,after:ow,seekLeft:iw,seekRight:uw,walkers:aw,walk:cw},sw=ha.generate([{none:[]},{retry:["caret"]}]),fw=function(e,t){return e.left()<t.left()||Math.abs(t.right()-e.left())<1||e.left()>t.right()},dw=function(e,t,n){return no.closest(t,Ol.isBlock).fold(F.constant(!1),function(t){return Bb.getEntireBox(e,t).exists(function(e){return fw(n,e)})})},mw=function(e,t,n,r,o){var i=Ab.moveDown(o,5);return Math.abs(n.bottom()-r.bottom())<1?sw.retry(i):n.top()>o.bottom()?sw.retry(i):n.top()===o.bottom()?sw.retry(Ab.moveDown(o,1)):dw(e,t,o)?sw.retry(Ab.translate(i,5,0)):sw.none()},gw=function(e,t,n,r,o){var i=Ab.moveUp(o,5);return Math.abs(n.top()-r.top())<1?sw.retry(i):n.bottom()<o.top()?sw.retry(i):n.bottom()===o.top()?sw.retry(Ab.moveUp(o,1)):dw(e,t,o)?sw.retry(Ab.translate(i,5,0)):sw.none()},pw={point:Ab.getTop,adjuster:gw,move:Ab.moveUp,gather:lw.before},hw={point:Ab.getBottom,adjuster:mw,move:Ab.moveDown,gather:lw.after},vw=function(e,t,n){return e.elementFromPoint(t,n).filter(function(e){return"table"===Cr.name(e)}).isSome()},bw=function(e,t,n,r,o){return ww(e,t,n,t.move(r,5),o)},ww=function(e,t,n,r,o){return 0===o?V.some(r):vw(e,r.left(),t.point(r))?bw(e,t,n,r,o-1):e.situsFromPoint(r.left(),t.point(r)).bind(function(i){return i.start().fold(V.none,function(i,u){return Bb.getEntireBox(e,i,u).bind(function(u){return t.adjuster(e,i,u,n,r).fold(V.none,function(r){return ww(e,t,n,r,o-1)})}).orThunk(function(){return V.some(r)})},V.none)})},yw=function(e,t){return e.situsFromPoint(t.left(),t.bottom()+5)},xw=function(e,t){return e.situsFromPoint(t.left(),t.top()-5)},Cw=function(e,t,n){return e.point(t)>n.getInnerHeight()?V.some(e.point(t)-n.getInnerHeight()):e.point(t)<0?V.some(-e.point(t)):V.none()},Sw=function(e,t,n){var r=e.move(n,5),o=ww(t,e,n,r,100).getOr(r);return Cw(e,o,t).fold(function(){return t.situsFromPoint(o.left(),e.point(o))},function(n){return t.scrollBy(0,n),t.situsFromPoint(o.left(),e.point(o)-n)})},Rw={tryUp:F.curry(Sw,pw),tryDown:F.curry(Sw,hw),ieTryUp:xw,ieTryDown:yw,getJumpSize:F.constant(5)},Tw=ha.generate([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),Aw=function(e,t,n){var r=e.getRect(t),o=e.getRect(n);return o.right>r.left&&o.left<r.right},Dw=function(e,t,n,r,o,i,u){return lo.closest(r,"td,th",u).bind(function(n){return lo.closest(t,"td,th",u).map(function(t){return _n.eq(n,t)?_n.eq(r,n)&&Hi.getEnd(n)===o?i(t):Tw.none("in same cell"):Mu.sharedOne(Ew,[n,t]).fold(function(){return Aw(e,t,n)?Tw.success():i(t)},function(e){return i(t)})})}).getOr(Tw.none("default"))},Ew=function(e){return lo.closest(e,"tr")},kw=function(e,t,n,r,o){return e.fold(t,n,r,o)},Ow={verify:Dw,cata:kw,adt:Tw},Nw=Ue.immutable("element","offset"),Bw=Ue.immutable("element","deltaOffset"),Pw=Ue.immutable("element","start","finish"),Iw=Ue.immutable("begin","end"),Ww=Ue.immutable("element","text"),Mw={point:Nw,delta:Bw,range:Pw,points:Iw,text:Ww},Lw=Ue.immutable("ancestor","descendants","element","index"),Fw=Ue.immutable("parent","children","element","index"),qw=function(e,t){return no.closest(e,function(e){return sr.parent(e).exists(function(e){return _n.eq(e,t)})})},zw=function(e){return sr.parent(e).bind(function(t){var n=sr.children(t);return Hw(n,e).map(function(r){return Fw(t,n,e,r)})})},Hw=function(e,t){return Ae.findIndex(e,F.curry(_n.eq,t))},jw=function(e,t){return sr.parent(e).bind(function(n){var r=Kr.children(n,t);return Hw(r,e).map(function(t){return Fw(n,r,e,t)})})},_w=function(e,t,n){return lo.closest(e,t).bind(function(t){var r=Kr.descendants(t,n);return Hw(r,e).map(function(n){return Lw(t,r,e,n)})})},Uw={childOf:qw,indexOf:Hw,indexInParent:zw,selectorsInParent:jw,descendantsInAncestor:_w},Vw=function(e){return"br"===Cr.name(e)},Gw=function(e,t,n){return t(e,n).bind(function(e){return Cr.isText(e)&&0===Ii.get(e).trim().length?Gw(e,t,n):V.some(e)})},Yw=function(e,t,n){return n.traverse(t).orThunk(function(){return Gw(t,n.gather,e)}).map(n.relative)},Xw=function(e,t){return sr.child(e,t).filter(Vw).orThunk(function(){return sr.child(e,t-1).filter(Vw)})},Kw=function(e,t,n,r){return Xw(t,n).bind(function(t){return r.traverse(t).fold(function(){return Gw(t,r.gather,e).map(r.relative)},function(e){return Uw.indexInParent(e).map(function(e){return th.on(e.parent(),e.index())})})})},$w=function(e,t,n,r){return(Vw(t)?Yw(e,t,r):Kw(e,t,n,r)).map(function(e){return{start:F.constant(e),finish:F.constant(e)}})},Jw=function(e){return Ow.cata(e,function(e){return V.none()},function(){return V.none()},function(e){return V.some(Mw.point(e,0))},function(e){return V.some(Mw.point(e,Hi.getEnd(e)))})},Qw={tryBr:$w,process:Jw},Zw=Wn.detect(),ey=function(e,t,n){return e.getSelection().bind(function(r){return Qw.tryBr(t,r.finish(),r.foffset(),n).fold(function(){return V.some(Mw.point(r.finish(),r.foffset()))},function(o){var i=e.fromSitus(o),u=Ow.verify(e,r.finish(),r.foffset(),i.finish(),i.foffset(),n.failure,t);return Qw.process(u)})})},ty=function(e,t,n,r,o,i){return 0===i?V.none():oy(e,t,n,r,o).bind(function(u){var a=e.fromSitus(u),c=Ow.verify(e,n,r,a.finish(),a.foffset(),o.failure,t);return Ow.cata(c,function(){return V.none()},function(){return V.some(u)},function(u){return _n.eq(n,u)&&0===r?ny(e,n,r,Ab.moveUp,o):ty(e,t,u,0,o,i-1)},function(u){return _n.eq(n,u)&&r===Hi.getEnd(u)?ny(e,n,r,Ab.moveDown,o):ty(e,t,u,Hi.getEnd(u),o,i-1)})})},ny=function(e,t,n,r,o){return Bb.getBoxAt(e,t,n).bind(function(t){return ry(e,o,r(t,Rw.getJumpSize()))})},ry=function(e,t,n){return Zw.browser.isChrome()||Zw.browser.isSafari()||Zw.browser.isFirefox()||Zw.browser.isEdge()?t.otherRetry(e,n):Zw.browser.isIE()?t.ieRetry(e,n):V.none()},oy=function(e,t,n,r,o){return Bb.getBoxAt(e,n,r).bind(function(t){return ry(e,o,t)})},iy=function(e,t,n){return ey(e,t,n).bind(function(r){return ty(e,t,r.element(),r.offset(),n,20).map(e.fromSitus)})},uy={handle:iy},ay=function(e){return no.first(e).isSome()},cy=function(e,t,n){return no.ancestor(e,t,n).isSome()},ly=function(e,t,n){return no.closest(e,t,n).isSome()},sy=function(e,t){return no.sibling(e,t).isSome()},fy=function(e,t){return no.child(e,t).isSome()},dy=function(e,t){return no.descendant(e,t).isSome()},my={any:ay,ancestor:cy,closest:ly,sibling:sy,child:fy,descendant:dy},gy=Wn.detect(),py=function(e,t){return my.ancestor(e,function(e){return sr.parent(e).exists(function(e){return _n.eq(e,t)})})},hy=function(e,t,n,r,o){return lo.closest(r,"td,th",t).bind(function(r){return lo.closest(r,"table",t).bind(function(i){return py(o,i)?uy.handle(e,t,n).bind(function(e){return lo.closest(e.finish(),"td,th",t).map(function(t){return{start:F.constant(r),finish:F.constant(t),range:F.constant(e)}})}):V.none()})})},vy=function(e,t,n,r,o,i){return gy.browser.isIE()?V.none():i(r,t).orThunk(function(){return hy(e,t,n,r,o).map(function(e){var t=e.range();return Yv.response(V.some(tb.makeSitus(t.start(),t.soffset(),t.finish(),t.foffset())),!0)})})},by=function(e,t){return lo.closest(e,"tr",t).bind(function(e){return lo.closest(e,"table",t).bind(function(n){var r=Kr.descendants(n,"tr");return _n.eq(e,r[0])?lw.seekLeft(n,function(e){return Vi.last(e).isSome()},t).map(function(e){var t=Hi.getEnd(e);return Yv.response(V.some(tb.makeSitus(e,t,e,t)),!0)}):V.none()})})},wy=function(e,t){return lo.closest(e,"tr",t).bind(function(e){return lo.closest(e,"table",t).bind(function(n){var r=Kr.descendants(n,"tr");return _n.eq(e,r[r.length-1])?lw.seekRight(n,function(e){return Vi.first(e).isSome()},t).map(function(e){return Yv.response(V.some(tb.makeSitus(e,0,e,0)),!0)}):V.none()})})},yy=function(e,t,n,r,o,i,u){return hy(e,n,r,o,i).bind(function(e){return hb.detect(t,n,e.start(),e.finish(),u)})},xy={navigate:vy,select:yy,firstUpCheck:by,lastDownCheck:wy},Cy=function(e,t){return lo.closest(e,"td,th",t)},Sy={down:{traverse:sr.nextSibling,gather:lw.after,relative:th.before,otherRetry:Rw.tryDown,ieRetry:Rw.ieTryDown,failure:Ow.adt.failedDown},up:{traverse:sr.prevSibling,gather:lw.before,relative:th.before,otherRetry:Rw.tryUp,ieRetry:Rw.ieTryUp,failure:Ow.adt.failedUp}},Ry=Ue.immutable("rows","cols"),Ty=function(e,t,n,r){var o=w(e),i=y(o,t,n,r);return{mousedown:i.mousedown,mouseover:i.mouseover,mouseup:i.mouseup}},Ay=function(e,t,n,r){var o=w(e),i=function(){return r.clear(t),V.none()};return{keydown:function(e,u,a,c,l,s){var f=e.raw().which,d=!0===e.raw().shiftKey;return la.retrieve(t,r.selectedSelector()).fold(function(){return Qv.isDown(f)&&d?F.curry(xy.select,o,t,n,Sy.down,c,u,r.selectRange):Qv.isUp(f)&&d?F.curry(xy.select,o,t,n,Sy.up,c,u,r.selectRange):Qv.isDown(f)?F.curry(xy.navigate,o,n,Sy.down,c,u,xy.lastDownCheck):Qv.isUp(f)?F.curry(xy.navigate,o,n,Sy.up,c,u,xy.firstUpCheck):V.none},function(e){var n=function(n){return function(){return jl.findMap(n,function(n){return hb.update(n.rows(),n.cols(),t,e,r)}).fold(function(){return la.getEdges(t,r.firstSelectedSelector(),r.lastSelectedSelector()).map(function(e){var n=Qv.isDown(f)||s.isForward(f)?th.after:th.before;return o.setRelativeSelection(th.on(e.first(),0),n(e.table())),r.clear(t),Yv.response(V.none(),!0)})},function(e){return V.some(Yv.response(V.none(),!0))})}};return Qv.isDown(f)&&d?n([Ry(1,0)]):Qv.isUp(f)&&d?n([Ry(-1,0)]):s.isBackward(f)&&d?n([Ry(0,-1),Ry(-1,0)]):s.isForward(f)&&d?n([Ry(0,1),Ry(1,0)]):Qv.isNavigation(f)&&!1===d?i:V.none})()},keyup:function(e,o,i,u,a){return la.retrieve(t,r.selectedSelector()).fold(function(){var c=e.raw().which;return 0==(!0===e.raw().shiftKey)?V.none():Qv.isNavigation(c)?hb.sync(t,n,o,i,u,a,r.selectRange):V.none()},V.none)}}},Dy={mouse:Ty,keyboard:Ay},Ey=function(e,t){Ae.each(t,function(t){Hs.add(e,t)})},ky=function(e,t){Ae.each(t,function(t){Hs.remove(e,t)})},Oy=function(e,t){Ae.each(t,function(t){Hs.toggle(e,t)})},Ny=function(e,t){return Ae.forall(t,function(t){return Hs.has(e,t)})},By=function(e,t){return Ae.exists(t,function(t){return Hs.has(e,t)})},Py=function(e){for(var t=e.dom().classList,n=new Array(t.length),r=0;r<t.length;r++)n[r]=t.item(r);return n},Iy=function(e){return Is.supports(e)?Py(e):Is.get(e)},Wy={add:Ey,remove:ky,toggle:Oy,hasAll:Ny,hasAny:By,get:Iy},My=function(e){return function(t){Hs.add(t,e)}},Ly=function(e){return function(t){Hs.remove(t,e)}},Fy=function(e){return function(t){Wy.remove(t,e)}},qy=function(e){return function(t){return Hs.has(t,e)}},zy={addClass:My,removeClass:Ly,removeClasses:Fy,hasClass:qy},Hy=function(e){var t=zy.addClass(e.selected()),n=zy.removeClasses([e.selected(),e.lastSelected(),e.firstSelected()]),r=function(t){var r=Kr.descendants(t,e.selectedSelector());Ae.each(r,n)};return{clear:r,selectRange:function(n,o,i,u){r(n),Ae.each(o,t),Hs.add(i,e.firstSelected()),Hs.add(u,e.lastSelected())},selectedSelector:e.selectedSelector,firstSelectedSelector:e.firstSelectedSelector,lastSelectedSelector:e.lastSelectedSelector}},jy=function(e){var t=function(t){Pr.remove(t,e.selected()),Pr.remove(t,e.firstSelected()),Pr.remove(t,e.lastSelected())},n=function(t){Pr.set(t,e.selected(),"1")},r=function(n){var r=Kr.descendants(n,e.selectedSelector());Ae.each(r,t)};return{clear:r,selectRange:function(t,o,i,u){r(t),Ae.each(o,n),Pr.set(i,e.firstSelected(),"1"),Pr.set(u,e.lastSelected(),"1")},selectedSelector:e.selectedSelector,firstSelectedSelector:e.firstSelectedSelector,lastSelectedSelector:e.lastSelectedSelector}},_y={byClass:Hy,byAttr:jy},Uy=function(e){return{get:function(){var t=ym.getBody(e);return da.retrieve(t,ga.selectedSelector()).fold(function(){return void 0===e.selection.getStart()?wa.none():wa.single(e.selection)},function(e){return wa.multiple(e)})}}},Vy=eg.each,Gy=function(e){function t(t){return function(){e.execCommand(t)}}var n=[];Vy("inserttable tableprops deletetable | cell row column".split(" "),function(t){"|"===t?n.push({text:"-"}):n.push(e.menuItems[t])}),e.addButton("table",{type:"menubutton",title:"Table",menu:n}),e.addButton("tableprops",{title:"Table properties",onclick:F.curry(_g.open,e,!0),icon:"table"}),e.addButton("tabledelete",{title:"Delete table",onclick:t("mceTableDelete")}),e.addButton("tablecellprops",{title:"Cell properties",onclick:t("mceTableCellProps")}),e.addButton("tablemergecells",{title:"Merge cells",onclick:t("mceTableMergeCells")}),e.addButton("tablesplitcells",{title:"Split cell",onclick:t("mceTableSplitCells")}),e.addButton("tableinsertrowbefore",{title:"Insert row before",onclick:t("mceTableInsertRowBefore")}),e.addButton("tableinsertrowafter",{title:"Insert row after",onclick:t("mceTableInsertRowAfter")}),e.addButton("tabledeleterow",{title:"Delete row",onclick:t("mceTableDeleteRow")}),e.addButton("tablerowprops",{title:"Row properties",onclick:t("mceTableRowProps")}),e.addButton("tablecutrow",{title:"Cut row",onclick:t("mceTableCutRow")}),e.addButton("tablecopyrow",{title:"Copy row",onclick:t("mceTableCopyRow")}),e.addButton("tablepasterowbefore",{title:"Paste row before",onclick:t("mceTablePasteRowBefore")}),e.addButton("tablepasterowafter",{title:"Paste row after",onclick:t("mceTablePasteRowAfter")}),e.addButton("tableinsertcolbefore",{title:"Insert column before",onclick:t("mceTableInsertColBefore")}),e.addButton("tableinsertcolafter",{title:"Insert column after",onclick:t("mceTableInsertColAfter")}),e.addButton("tabledeletecol",{title:"Delete column",onclick:t("mceTableDeleteCol")})},Yy=function(e){var t=function(t){return e.dom.is(t,"table")&&e.getBody().contains(t)},n=Xm(e);n.length>0&&e.addContextToolbar(t,n.join(" "))},Xy={addButtons:Gy,addToolbars:Yy},Ky=function(e,t){function n(t){return function(){e.execCommand(t)}}var r=V.none(),o=[],i=[],u=[],a=[],c=function(e){e.disabled(!0)},l=function(e){e.disabled(!1)},s=function(){var e=this;o.push(e),r.fold(function(){c(e)},function(t){l(e)})},f=function(){var e=this;i.push(e),r.fold(function(){c(e)},function(t){l(e)})},d=function(){var e=this;u.push(e),r.fold(function(){c(e)},function(t){e.disabled(t.mergable().isNone())})},m=function(){var e=this;a.push(e),r.fold(function(){c(e)},function(t){e.disabled(t.unmergable().isNone())})},g=function(){r.fold(function(){Ae.each(o,c),Ae.each(i,c),Ae.each(u,c),Ae.each(a,c)},function(e){Ae.each(o,l),Ae.each(i,l),Ae.each(u,function(t){t.disabled(e.mergable().isNone())}),Ae.each(a,function(t){t.disabled(e.unmergable().isNone())})})};e.on("init",function(){e.on("nodechange",function(n){var o=V.from(e.dom.getParent(e.selection.getStart(),"th,td"));r=o.bind(function(e){var n=st.fromDom(e);return Ro.table(n).map(function(e){return ka.forMenu(t,e,n)})}),g()})});var p=function(e,t,n,r){var o,i,u,a,c,l=r.getEl().getElementsByTagName("table")[0],s=r.isRtl()||"tl-tr"===r.parent().rel;for(l.nextSibling.innerHTML=t+1+" x "+(n+1),s&&(t=9-t),i=0;i<10;i++)for(o=0;o<10;o++)a=l.rows[i].childNodes[o].firstChild,c=(s?o>=t:o<=t)&&i<=n,e.dom.toggleClass(a,"mce-active",c),c&&(u=a);return u.parentNode},h=!1===qm(e)?{text:"Table",icon:"table",context:"table",onclick:F.curry(_g.open,e)}:{text:"Table",icon:"table",context:"table",ariaHideMenu:!0,onclick:function(t){t.aria&&(this.parent().hideAll(),t.stopImmediatePropagation(),_g.open(e))},onshow:function(){p(e,0,0,this.menu.items()[0])},onhide:function(){var t=this.menu.items()[0].getEl().getElementsByTagName("a");e.dom.removeClass(t,"mce-active"),e.dom.addClass(t[0],"mce-active")},menu:[{type:"container",html:function(){var e="";e='<table role="grid" class="mce-grid mce-grid-border" aria-readonly="true">';for(var t=0;t<10;t++){e+="<tr>";for(var n=0;n<10;n++)e+='<td role="gridcell" tabindex="-1"><a id="mcegrid'+(10*t+n)+'" href="#" data-mce-x="'+n+'" data-mce-y="'+t+'"></a></td>';e+="</tr>"}return e+="</table>",e+='<div class="mce-text-center" role="presentation">1 x 1</div>'}(),onPostRender:function(){this.lastX=this.lastY=0},onmousemove:function(t){var n,r,o=t.target;"A"===o.tagName.toUpperCase()&&(n=parseInt(o.getAttribute("data-mce-x"),10),r=parseInt(o.getAttribute("data-mce-y"),10),(this.isRtl()||"tl-tr"===this.parent().rel)&&(n=9-n),n===this.lastX&&r===this.lastY||(p(e,n,r,t.control),this.lastX=n,this.lastY=r))},onclick:function(t){var n=this;"A"===t.target.tagName.toUpperCase()&&(t.preventDefault(),t.stopPropagation(),n.parent().cancel(),e.undoManager.transact(function(){Fg.insert(e,n.lastX+1,n.lastY+1)}),e.addVisual())}}]},v={text:"Table properties",context:"table",onPostRender:s,onclick:F.curry(_g.open,e,!0)},b={text:"Delete table",context:"table",onPostRender:s,cmd:"mceTableDelete"},w={text:"Row",context:"table",menu:[{text:"Insert row before",onclick:n("mceTableInsertRowBefore"),onPostRender:f},{text:"Insert row after",onclick:n("mceTableInsertRowAfter"),onPostRender:f},{text:"Delete row",onclick:n("mceTableDeleteRow"),onPostRender:f},{text:"Row properties",onclick:n("mceTableRowProps"),onPostRender:f},{text:"-"},{text:"Cut row",onclick:n("mceTableCutRow"),onPostRender:f},{text:"Copy row",onclick:n("mceTableCopyRow"),onPostRender:f},{text:"Paste row before",onclick:n("mceTablePasteRowBefore"),onPostRender:f},{text:"Paste row after",onclick:n("mceTablePasteRowAfter"),onPostRender:f}]},y={text:"Column",context:"table",menu:[{text:"Insert column before",onclick:n("mceTableInsertColBefore"),onPostRender:f},{text:"Insert column after",onclick:n("mceTableInsertColAfter"),onPostRender:f},{text:"Delete column",onclick:n("mceTableDeleteCol"),onPostRender:f}]},x={separator:"before",text:"Cell",context:"table",menu:[{text:"Cell properties",onclick:n("mceTableCellProps"),onPostRender:f},{text:"Merge cells",onclick:n("mceTableMergeCells"),onPostRender:d},{text:"Split cell",onclick:n("mceTableSplitCells"),onPostRender:m}]};e.addMenuItem("inserttable",h),e.addMenuItem("tableprops",v),e.addMenuItem("deletetable",b),e.addMenuItem("row",w),e.addMenuItem("column",y),e.addMenuItem("cell",x)},$y={addMenuItems:Ky},Jy=function(e){return e.get().fold(function(){},function(e){return Ae.map(e,function(e){return e.dom()})})},Qy=function(e,t){var n=Ae.map(e,st.fromDom);t.set(V.from(n))},Zy=function(e,t){return{insertTable:function(t,n){return Fg.insert(e,t,n)},setClipboardRows:function(e){return Qy(e,t)},getClipboardRows:function(){return Jy(t)}}};R.add("table",C)}()}();