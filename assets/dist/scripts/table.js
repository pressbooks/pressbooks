!function(){!function(){"use strict";function t(){var t=arguments;return function(){for(var e=new Array(arguments.length),n=0;n<e.length;n++)e[n]=arguments[n];if(t.length!==e.length)throw new Error('Wrong number of arguments to struct. Expected "['+t.length+']", got '+e.length+" arguments");var r={};return Tt.each(t,function(t,n){r[t]=z.constant(e[n])}),r}}function e(t,e){var n=t.concat(e);if(0===n.length)throw new Error("You must specify at least one required or optional field.");return Vt.validateStrArr("required",t),Vt.validateStrArr("optional",e),Vt.checkDupes(n),function(r){var o=Wt.keys(r);Tt.forall(t,function(t){return Tt.contains(o,t)})||Vt.reqMessage(t,o);var i=Tt.filter(o,function(t){return!Tt.contains(n,t)});i.length>0&&Vt.unsuppMessage(i);var u={};return Tt.each(t,function(t){u[t]=z.constant(r[t])}),Tt.each(e,function(t){u[t]=z.constant(Object.prototype.hasOwnProperty.call(r,t)?X.some(r[t]):X.none())}),u}}function n(t,e,n){var r=t.isiOS()&&!0===/ipad/i.test(n),o=t.isiOS()&&!r,i=t.isAndroid()&&3===t.version.major,u=t.isAndroid()&&4===t.version.major,a=r||i||u&&!0===/mobile/i.test(n),c=t.isiOS()||t.isAndroid(),l=c&&!a,s=e.isSafari()&&t.isiOS()&&!1===/safari/i.test(n);return{isiPad:z.constant(r),isiPhone:z.constant(o),isTablet:z.constant(a),isPhone:z.constant(l),isTouch:z.constant(c),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:z.constant(s)}}function r(t,e,n,r,o){return t(n,r)?X.some(n):Lt.isFunction(o)&&o(n)?X.none():e(n,r,o)}function o(){var t=function(t){return de.fromDom(t.dom().cloneNode(!1))},e=function(t){return!!Rr.isElement(t)&&("body"===Rr.name(t)||Tt.contains(au,Rr.name(t)))},n=function(t){return!!Rr.isElement(t)&&Tt.contains(["br","img","hr","input"],Rr.name(t))},r=function(t,e){return t.dom().compareDocumentPosition(e.dom())},o=function(t,e){var n=Wr.clone(t);Wr.setAll(e,n)};return{up:z.constant({selector:fo.ancestor,closest:fo.closest,predicate:oo.ancestor,all:dr.parents}),down:z.constant({selector:Jr.descendants,predicate:Vr.descendants}),styles:z.constant({get:ei.get,getRaw:ei.getRaw,set:ei.set,remove:ei.remove}),attrs:z.constant({get:Wr.get,set:Wr.set,remove:Wr.remove,copyTo:o}),insert:z.constant({before:ci.before,after:ci.after,afterAll:mi.after,append:ci.append,appendAll:mi.append,prepend:ci.prepend,wrap:ci.wrap}),remove:z.constant({unwrap:vi.unwrap,remove:vi.remove}),create:z.constant({nu:de.fromTag,clone:t,text:de.fromText}),query:z.constant({comparePosition:r,prevSibling:dr.prevSibling,nextSibling:dr.nextSibling}),property:z.constant({children:dr.children,name:Rr.name,parent:dr.parent,isText:Rr.isText,isComment:Rr.isComment,isElement:Rr.isElement,getText:Mi.get,setText:Mi.set,isBoundary:e,isEmptyTag:n}),eq:Vn.eq,is:Vn.is}}function i(t,e){var n=function(e,n){if(!Lt.isNumber(n)&&!n.match(/^[0-9]+$/))throw t+".set accepts only positive integer values. Value was "+n;var r=e.dom();Lo.isSupported(r)&&(r.style[t]=n+"px")},r=function(n){var r=e(n);if(r<=0||null===r){var o=ei.get(n,t);return parseFloat(o)||0}return r},o=r,i=function(t,e){return Tt.foldl(e,function(e,n){var r=ei.get(t,n),o=void 0===r?0:parseInt(r,10);return isNaN(o)?e:e+o},0)};return{set:n,get:r,getOuter:o,aggregate:i,max:function(t,e,n){var r=i(t,n);return e>r?e-r:0}}}function u(t){var e=function(e){return t(e).isRtl()?gl.rtl:gl.ltr},n=function(t,n){return e(n).delta(t,n)},r=function(t,n){return e(n).positions(t,n)};return{delta:n,edge:function(t){return e(t).edge(t)},positions:r}}function a(t,e,n){var r=n||!1,o=function(){e(),r=!0},i=function(){t(),r=!1};return{on:o,off:i,toggle:function(){(r?i:o)()},isOn:function(){return r}}}function c(t,e){var n,r=function(t){return"table"===Rr.name(Lm.getBody(t))},o=function(e){var n=hl.getGridSize(e);return!1===r(t)||n.rows()>1},i=function(e){var n=hl.getGridSize(e);return!1===r(t)||n.columns()>1},a=function(e){return t.fire("newrow",{node:e.dom()}),e.dom()},c=function(e){return t.fire("newcell",{node:e.dom()}),e.dom()};!1!==t.settings.table_clone_elements&&("string"==typeof t.settings.table_clone_elements?n=t.settings.table_clone_elements.split(/[ ,]/):Array.isArray(t.settings.table_clone_elements)&&(n=t.settings.table_clone_elements));var l=X.from(n),s=function(e,n,r,o){return function(i,s){var f=Jr.descendants(i,"td[data-mce-style],th[data-mce-style]");Tt.each(f,function(t){Wr.remove(t,"data-mce-style")});var d=o(),m=de.fromDom(t.getDoc()),g=u(Vm.directionAt),p=eu.cellOperations(r,m,l);return n(i)?e(d,i,s,p,g).bind(function(e){return Tt.each(e.newRows(),function(t){a(t)}),Tt.each(e.newCells(),function(t){c(t)}),e.cursor().map(function(e){var n=t.dom.createRng();return n.setStart(e.dom(),0),n.setEnd(e.dom(),0),n})}):X.none()}};return{deleteRow:s(Im.eraseRows,o,z.noop,e),deleteColumn:s(Im.eraseColumns,i,z.noop,e),insertRowsBefore:s(Im.insertRowsBefore,z.always,z.noop,e),insertRowsAfter:s(Im.insertRowsAfter,z.always,z.noop,e),insertColumnsBefore:s(Im.insertColumnsBefore,z.always,Hc.halve,e),insertColumnsAfter:s(Im.insertColumnsAfter,z.always,Hc.halve,e),mergeCells:s(Im.mergeCells,z.always,z.noop,e),unmergeCells:s(Im.unmergeCells,z.always,z.noop,e),pasteRowsBefore:s(Im.pasteRowsBefore,z.always,z.noop,e),pasteRowsAfter:s(Im.pasteRowsAfter,z.always,z.noop,e),pasteCells:s(Im.pasteCells,z.always,z.noop,e)}}function l(t,e,n,r){if("TD"===e.tagName||"TH"===e.tagName)t.setStyle(e,n,r);else if(e.children)for(var o=0;o<e.children.length;o++)l(t,e.children[o],n,r)}function s(t,e,n){function r(t,e,n){n&&u.setAttrib(t,e,n)}function o(t,e,n){n&&u.setStyle(t,e,n)}var i,u=t.dom;ug.updateStyleField(t,n),i=n.control.rootControl.toJSON(),t.undoManager.transact(function(){Xm.each(e,function(n){r(n,"scope",i.scope),r(n,"style",i.style),r(n,"class",i.class),o(n,"height",Lm.addSizeSuffix(i.height)),i.type!==n.parentNode.nodeName.toLowerCase()&&mg(t.dom,n,i.type),1===e.length&&eg.unApplyAlign(t,n),i.align&&eg.applyAlign(t,n,i.align)}),t.focus()})}function f(t){var e=Gt.immutable.apply(null,t),n=[];return{bind:function(t){if(void 0===t)throw"Event bind error: undefined handler";n.push(t)},unbind:function(t){n=Tt.filter(n,function(e){return e!==t})},trigger:function(){var t=e.apply(null,arguments);Tt.each(n,function(e){e(t)})}}}function d(t){var e=ns.merge({layerClass:Lg.resolve("blocker")},t),n=de.fromTag("div");return Wr.set(n,"role","presentation"),ei.setAll(n,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),uf.add(n,Lg.resolve("blocker")),uf.add(n,e.layerClass),{element:function(){return n},destroy:function(){vi.remove(n)}}}function m(){var t=X.none(),e=function(){t=X.none()},n=function(e,n){var r=t.map(function(t){return e.compare(t,n)});return t=X.some(n),r},r=function(t,e){e.extract(t).each(function(t){n(e,t).each(function(t){o.trigger.move(t)})})},o=Bg.create({move:f(["info"])});return{onEvent:r,reset:e,events:o.registry}}function g(t){return{onEvent:function(t,e){},reset:z.noop}}function p(){var t=g(),e=m(),n=t,r=function(){n.reset(),n=e},o=function(){n.reset(),n=t},i=function(t,e){n.onEvent(t,e)};return{on:r,off:o,isOn:function(){return n===e},onEvent:i,events:e.events}}function h(){var t=Bg.create({drag:f(["xDelta","yDelta"])});return{mutate:function(e,n){t.trigger.drag(e,n)},events:t.registry}}function v(){var t=Bg.create({drag:f(["xDelta","yDelta","target"])}),e=X.none(),n=h();return n.events.drag.bind(function(n){e.each(function(e){t.trigger.drag(n.xDelta(),n.yDelta(),e)})}),{assign:function(t){e=X.some(t)},get:function(){return e},mutate:n.mutate,events:t.registry}}function b(t,e,n){var r=v(),o=cp.transform(r,{}),i=X.none(),u=function(t,e){return X.from(Wr.get(t,e))};r.events.drag.bind(function(t){u(t.target(),"data-row").each(function(e){var n=Dd.getInt(t.target(),"top");ei.set(t.target(),"top",n+t.yDelta()+"px")}),u(t.target(),"data-column").each(function(e){var n=Dd.getInt(t.target(),"left");ei.set(t.target(),"left",n+t.xDelta()+"px")})});var a=function(t,e){return Dd.getInt(t,e)-parseInt(Wr.get(t,"data-initial-"+e),10)};o.events.stop.bind(function(){r.get().each(function(r){i.each(function(o){u(r,"data-row").each(function(t){var e=a(r,"top");Wr.remove(r,"data-initial-top"),p.trigger.adjustHeight(o,e,parseInt(t,10))}),u(r,"data-column").each(function(t){var e=a(r,"left");Wr.remove(r,"data-initial-left"),p.trigger.adjustWidth(o,e,parseInt(t,10))}),xf.refresh(t,o,n,e)})})});var c=function(e,n){p.trigger.startAdjust(),r.assign(e),Wr.set(e,"data-initial-"+n,parseInt(ei.get(e,n),10)),uf.add(e,hp),ei.set(e,"opacity","0.2"),o.go(t.parent())},l=$g.bind(t.parent(),"mousedown",function(t){xf.isRowBar(t.target())&&c(t.target(),"top"),xf.isColBar(t.target())&&c(t.target(),"left")}),s=function(e){return Vn.eq(e,t.view())},d=$g.bind(t.view(),"mouseover",function(r){"table"===Rr.name(r.target())||pp.ancestor(r.target(),"table",s)?(i="table"===Rr.name(r.target())?X.some(r.target()):fo.ancestor(r.target(),"table",s),i.each(function(r){xf.refresh(t,r,n,e)})):Fr.inBody(r.target())&&xf.destroy(t)}),m=function(){l.unbind(),d.unbind(),o.destroy(),xf.destroy(t)},g=function(r){xf.refresh(t,r,n,e)},p=Bg.create({adjustHeight:f(["table","delta","row"]),adjustWidth:f(["table","delta","column"]),startAdjust:f([])});return{destroy:m,refresh:g,on:o.on,off:o.off,hideBars:z.curry(xf.hide,t),showBars:z.curry(xf.show,t),events:p.registry}}function w(t,e){var n=ml.height,r=b(t,e,n),o=Bg.create({beforeResize:f(["table"]),afterResize:f(["table"]),startDrag:f([])});return r.events.adjustHeight.bind(function(t){o.trigger.beforeResize(t.table());var e=n.delta(t.delta(),t.table());nm.adjustHeight(t.table(),e,t.row(),n),o.trigger.afterResize(t.table())}),r.events.startAdjust.bind(function(t){o.trigger.startDrag()}),r.events.adjustWidth.bind(function(t){o.trigger.beforeResize(t.table());var n=e.delta(t.delta(),t.table());nm.adjustWidth(t.table(),n,t.column(),e),o.trigger.afterResize(t.table())}),{on:r.on,off:r.off,hideBars:r.hideBars,showBars:r.showBars,destroy:r.destroy,events:o.registry}}function y(t){var e,n,r=X.none(),o=X.none(),i=X.none(),a=/(\d+(\.\d+)?)%/,c=function(t){return"TABLE"===t.nodeName},l=function(e){return t.dom.getStyle(e,"width")||t.dom.getAttrib(e,"width")},s=function(){return o},f=function(){return i.getOr(Og.only(de.fromDom(t.getBody())))},d=function(){o.each(function(t){t.destroy()}),i.each(function(e){yp.remove(t,e)})};return t.on("init",function(){var e=u(Vm.directionAt),n=yp.get(t);if(i=X.some(n),t.settings.object_resizing&&!1!==t.settings.table_resize_bars&&(!0===t.settings.object_resizing||"table"===t.settings.object_resizing)){var a=w(n,e);a.on(),a.events.startDrag.bind(function(e){r=X.some(t.selection.getRng())}),a.events.afterResize.bind(function(e){var n=e.table(),o=Jr.descendants(n,"td[data-mce-style],th[data-mce-style]");Tt.each(o,function(t){Wr.remove(t,"data-mce-style")}),r.each(function(e){t.selection.setRng(e),t.focus()}),t.undoManager.add()}),o=X.some(a)}}),t.on("ObjectResizeStart",function(t){c(t.target)&&(e=t.width,n=l(t.target))}),t.on("ObjectResized",function(r){if(c(r.target)){var o=r.target;if(a.test(n)){var i=parseFloat(a.exec(n)[1]),u=r.width*i/e;t.dom.setStyle(o,"width",u+"%")}else{var l=[];Xm.each(o.rows,function(e){Xm.each(e.cells,function(e){var n=t.dom.getStyle(e,"width",!0);l.push({cell:e,width:n})})}),Xm.each(l,function(e){t.dom.setStyle(e.cell,"width",e.width),t.dom.setAttrib(e.cell,"width",null)})}}}),{lazyResize:s,lazyWire:f,destroy:d}}function x(t){var e=function(e,n){return X.from(t.document.elementFromPoint(e,n)).map(de.fromDom)},n=function(t){return t.dom().getBoundingClientRect()},r=function(e,n,r,o){var i=qp.exact(e,n,r,o);return pv.getFirstRect(t,i).map(function(t){return Wt.map(t,z.apply)})},o=function(){return pv.get(t).map(function(e){return Pv.convertToRange(t,e)})},i=function(e){var n=qp.relative(e.start(),e.finish());return Pv.convertToRange(t,n)},u=function(e,n){return pv.getAtPoint(t,e,n).map(function(t){return{start:z.constant(Pp.on(t.start(),t.soffset())),finish:z.constant(Pp.on(t.finish(),t.foffset()))}})},a=function(){pv.clear(t)},c=function(e){pv.setToElement(t,e)};return{elementFromPoint:e,getRect:n,getRangedRect:r,getSelection:o,fromSitus:i,situsFromPoint:u,clearSelection:a,setSelection:function(e){pv.setExact(t,e.start(),e.soffset(),e.finish(),e.foffset())},setRelativeSelection:function(e,n){pv.setRelative(t,e,n)},selectContents:c,getInnerHeight:function(){return t.innerHeight},getScrollY:function(){return Vv.get(de.fromDom(t.document)).top()},scrollBy:function(e,n){Vv.by(e,n,de.fromDom(t.document))}}}function C(t,e,n,r){var o=X.none(),i=function(){o=X.none()};return{mousedown:function(t){r.clear(e),o=ey(t.target(),n)},mouseover:function(i){o.each(function(o){r.clear(e),ey(i.target(),n).each(function(i){fa.identify(o,i,n).each(function(n){var u=n.boxes().getOr([]);(u.length>1||1===u.length&&!Vn.eq(o,i))&&(r.selectRange(e,u,n.start(),n.finish()),t.selectContents(i))})})})},mouseup:function(){o.each(i)}}}function S(t,e){var n=Gt.immutableBag(["mousedown","mouseover","mouseup","keyup","keydown"],[]),r=X.none(),o=Cy.byAttr(ha);t.on("init",function(i){var u=t.getWin(),a=Lm.getBody(t),c=Lm.getIsRoot(t),l=function(){var e=t.selection,n=de.fromDom(e.getStart()),r=de.fromDom(e.getEnd()),i=Ao.table(n),u=Ao.table(r);i.bind(function(t){return u.bind(function(e){return Vn.eq(t,e)?X.some(!0):X.none()})}).fold(function(){o.clear(a)},z.noop)},s=uy.mouse(u,a,c,o),f=uy.keyboard(u,a,c,o),d=function(e,n){n.kill()&&e.kill(),n.selection().each(function(e){var n=qp.relative(e.start(),e.finish()),r=ph.asLtrRange(u,n);t.selection.setRng(r)})},m=function(e){var n=v(e);if(n.raw().shiftKey&&Nv.isNavigation(n.raw().which)){var r=t.selection.getRng(),o=de.fromDom(r.startContainer),i=de.fromDom(r.endContainer);f.keyup(n,o,r.startOffset,i,r.endOffset).each(function(t){d(n,t)})}},g=function(t){return!(Wr.has(t,"data-mce-bogus")||"br"===Rr.name(t)||Rr.isText(t)&&0===Mi.get(t).length)},p=function(){var e=de.fromDom(t.getBody()),n=dr.lastChild(e),r=function(t){return dr.prevSibling(t).bind(function(t){return g(t)?X.some(t):r(t)})};return n.bind(function(t){return g(t)?X.some(t):r(t)})},h=function(n){var r=v(n);e().each(function(t){t.hideBars()}),40===n.which&&p().each(function(e){"table"===Rr.name(e)&&(t.settings.forced_root_block?t.dom.add(t.getBody(),t.settings.forced_root_block,t.settings.forced_root_block_attrs,"<br/>"):t.dom.add(t.getBody(),"br"))});var o=t.selection.getRng(),i=de.fromDom(t.selection.getStart()),u=de.fromDom(o.startContainer),a=de.fromDom(o.endContainer),c=Vm.directionAt(i).isRtl()?Nv.rtl:Nv.ltr;f.keydown(r,u,o.startOffset,a,o.endOffset,c).each(function(t){d(r,t)}),e().each(function(t){t.showBars()})},v=function(t){var e=de.fromDom(t.target),n=function(){t.stopPropagation()},r=function(){t.preventDefault()},o=z.compose(r,n);return{target:z.constant(e),x:z.constant(t.x),y:z.constant(t.y),stop:n,prevent:r,kill:o,raw:z.constant(t)}},b=function(t){return 0===t.button},w=function(t){return void 0===t.buttons||0!=(1&t.buttons)},y=function(t){b(t)&&s.mousedown(v(t))},x=function(t){w(t)&&s.mouseover(v(t))},C=function(t){b&&s.mouseup(v(t))};t.on("mousedown",y),t.on("mouseover",x),t.on("mouseup",C),t.on("keyup",m),t.on("keydown",h),t.on("nodechange",l),r=X.some(n({mousedown:y,mouseover:x,mouseup:C,keyup:m,keydown:h}))});var i=function(){r.each(function(t){})};return{clear:o.clear,destroy:i}}function R(t){return{get:function(){var e=Lm.getBody(t);return ga.retrieve(e,ha.selectedSelector()).fold(function(){return void 0===t.selection.getStart()?xa.none():xa.single(t.selection)},function(t){return xa.multiple(t)})}}}function T(t){var e=this,n=y(t),r=S(t,n.lazyResize),o=c(t,n.lazyWire),i=R(t);Ag.registerCommands(t,o,r,i),Wa.registerEvents(t,i,o,r),Ey.addMenuItems(t,i),Ay.addButtons(t),Ay.addToolbars(t),t.on("PreInit",function(){t.serializer.addTempAttr(ha.firstSelected()),t.serializer.addTempAttr(ha.lastSelected())}),!1!==t.settings.table_tab_navigation&&t.on("keydown",function(e){Rv.handle(e,t,o,n.lazyWire)}),t.on("remove",function(){n.destroy(),r.destroy()}),e.insertTable=function(e,n){return Ja.insert(t,e,n)},e.setClipboardRows=Ag.setClipboardRows,e.getClipboardRows=Ag.getClipboardRows}function A(){}var D=tinymce.util.Tools.resolve("tinymce.PluginManager"),E=function(){},k=function(t){return function(){return t()}},O=function(t,e){return function(){return t(e.apply(null,arguments))}},N=function(t){return function(){return t}},B=function(t){return t},I=function(t,e){return t===e},P=function(t){for(var e=new Array(arguments.length-1),n=1;n<arguments.length;n++)e[n-1]=arguments[n];return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];var o=e.concat(n);return t.apply(null,o)}},W=function(t){return function(){return!t.apply(null,arguments)}},M=function(t){return function(){throw new Error(t)}},_=function(t){return t()},L=function(t){t()},F=N(!1),q=N(!0),z={noop:E,noarg:k,compose:O,constant:N,identity:B,tripleEquals:I,curry:P,not:W,die:M,apply:_,call:L,never:F,always:q},H=z.never,j=z.always,U=function(){return V},V=function(){var t=function(t){return t.isNone()},e=function(t){return t()},n=function(t){return t},r=function(){},o={fold:function(t,e){return t()},is:H,isSome:H,isNone:j,getOr:n,getOrThunk:e,getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},or:n,orThunk:e,map:U,ap:U,each:r,bind:U,flatten:U,exists:H,forall:j,filter:U,equals:t,equals_:t,toArray:function(){return[]},toString:z.constant("none()")};return Object.freeze&&Object.freeze(o),o}(),G=function(t){var e=function(){return t},n=function(){return i},r=function(e){return G(e(t))},o=function(e){return e(t)},i={fold:function(e,n){return n(t)},is:function(e){return t===e},isSome:j,isNone:H,getOr:e,getOrThunk:e,getOrDie:e,or:n,orThunk:n,map:r,ap:function(e){return e.fold(U,function(e){return G(e(t))})},each:function(e){e(t)},bind:o,flatten:e,exists:o,forall:o,filter:function(e){return e(t)?i:V},equals:function(e){return e.is(t)},equals_:function(e,n){return e.fold(H,function(e){return n(t,e)})},toArray:function(){return[t]},toString:function(){return"some("+t+")"}};return i},Y=function(t){return null===t||void 0===t?V:G(t)},X={some:G,none:U,from:Y},$=function(){var t=Array.prototype.indexOf,e=function(e,n){return t.call(e,n)},n=function(t,e){return ft(t,e)};return void 0===t?n:e}(),K=function(t,e){var n=$(t,e);return-1===n?X.none():X.some(n)},J=function(t,e){return $(t,e)>-1},Q=function(t,e){return st(t,e).isSome()},Z=function(t,e){for(var n=[],r=0;r<t;r++)n.push(e(r));return n},tt=function(t,e){for(var n=[],r=0;r<t.length;r+=e){var o=t.slice(r,r+e);n.push(o)}return n},et=function(t,e){for(var n=t.length,r=new Array(n),o=0;o<n;o++){var i=t[o];r[o]=e(i,o,t)}return r},nt=function(t,e){for(var n=0,r=t.length;n<r;n++){e(t[n],n,t)}},rt=function(t,e){for(var n=t.length-1;n>=0;n--){e(t[n],n,t)}},ot=function(t,e){for(var n=[],r=[],o=0,i=t.length;o<i;o++){var u=t[o];(e(u,o,t)?n:r).push(u)}return{pass:n,fail:r}},it=function(t,e){for(var n=[],r=0,o=t.length;r<o;r++){var i=t[r];e(i,r,t)&&n.push(i)}return n},ut=function(t,e){if(0===t.length)return[];for(var n=e(t[0]),r=[],o=[],i=0,u=t.length;i<u;i++){var a=t[i],c=e(a);c!==n&&(r.push(o),o=[]),n=c,o.push(a)}return 0!==o.length&&r.push(o),r},at=function(t,e,n){return rt(t,function(t){n=e(n,t)}),n},ct=function(t,e,n){return nt(t,function(t){n=e(n,t)}),n},lt=function(t,e){for(var n=0,r=t.length;n<r;n++){var o=t[n];if(e(o,n,t))return X.some(o)}return X.none()},st=function(t,e){for(var n=0,r=t.length;n<r;n++){if(e(t[n],n,t))return X.some(n)}return X.none()},ft=function(t,e){for(var n=0,r=t.length;n<r;++n)if(t[n]===e)return n;return-1},dt=Array.prototype.push,mt=function(t){for(var e=[],n=0,r=t.length;n<r;++n){if(!Array.prototype.isPrototypeOf(t[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+t);dt.apply(e,t[n])}return e},gt=function(t,e){var n=et(t,e);return mt(n)},pt=function(t,e){for(var n=0,r=t.length;n<r;++n){if(!0!==e(t[n],n,t))return!1}return!0},ht=function(t,e){return t.length===e.length&&pt(t,function(t,n){return t===e[n]})},vt=Array.prototype.slice,bt=function(t){var e=vt.call(t,0);return e.reverse(),e},wt=function(t,e){return it(t,function(t){return!J(e,t)})},yt=function(t,e){for(var n={},r=0,o=t.length;r<o;r++){var i=t[r];n[String(i)]=e(i,r)}return n},xt=function(t){return[t]},Ct=function(t,e){var n=vt.call(t,0);return n.sort(e),n},St=function(t){return 0===t.length?X.none():X.some(t[0])},Rt=function(t){return 0===t.length?X.none():X.some(t[t.length-1])},Tt={map:et,each:nt,eachr:rt,partition:ot,filter:it,groupBy:ut,indexOf:K,foldr:at,foldl:ct,find:lt,findIndex:st,flatten:mt,bind:gt,forall:pt,exists:Q,contains:J,equal:ht,reverse:bt,chunk:tt,difference:wt,mapToObject:yt,pure:xt,sort:Ct,range:Z,head:St,last:Rt},At=function(){var t=Object.keys,e=function(t){var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(n);return e};return void 0===t?e:t}(),Dt=function(t,e){for(var n=At(t),r=0,o=n.length;r<o;r++){var i=n[r];e(t[i],i,t)}},Et=function(t,e){return kt(t,function(t,n,r){return{k:n,v:e(t,n,r)}})},kt=function(t,e){var n={};return Dt(t,function(r,o){var i=e(r,o,t);n[i.k]=i.v}),n},Ot=function(t,e){var n={},r={};return Dt(t,function(t,o){(e(t,o)?n:r)[o]=t}),{t:n,f:r}},Nt=function(t,e){var n=[];return Dt(t,function(t,r){n.push(e(t,r))}),n},Bt=function(t,e){for(var n=At(t),r=0,o=n.length;r<o;r++){var i=n[r],u=t[i];if(e(u,i,t))return X.some(u)}return X.none()},It=function(t){return Nt(t,function(t){return t})},Pt=function(t){return It(t).length},Wt={bifilter:Ot,each:Dt,map:Et,mapToArray:Nt,tupleMap:kt,find:Bt,keys:At,values:It,size:Pt},Mt=function(t){if(null===t)return"null";var e=typeof t;return"object"===e&&Array.prototype.isPrototypeOf(t)?"array":"object"===e&&String.prototype.isPrototypeOf(t)?"string":e},_t=function(t){return function(e){return Mt(e)===t}},Lt={isString:_t("string"),isObject:_t("object"),isArray:_t("array"),isNull:_t("null"),isBoolean:_t("boolean"),isUndefined:_t("undefined"),isFunction:_t("function"),isNumber:_t("number")},Ft=function(t){return t.slice(0).sort()},qt=function(t,e){throw new Error("All required keys ("+Ft(t).join(", ")+") were not specified. Specified keys were: "+Ft(e).join(", ")+".")},zt=function(t){throw new Error("Unsupported keys for object: "+Ft(t).join(", "))},Ht=function(t,e){if(!Lt.isArray(e))throw new Error("The "+t+" fields must be an array. Was: "+e+".");Tt.each(e,function(e){if(!Lt.isString(e))throw new Error("The value "+e+" in the "+t+" fields was not a string.")})},jt=function(t,e){throw new Error("All values need to be of type: "+e+". Keys ("+Ft(t).join(", ")+") were not.")},Ut=function(t){var e=Ft(t);Tt.find(e,function(t,n){return n<e.length-1&&t===e[n+1]}).each(function(t){throw new Error("The field: "+t+" occurs more than once in the combined fields: ["+e.join(", ")+"].")})},Vt={sort:Ft,reqMessage:qt,unsuppMessage:zt,validateStrArr:Ht,invalidTypeMessage:jt,checkDupes:Ut},Gt={immutable:t,immutableBag:e},Yt=Gt.immutable("width","height"),Xt=Gt.immutable("rows","columns"),$t=Gt.immutable("row","column"),Kt=Gt.immutable("x","y"),Jt=Gt.immutable("element","rowspan","colspan"),Qt=Gt.immutable("element","rowspan","colspan","isNew"),Zt=Gt.immutable("element","rowspan","colspan","row","column"),te=Gt.immutable("element","cells","section"),ee=Gt.immutable("element","isNew"),ne=Gt.immutable("element","cells","section","isNew"),re=Gt.immutable("cells","section"),oe=Gt.immutable("details","section"),ie=Gt.immutable("startRow","startCol","finishRow","finishCol"),ue={dimensions:Yt,grid:Xt,address:$t,coords:Kt,extended:Zt,detail:Jt,detailnew:Qt,rowdata:te,elementnew:ee,rowdatanew:ne,rowcells:re,rowdetails:oe,bounds:ie},ae=function(t,e){var n=e||document,r=n.createElement("div");if(r.innerHTML=t,!r.hasChildNodes()||r.childNodes.length>1)throw console.error("HTML does not have a single root node",t),"HTML must have a single root node";return se(r.childNodes[0])},ce=function(t,e){var n=e||document,r=n.createElement(t);return se(r)},le=function(t,e){var n=e||document,r=n.createTextNode(t);return se(r)},se=function(t){if(null===t||void 0===t)throw new Error("Node cannot be null or undefined");return{dom:z.constant(t)}},fe=function(t,e,n){return X.from(t.dom().elementFromPoint(e,n)).map(se)},de={fromHtml:ae,fromTag:ce,fromText:le,fromDom:se,fromPoint:fe},me={ATTRIBUTE:2,CDATA_SECTION:4,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,ELEMENT:1,TEXT:3,PROCESSING_INSTRUCTION:7,ENTITY_REFERENCE:5,ENTITY:6,NOTATION:12},ge=me.ELEMENT,pe=me.DOCUMENT,he=function(t,e){var n=t.dom();if(n.nodeType!==ge)return!1;if(void 0!==n.matches)return n.matches(e);if(void 0!==n.msMatchesSelector)return n.msMatchesSelector(e);if(void 0!==n.webkitMatchesSelector)return n.webkitMatchesSelector(e);if(void 0!==n.mozMatchesSelector)return n.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")},ve=function(t){return t.nodeType!==ge&&t.nodeType!==pe||0===t.childElementCount},be=function(t,e){var n=void 0===e?document:e.dom();return ve(n)?[]:Tt.map(n.querySelectorAll(t),de.fromDom)},we=function(t,e){var n=void 0===e?document:e.dom();return ve(n)?X.none():X.from(n.querySelector(t)).map(de.fromDom)},ye={all:be,is:he,one:we},xe=function(t,e){var n=[],r=function(t){return n.push(t),e(t)},o=e(t);do{o=o.bind(r)}while(o.isSome());return n},Ce={toArray:xe},Se="undefined"!=typeof window?window:Function("return this;")(),Re=function(t,e){for(var n=void 0!==e&&null!==e?e:Se,r=0;r<t.length&&void 0!==n&&null!==n;++r)n=n[t[r]];return n},Te=function(t,e){var n=t.split(".");return Re(n,e)},Ae=function(t,e){return void 0!==t[e]&&null!==t[e]||(t[e]={}),t[e]},De=function(t,e){for(var n=void 0!==e?e:Se,r=0;r<t.length;++r)n=Ae(n,t[r]);return n},Ee=function(t,e){var n=t.split(".");return De(n,e)},ke={path:Re,resolve:Te,forge:De,namespace:Ee},Oe=function(t,e){return ke.resolve(t,e)},Ne=function(t,e){var n=Oe(t,e);if(void 0===n||null===n)throw t+" not available on this browser";return n},Be={getOrDie:Ne},Ie=function(){return Be.getOrDie("Node")},Pe=function(t,e,n){return 0!=(t.compareDocumentPosition(e)&n)},We=function(t,e){return Pe(t,e,Ie().DOCUMENT_POSITION_PRECEDING)},Me=function(t,e){return Pe(t,e,Ie().DOCUMENT_POSITION_CONTAINED_BY)},_e={documentPositionPreceding:We,documentPositionContainedBy:Me},Le=function(t){var e,n=!1;return function(){return n||(n=!0,e=t.apply(null,arguments)),e}},Fe={cached:Le},qe=function(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(r.test(e))return r}},ze=function(t,e){var n=qe(t,e);if(!n)return{major:0,minor:0};var r=function(t){return Number(e.replace(n,"$"+t))};return Ue(r(1),r(2))},He=function(t,e){var n=String(e).toLowerCase();return 0===t.length?je():ze(t,n)},je=function(){return Ue(0,0)},Ue=function(t,e){return{major:t,minor:e}},Ve={nu:Ue,detect:He,unknown:je},Ge=function(t,e){return function(){return e===t}},Ye=function(){return Xe({current:void 0,version:Ve.unknown()})},Xe=function(t){var e=t.current;return{current:e,version:t.version,isEdge:Ge("Edge",e),isChrome:Ge("Chrome",e),isIE:Ge("IE",e),isOpera:Ge("Opera",e),isFirefox:Ge("Firefox",e),isSafari:Ge("Safari",e)}},$e={unknown:Ye,nu:Xe,edge:z.constant("Edge"),chrome:z.constant("Chrome"),ie:z.constant("IE"),opera:z.constant("Opera"),firefox:z.constant("Firefox"),safari:z.constant("Safari")},Ke=function(t,e){return function(){return e===t}},Je=function(){return Qe({current:void 0,version:Ve.unknown()})},Qe=function(t){var e=t.current;return{current:e,version:t.version,isWindows:Ke("Windows",e),isiOS:Ke("iOS",e),isAndroid:Ke("Android",e),isOSX:Ke("OSX",e),isLinux:Ke("Linux",e),isSolaris:Ke("Solaris",e),isFreeBSD:Ke("FreeBSD",e)}},Ze={unknown:Je,nu:Qe,windows:z.constant("Windows"),ios:z.constant("iOS"),android:z.constant("Android"),linux:z.constant("Linux"),osx:z.constant("OSX"),solaris:z.constant("Solaris"),freebsd:z.constant("FreeBSD")},tn=function(t,e){var n=String(e).toLowerCase();return Tt.find(t,function(t){return t.search(n)})},en=function(t,e){return tn(t,e).map(function(t){var n=Ve.detect(t.versionRegexes,e);return{current:t.name,version:n}})},nn=function(t,e){return tn(t,e).map(function(t){var n=Ve.detect(t.versionRegexes,e);return{current:t.name,version:n}})},rn={detectBrowser:en,detectOs:nn},on=function(t,e){return e+t},un=function(t,e){return t+e},an=function(t,e){return t.substring(e)},cn=function(t,e){return t.substring(0,t.length-e)},ln={addToStart:on,addToEnd:un,removeFromStart:an,removeFromEnd:cn},sn=function(t,e){return t.substr(0,e)},fn=function(t,e){return t.substr(t.length-e,t.length)},dn=function(t){return""===t?X.none():X.some(t.substr(0,1))},mn=function(t){return""===t?X.none():X.some(t.substring(1))},gn={first:sn,last:fn,head:dn,tail:mn},pn=function(t,e,n){return""===e||!(t.length<e.length)&&t.substr(n,n+e.length)===e},hn=function(t,e){var n=function(t){var e=typeof t;return"string"===e||"number"===e};return t.replace(/\${([^{}]*)}/g,function(t,r){var o=e[r];return n(o)?o:t})},vn=function(t,e){return Sn(t,e)?ln.removeFromStart(t,e.length):t},bn=function(t,e){return Rn(t,e)?ln.removeFromEnd(t,e.length):t},wn=function(t,e){return Sn(t,e)?t:ln.addToStart(t,e)},yn=function(t,e){return Rn(t,e)?t:ln.addToEnd(t,e)},xn=function(t,e){return-1!==t.indexOf(e)},Cn=function(t){return gn.head(t).bind(function(e){return gn.tail(t).map(function(t){return e.toUpperCase()+t})}).getOr(t)},Sn=function(t,e){return pn(t,e,0)},Rn=function(t,e){return pn(t,e,t.length-e.length)},Tn=function(t){return t.replace(/^\s+|\s+$/g,"")},An=function(t){return t.replace(/^\s+/g,"")},Dn=function(t){return t.replace(/\s+$/g,"")},En={supplant:hn,startsWith:Sn,removeLeading:vn,removeTrailing:bn,ensureLeading:wn,ensureTrailing:yn,endsWith:Rn,contains:xn,trim:Tn,lTrim:An,rTrim:Dn,capitalize:Cn},kn=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,On=function(t){return function(e){return En.contains(e,t)}},Nn=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return En.contains(t,"edge/")&&En.contains(t,"chrome")&&En.contains(t,"safari")&&En.contains(t,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,kn],search:function(t){return En.contains(t,"chrome")&&!En.contains(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return En.contains(t,"msie")||En.contains(t,"trident")}},{name:"Opera",versionRegexes:[kn,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:On("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:On("firefox")},{name:"Safari",versionRegexes:[kn,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return(En.contains(t,"safari")||En.contains(t,"mobile/"))&&En.contains(t,"applewebkit")}}],Bn=[{name:"Windows",search:On("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return En.contains(t,"iphone")||En.contains(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:On("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:On("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:On("linux"),versionRegexes:[]},{name:"Solaris",search:On("sunos"),versionRegexes:[]},{name:"FreeBSD",search:On("freebsd"),versionRegexes:[]}],In={browsers:z.constant(Nn),oses:z.constant(Bn)},Pn=function(t){var e=In.browsers(),r=In.oses(),o=rn.detectBrowser(e,t).fold($e.unknown,$e.nu),i=rn.detectOs(r,t).fold(Ze.unknown,Ze.nu);return{browser:o,os:i,deviceType:n(i,o,t)}},Wn={detect:Pn},Mn=Fe.cached(function(){var t=navigator.userAgent;return Wn.detect(t)}),_n={detect:Mn},Ln=function(t,e){return t.dom()===e.dom()},Fn=function(t,e){return t.dom().isEqualNode(e.dom())},qn=function(t,e){return Tt.exists(e,z.curry(Ln,t))},zn=function(t,e){var n=t.dom(),r=e.dom();return n!==r&&n.contains(r)},Hn=function(t,e){return _e.documentPositionContainedBy(t.dom(),e.dom())},jn=_n.detect().browser,Un=jn.isIE()?Hn:zn,Vn={eq:Ln,isEqualNode:Fn,member:qn,contains:Un,is:ye.is},Gn=function(t){return de.fromDom(t.dom().ownerDocument)},Yn=function(t){var e=Gn(t)
;return de.fromDom(e.dom().documentElement)},Xn=function(t){var e=t.dom(),n=e.ownerDocument.defaultView;return de.fromDom(n)},$n=function(t){var e=t.dom();return X.from(e.parentNode).map(de.fromDom)},Kn=function(t){return $n(t).bind(function(e){var n=or(e);return Tt.findIndex(n,function(e){return Vn.eq(t,e)})})},Jn=function(t,e){for(var n=Lt.isFunction(e)?e:z.constant(!1),r=t.dom(),o=[];null!==r.parentNode&&void 0!==r.parentNode;){var i=r.parentNode,u=de.fromDom(i);if(o.push(u),!0===n(u))break;r=i}return o},Qn=function(t){var e=function(e){return Tt.filter(e,function(e){return!Vn.eq(t,e)})};return $n(t).map(or).map(e).getOr([])},Zn=function(t){var e=t.dom();return X.from(e.offsetParent).map(de.fromDom)},tr=function(t){var e=t.dom();return X.from(e.previousSibling).map(de.fromDom)},er=function(t){var e=t.dom();return X.from(e.nextSibling).map(de.fromDom)},nr=function(t){return Tt.reverse(Ce.toArray(t,tr))},rr=function(t){return Ce.toArray(t,er)},or=function(t){var e=t.dom();return Tt.map(e.childNodes,de.fromDom)},ir=function(t,e){var n=t.dom().childNodes;return X.from(n[e]).map(de.fromDom)},ur=function(t){return ir(t,0)},ar=function(t){return ir(t,t.dom().childNodes.length-1)},cr=function(t){return t.dom().childNodes.length},lr=function(t){return t.dom().hasChildNodes()},sr=Gt.immutable("element","offset"),fr=function(t,e){var n=or(t);return n.length>0&&e<n.length?sr(n[e],0):sr(t,e)},dr={owner:Gn,defaultView:Xn,documentElement:Yn,parent:$n,findIndex:Kn,parents:Jn,siblings:Qn,prevSibling:tr,offsetParent:Zn,prevSiblings:nr,nextSibling:er,nextSiblings:rr,children:or,child:ir,firstChild:ur,lastChild:ar,childNodesCount:cr,hasChildNodes:lr,leaf:fr},mr=function(t,e){return gr(t,e,z.constant(!0))},gr=function(t,e,n){return Tt.bind(dr.children(t),function(t){return ye.is(t,e)?n(t)?[t]:[]:gr(t,e,n)})},pr={firstLayer:mr,filterFirstLayer:gr},hr=function(t){return t.dom().nodeName.toLowerCase()},vr=function(t){return t.dom().nodeType},br=function(t){return t.dom().nodeValue},wr=function(t){return function(e){return vr(e)===t}},yr=function(t){return vr(t)===me.COMMENT||"#comment"===hr(t)},xr=wr(me.ELEMENT),Cr=wr(me.TEXT),Sr=wr(me.DOCUMENT),Rr={name:hr,type:vr,value:br,isElement:xr,isText:Cr,isDocument:Sr,isComment:yr},Tr=function(t,e,n){if(!(Lt.isString(n)||Lt.isBoolean(n)||Lt.isNumber(n)))throw console.error("Invalid call to Attr.set. Key ",e,":: Value ",n,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(e,n+"")},Ar=function(t,e,n){Tr(t.dom(),e,n)},Dr=function(t,e){var n=t.dom();Wt.each(e,function(t,e){Tr(n,e,t)})},Er=function(t,e){var n=t.dom().getAttribute(e);return null===n?void 0:n},kr=function(t,e){var n=t.dom();return!(!n||!n.hasAttribute)&&n.hasAttribute(e)},Or=function(t,e){t.dom().removeAttribute(e)},Nr=function(t){var e=t.dom().attributes;return void 0===e||null===e||0===e.length},Br=function(t){return Tt.foldl(t.dom().attributes,function(t,e){return t[e.name]=e.value,t},{})},Ir=function(t,e,n){kr(t,n)&&!kr(e,n)&&Ar(e,n,Er(t,n))},Pr=function(t,e,n){Rr.isElement(t)&&Rr.isElement(e)&&Tt.each(n,function(n){Ir(t,e,n)})},Wr={clone:Br,set:Ar,setAll:Dr,get:Er,has:kr,remove:Or,hasNone:Nr,transfer:Pr},Mr=function(t){var e=Rr.isText(t)?t.dom().parentNode:t.dom();return void 0!==e&&null!==e&&e.ownerDocument.body.contains(e)},_r=Fe.cached(function(){return Lr(de.fromDom(document))}),Lr=function(t){var e=t.dom().body;if(null===e||void 0===e)throw"Body is not available yet";return de.fromDom(e)},Fr={body:_r,getBody:Lr,inBody:Mr},qr=function(t){return Ur(Fr.body(),t)},zr=function(t,e,n){return Tt.filter(dr.parents(t,n),e)},Hr=function(t,e){return Tt.filter(dr.siblings(t),e)},jr=function(t,e){return Tt.filter(dr.children(t),e)},Ur=function(t,e){var n=[];return Tt.each(dr.children(t),function(t){e(t)&&(n=n.concat([t])),n=n.concat(Ur(t,e))}),n},Vr={all:qr,ancestors:zr,siblings:Hr,children:jr,descendants:Ur},Gr=function(t){return ye.all(t)},Yr=function(t,e,n){return Vr.ancestors(t,function(t){return ye.is(t,e)},n)},Xr=function(t,e){return Vr.siblings(t,function(t){return ye.is(t,e)})},$r=function(t,e){return Vr.children(t,function(t){return ye.is(t,e)})},Kr=function(t,e){return ye.all(e,t)},Jr={all:Gr,ancestors:Yr,siblings:Xr,children:$r,descendants:Kr},Qr=function(t){return ro(Fr.body(),t)},Zr=function(t,e,n){for(var r=t.dom(),o=Lt.isFunction(n)?n:z.constant(!1);r.parentNode;){r=r.parentNode;var i=de.fromDom(r);if(e(i))return X.some(i);if(o(i))break}return X.none()},to=function(t,e,n){return r(function(t){return e(t)},Zr,t,e,n)},eo=function(t,e){var n=t.dom();return n.parentNode?no(de.fromDom(n.parentNode),function(n){return!Vn.eq(t,n)&&e(n)}):X.none()},no=function(t,e){return Tt.find(t.dom().childNodes,z.compose(e,de.fromDom)).map(de.fromDom)},ro=function(t,e){var n=function(t){for(var r=0;r<t.childNodes.length;r++){if(e(de.fromDom(t.childNodes[r])))return X.some(de.fromDom(t.childNodes[r]));var o=n(t.childNodes[r]);if(o.isSome())return o}return X.none()};return n(t.dom())},oo={first:Qr,ancestor:Zr,closest:to,sibling:eo,child:no,descendant:ro},io=function(t){return ye.one(t)},uo=function(t,e,n){return oo.ancestor(t,function(t){return ye.is(t,e)},n)},ao=function(t,e){return oo.sibling(t,function(t){return ye.is(t,e)})},co=function(t,e){return oo.child(t,function(t){return ye.is(t,e)})},lo=function(t,e){return ye.one(e,t)},so=function(t,e,n){return r(ye.is,uo,t,e,n)},fo={first:io,ancestor:uo,sibling:ao,child:co,descendant:lo,closest:so},mo=function(t,e,n){var r=void 0!==n?n:z.constant(!1);if(r(e))return X.none();if(Tt.contains(t,Rr.name(e)))return X.some(e);var o=function(t){return ye.is(t,"table")||r(t)};return fo.ancestor(e,t.join(","),o)},go=function(t,e){return mo(["td","th"],t,e)},po=function(t){return pr.firstLayer(t,"th,td")},ho=function(t,e){return mo(["caption","tr","tbody","tfoot","thead"],t,e)},vo=function(t,e){return dr.parent(e).map(function(e){return Jr.children(e,t)})},bo=z.curry(vo,"th,td"),wo=z.curry(vo,"tr"),yo=function(t){return fo.descendant(t,"th,td")},xo=function(t,e){return fo.closest(t,"table",e)},Co=function(t,e){return mo(["tr"],t,e)},So=function(t){return pr.firstLayer(t,"tr")},Ro=function(t,e){return parseInt(Wr.get(t,e),10)},To=function(t,e,n){var r=Ro(t,e),o=Ro(t,n);return ue.grid(r,o)},Ao={cell:go,firstCell:yo,cells:po,neighbourCells:bo,table:xo,row:Co,rows:So,notCell:ho,neighbourRows:wo,attr:Ro,grid:To},Do=function(t){var e=Ao.rows(t);return Tt.map(e,function(t){var e=t,n=dr.parent(e),r=n.bind(function(t){var e=Rr.name(t);return"tfoot"===e||"thead"===e||"tbody"===e?e:"tbody"}),o=Tt.map(Ao.cells(t),function(t){var e=Wr.has(t,"rowspan")?parseInt(Wr.get(t,"rowspan"),10):1,n=Wr.has(t,"colspan")?parseInt(Wr.get(t,"colspan"),10):1;return ue.detail(t,e,n)});return ue.rowdata(e,o,r)})},Eo=function(t,e){return Tt.map(t,function(t){var n=Tt.map(Ao.cells(t),function(t){var e=Wr.has(t,"rowspan")?parseInt(Wr.get(t,"rowspan"),10):1,n=Wr.has(t,"colspan")?parseInt(Wr.get(t,"colspan"),10):1;return ue.detail(t,e,n)});return ue.rowdata(t,n,e.section())})},ko={fromTable:Do,fromPastedRows:Eo},Oo=function(t,e){return t+","+e},No=function(t,e,n){var r=t.access()[Oo(e,n)];return void 0!==r?X.some(r):X.none()},Bo=function(t,e,n){var r=Io(t,function(t){return n(e,t.element())});return r.length>0?X.some(r[0]):X.none()},Io=function(t,e){var n=Tt.bind(t.all(),function(t){return t.cells()});return Tt.filter(n,e)},Po=function(t){var e={},n=[],r=t.length,o=0;Tt.each(t,function(t,r){var i=[];Tt.each(t.cells(),function(t,n){for(var u=0;void 0!==e[Oo(r,u)];)u++;for(var a=ue.extended(t.element(),t.rowspan(),t.colspan(),r,u),c=0;c<t.colspan();c++)for(var l=0;l<t.rowspan();l++){var s=r+l,f=u+c,d=Oo(s,f);e[d]=a,o=Math.max(o,f+1)}i.push(a)}),n.push(ue.rowdata(t.element(),i,t.section()))});var i=ue.grid(r,o);return{grid:z.constant(i),access:z.constant(e),all:z.constant(n)}},Wo=function(t){var e=Tt.map(t.all(),function(t){return t.cells()});return Tt.flatten(e)},Mo={generate:Po,getAt:No,findItem:Bo,filterItems:Io,justCells:Wo},_o=function(t){return void 0!==t.style},Lo={isSupported:_o},Fo=function(t,e,n){if(!Lt.isString(n))throw console.error("Invalid call to CSS.set. Property ",e,":: Value ",n,":: Element ",t),new Error("CSS value must be a string: "+n);Lo.isSupported(t)&&t.style.setProperty(e,n)},qo=function(t,e){Lo.isSupported(t)&&t.style.removeProperty(e)},zo=function(t,e,n){var r=t.dom();Fo(r,e,n)},Ho=function(t,e){var n=t.dom();Wt.each(e,function(t,e){Fo(n,e,t)})},jo=function(t,e){var n=t.dom();Wt.each(e,function(t,e){t.fold(function(){qo(n,e)},function(t){Fo(n,e,t)})})},Uo=function(t,e){var n=t.dom(),r=window.getComputedStyle(n),o=r.getPropertyValue(e),i=""!==o||Fr.inBody(t)?o:Vo(n,e);return null===i?void 0:i},Vo=function(t,e){return Lo.isSupported(t)?t.style.getPropertyValue(e):""},Go=function(t,e){var n=t.dom(),r=Vo(n,e);return X.from(r).filter(function(t){return t.length>0})},Yo=function(t){var e={},n=t.dom();if(Lo.isSupported(n))for(var r=0;r<n.style.length;r++){var o=n.style.item(r);e[o]=n.style[o]}return e},Xo=function(t,e,n){var r=de.fromTag(t);return zo(r,e,n),Go(r,e).isSome()},$o=function(t,e){var n=t.dom();qo(n,e),Wr.has(t,"style")&&""===En.trim(Wr.get(t,"style"))&&Wr.remove(t,"style")},Ko=function(t,e){var n=Wr.get(t,"style"),r=e(t);return(void 0===n?Wr.remove:Wr.set)(t,"style",n),r},Jo=function(t,e){var n=t.dom(),r=e.dom();Lo.isSupported(n)&&Lo.isSupported(r)&&(r.style.cssText=n.style.cssText)},Qo=function(t){return t.dom().offsetWidth},Zo=function(t,e,n){Go(t,n).each(function(t){Go(e,n).isNone()&&zo(e,n,t)})},ti=function(t,e,n){Rr.isElement(t)&&Rr.isElement(e)&&Tt.each(n,function(n){Zo(t,e,n)})},ei={copy:Jo,set:zo,preserve:Ko,setAll:Ho,setOptions:jo,remove:$o,get:Uo,getRaw:Go,getAllRaw:Yo,isValidValue:Xo,reflow:Qo,transfer:ti},ni=function(t,e){dr.parent(t).each(function(n){n.dom().insertBefore(e.dom(),t.dom())})},ri=function(t,e){dr.nextSibling(t).fold(function(){dr.parent(t).each(function(t){ii(t,e)})},function(t){ni(t,e)})},oi=function(t,e){dr.firstChild(t).fold(function(){ii(t,e)},function(n){t.dom().insertBefore(e.dom(),n.dom())})},ii=function(t,e){t.dom().appendChild(e.dom())},ui=function(t,e,n){dr.child(t,n).fold(function(){ii(t,e)},function(t){ni(t,e)})},ai=function(t,e){ni(t,e),ii(e,t)},ci={before:ni,after:ri,prepend:oi,append:ii,appendAt:ui,wrap:ai},li=function(t,e){Tt.each(e,function(e){ci.before(t,e)})},si=function(t,e){Tt.each(e,function(n,r){var o=0===r?t:e[r-1];ci.after(o,n)})},fi=function(t,e){Tt.each(e.slice().reverse(),function(e){ci.prepend(t,e)})},di=function(t,e){Tt.each(e,function(e){ci.append(t,e)})},mi={before:li,after:si,prepend:fi,append:di},gi=function(t){t.dom().textContent="",Tt.each(dr.children(t),function(t){pi(t)})},pi=function(t){var e=t.dom();null!==e.parentNode&&e.parentNode.removeChild(e)},hi=function(t){var e=dr.children(t);e.length>0&&mi.before(t,e),pi(t)},vi={empty:gi,remove:pi,unwrap:hi},bi=Gt.immutable("minRow","minCol","maxRow","maxCol"),wi=function(t,e){var n=t.grid().columns(),r=t.grid().rows(),o=r,i=n,u=0,a=0;return Wt.each(t.access(),function(t){if(e(t)){var n=t.row(),r=n+t.rowspan()-1,c=t.column(),l=c+t.colspan()-1;n<o?o=n:r>u&&(u=r),c<i?i=c:l>a&&(a=l)}}),bi(o,i,u,a)},yi=function(t,e,n){var r=t[n].element(),o=de.fromTag("td");ci.append(o,de.fromTag("br")),(e?ci.append:ci.prepend)(r,o)},xi=function(t,e,n,r){for(var o=e.grid().columns(),i=e.grid().rows(),u=0;u<i;u++)for(var a=!1,c=0;c<o;c++)if(!(u<n.minRow()||u>n.maxRow()||c<n.minCol()||c>n.maxCol())){var l=Mo.getAt(e,u,c).filter(r).isNone();l?yi(t,a,u):a=!0}},Ci=function(t,e){var n=Tt.filter(pr.firstLayer(t,"tr"),function(t){return 0===t.dom().childElementCount});Tt.each(n,vi.remove),e.minCol()!==e.maxCol()&&e.minRow()!==e.maxRow()||Tt.each(pr.firstLayer(t,"th,td"),function(t){Wr.remove(t,"rowspan"),Wr.remove(t,"colspan")}),Wr.remove(t,"width"),Wr.remove(t,"height"),ei.remove(t,"width"),ei.remove(t,"height")},Si=function(t,e){var n=function(t){return ye.is(t.element(),e)},r=ko.fromTable(t),o=Mo.generate(r),i=wi(o,n),u="th:not("+e+"),td:not("+e+")",a=pr.filterFirstLayer(t,"th,td",function(t){return ye.is(t,u)});return Tt.each(a,vi.remove),xi(r,o,i,n),Ci(t,i),t},Ri={extract:Si},Ti=function(t,e){return de.fromDom(t.dom().cloneNode(e))},Ai=function(t){return Ti(t,!1)},Di=function(t){return Ti(t,!0)},Ei=function(t,e){var n=de.fromTag(e),r=Wr.clone(t);return Wr.setAll(n,r),n},ki=function(t,e){var n=Ei(t,e),r=dr.children(Di(t));return mi.append(n,r),n},Oi=function(t,e){var n=Ei(t,e);ci.before(t,n);var r=dr.children(t);return mi.append(n,r),vi.remove(t),n},Ni={shallow:Ai,shallowAs:Ei,deep:Di,copy:ki,mutate:Oi},Bi=function(t,e){var n=function(n){if(!t(n))throw new Error("Can only get "+e+" value of a "+e+" node");return u(n).getOr("")},r=function(t){try{return o(t)}catch(t){return X.none()}},o=function(e){return t(e)?X.from(e.dom().nodeValue):X.none()},i=_n.detect().browser,u=i.isIE()&&10===i.version.major?r:o;return{get:n,getOption:u,set:function(n,r){if(!t(n))throw new Error("Can only set raw "+e+" value of a "+e+" node");n.dom().nodeValue=r}}}(Rr.isText,"text"),Ii=function(t){return Bi.get(t)},Pi=function(t){return Bi.getOption(t)},Wi=function(t,e){Bi.set(t,e)},Mi={get:Ii,getOption:Pi,set:Wi},_i=function(t){return"img"===Rr.name(t)?1:Mi.getOption(t).fold(function(){return dr.children(t).length},function(t){return t.length})},Li=function(t,e){return _i(t)===e},Fi=function(t,e){return 0===e},qi=function(t){return Mi.getOption(t).filter(function(t){return 0!==t.trim().length||t.indexOf(" ")>-1}).isSome()},zi=["img","br"],Hi=function(t){return qi(t)||Tt.contains(zi,Rr.name(t))},ji={getEnd:_i,isEnd:Li,isStart:Fi,isCursorPosition:Hi},Ui=function(t){return oo.descendant(t,ji.isCursorPosition)},Vi=function(t){return Gi(t,ji.isCursorPosition)},Gi=function(t,e){var n=function(t){for(var r=dr.children(t),o=r.length-1;o>=0;o--){var i=r[o];if(e(i))return X.some(i);var u=n(i);if(u.isSome())return u}return X.none()};return n(t)},Yi={first:Ui,last:Vi},Xi=function(){var t=de.fromTag("td");return ci.append(t,de.fromTag("br")),t},$i=function(t,e,n){var r=Ni.copy(t,e);return Wt.each(n,function(t,e){null===t?Wr.remove(r,e):Wr.set(r,e,t)}),r},Ki=function(t){return t},Ji=function(t){return function(){return de.fromTag("tr",t.dom())}},Qi=function(t,e,n){return Yi.first(t).map(function(r){var o=n.join(","),i=Jr.ancestors(r,o,function(e){return Vn.eq(e,t)});return Tt.foldr(i,function(t,e){var n=Ni.shallow(e);return ci.append(t,n),n},e)}).getOr(e)},Zi=function(t,e,n){var r=function(e){var r=dr.owner(e.element()),o=de.fromTag(Rr.name(e.element()),r.dom()),i=n.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),u=i.length>0?Qi(e.element(),o,i):o;return ci.append(u,de.fromTag("br")),ei.copy(e.element(),o),ei.remove(o,"height"),1!==e.colspan()&&ei.remove(e.element(),"width"),t(e.element(),o),o};return{row:Ji(e),cell:r,replace:$i,gap:Xi}},tu=function(t){return{row:Ji(t),cell:Xi,replace:Ki,gap:Xi}},eu={cellOperations:Zi,paste:tu},nu=function(t,e){var n=e||document,r=n.createElement("div");return r.innerHTML=t,dr.children(de.fromDom(r))},ru=function(t,e){return Tt.map(t,function(t){return de.fromTag(t,e)})},ou=function(t,e){return Tt.map(t,function(t){return de.fromText(t,e)})},iu=function(t){return Tt.map(t,de.fromDom)},uu={fromHtml:nu,fromTags:ru,fromText:ou,fromDom:iu},au=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],cu=Gt.immutable("left","right"),lu=function(t,e,n){var r=t.property().children(e);return Tt.findIndex(r,z.curry(t.eq,n)).map(function(t){return{before:z.constant(r.slice(0,t)),after:z.constant(r.slice(t+1))}})},su=function(t,e,n){return lu(t,e,n).map(function(n){var r=t.create().clone(e);return t.insert().appendAll(r,n.after()),t.insert().after(e,r),cu(e,r)})},fu=function(t,e,n){return lu(t,e,n).map(function(r){var o=t.create().clone(e);return t.insert().appendAll(o,r.before().concat([n])),t.insert().appendAll(e,r.after()),t.insert().before(e,o),cu(o,e)})},du=function(t,e,n,r){var o=Gt.immutable("first","second","splits"),i=function(e,u,a){var c=o(e,X.none(),a);return n(e)?o(e,u,a):t.property().parent(e).bind(function(o){return r(t,o,e).map(function(t){var e=[{first:t.left,second:t.right}],r=n(o)?o:t.left();return i(r,X.some(t.right()),a.concat(e))}).getOr(c)})};return i(e,X.none(),[])},mu={breakToLeft:fu,breakToRight:su,breakPath:du},gu=function(t,e,n,r){return r(t,e,n[0],n.slice(1))},pu=function(t,e,n){return n.length>0?gu(t,e,n,hu):X.none()},hu=function(t,e,n,r){var o=e(t,n);return Tt.foldr(r,function(n,r){var o=e(t,r);return vu(t,n,o)},o)},vu=function(t,e,n){return e.bind(function(e){return n.filter(z.curry(t.eq,e))})},bu={oneAll:pu},wu=function(t,e){return z.curry(t.eq,e)},yu=function(t,e,n,r){var o=t.property().children(e);if(t.eq(e,n[0]))return X.some([n[0]]);if(t.eq(e,r[0]))return X.some([r[0]]);var i=function(n){var r=Tt.reverse(n),i=Tt.findIndex(r,wu(t,e)).getOr(-1),u=i<r.length-1?r[i+1]:r[i];return Tt.findIndex(o,wu(t,u))},u=i(n),a=i(r);return u.bind(function(t){return a.map(function(e){var n=Math.min(t,e),r=Math.max(t,e);return o.slice(n,r+1)})})},xu=function(t,e,n,r){var o=void 0!==r?r:z.constant(!1),i=[e].concat(t.up().all(e)),u=[n].concat(t.up().all(n)),a=function(t){return Tt.findIndex(t,o).fold(function(){return t},function(e){return t.slice(0,e+1)})},c=a(i),l=a(u),s=Tt.find(c,function(e){return Tt.exists(l,wu(t,e))});return{firstpath:z.constant(c),secondpath:z.constant(l),shared:z.constant(s)}},Cu=function(t,e,n){var r=xu(t,e,n);return r.shared().bind(function(e){return yu(t,e,r.firstpath(),r.secondpath())})},Su={subset:Cu,ancestors:xu},Ru=function(t,e,n){return bu.oneAll(t,e,n)},Tu=function(t,e,n){return Su.subset(t,e,n)},Au=function(t,e,n,r){return Su.ancestors(t,e,n,r)},Du=function(t,e,n){return mu.breakToLeft(t,e,n)},Eu=function(t,e,n){return mu.breakToRight(t,e,n)},ku=function(t,e,n,r){return mu.breakPath(t,e,n,r)},Ou={sharedOne:Ru,subset:Tu,ancestors:Au,breakToLeft:Du,breakToRight:Eu,breakPath:ku},Nu=o(),Bu=function(t,e){return Ou.sharedOne(Nu,function(e,n){return t(n)},e)},Iu=function(t,e){return Ou.subset(Nu,t,e)},Pu=function(t,e,n){return Ou.ancestors(Nu,t,e,n)},Wu=function(t,e){return Ou.breakToLeft(Nu,t,e)},Mu=function(t,e){return Ou.breakToRight(Nu,t,e)},_u=function(t,e,n){return Ou.breakPath(Nu,t,e,function(t,e,r){return n(e,r)})},Lu={sharedOne:Bu,subset:Iu,ancestors:Pu,breakToLeft:Wu,breakToRight:Mu,breakPath:_u},Fu=function(t,e){var n=e.column(),r=e.column()+e.colspan()-1,o=e.row(),i=e.row()+e.rowspan()-1;return n<=t.finishCol()&&r>=t.startCol()&&o<=t.finishRow()&&i>=t.startRow()},qu=function(t,e){return e.column()>=t.startCol()&&e.column()+e.colspan()-1<=t.finishCol()&&e.row()>=t.startRow()&&e.row()+e.rowspan()-1<=t.finishRow()},zu=function(t,e){for(var n=!0,r=z.curry(qu,e),o=e.startRow();o<=e.finishRow();o++)for(var i=e.startCol();i<=e.finishCol();i++)n=n&&Mo.getAt(t,o,i).exists(r);return n?X.some(e):X.none()},Hu={inSelection:Fu,isWithin:qu,isRectangular:zu},ju=function(t,e){return ue.bounds(Math.min(t.row(),e.row()),Math.min(t.column(),e.column()),Math.max(t.row()+t.rowspan()-1,e.row()+e.rowspan()-1),Math.max(t.column()+t.colspan()-1,e.column()+e.colspan()-1))},Uu=function(t,e,n){var r=Mo.findItem(t,e,Vn.eq),o=Mo.findItem(t,n,Vn.eq);return r.bind(function(t){return o.map(function(e){return ju(t,e)})})},Vu=function(t,e,n){return Uu(t,e,n).bind(function(e){return Hu.isRectangular(t,e)})},Gu={getAnyBox:Uu,getBox:Vu},Yu=function(t,e,n,r){return Mo.findItem(t,e,Vn.eq).bind(function(e){var o=n>0?e.row()+e.rowspan()-1:e.row(),i=r>0?e.column()+e.colspan()-1:e.column();return Mo.getAt(t,o+n,i+r).map(function(t){return t.element()})})},Xu=function(t,e,n){return Gu.getAnyBox(t,e,n).map(function(e){var n=Mo.filterItems(t,z.curry(Hu.inSelection,e));return Tt.map(n,function(t){return t.element()})})},$u=function(t,e){var n=function(t,e){return Vn.contains(e,t)};return Mo.findItem(t,e,n).bind(function(t){return t.element()})},Ku={moveBy:Yu,intercepts:Xu,parentCell:$u},Ju=function(t,e,n){return Ao.table(t).bind(function(r){var o=ea(r);return Ku.moveBy(o,t,e,n)})},Qu=function(t,e,n){var r=ea(t);return Ku.intercepts(r,e,n)},Zu=function(t,e,n,r,o){var i=ea(t),u=Vn.eq(t,n)?e:Ku.parentCell(i,e),a=Vn.eq(t,o)?r:Ku.parentCell(i,r);return Ku.intercepts(i,u,a)},ta=function(t,e,n){var r=ea(t);return Gu.getBox(r,e,n)},ea=function(t){var e=ko.fromTable(t);return Mo.generate(e)},na={moveBy:Ju,intercepts:Qu,nestedIntercepts:Zu,getBox:ta},ra=function(t,e){return fo.ancestor(t,"table")},oa=Gt.immutableBag(["boxes","start","finish"],[]),ia=function(t,e,n){var r=function(t){return function(e){return n(e)||Vn.eq(e,t)}};return Vn.eq(t,e)?X.some(oa({boxes:X.some([t]),start:t,finish:e})):ra(t).bind(function(o){return ra(e).bind(function(i){if(Vn.eq(o,i))return X.some(oa({boxes:na.intercepts(o,t,e),start:t,finish:e}));if(Vn.contains(o,i)){var u=Jr.ancestors(e,"td,th",r(o)),a=u.length>0?u[u.length-1]:e;return X.some(oa({boxes:na.nestedIntercepts(o,t,o,e,i),start:t,finish:a}))}if(Vn.contains(i,o)){var u=Jr.ancestors(t,"td,th",r(i)),c=u.length>0?u[u.length-1]:t;return X.some(oa({boxes:na.nestedIntercepts(i,t,o,e,i),start:t,finish:c}))}return Lu.ancestors(t,e).shared().bind(function(u){return fo.closest(u,"table",n).bind(function(n){var u=Jr.ancestors(e,"td,th",r(n)),a=u.length>0?u[u.length-1]:e,c=Jr.ancestors(t,"td,th",r(n)),l=c.length>0?c[c.length-1]:t;return X.some(oa({boxes:na.nestedIntercepts(n,t,o,e,i),start:l,finish:a}))})})})})},ua=function(t,e){var n=Jr.descendants(t,e);return n.length>0?X.some(n):X.none()},aa=function(t,e){return Tt.find(t,function(t){return ye.is(t,e)})},ca=function(t,e,n){return fo.descendant(t,e).bind(function(e){return fo.descendant(t,n).bind(function(t){return Lu.sharedOne(ra,[e,t]).map(function(n){return{first:z.constant(e),last:z.constant(t),table:z.constant(n)}})})})},la=function(t,e){return fo.ancestor(t,"table").bind(function(n){return fo.descendant(n,e).bind(function(e){return ia(e,t).bind(function(t){return t.boxes().map(function(e){return{boxes:z.constant(e),start:z.constant(t.start()),finish:z.constant(t.finish())}})})})})},sa=function(t,e,n,r,o){return aa(t,o).bind(function(t){return na.moveBy(t,e,n).bind(function(t){return la(t,r)})})},fa={identify:ia,retrieve:ua,shiftSelection:sa,getEdges:ca},da=function(t,e){return fa.retrieve(t,e)},ma=function(t,e,n){return fa.getEdges(t,e,n).bind(function(e){var n=function(e){return Vn.eq(t,e)},r=fo.ancestor(e.first(),"thead,tfoot,tbody,table",n),o=fo.ancestor(e.last(),"thead,tfoot,tbody,table",n);return r.bind(function(t){return o.bind(function(n){return Vn.eq(t,n)?na.getBox(e.table(),e.first(),e.last()):X.none()})})})},ga={retrieve:da,retrieveBox:ma},pa="data-mce-selected",ha={selected:z.constant(pa),selectedSelector:z.constant("td[data-mce-selected],th[data-mce-selected]"),attributeSelector:z.constant("[data-mce-selected]"),firstSelected:z.constant("data-mce-first-selected"),firstSelectedSelector:z.constant("td[data-mce-first-selected],th[data-mce-first-selected]"),lastSelected:z.constant("data-mce-last-selected"),lastSelectedSelector:z.constant("td[data-mce-last-selected],th[data-mce-last-selected]")},va=function(t){if(!Lt.isArray(t))throw new Error("cases must be an array");if(0===t.length)throw new Error("there must be at least one case");var e=[],n={};return Tt.each(t,function(r,o){var i=Wt.keys(r);if(1!==i.length)throw new Error("one and only one name per case");var u=i[0],a=r[u];if(void 0!==n[u])throw new Error("duplicate key detected:"+u);if("cata"===u)throw new Error("cannot have a case named cata (sorry)");if(!Lt.isArray(a))throw new Error("case arguments must be an array");e.push(u),n[u]=function(){var n=arguments.length;if(n!==a.length)throw new Error("Wrong number of arguments to case "+u+". Expected "+a.length+" ("+a+"), got "+n);for(var r=new Array(n),i=0;i<r.length;i++)r[i]=arguments[i];var c=function(t){var n=Wt.keys(t);if(e.length!==n.length)throw new Error("Wrong number of arguments to match. Expected: "+e.join(",")+"\nActual: "+n.join(","));if(!Tt.forall(e,function(t){return Tt.contains(n,t)}))throw new Error("Not all branches were specified when using match. Specified: "+n.join(", ")+"\nRequired: "+e.join(", "));return t[u].apply(null,r)};return{fold:function(){if(arguments.length!==t.length)throw new Error("Wrong number of arguments to fold. Expected "+t.length+", got "+arguments.length);return arguments[o].apply(null,r)},match:c,log:function(t){console.log(t,{constructors:e,constructor:u,params:r})}}}}),n},ba={generate:va},wa=ba.generate([{none:[]},{multiple:["elements"]},{single:["selection"]}]),ya=function(t,e,n,r){return t.fold(e,n,r)},xa={cata:ya,none:wa.none,multiple:wa.multiple,single:wa.single},Ca=function(t,e){return xa.cata(e.get(),z.constant([]),z.identity,z.constant([t]))},Sa=function(t,e){var n=function(t){return Wr.has(t,"rowspan")&&parseInt(Wr.get(t,"rowspan"),10)>1||Wr.has(t,"colspan")&&parseInt(Wr.get(t,"colspan"),10)>1},r=Ca(t,e);return r.length>0&&Tt.forall(r,n)?X.some(r):X.none()},Ra=function(t,e){return xa.cata(e.get(),X.none,function(e,n){return 0===e.length?X.none():ga.retrieveBox(t,ha.firstSelectedSelector(),ha.lastSelectedSelector()).bind(function(t){return e.length>1?X.some({bounds:z.constant(t),cells:z.constant(e)}):X.none()})},X.none)},Ta={mergable:Ra,unmergable:Sa,selection:Ca},Aa=function(t){return{element:z.constant(t),mergable:X.none,unmergable:X.none,selection:z.constant([t])}},Da=function(t,e,n){return{element:z.constant(n),mergable:z.constant(Ta.mergable(e,t)),unmergable:z.constant(Ta.unmergable(n,t)),selection:z.constant(Ta.selection(n,t))}},Ea=function(t){return Aa(t)},ka=Gt.immutable("element","clipboard","generators"),Oa=function(t,e,n,r,o){return{element:z.constant(n),mergable:X.none,unmergable:X.none,selection:z.constant(Ta.selection(n,t)),clipboard:z.constant(r),generators:z.constant(o)}},Na={noMenu:Aa,forMenu:Da,notCell:Ea,paste:ka,pasteRows:Oa},Ba=function(t){return Ao.table(t[0]).map(Ni.deep).map(function(t){return[Ri.extract(t,ha.attributeSelector())]})},Ia=function(t,e){return t.selection.serializer.serialize(e.dom(),{})},Pa=function(t,e,n,r){t.on("BeforeGetContent",function(n){var r=function(e){n.preventDefault(),Ba(e).each(function(e){n.content=Tt.map(e,function(e){return Ia(t,e)}).join("")})};!0===n.selection&&xa.cata(e.get(),z.noop,r,z.noop)}),t.on("BeforeSetContent",function(e){if(!0===e.selection&&!0===e.paste){X.from(t.dom.getParent(t.selection.getStart(),"th,td")).each(function(o){var i=de.fromDom(o);Ao.table(i).bind(function(o){var u=Tt.filter(uu.fromHtml(e.content),function(t){return"meta"!==Rr.name(t)});if(1===u.length&&"table"===Rr.name(u[0])){e.preventDefault();var a=de.fromDom(t.getDoc()),c=eu.paste(a),l=Na.paste(i,u[0],c);n.pasteCells(o,l).each(function(e){t.selection.setRng(e),t.focus(),r.clear(o)})}})})}})},Wa={registerEvents:Pa},Ma=function(){return de.fromTag("table")},_a=function(){return de.fromTag("tbody")},La=function(){return de.fromTag("tr")},Fa=function(){return de.fromTag("th")},qa=function(){return de.fromTag("td")},za=function(t,e,n,r){var o=Ma();ei.setAll(o,{"border-collapse":"collapse",width:"100%"}),Wr.set(o,"border","1");var i=_a();ci.append(o,i);for(var u=[],a=0;a<t;a++){for(var c=La(),l=0;l<e;l++){var s=a<n||l<r?Fa():qa();l<r&&Wr.set(s,"scope","row"),a<n&&Wr.set(s,"scope","col"),ci.append(s,de.fromTag("br")),ei.set(s,"width",100/e+"%"),ci.append(c,s)}u.push(c)}return mi.append(i,u),o},Ha={render:za},ja={render:Ha.render},Ua=function(t){return t.dom().innerHTML},Va=function(t,e){var n=dr.owner(t),r=n.dom(),o=de.fromDom(r.createDocumentFragment()),i=uu.fromHtml(e,r);mi.append(o,i),vi.empty(t),ci.append(t,o)},Ga=function(t){var e=de.fromTag("div"),n=de.fromDom(t.dom().cloneNode(!0));return ci.append(e,n),Ua(e)},Ya={get:Ua,set:Va,getOuter:Ga},Xa=function(t,e){t.selection.select(e.dom(),!0),t.selection.collapse(!0)},$a=function(t,e){fo.descendant(e,"td,th").each(z.curry(Xa,t))},Ka=function(t,e,n){var r,o=ja.render(n,e,0,0);Wr.set(o,"id","__mce");var i=Ya.getOuter(o);return t.insertContent(i),r=t.dom.get("__mce"),t.dom.setAttrib(r,"id",null),t.$("tr",r).each(function(e,n){t.fire("newrow",{node:n}),t.$("th,td",n).each(function(e,n){t.fire("newcell",{node:n})})}),t.dom.setAttribs(r,t.settings.table_default_attributes||{}),t.dom.setStyles(r,t.settings.table_default_styles||{}),$a(t,de.fromDom(r)),r},Ja={insert:Ka},Qa=i("height",function(t){return Fr.inBody(t)?t.dom().getBoundingClientRect().height:t.dom().offsetHeight}),Za=function(t,e){Qa.set(t,e)},tc=function(t){return Qa.get(t)},ec=function(t){return Qa.getOuter(t)},nc=function(t,e){var n=["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"],r=Qa.max(t,e,n);ei.set(t,"max-height",r+"px")},rc={set:Za,get:tc,getOuter:ec,setMax:nc},oc=i("width",function(t){return t.dom().offsetWidth}),ic=function(t,e){oc.set(t,e)},uc=function(t){return oc.get(t)},ac=function(t){return oc.getOuter(t)},cc=function(t,e){var n=["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"],r=oc.max(t,e,n);ei.set(t,"max-width",r+"px")},lc={set:ic,get:uc,getOuter:ac,setMax:cc},sc=_n.detect(),fc=function(){return sc.browser.isIE()||sc.browser.isEdge()},dc=function(t,e){var n=parseFloat(t);return isNaN(n)?e:n},mc=function(t,e,n){return dc(ei.get(t,e),n)},gc=function(t){var e=mc(t,"padding-top",0),n=mc(t,"padding-bottom",0),r=mc(t,"border-top-width",0),o=mc(t,"border-bottom-width",0),i=t.dom().getBoundingClientRect().height,u=ei.get(t,"box-sizing"),a=r+o;return"border-box"===u?i:i-e-n-a},pc=function(t){return mc(t,"width",lc.get(t))},hc=function(t){return fc()?gc(t):mc(t,"height",rc.get(t))},vc={getWidth:pc,getHeight:hc},bc=/(\d+(\.\d+)?)(\w|%)*/,wc=/(\d+(\.\d+)?)%/,yc=/(\d+(\.\d+)?)px|em/,xc=function(t,e){ei.set(t,"width",e+"px")},Cc=function(t,e){ei.set(t,"width",e+"%")},Sc=function(t,e){ei.set(t,"height",e+"px")},Rc=function(t){return ei.getRaw(t,"height").getOrThunk(function(){return vc.getHeight(t)+"px"})},Tc=function(t,e,n,r){var o=Ao.table(t).map(function(t){var r=n(t);return Math.floor(e/100*r)}).getOr(e);return r(t,o),o},Ac=function(t,e,n,r){var o=parseInt(t,10);return En.endsWith(t,"%")&&"table"!==Rr.name(e)?Tc(e,o,n,r):o},Dc=function(t){var e=Rc(t);return e?Ac(e,t,rc.get,Sc):rc.get(t)},Ec=function(t,e,n){return n(t)/kc(t,e)},kc=function(t,e){return Wr.has(t,e)?parseInt(Wr.get(t,e),10):1},Oc=function(t){return ei.getRaw(t,"width").fold(function(){return X.from(Wr.get(t,"width"))},function(t){return X.some(t)})},Nc=function(t,e){return t/e.pixelWidth()*100},Bc=function(t,e,n){if(wc.test(e)){var r=wc.exec(e);return parseFloat(r[1])}var o=lc.get(t),i=parseInt(o,10);return Nc(i,n)},Ic=function(t,e){return Oc(t).fold(function(){var n=lc.get(t),r=parseInt(n,10);return Nc(r,e)},function(n){return Bc(t,n,e)})},Pc=function(t,e){return t/100*e.pixelWidth()},Wc=function(t,e,n){if(yc.test(e)){var r=yc.exec(e);return parseInt(r[1],10)}if(wc.test(e)){var o=wc.exec(e),i=parseFloat(o[1]);return Pc(i,n)}var u=lc.get(t);return parseInt(u,10)},Mc=function(t,e){return Oc(t).fold(function(){var e=lc.get(t);return parseInt(e,10)},function(n){return Wc(t,n,e)})},_c=function(t){return Ec(t,"rowspan",Dc)},Lc=function(t){return Oc(t).bind(function(t){if(bc.test(t)){var e=bc.exec(t);return X.some({width:z.constant(e[1]),unit:z.constant(e[3])})}return X.none()})},Fc=function(t,e,n){ei.set(t,"width",e+n)},qc={percentageBasedSizeRegex:z.constant(wc),pixelBasedSizeRegex:z.constant(yc),setPixelWidth:xc,setPercentageWidth:Cc,setHeight:Sc,getPixelWidth:Mc,getPercentageWidth:Ic,getGenericWidth:Lc,setGenericWidth:Fc,getHeight:_c,getRawWidth:Oc},zc=function(t,e){qc.getGenericWidth(t).each(function(n){var r=n.width()/2;qc.setGenericWidth(t,r,n.unit()),qc.setGenericWidth(e,r,n.unit())})},Hc={halve:zc},jc=function(t,e){var n=e||de.fromDom(document.documentElement);return oo.ancestor(t,z.curry(Vn.eq,n)).isSome()},Uc=function(t){
var e=t.dom();return e===e.window?t:Rr.isDocument(t)?e.defaultView||e.parentWindow:null},Vc={attached:jc,windowOf:Uc},Gc=function(t,e){var n=function(n,r){return Gc(t+n,e+r)};return{left:z.constant(t),top:z.constant(e),translate:n}},Yc=function(t){var e=t.getBoundingClientRect();return Gc(e.left,e.top)},Xc=function(t,e){return void 0!==t?t:void 0!==e?e:0},$c=function(t){var e=t.dom().ownerDocument,n=e.body,r=Vc.windowOf(de.fromDom(e)),o=e.documentElement,i=Xc(r.pageYOffset,o.scrollTop),u=Xc(r.pageXOffset,o.scrollLeft),a=Xc(o.clientTop,n.clientTop),c=Xc(o.clientLeft,n.clientLeft);return Jc(t).translate(u-c,i-a)},Kc=function(t){var e=t.dom();return Gc(e.offsetLeft,e.offsetTop)},Jc=function(t){var e=t.dom(),n=e.ownerDocument,r=n.body,o=de.fromDom(n.documentElement);return r===e?Gc(r.offsetLeft,r.offsetTop):Vc.attached(t,o)?Yc(e):Gc(0,0)},Qc={absolute:$c,relative:Kc,viewport:Jc},Zc=Gt.immutable("row","y"),tl=Gt.immutable("col","x"),el=function(t){return Qc.absolute(t).left()+lc.getOuter(t)},nl=function(t){return Qc.absolute(t).left()},rl=function(t,e){return tl(t,nl(e))},ol=function(t,e){return tl(t,el(e))},il=function(t){return Qc.absolute(t).top()},ul=function(t,e){return Zc(t,il(e))},al=function(t,e){return Zc(t,il(e)+rc.getOuter(e))},cl=function(t,e,n){if(0===n.length)return[];var r=Tt.map(n.slice(1),function(e,n){return e.map(function(e){return t(n,e)})}),o=n[n.length-1].map(function(t){return e(n.length-1,t)});return r.concat([o])},ll=function(t,e){return-t},sl={delta:z.identity,positions:z.curry(cl,ul,al),edge:il},fl={delta:z.identity,edge:nl,positions:z.curry(cl,rl,ol)},dl={delta:ll,edge:el,positions:z.curry(cl,ol,rl)},ml={height:sl,rtl:dl,ltr:fl},gl={ltr:ml.ltr,rtl:ml.rtl},pl=function(t){var e=ko.fromTable(t);return Mo.generate(e).grid()},hl={getGridSize:pl},vl=function(t){var e=t,n=function(){return e};return{get:n,set:function(t){e=t},clone:function(){return vl(n())}}},bl=function(t,e){return wl(t,e,{validate:Lt.isFunction,label:"function"})},wl=function(t,e,n){if(0===e.length)throw new Error("You must specify at least one required field.");return Vt.validateStrArr("required",e),Vt.checkDupes(e),function(r){var o=Wt.keys(r);Tt.forall(e,function(t){return Tt.contains(o,t)})||Vt.reqMessage(e,o),t(e,o);var i=Tt.filter(e,function(t){return!n.validate(r[t],t)});return i.length>0&&Vt.invalidTypeMessage(i,n.label),r}},yl=function(t,e){var n=Tt.filter(e,function(e){return!Tt.contains(t,e)});n.length>0&&Vt.unsuppMessage(n)},xl=z.noop,Cl={exactly:z.curry(bl,yl),ensure:z.curry(bl,xl),ensureWith:z.curry(wl,xl)},Sl=function(t){var e=Wr.has(t,"colspan")?parseInt(Wr.get(t,"colspan"),10):1,n=Wr.has(t,"rowspan")?parseInt(Wr.get(t,"rowspan"),10):1;return{element:z.constant(t),colspan:z.constant(e),rowspan:z.constant(n)}},Rl=function(t,e){Dl(t);var n=vl(X.none()),r=void 0!==e?e:Sl,o=function(e){return t.cell(e)},i=function(t){var e=r(t);return o(e)},u=function(t){var e=i(t);return n.get().isNone()&&n.set(X.some(e)),a=X.some({item:t,replacement:e}),e},a=X.none();return{getOrInit:function(t,e){return a.fold(function(){return u(t)},function(n){return e(t,n.item)?n.replacement:u(t)})},cursor:n.get}},Tl=function(t,e){return function(n){var r=vl(X.none());Dl(n);var o=[],i=function(t,e){return Tt.find(o,function(n){return e(n.item,t)})},u=function(i){var u=n.replace(i,e,{scope:t});return o.push({item:i,sub:u}),r.get().isNone()&&r.set(X.some(u)),u};return{replaceOrInit:function(t,e){return i(t,e).fold(function(){return u(t)},function(n){return e(t,n.item)?n.sub:u(t)})},cursor:r.get}}},Al=function(t){Dl(t);var e=vl(X.none());return{combine:function(n){return e.get().isNone()&&e.set(X.some(n)),function(){var e=t.cell({element:z.constant(n),colspan:z.constant(1),rowspan:z.constant(1)});return ei.remove(e,"width"),ei.remove(n,"width"),e}},cursor:e.get}},Dl=Cl.exactly(["cell","row","replace","gap"]),El={modification:Rl,transform:Tl,merging:Al},kl=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],Ol=function(t,e){var n=t.property().name(e);return Tt.contains(["ol","ul"],n)},Nl=function(t,e){var n=t.property().name(e);return Tt.contains(kl,n)},Bl=function(t,e){var n=t.property().name(e);return Tt.contains(["address","pre","p","h1","h2","h3","h4","h5","h6"],n)},Il=function(t,e){var n=t.property().name(e);return Tt.contains(["h1","h2","h3","h4","h5","h6"],n)},Pl=function(t,e){return Tt.contains(["div","li","td","th","blockquote","body","caption"],t.property().name(e))},Wl=function(t,e){return Tt.contains(["br","img","hr","input"],t.property().name(e))},Ml=function(t,e){return"iframe"===t.property().name(e)},_l=function(t,e){return!(Nl(t,e)||Wl(t,e))&&"li"!==t.property().name(e)},Ll={isBlock:Nl,isList:Ol,isFormatting:Bl,isHeading:Il,isContainer:Pl,isEmptyTag:Wl,isFrame:Ml,isInline:_l},Fl=o(),ql=function(t){return Ll.isBlock(Fl,t)},zl=function(t){return Ll.isList(Fl,t)},Hl=function(t){return Ll.isFormatting(Fl,t)},jl=function(t){return Ll.isHeading(Fl,t)},Ul=function(t){return Ll.isContainer(Fl,t)},Vl=function(t){return Ll.isEmptyTag(Fl,t)},Gl=function(t){return Ll.isFrame(Fl,t)},Yl=function(t){return Ll.isInline(Fl,t)},Xl={isBlock:ql,isList:zl,isFormatting:Hl,isHeading:jl,isContainer:Ul,isEmptyTag:Vl,isFrame:Gl,isInline:Yl},$l=function(t){var e=function(t){return"br"===Rr.name(t)},n=function(t){return Tt.forall(t,function(t){return e(t)||Rr.isText(t)&&0===Mi.get(t).trim().length})},r=function(t){return"li"===Rr.name(t)||oo.ancestor(t,Xl.isList).isSome()},o=function(t){return dr.nextSibling(t).map(function(t){return!!Xl.isBlock(t)||(Xl.isEmptyTag(t)?"img"!==Rr.name(t):void 0)}).getOr(!1)},i=function(t){return Yi.last(t).bind(function(n){var i=o(n);return dr.parent(n).map(function(o){return!0===i||r(o)||e(n)||Xl.isBlock(o)&&!Vn.eq(t,o)?[]:[de.fromTag("br")]})}).getOr([])},u=function(){var e=Tt.bind(t,function(t){var e=dr.children(t);return n(e)?[]:e.concat(i(t))});return 0===e.length?[de.fromTag("br")]:e}();vi.empty(t[0]),mi.append(t[0],u)},Kl={merge:$l},Jl=function(t,e){return e},Ql=function(t,e){return Lt.isObject(t)&&Lt.isObject(e)?ts(t,e):e},Zl=function(t){return function(){for(var e=new Array(arguments.length),n=0;n<e.length;n++)e[n]=arguments[n];if(0===e.length)throw new Error("Can't merge zero objects");for(var r={},o=0;o<e.length;o++){var i=e[o];for(var u in i)i.hasOwnProperty(u)&&(r[u]=t(r[u],i[u]))}return r}},ts=Zl(Ql),es=Zl(Jl),ns={deepMerge:ts,merge:es},rs=function(t){for(var e=[],n=function(t){e.push(t)},r=0;r<t.length;r++)t[r].each(n);return e},os=function(t,e){for(var n=0;n<t.length;n++){var r=e(t[n],n);if(r.isSome())return r}return X.none()},is=function(t,e){for(var n=[],r=0;r<t.length;r++){var o=t[r];if(!o.isSome())return X.none();n.push(o.getOrDie())}return X.some(e.apply(null,n))},us={cat:rs,findMap:os,liftN:is},as=function(t,e,n){var r=t.cells(),o=r.slice(0,e),i=r.slice(e),u=o.concat([n]).concat(i);return ls(t,u)},cs=function(t,e,n){t.cells()[e]=n},ls=function(t,e){return ue.rowcells(e,t.section())},ss=function(t,e){var n=t.cells(),r=Tt.map(n,e);return ue.rowcells(r,t.section())},fs=function(t,e){return t.cells()[e]},ds=function(t,e){return fs(t,e).element()},ms=function(t){return t.cells().length},gs={addCell:as,setCells:ls,mutateCell:cs,getCell:fs,getCellElement:ds,mapCells:ss,cellLength:ms},ps=function(t,e){return Tt.map(t,function(t){return gs.getCell(t,e)})},hs=function(t,e){return t[e]},vs=function(t,e){if(0===t.length)return 0;var n=t[0];return Tt.findIndex(t,function(t){return!e(n.element(),t.element())}).fold(function(){return t.length},function(t){return t})},bs=function(t,e,n,r){var o=hs(t,e).cells().slice(n),i=vs(o,r),u=ps(t,n).slice(e),a=vs(u,r);return{colspan:z.constant(i),rowspan:z.constant(a)}},ws={subgrid:bs},ys=function(t,e){var n=Tt.map(t,function(t,e){return Tt.map(t.cells(),function(t,e){return!1})}),r=function(t,e,r,o){for(var i=t;i<t+r;i++)for(var u=e;u<e+o;u++)n[i][u]=!0};return Tt.map(t,function(o,i){var u=Tt.bind(o.cells(),function(o,u){if(!1===n[i][u]){var a=ws.subgrid(t,i,u,e);return r(i,u,a.rowspan(),a.colspan()),[ue.detailnew(o.element(),a.rowspan(),a.colspan(),o.isNew())]}return[]});return ue.rowdetails(u,o.section())})},xs=function(t,e,n){for(var r=[],o=0;o<t.grid().rows();o++){for(var i=[],u=0;u<t.grid().columns();u++){var a=Mo.getAt(t,o,u).map(function(t){return ue.elementnew(t.element(),n)}).getOrThunk(function(){return ue.elementnew(e.gap(),!0)});i.push(a)}var c=ue.rowcells(i,t.all()[o].section());r.push(c)}return r},Cs={toDetails:ys,toGrid:xs},Ss=function(t,e,n,r){n===r?Wr.remove(t,e):Wr.set(t,e,n)},Rs=function(t,e){var n=[],r=[],o=function(e,o){var i=fo.child(t,o).getOrThunk(function(){var e=de.fromTag(o,dr.owner(t).dom());return ci.append(t,e),e});vi.empty(i);var u=Tt.map(e,function(t){t.isNew()&&n.push(t.element());var e=t.element();return vi.empty(e),Tt.each(t.cells(),function(t){t.isNew()&&r.push(t.element()),Ss(t.element(),"colspan",t.colspan(),1),Ss(t.element(),"rowspan",t.rowspan(),1),ci.append(e,t.element())}),e});mi.append(i,u)},i=function(e){fo.child(t,e).bind(vi.remove)},u=function(t,e){t.length>0?o(t,e):i(e)},a=[],c=[],l=[];return Tt.each(e,function(t){switch(t.section()){case"thead":a.push(t);break;case"tbody":c.push(t);break;case"tfoot":l.push(t)}}),u(a,"thead"),u(c,"tbody"),u(l,"tfoot"),{newRows:z.constant(n),newCells:z.constant(r)}},Ts=function(t){return Tt.map(t,function(t){var e=Ni.shallow(t.element());return Tt.each(t.cells(),function(t){var n=Ni.deep(t.element());Ss(n,"colspan",t.colspan(),1),Ss(n,"rowspan",t.rowspan(),1),ci.append(e,n)}),e})},As={render:Rs,copy:Ts},Ds=function(t,e){for(var n=[],r=0;r<t;r++)n.push(e(r));return n},Es=function(t,e){for(var n=[],r=t;r<e;r++)n.push(r);return n},ks=function(t,e){var n=[];return Tt.each(t,function(r,o){o<t.length-1&&!e(r,t[o+1])?n.push(r):o===t.length-1&&n.push(r)}),n},Os=function(t,e){if(e<0||e>=t.length-1)return X.none();var n=t[e].fold(function(){var n=Tt.reverse(t.slice(0,e));return us.findMap(n,function(t,e){return t.map(function(t){return{value:t,delta:e+1}})})},function(t){return X.some({value:t,delta:0})}),r=t[e+1].fold(function(){var n=t.slice(e+1);return us.findMap(n,function(t,e){return t.map(function(t){return{value:t,delta:e+1}})})},function(t){return X.some({value:t,delta:1})});return n.bind(function(t){return r.map(function(e){var n=e.delta+t.delta;return Math.abs(e.value-t.value)/n})})},Ns={repeat:Ds,range:Es,unique:ks,deduce:Os},Bs=function(t){var e=t.grid(),n=Ns.range(0,e.columns()),r=Ns.range(0,e.rows());return Tt.map(n,function(e){return Is(function(){return Tt.bind(r,function(n){return Mo.getAt(t,n,e).filter(function(t){return t.column()===e}).fold(z.constant([]),function(t){return[t]})})},function(t){return 1===t.colspan()},function(){return Mo.getAt(t,0,e)})})},Is=function(t,e,n){var r=t();return Tt.find(r,e).orThunk(function(){return X.from(r[0]).orThunk(n)}).map(function(t){return t.element()})},Ps=function(t){var e=t.grid(),n=Ns.range(0,e.rows()),r=Ns.range(0,e.columns());return Tt.map(n,function(e){return Is(function(){return Tt.bind(r,function(n){return Mo.getAt(t,e,n).filter(function(t){return t.row()===e}).fold(z.constant([]),function(t){return[t]})})},function(t){return 1===t.rowspan()},function(){return Mo.getAt(t,e,0)})})},Ws={columns:Bs,rows:Ps},Ms=function(t,e,n,r,o){var i=de.fromTag("div");return ei.setAll(i,{position:"absolute",left:e-r/2+"px",top:n+"px",height:o+"px",width:r+"px"}),Wr.setAll(i,{"data-column":t,role:"presentation"}),i},_s=function(t,e,n,r,o){var i=de.fromTag("div");return ei.setAll(i,{position:"absolute",left:e+"px",top:n-o/2+"px",height:o+"px",width:r+"px"}),Wr.setAll(i,{"data-row":t,role:"presentation"}),i},Ls={col:Ms,row:_s},Fs=function(t){var e=t.replace(/\./g,"-");return{resolve:function(t){return e+"-"+t}}},qs={css:Fs},zs=qs.css("ephox-snooker"),Hs={resolve:zs.resolve},js=function(t,e){var n=Wr.get(t,e);return void 0===n||""===n?[]:n.split(" ")},Us=function(t,e,n){var r=js(t,e),o=r.concat([n]);Wr.set(t,e,o.join(" "))},Vs=function(t,e,n){var r=Tt.filter(js(t,e),function(t){return t!==n});r.length>0?Wr.set(t,e,r.join(" ")):Wr.remove(t,e)},Gs={read:js,add:Us,remove:Vs},Ys=function(t){return void 0!==t.dom().classList},Xs=function(t){return Gs.read(t,"class")},$s=function(t,e){return Gs.add(t,"class",e)},Ks=function(t,e){return Gs.remove(t,"class",e)},Js=function(t,e){Tt.contains(Xs(t),e)?Ks(t,e):$s(t,e)},Qs={get:Xs,add:$s,remove:Ks,toggle:Js,supports:Ys},Zs=function(t,e){Qs.supports(t)?t.dom().classList.add(e):Qs.add(t,e)},tf=function(t){0===(Qs.supports(t)?t.dom().classList:Qs.get(t)).length&&Wr.remove(t,"class")},ef=function(t,e){if(Qs.supports(t)){t.dom().classList.remove(e)}else Qs.remove(t,e);tf(t)},nf=function(t,e){return Qs.supports(t)?t.dom().classList.toggle(e):Qs.toggle(t,e)},rf=function(t,e){var n=Qs.supports(t),r=t.dom().classList;return a(function(){n?r.remove(e):Qs.remove(t,e)},function(){n?r.add(e):Qs.add(t,e)},of(t,e))},of=function(t,e){return Qs.supports(t)&&t.dom().classList.contains(e)},uf={add:Zs,remove:ef,toggle:nf,toggler:rf,has:of},af=Hs.resolve("resizer-bar"),cf=Hs.resolve("resizer-rows"),lf=Hs.resolve("resizer-cols"),sf=function(t){var e=Jr.descendants(t.parent(),"."+af);Tt.each(e,vi.remove)},ff=function(t,e,n){var r=t.origin();Tt.each(e,function(e,o){e.each(function(e){var o=n(r,e);uf.add(o,af),ci.append(t.parent(),o)})})},df=function(t,e,n,r){ff(t,e,function(t,e){var o=Ls.col(e.col(),e.x()-t.left(),n.top()-t.top(),7,r);return uf.add(o,lf),o})},mf=function(t,e,n,r){ff(t,e,function(t,e){var o=Ls.row(e.row(),n.left()-t.left(),e.y()-t.top(),r,7);return uf.add(o,cf),o})},gf=function(t,e,n,r,o,i){var u=Qc.absolute(e),a=n.length>0?o.positions(n,e):[];mf(t,a,u,lc.getOuter(e));var c=r.length>0?i.positions(r,e):[];df(t,c,u,rc.getOuter(e))},pf=function(t,e,n,r){sf(t);var o=ko.fromTable(e),i=Mo.generate(o),u=Ws.rows(i),a=Ws.columns(i);gf(t,e,u,a,n,r)},hf=function(t,e){var n=Jr.descendants(t.parent(),"."+af);Tt.each(n,e)},vf=function(t){hf(t,function(t){ei.set(t,"display","none")})},bf=function(t){hf(t,function(t){ei.set(t,"display","block")})},wf=function(t){return uf.has(t,cf)},yf=function(t){return uf.has(t,lf)},xf={refresh:pf,hide:vf,show:bf,destroy:sf,isRowBar:wf,isColBar:yf},Cf=function(t,e){return Cs.toGrid(t,e,!1)},Sf=function(t,e){var n=function(t){return us.findMap(t,function(t){return dr.parent(t.element()).map(function(t){var e=dr.parent(t).isNone();return ue.elementnew(t,e)})}).getOrThunk(function(){return ue.elementnew(e.row(),!0)})};return Tt.map(t,function(t){var e=n(t.details());return ue.rowdatanew(e.element(),t.details(),t.section(),e.isNew())})},Rf=function(t,e){var n=Cs.toDetails(t,Vn.eq);return Sf(n,e)},Tf=function(t,e){var n=Tt.flatten(Tt.map(t.all(),function(t){return t.cells()}));return Tt.find(n,function(t){return Vn.eq(e,t.element())})},Af=function(t,e,n,r,o){return function(i,u,a,c,l){var s=ko.fromTable(u),f=Mo.generate(s);return e(f,a).map(function(e){var n=Cf(f,c),r=t(n,e,Vn.eq,o(c)),i=Rf(r.grid(),c);return{grid:z.constant(i),cursor:r.cursor}}).fold(function(){return X.none()},function(t){var e=As.render(u,t.grid());return n(u,t.grid(),l),r(u),xf.refresh(i,u,ml.height,l),X.some({cursor:t.cursor,newRows:e.newRows,newCells:e.newCells})})}},Df=function(t,e){return Ao.cell(e.element()).bind(function(e){return Tf(t,e)})},Ef=function(t,e){return Ao.cell(e.element()).bind(function(n){return Tf(t,n).map(function(t){return ns.merge(t,{generators:e.generators,clipboard:e.clipboard})})})},kf=function(t,e){var n=Tt.map(e.selection(),function(e){return Ao.cell(e).bind(function(e){return Tf(t,e)})}),r=us.cat(n);return r.length>0?X.some(ns.merge({cells:r},{generators:e.generators,clipboard:e.clipboard})):X.none()},Of=function(t,e){return e.mergable()},Nf=function(t,e){return e.unmergable()},Bf=function(t,e){var n=Tt.map(e.selection(),function(e){return Ao.cell(e).bind(function(e){return Tf(t,e)})}),r=us.cat(n);return r.length>0?X.some(r):X.none()},If={run:Af,toDetailList:Rf,onCell:Df,onCells:Bf,onPaste:Ef,onPasteRows:kf,onMergable:Of,onUnmergable:Nf},Pf=function(t){var e=function(e){return t===e},n=function(e){return Pf(t)},r=function(e){return Pf(t)},o=function(e){return Pf(e(t))},i=function(e){e(t)},u=function(e){return e(t)},a=function(e,n){return n(t)},c=function(e){return e(t)},l=function(e){return e(t)},s=function(){return X.some(t)};return{is:e,isValue:z.constant(!0),isError:z.constant(!1),getOr:z.constant(t),getOrThunk:z.constant(t),getOrDie:z.constant(t),or:n,orThunk:r,fold:a,map:o,each:i,bind:u,exists:c,forall:l,toOption:s}},Wf=function(t){var e=function(t){return t()},n=function(){return z.die(t)()},r=function(t){return t},o=function(t){return t()},i=function(e){return Wf(t)},u=function(e){return Wf(t)},a=function(e,n){return e(t)};return{is:z.constant(!1),isValue:z.constant(!1),isError:z.constant(!0),getOr:z.identity,getOrThunk:e,getOrDie:n,or:r,orThunk:o,fold:a,map:i,each:z.noop,bind:u,exists:z.constant(!1),forall:z.constant(!0),toOption:X.none}},Mf={value:Pf,error:Wf},_f=function(t,e,n){if(t.row()>=e.length||t.column()>gs.cellLength(e[0]))return Mf.error("invalid start address out of table bounds, row: "+t.row()+", column: "+t.column());var r=e.slice(t.row()),o=r[0].cells().slice(t.column()),i=gs.cellLength(n[0]),u=n.length;return Mf.value({rowDelta:z.constant(r.length-u),colDelta:z.constant(o.length-i)})},Lf=function(t,e){var n=gs.cellLength(t[0]),r=gs.cellLength(e[0]);return{rowDelta:z.constant(0),colDelta:z.constant(n-r)}},Ff=function(t,e){return Tt.map(t,function(){return ue.elementnew(e.cell(),!0)})},qf=function(t,e,n){return t.concat(Ns.repeat(e,function(e){return gs.setCells(t[t.length-1],Ff(t[t.length-1].cells(),n))}))},zf=function(t,e,n){return Tt.map(t,function(t){return gs.setCells(t,t.cells().concat(Ff(Ns.range(0,e),n)))})},Hf=function(t,e,n){var r=e.colDelta()<0?zf:z.identity;return(e.rowDelta()<0?qf:z.identity)(r(t,Math.abs(e.colDelta()),n),Math.abs(e.rowDelta()),n)},jf={measure:_f,measureWidth:Lf,tailor:Hf},Uf=function(t,e,n,r){if(0===t.length)return t;for(var o=e.startRow();o<=e.finishRow();o++)for(var i=e.startCol();i<=e.finishCol();i++)gs.mutateCell(t[o],i,ue.elementnew(r(),!1));return t},Vf=function(t,e,n,r){for(var o=!0,i=0;i<t.length;i++)for(var u=0;u<gs.cellLength(t[0]);u++){var a=gs.getCellElement(t[i],u),c=n(a,e);!0===c&&!1===o?gs.mutateCell(t[i],u,ue.elementnew(r(),!0)):!0===c&&(o=!1)}return t},Gf=function(t,e){return Tt.foldl(t,function(t,n){return Tt.exists(t,function(t){return e(t.element(),n.element())})?t:t.concat([n])},[])},Yf=function(t,e,n,r){if(e>0&&e<t.length){var o=t[e-1].cells(),i=Gf(o,n);Tt.each(i,function(o){for(var i=X.none(),u=e;u<t.length;u++)for(var a=0;a<gs.cellLength(t[0]);a++){var c=t[u].cells()[a],l=n(c.element(),o.element());l&&(i.isNone()&&(i=X.some(r())),i.each(function(e){gs.mutateCell(t[u],a,ue.elementnew(e,!0))}))}})}return t},Xf={merge:Uf,unmerge:Vf,splitRows:Yf},$f=function(t,e,n,r){var o=gs.getCell(t[e],n),i=z.curry(r,o.element()),u=t[e];return t.length>1&&gs.cellLength(u)>1&&(n>0&&i(gs.getCellElement(u,n-1))||n<u.length-1&&i(gs.getCellElement(u,n+1))||e>0&&i(gs.getCellElement(t[e-1],n))||e<t.length-1&&i(gs.getCellElement(t[e+1],n)))},Kf=function(t,e,n,r,o){for(var i=t.row(),u=t.column(),a=n.length,c=gs.cellLength(n[0]),l=i+a,s=u+c,f=i;f<l;f++)for(var d=u;d<s;d++){$f(e,f,d,o)&&Xf.unmerge(e,gs.getCellElement(e[f],d),o,r.cell);var m=gs.getCellElement(n[f-i],d-u),g=r.replace(m);gs.mutateCell(e[f],d,ue.elementnew(g,!0))}return e},Jf=function(t,e,n,r,o){return jf.measure(t,e,n).map(function(i){var u=jf.tailor(e,i,r);return Kf(t,u,n,r,o)})},Qf=function(t,e,n,r,o){Xf.splitRows(e,t,o,r.cell);var i=jf.measureWidth(n,e),u=jf.tailor(n,i,r),a=jf.measureWidth(e,u),c=jf.tailor(e,a,r);return c.slice(0,t).concat(u).concat(c.slice(t,c.length))},Zf={merge:Jf,insert:Qf},td=function(t,e,n,r,o){var i=t.slice(0,e),u=t.slice(e),a=gs.mapCells(t[n],function(n,i){return e>0&&e<t.length&&r(gs.getCellElement(t[e-1],i),gs.getCellElement(t[e],i))?gs.getCell(t[e],i):ue.elementnew(o(n.element(),r),!0)});return i.concat([a]).concat(u)},ed=function(t,e,n,r,o){return Tt.map(t,function(t){var i=e>0&&e<gs.cellLength(t)&&r(gs.getCellElement(t,e-1),gs.getCellElement(t,e)),u=i?gs.getCell(t,e):ue.elementnew(o(gs.getCellElement(t,n),r),!0);return gs.addCell(t,e,u)})},nd=function(t,e,n,r,o){var i=n+1;return Tt.map(t,function(t,u){var a=u===e,c=a?ue.elementnew(o(gs.getCellElement(t,n),r),!0):gs.getCell(t,n);return gs.addCell(t,i,c)})},rd=function(t,e,n,r,o){var i=e+1,u=t.slice(0,i),a=t.slice(i),c=gs.mapCells(t[e],function(t,e){return e===n?ue.elementnew(o(t.element(),r),!0):t});return u.concat([c]).concat(a)},od=function(t,e,n){var r=Tt.map(t,function(t){var r=t.cells().slice(0,e).concat(t.cells().slice(n+1));return ue.rowcells(r,t.section())});return Tt.filter(r,function(t){return t.cells().length>0})},id=function(t,e,n){return t.slice(0,e).concat(t.slice(n+1))},ud={insertRowAt:td,insertColumnAt:ed,splitCellIntoColumns:nd,splitCellIntoRows:rd,deleteRowsAt:id,deleteColumnsAt:od},ad=function(t,e,n,r){var o=function(t){return Tt.exists(e,function(e){return n(t.element(),e.element())})};return Tt.map(t,function(t){return gs.mapCells(t,function(t){return o(t)?ue.elementnew(r(t.element(),n),!0):t})})},cd=function(t,e,n,r){return void 0!==gs.getCellElement(t[e],n)&&e>0&&r(gs.getCellElement(t[e-1],n),gs.getCellElement(t[e],n))},ld=function(t,e,n){return e>0&&n(gs.getCellElement(t,e-1),gs.getCellElement(t,e))},sd=function(t,e,n,r){var o=Tt.bind(t,function(r,o){return cd(t,o,e,n)||ld(r,e,n)?[]:[gs.getCell(r,e)]});return ad(t,o,n,r)},fd=function(t,e,n,r){var o=t[e],i=Tt.bind(o.cells(),function(r,i){return cd(t,e,i,n)||ld(o,i,n)?[]:[r]});return ad(t,i,n,r)},dd={replaceColumn:sd,replaceRow:fd},md=function(){return bd(function(t,e,n,r,o){return t()})},gd=function(t){return bd(function(e,n,r,o,i){return n(t)})},pd=function(t,e){return bd(function(n,r,o,i,u){return o(t,e)})},hd=function(t,e,n){return bd(function(r,o,i,u,a){return u(t,e,n)})},vd=function(t,e){return bd(function(n,r,o,i,u){return u(t,e)})},bd=function(t){return{fold:t}},wd={none:md,only:gd,left:pd,middle:hd,right:vd},yd=function(t,e){return 0===t.length?wd.none():1===t.length?wd.only(0):0===e?wd.left(0,1):e===t.length-1?wd.right(e-1,e):e>0&&e<t.length-1?wd.middle(e-1,e,e+1):wd.none()},xd=function(t,e,n,r){var o=t.slice(0),i=yd(t,e),u=function(t){return Tt.map(t,z.constant(0))},a=z.constant(u(o)),c=function(t){return r.singleColumnWidth(o[t],n)},l=function(t,e){if(n>=0){var i=Math.max(r.minCellWidth(),o[e]-n);return u(o.slice(0,t)).concat([n,i-o[e]]).concat(u(o.slice(e+1)))}var a=Math.max(r.minCellWidth(),o[t]+n),c=o[t]-a;return u(o.slice(0,t)).concat([a-o[t],c]).concat(u(o.slice(e+1)))},s=l,f=function(t,e,n){return l(e,n)},d=function(t,e){if(n>=0)return u(o.slice(0,e)).concat([n]);var i=Math.max(r.minCellWidth(),o[e]+n);return u(o.slice(0,e)).concat([i-o[e]])};return i.fold(a,c,s,f,d)},Cd={determine:xd},Sd=function(t,e){return Wr.has(t,e)&&parseInt(Wr.get(t,e),10)>1},Rd=function(t){return Sd(t,"colspan")},Td=function(t){return Sd(t,"rowspan")},Ad=function(t,e){return parseInt(ei.get(t,e),10)},Dd={hasColspan:Rd,hasRowspan:Td,minWidth:z.constant(10),minHeight:z.constant(10),getInt:Ad},Ed=function(t,e,n){return ei.getRaw(t,e).fold(function(){return n(t)+"px"},function(t){return t})},kd=function(t){return Ed(t,"width",qc.getPixelWidth)},Od=function(t){return Ed(t,"height",qc.getHeight)},Nd=function(t,e,n,r,o){var i=Ws.columns(t),u=Tt.map(i,function(t){return t.map(e.edge)});return Tt.map(i,function(t,e){return t.filter(z.not(Dd.hasColspan)).fold(function(){var t=Ns.deduce(u,e);return r(t)},function(t){return n(t,o)})})},Bd=function(t){return t.map(function(t){return t+"px"}).getOr("")},Id=function(t,e){return Nd(t,e,kd,Bd)},Pd=function(t,e,n){return Nd(t,e,qc.getPercentageWidth,function(t){return t.fold(function(){return n.minCellWidth()},function(t){return t/n.pixelWidth()*100})},n)},Wd=function(t,e,n){return Nd(t,e,qc.getPixelWidth,function(t){return t.getOrThunk(n.minCellWidth)},n)},Md=function(t,e,n,r){var o=Ws.rows(t),i=Tt.map(o,function(t){return t.map(e.edge)});return Tt.map(o,function(t,e){return t.filter(z.not(Dd.hasRowspan)).fold(function(){var t=Ns.deduce(i,e);return r(t)},function(t){return n(t)})})},_d=function(t,e){return Md(t,e,qc.getHeight,function(t){return t.getOrThunk(Dd.minHeight)})},Ld=function(t,e){return Md(t,e,Od,Bd)},Fd={getRawWidths:Id,getPixelWidths:Wd,getPercentageWidths:Pd,getPixelHeights:_d,getRawHeights:Ld},qd=function(t,e,n){for(var r=0,o=t;o<e;o++)r+=void 0!==n[o]?n[o]:0;return r},zd=function(t,e){var n=Mo.justCells(t);return Tt.map(n,function(t){var n=qd(t.column(),t.column()+t.colspan(),e);return{element:t.element,width:z.constant(n),colspan:t.colspan}})},Hd=function(t,e){var n=Mo.justCells(t);return Tt.map(n,function(t){var n=qd(t.row(),t.row()+t.rowspan(),e);return{element:t.element,height:z.constant(n),rowspan:t.rowspan}})},jd=function(t,e){return Tt.map(t.all(),function(t,n){return{element:t.element,height:z.constant(e[n])}})},Ud={recalculateWidth:zd,recalculateHeight:Hd,matchRowHeight:jd},Vd=function(t,e){var n=parseFloat(t),r=lc.get(e),o=function(t){return t/r*100},i=function(t,e){return[100-t]},u=function(){return Dd.minWidth()/r*100},a=function(t,e,r){var o=n+r;qc.setPercentageWidth(t,o)};return{width:z.constant(n),pixelWidth:z.constant(r),getWidths:Fd.getPercentageWidths,getCellDelta:o,singleColumnWidth:i,minCellWidth:u,setElementWidth:qc.setPercentageWidth,setTableWidth:a}},Gd=function(t){var e=parseInt(t,10),n=z.identity,r=function(t,e){return[Math.max(Dd.minWidth(),t+e)-t]},o=function(t,e,n){var r=Tt.foldr(e,function(t,e){return t+e},0);qc.setPixelWidth(t,r)};return{width:z.constant(e),pixelWidth:z.constant(e),getWidths:Fd.getPixelWidths,getCellDelta:n,singleColumnWidth:r,minCellWidth:Dd.minWidth,setElementWidth:qc.setPixelWidth,setTableWidth:o}},Yd=function(t,e){if(qc.percentageBasedSizeRegex().test(e)){var n=qc.percentageBasedSizeRegex().exec(e);return Vd(n[1],t)}if(qc.pixelBasedSizeRegex().test(e)){var r=qc.pixelBasedSizeRegex().exec(e);return Gd(r[1])}var o=lc.get(t);return Gd(o)},Xd=function(t){return qc.getRawWidth(t).fold(function(){var e=lc.get(t);return Gd(e)},function(e){return Yd(t,e)})},$d={getTableSize:Xd},Kd=function(t){return Mo.generate(t)},Jd=function(t){return Tt.foldr(t,function(t,e){return t+e},0)},Qd=function(t){var e=ko.fromTable(t);return Kd(e)},Zd=function(t,e,n,r){var o=$d.getTableSize(t),i=o.getCellDelta(e),u=Qd(t),a=o.getWidths(u,r,o),c=Cd.determine(a,n,i,o),l=Tt.map(c,function(t,e){return t+a[e]}),s=Ud.recalculateWidth(u,l);Tt.each(s,function(t){o.setElementWidth(t.element(),t.width())}),n===u.grid().columns()-1&&o.setTableWidth(t,l,i)},tm=function(t,e,n,r){var o=Qd(t),i=Fd.getPixelHeights(o,r),u=Tt.map(i,function(t,r){return n===r?Math.max(e+t,Dd.minHeight()):t}),a=Ud.recalculateHeight(o,u),c=Ud.matchRowHeight(o,u);Tt.each(c,function(t){qc.setHeight(t.element(),t.height())}),Tt.each(a,function(t){qc.setHeight(t.element(),t.height())});var l=Jd(u);qc.setHeight(t,l)},em=function(t,e,n){var r=$d.getTableSize(t),o=Kd(e),i=r.getWidths(o,n,r),u=Ud.recalculateWidth(o,i);Tt.each(u,function(t){r.setElementWidth(t.element(),t.width())});var a=Tt.foldr(i,function(t,e){return e+t},0);u.length>0&&r.setElementWidth(t,a)},nm={adjustWidth:Zd,adjustHeight:tm,adjustWidthTo:em},rm=function(t){0===Ao.cells(t).length&&vi.remove(t)},om=Gt.immutable("grid","cursor"),im=function(t,e,n){return um(t,e,n).orThunk(function(){return um(t,0,0)})},um=function(t,e,n){return X.from(t[e]).bind(function(t){return X.from(t.cells()[n]).bind(function(t){return X.from(t.element())})})},am=function(t,e,n){return om(t,um(t,e,n))},cm=function(t){return Tt.foldl(t,function(t,e){return Tt.exists(t,function(t){return t.row()===e.row()})?t:t.concat([e])},[]).sort(function(t,e){return t.row()-e.row()})},lm=function(t){return Tt.foldl(t,function(t,e){return Tt.exists(t,function(t){return t.column()===e.column()})?t:t.concat([e])},[]).sort(function(t,e){return t.column()-e.column()})},sm=function(t,e,n,r){var o=e.row(),i=e.row(),u=ud.insertRowAt(t,i,o,n,r.getOrInit);return am(u,i,e.column())},fm=function(t,e,n,r){var o=e[0].row(),i=e[0].row(),u=cm(e),a=Tt.foldl(u,function(t,e){return ud.insertRowAt(t,i,o,n,r.getOrInit)},t);return am(a,i,e[0].column())},dm=function(t,e,n,r){var o=e.row(),i=e.row()+e.rowspan(),u=ud.insertRowAt(t,i,o,n,r.getOrInit);return am(u,i,e.column())},mm=function(t,e,n,r){var o=cm(e),i=o[o.length-1].row(),u=o[o.length-1].row()+o[o.length-1].rowspan(),a=Tt.foldl(o,function(t,e){return ud.insertRowAt(t,u,i,n,r.getOrInit)},t);return am(a,u,e[0].column())},gm=function(t,e,n,r){var o=e.column(),i=e.column(),u=ud.insertColumnAt(t,i,o,n,r.getOrInit);return am(u,e.row(),i)},pm=function(t,e,n,r){var o=lm(e),i=o[0].column(),u=o[0].column(),a=Tt.foldl(o,function(t,e){return ud.insertColumnAt(t,u,i,n,r.getOrInit)},t);return am(a,e[0].row(),u)},hm=function(t,e,n,r){var o=e.column(),i=e.column()+e.colspan(),u=ud.insertColumnAt(t,i,o,n,r.getOrInit);return am(u,e.row(),i)},vm=function(t,e,n,r){var o=e[e.length-1].column(),i=e[e.length-1].column()+e[e.length-1].colspan(),u=lm(e),a=Tt.foldl(u,function(t,e){return ud.insertColumnAt(t,i,o,n,r.getOrInit)},t);return am(a,e[0].row(),i)},bm=function(t,e,n,r){var o=dd.replaceRow(t,e.row(),n,r.replaceOrInit);return am(o,e.row(),e.column())},wm=function(t,e,n,r){var o=dd.replaceColumn(t,e.column(),n,r.replaceOrInit);return am(o,e.row(),e.column())},ym=function(t,e,n,r){var o=dd.replaceRow(t,e.row(),n,r.replaceOrInit);return am(o,e.row(),e.column())},xm=function(t,e,n,r){var o=dd.replaceColumn(t,e.column(),n,r.replaceOrInit);return am(o,e.row(),e.column())},Cm=function(t,e,n,r){var o=ud.splitCellIntoColumns(t,e.row(),e.column(),n,r.getOrInit);return am(o,e.row(),e.column())},Sm=function(t,e,n,r){var o=ud.splitCellIntoRows(t,e.row(),e.column(),n,r.getOrInit);return am(o,e.row(),e.column())},Rm=function(t,e,n,r){var o=lm(e),i=ud.deleteColumnsAt(t,o[0].column(),o[o.length-1].column()),u=im(i,e[0].row(),e[0].column());return om(i,u)},Tm=function(t,e,n,r){var o=cm(e),i=ud.deleteRowsAt(t,o[0].row(),o[o.length-1].row()),u=im(i,e[0].row(),e[0].column());return om(i,u)},Am=function(t,e,n,r){var o=e.cells();Kl.merge(o);var i=Xf.merge(t,e.bounds(),n,z.constant(o[0]));return om(i,X.from(o[0]))},Dm=function(t,e,n,r){var o=Tt.foldr(e,function(t,e){return Xf.unmerge(t,e,n,r.combine(e))},t);return om(o,X.from(e[0]))},Em=function(t,e,n,r){var o=function(t,e){var n=ko.fromTable(t),r=Mo.generate(n);return Cs.toGrid(r,e,!0)}(e.clipboard(),e.generators()),i=ue.address(e.row(),e.column());return Zf.merge(i,t,o,e.generators(),n).fold(function(){return om(t,X.some(e.element()))},function(t){var n=im(t,e.row(),e.column());return om(t,n)})},km=function(t,e,n){var r=ko.fromPastedRows(t,n),o=Mo.generate(r);return Cs.toGrid(o,e,!0)},Om=function(t,e,n,r){var o=t[e.cells[0].row()],i=e.cells[0].row(),u=km(e.clipboard(),e.generators(),o),a=Zf.insert(i,t,u,e.generators(),n),c=im(a,e.cells[0].row(),e.cells[0].column());return om(a,c)},Nm=function(t,e,n,r){var o=t[e.cells[0].row()],i=e.cells[e.cells.length-1].row()+e.cells[e.cells.length-1].rowspan(),u=km(e.clipboard(),e.generators(),o),a=Zf.insert(i,t,u,e.generators(),n),c=im(a,e.cells[0].row(),e.cells[0].column());return om(a,c)},Bm=nm.adjustWidthTo,Im={insertRowBefore:If.run(sm,If.onCell,z.noop,z.noop,El.modification),insertRowsBefore:If.run(fm,If.onCells,z.noop,z.noop,El.modification),insertRowAfter:If.run(dm,If.onCell,z.noop,z.noop,El.modification),insertRowsAfter:If.run(mm,If.onCells,z.noop,z.noop,El.modification),insertColumnBefore:If.run(gm,If.onCell,Bm,z.noop,El.modification),insertColumnsBefore:If.run(pm,If.onCells,Bm,z.noop,El.modification),insertColumnAfter:If.run(hm,If.onCell,Bm,z.noop,El.modification),insertColumnsAfter:If.run(vm,If.onCells,Bm,z.noop,El.modification),splitCellIntoColumns:If.run(Cm,If.onCell,Bm,z.noop,El.modification),
splitCellIntoRows:If.run(Sm,If.onCell,z.noop,z.noop,El.modification),eraseColumns:If.run(Rm,If.onCells,Bm,rm,El.modification),eraseRows:If.run(Tm,If.onCells,z.noop,rm,El.modification),makeColumnHeader:If.run(wm,If.onCell,z.noop,z.noop,El.transform("row","th")),unmakeColumnHeader:If.run(xm,If.onCell,z.noop,z.noop,El.transform(null,"td")),makeRowHeader:If.run(bm,If.onCell,z.noop,z.noop,El.transform("col","th")),unmakeRowHeader:If.run(ym,If.onCell,z.noop,z.noop,El.transform(null,"td")),mergeCells:If.run(Am,If.onMergable,z.noop,z.noop,El.merging),unmergeCells:If.run(Dm,If.onUnmergable,Bm,z.noop,El.merging),pasteCells:If.run(Em,If.onPaste,Bm,z.noop,El.modification),pasteRowsBefore:If.run(Om,If.onPasteRows,z.noop,z.noop,El.modification),pasteRowsAfter:If.run(Nm,If.onPasteRows,z.noop,z.noop,El.modification)},Pm=function(t){return de.fromDom(t.getBody())},Wm=function(t){return function(e){return Vn.eq(e,Pm(t))}},Mm=function(t){return t?t.replace(/px$/,""):""},_m=function(t){return/^[0-9]+$/.test(t)&&(t+="px"),t},Lm={getBody:Pm,getIsRoot:Wm,addSizeSuffix:_m,removePxSuffix:Mm},Fm=function(t,e){return function(n){return"rtl"===qm(n)?e:t}},qm=function(t){return"rtl"===ei.get(t,"direction")?"rtl":"ltr"},zm={onDirection:Fm,getDirection:qm},Hm={isRtl:z.constant(!1)},jm={isRtl:z.constant(!0)},Um=function(t){return"rtl"===zm.getDirection(t)?jm:Hm},Vm={directionAt:Um},Gm=function(t,e,n){var r=ko.fromTable(t),o=Mo.generate(r);return If.onCells(o,e).map(function(t){var e=Cs.toGrid(o,n,!1),r=e.slice(t[0].row(),t[t.length-1].row()+t[t.length-1].rowspan()),i=If.toDetailList(r,n);return As.copy(i)})},Ym={copyRows:Gm},Xm=tinymce.util.Tools.resolve("tinymce.util.Tools"),$m=tinymce.util.Tools.resolve("tinymce.Env"),Km=function(t,e,n){var r,o=t.select("td,th",e);return r=function(e,r){for(var o=0;o<r.length;o++){var i=t.getStyle(r[o],n);if(void 0===e&&(e=i),e!==i)return""}return e}(r,o)},Jm=function(t,e,n){n&&t.formatter.apply("align"+n,{},e)},Qm=function(t,e,n){n&&t.formatter.apply("valign"+n,{},e)},Zm=function(t,e){Xm.each("left center right".split(" "),function(n){t.formatter.remove("align"+n,{},e)})},tg=function(t,e){Xm.each("top middle bottom".split(" "),function(n){t.formatter.remove("valign"+n,{},e)})},eg={applyAlign:Jm,applyVAlign:Qm,unApplyAlign:Zm,unApplyVAlign:tg,getTDTHOverallStyle:Km},ng=function(t,e,n){var r=function(t,n){return n=n||[],Xm.each(t,function(t){var o={text:t.text||t.title};t.menu?o.menu=r(t.menu):(o.value=t.value,e&&e(o)),n.push(o)}),n};return r(t,n||[])},rg=function(t,e){var n=t.dom,r=e.control.rootControl,o=r.toJSON(),i=n.parseStyle(o.style);"style"===e.control.name()?(r.find("#borderStyle").value(i["border-style"]||"")[0].fire("select"),r.find("#borderColor").value(i["border-color"]||"")[0].fire("change"),r.find("#backgroundColor").value(i["background-color"]||"")[0].fire("change"),r.find("#width").value(i.width||"").fire("change"),r.find("#height").value(i.height||"").fire("change")):(i["border-style"]=o.borderStyle,i["border-color"]=o.borderColor,i["background-color"]=o.backgroundColor,i.width=o.width?Lm.addSizeSuffix(o.width):"",i.height=o.height?Lm.addSizeSuffix(o.height):""),r.find("#style").value(n.serializeStyle(n.parseStyle(n.serializeStyle(i))))},og=function(t,e){var n=t.parseStyle(t.getAttrib(e,"style")),r={};return n["border-style"]&&(r.borderStyle=n["border-style"]),n["border-color"]&&(r.borderColor=n["border-color"]),n["background-color"]&&(r.backgroundColor=n["background-color"]),r.style=t.serializeStyle(n),r},ig=function(t){var e=function(){var e=t.settings.color_picker_callback;if(e)return function(n){return e.call(t,function(t){n.control.value(t).fire("change")},n.control.value())}};return{title:"Advanced",type:"form",defaults:{onchange:z.curry(rg,t)},items:[{label:"Style",name:"style",type:"textbox"},{type:"form",padding:0,formItemDefaults:{layout:"grid",alignH:["start","right"]},defaults:{size:7},items:[{label:"Border style",type:"listbox",name:"borderStyle",width:90,onselect:z.curry(rg,t),values:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{label:"Border color",type:"colorbox",name:"borderColor",onaction:e()},{label:"Background color",type:"colorbox",name:"backgroundColor",onaction:e()}]}]}},ug={createStyleForm:ig,buildListItems:ng,updateStyleField:rg,extractAdvancedStyles:og},ag=function(t,e){var n=t.dom,r={width:n.getStyle(e,"width")||n.getAttrib(e,"width"),height:n.getStyle(e,"height")||n.getAttrib(e,"height"),cellspacing:n.getStyle(e,"border-spacing")||n.getAttrib(e,"cellspacing"),cellpadding:n.getAttrib(e,"data-mce-cell-padding")||n.getAttrib(e,"cellpadding")||eg.getTDTHOverallStyle(t.dom,e,"padding"),border:n.getAttrib(e,"data-mce-border")||n.getAttrib(e,"border")||eg.getTDTHOverallStyle(t.dom,e,"border"),borderColor:n.getAttrib(e,"data-mce-border-color"),caption:!!n.select("caption",e)[0],class:n.getAttrib(e,"class")};return Xm.each("left center right".split(" "),function(n){t.formatter.matchNode(e,"align"+n)&&(r.align=n)}),!1!==t.settings.table_advtab&&Xm.extend(r,ug.extractAdvancedStyles(n,e)),r},cg=function(t,e,n){var r=t.dom,o={},i={};if(o.class=n.class,i.height=Lm.addSizeSuffix(n.height),r.getAttrib(e,"width")&&!t.settings.table_style_by_css?o.width=Lm.removePxSuffix(n.width):i.width=Lm.addSizeSuffix(n.width),t.settings.table_style_by_css?(i["border-width"]=Lm.addSizeSuffix(n.border),i["border-spacing"]=Lm.addSizeSuffix(n.cellspacing),Xm.extend(o,{"data-mce-border-color":n.borderColor,"data-mce-cell-padding":n.cellpadding,"data-mce-border":n.border})):Xm.extend(o,{border:n.border,cellpadding:n.cellpadding,cellspacing:n.cellspacing}),t.settings.table_style_by_css&&e.children)for(var u=0;u<e.children.length;u++)l(r,e.children[u],{"border-width":Lm.addSizeSuffix(n.border),"border-color":n.borderColor,padding:Lm.addSizeSuffix(n.cellpadding)});n.style?Xm.extend(i,r.parseStyle(n.style)):i=Xm.extend({},r.parseStyle(r.getAttrib(e,"style")),i),o.style=r.serializeStyle(i),r.setAttribs(e,o)},lg=function(t,e,n){var r,o,i=t.dom;ug.updateStyleField(t,n),o=n.control.rootControl.toJSON(),!1===o.class&&delete o.class,t.undoManager.transact(function(){e||(e=Ja.insert(t,o.cols||1,o.rows||1)),cg(t,e,o),r=i.select("caption",e)[0],r&&!o.caption&&i.remove(r),!r&&o.caption&&(r=i.create("caption"),r.innerHTML=$m.ie?" ":'<br data-mce-bogus="1"/>',e.insertBefore(r,e.firstChild)),eg.unApplyAlign(t,e),o.align&&eg.applyAlign(t,e,o.align),t.focus(),t.addVisual()})},sg=function(t,e){var n,r,o,i,u,a=t.dom,c={};!0===e?(n=a.getParent(t.selection.getStart(),"table"))&&(c=ag(t,n)):(r={label:"Cols",name:"cols"},o={label:"Rows",name:"rows"}),t.settings.table_class_list&&(c.class&&(c.class=c.class.replace(/\s*mce\-item\-table\s*/g,"")),i={name:"class",type:"listbox",label:"Class",values:ug.buildListItems(t.settings.table_class_list,function(e){e.value&&(e.textStyle=function(){return t.formatter.getCssText({block:"table",classes:[e.value]})})})}),u={type:"form",layout:"flex",direction:"column",labelGapCalc:"children",padding:0,items:[{type:"form",labelGapCalc:!1,padding:0,layout:"grid",columns:2,defaults:{type:"textbox",maxWidth:50},items:!1!==t.settings.table_appearance_options?[r,o,{label:"Width",name:"width",onchange:z.curry(ug.updateStyleField,t)},{label:"Height",name:"height",onchange:z.curry(ug.updateStyleField,t)},{label:"Cell spacing",name:"cellspacing"},{label:"Cell padding",name:"cellpadding"},{label:"Border",name:"border"},{label:"Caption",name:"caption",type:"checkbox"}]:[r,o,{label:"Width",name:"width",onchange:z.curry(ug.updateStyleField,t)},{label:"Height",name:"height",onchange:z.curry(ug.updateStyleField,t)}]},{label:"Alignment",name:"align",type:"listbox",text:"None",values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},i]},!1!==t.settings.table_advtab?t.windowManager.open({title:"Table properties",data:c,bodyType:"tabpanel",body:[{title:"General",type:"form",items:u},ug.createStyleForm(t)],onsubmit:z.curry(lg,t,n)}):t.windowManager.open({title:"Table properties",data:c,body:u,onsubmit:z.curry(lg,t,n)})},fg={open:sg},dg=function(t,e){var n=t.dom,r={height:n.getStyle(e,"height")||n.getAttrib(e,"height"),scope:n.getAttrib(e,"scope"),class:n.getAttrib(e,"class")};return r.type=e.parentNode.nodeName.toLowerCase(),Xm.each("left center right".split(" "),function(n){t.formatter.matchNode(e,"align"+n)&&(r.align=n)}),!1!==t.settings.table_row_advtab&&Xm.extend(r,ug.extractAdvancedStyles(n,e)),r},mg=function(t,e,n){var r=t.getParent(e,"table"),o=e.parentNode,i=t.select(n,r)[0];i||(i=t.create(n),r.firstChild?"CAPTION"===r.firstChild.nodeName?t.insertAfter(i,r.firstChild):r.insertBefore(i,r.firstChild):r.appendChild(i)),i.appendChild(e),o.hasChildNodes()||t.remove(o)},gg=function(t){var e,n,r,o,i,u,a=t.dom,c=[];e=a.getParent(t.selection.getStart(),"table"),n=a.getParent(t.selection.getStart(),"td,th"),Xm.each(e.rows,function(t){Xm.each(t.cells,function(e){if(a.getAttrib(e,"data-mce-selected")||e===n)return c.push(t),!1})}),(r=c[0])&&(i=c.length>1?{height:"",scope:"",class:"",align:"",type:r.parentNode.nodeName.toLowerCase()}:dg(t,r),t.settings.table_row_class_list&&(o={name:"class",type:"listbox",label:"Class",values:ug.buildListItems(t.settings.table_row_class_list,function(e){e.value&&(e.textStyle=function(){return t.formatter.getCssText({block:"tr",classes:[e.value]})})})}),u={type:"form",columns:2,padding:0,defaults:{type:"textbox"},items:[{type:"listbox",name:"type",label:"Row type",text:"Header",maxWidth:null,values:[{text:"Header",value:"thead"},{text:"Body",value:"tbody"},{text:"Footer",value:"tfoot"}]},{type:"listbox",name:"align",label:"Alignment",text:"None",maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height"},o]},!1!==t.settings.table_row_advtab?t.windowManager.open({title:"Row properties",data:i,bodyType:"tabpanel",body:[{title:"General",type:"form",items:u},ug.createStyleForm(t)],onsubmit:z.curry(s,t,c)}):t.windowManager.open({title:"Row properties",data:i,body:u,onsubmit:z.curry(s,t,c)}))},pg={open:gg},hg=function(t,e){t.style.cssText+=";"+e},vg=function(t,e){var n=t.dom,r={width:n.getStyle(e,"width")||n.getAttrib(e,"width"),height:n.getStyle(e,"height")||n.getAttrib(e,"height"),scope:n.getAttrib(e,"scope"),class:n.getAttrib(e,"class")};return r.type=e.nodeName.toLowerCase(),Xm.each("left center right".split(" "),function(n){t.formatter.matchNode(e,"align"+n)&&(r.align=n)}),Xm.each("top middle bottom".split(" "),function(n){t.formatter.matchNode(e,"valign"+n)&&(r.valign=n)}),!1!==t.settings.table_cell_advtab&&Xm.extend(r,ug.extractAdvancedStyles(n,e)),r},bg=function(t,e,n){function r(t,e,n){n&&u.setAttrib(t,e,n)}function o(t,e,n){n&&u.setStyle(t,e,n)}var i,u=t.dom;ug.updateStyleField(t,n),i=n.control.rootControl.toJSON(),t.undoManager.transact(function(){Xm.each(e,function(n){r(n,"scope",i.scope),1===e.length?r(n,"style",i.style):hg(n,i.style),r(n,"class",i.class),o(n,"width",Lm.addSizeSuffix(i.width)),o(n,"height",Lm.addSizeSuffix(i.height)),i.type&&n.nodeName.toLowerCase()!==i.type&&(n=u.rename(n,i.type)),1===e.length&&(eg.unApplyAlign(t,n),eg.unApplyVAlign(t,n)),i.align&&eg.applyAlign(t,n,i.align),i.valign&&eg.applyVAlign(t,n,i.valign)}),t.focus()})},wg=function(t){var e,n,r,o=[];if(o=t.dom.select("td[data-mce-selected],th[data-mce-selected]"),e=t.dom.getParent(t.selection.getStart(),"td,th"),!o.length&&e&&o.push(e),e=e||o[0]){n=o.length>1?{width:"",height:"",scope:"",class:"",align:"",style:"",type:e.nodeName.toLowerCase()}:vg(t,e),t.settings.table_cell_class_list&&(r={name:"class",type:"listbox",label:"Class",values:ug.buildListItems(t.settings.table_cell_class_list,function(e){e.value&&(e.textStyle=function(){return t.formatter.getCssText({block:"td",classes:[e.value]})})})});var i={type:"form",layout:"flex",direction:"column",labelGapCalc:"children",padding:0,items:[{type:"form",layout:"grid",columns:2,labelGapCalc:!1,padding:0,defaults:{type:"textbox",maxWidth:50},items:[{label:"Width",name:"width",onchange:z.curry(ug.updateStyleField,t)},{label:"Height",name:"height",onchange:z.curry(ug.updateStyleField,t)},{label:"Cell type",name:"type",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{label:"Scope",name:"scope",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{label:"H Align",name:"align",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"V Align",name:"valign",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}]},r]};!1!==t.settings.table_cell_advtab?t.windowManager.open({title:"Cell properties",bodyType:"tabpanel",data:n,body:[{title:"General",type:"form",items:i},ug.createStyleForm(t)],onsubmit:z.curry(bg,t,o)}):t.windowManager.open({title:"Cell properties",data:n,body:i,onsubmit:z.curry(bg,t,o)})}},yg={open:wg},xg=Xm.each,Cg=X.none(),Sg=function(){return Cg.fold(function(){},function(t){return Tt.map(t,function(t){return t.dom()})})},Rg=function(t){var e=Tt.map(t,de.fromDom);Cg=X.from(e)},Tg=function(t,e,n,r){var o=Lm.getIsRoot(t),i=function(){var e=de.fromDom(t.dom.getParent(t.selection.getStart(),"th,td"));Ao.table(e,o).filter(z.not(o)).each(function(e){var n=de.fromText("");ci.after(e,n),vi.remove(e);var r=t.dom.createRng();r.setStart(n.dom(),0),r.setEnd(n.dom(),0),t.selection.setRng(r)})},u=function(){return de.fromDom(t.dom.getParent(t.selection.getStart(),"th,td"))},a=function(t){return Ao.table(t,o)},c=function(e){var o=u();a(o).each(function(i){var u=Na.forMenu(r,i,o);e(i,u).each(function(e){t.selection.setRng(e),t.focus(),n.clear(i)})})},l=function(e){var n=u();return a(n).bind(function(e){var o=de.fromDom(t.getDoc()),i=Na.forMenu(r,e,n),u=eu.cellOperations(z.noop,o,X.none());return Ym.copyRows(e,i,u)})},s=function(e){Cg.each(function(o){var i=Tt.map(o,function(t){return Ni.deep(t)}),c=u();a(c).bind(function(o){var u=de.fromDom(t.getDoc()),a=eu.paste(u),l=Na.pasteRows(r,o,c,i,a);e(o,l).each(function(e){t.selection.setRng(e),t.focus(),n.clear(o)})})})};xg({mceTableSplitCells:function(){c(e.unmergeCells)},mceTableMergeCells:function(){c(e.mergeCells)},mceTableInsertRowBefore:function(){c(e.insertRowsBefore)},mceTableInsertRowAfter:function(){c(e.insertRowsAfter)},mceTableInsertColBefore:function(){c(e.insertColumnsBefore)},mceTableInsertColAfter:function(){c(e.insertColumnsAfter)},mceTableDeleteCol:function(){c(e.deleteColumn)},mceTableDeleteRow:function(){c(e.deleteRow)},mceTableCutRow:function(t){Cg=l(),c(e.deleteRow)},mceTableCopyRow:function(t){Cg=l()},mceTablePasteRowBefore:function(t){s(e.pasteRowsBefore)},mceTablePasteRowAfter:function(t){s(e.pasteRowsAfter)},mceTableDelete:i},function(e,n){t.addCommand(n,e)}),xg({mceInsertTable:z.curry(fg.open,t),mceTableProps:z.curry(fg.open,t,!0),mceTableRowProps:z.curry(pg.open,t),mceTableCellProps:z.curry(yg.open,t)},function(e,n){t.addCommand(n,function(t,n){e(n)})})},Ag={registerCommands:Tg,getClipboardRows:Sg,setClipboardRows:Rg},Dg=function(t){var e=X.from(t.dom().documentElement).map(de.fromDom).getOr(t);return{parent:z.constant(e),view:z.constant(t),origin:z.constant(Gc(0,0))}},Eg=function(t,e){var n=z.curry(Qc.absolute,e);return{parent:z.constant(e),view:z.constant(t),origin:n}},kg=function(t,e){return{parent:z.constant(e),view:z.constant(t),origin:z.constant(Gc(0,0))}},Og={only:Dg,detached:Eg,body:kg},Ng=function(t){return{registry:Wt.map(t,function(t){return{bind:t.bind,unbind:t.unbind}}),trigger:Wt.map(t,function(t){return t.trigger})}},Bg={create:Ng},Ig=Cl.exactly(["compare","extract","mutate","sink"]),Pg=Cl.exactly(["element","start","stop","destroy"]),Wg=Cl.exactly(["forceDrop","drop","move","delayDrop"]),Mg={mode:Ig,sink:Pg,api:Wg},_g=qs.css("ephox-dragster"),Lg={resolve:_g.resolve},Fg=function(t,e,n,r,o,i,u){return{target:z.constant(t),x:z.constant(e),y:z.constant(n),stop:r,prevent:o,kill:i,raw:z.constant(u)}},qg=function(t,e){return function(n){if(t(n)){var r=de.fromDom(n.target),o=function(){n.stopPropagation()},i=function(){n.preventDefault()},u=z.compose(i,o),a=Fg(r,n.clientX,n.clientY,o,i,u,n);e(a)}}},zg=function(t,e,n,r,o){var i=qg(n,r);return t.dom().addEventListener(e,i,o),{unbind:z.curry(Ug,t,e,i,o)}},Hg=function(t,e,n,r){return zg(t,e,n,r,!1)},jg=function(t,e,n,r){return zg(t,e,n,r,!0)},Ug=function(t,e,n,r){t.dom().removeEventListener(e,n,r)},Vg={bind:Hg,capture:jg},Gg=z.constant(!0),Yg=function(t,e,n){return Vg.bind(t,e,Gg,n)},Xg=function(t,e,n){return Vg.capture(t,e,Gg,n)},$g={bind:Yg,capture:Xg},Kg=function(t,e){return Gc(e.left()-t.left(),e.top()-t.top())},Jg=function(t){return X.some(Gc(t.x(),t.y()))},Qg=function(t,e){t.mutate(e.left(),e.top())},Zg=function(t,e){var n=d(e),r=$g.bind(n.element(),"mousedown",t.forceDrop),o=$g.bind(n.element(),"mouseup",t.drop),i=$g.bind(n.element(),"mousemove",t.move),u=$g.bind(n.element(),"mouseout",t.delayDrop),a=function(){n.destroy(),o.unbind(),i.unbind(),u.unbind(),r.unbind()},c=function(t){ci.append(t,n.element())},l=function(){vi.remove(n.element())};return Mg.sink({element:n.element,start:c,stop:l,destroy:a})},tp=Mg.mode({compare:Kg,extract:Jg,sink:Zg,mutate:Qg}),ep=function(t,e){var n=null,r=null;return{cancel:function(){null!==n&&(clearTimeout(n),n=null,r=null)},throttle:function(){r=arguments,null===n&&(n=setTimeout(function(){t.apply(null,r),n=null,r=null},e))}}},np=function(t,e){var n=null;return{cancel:function(){null!==n&&(clearTimeout(n),n=null)},throttle:function(){var r=arguments;null===n&&(n=setTimeout(function(){t.apply(null,r),n=null,r=null},e))}}},rp=function(t,e){var n=null;return{cancel:function(){null!==n&&(clearTimeout(n),n=null)},throttle:function(){var r=arguments;null!==n&&clearTimeout(n),n=setTimeout(function(){t.apply(null,r),n=null,r=null},e)}}},op={adaptable:ep,first:np,last:rp},ip=function(t,e,n){var r=!1,o=Bg.create({start:f([]),stop:f([])}),i=p(),u=function(){g.stop(),i.isOn()&&(i.off(),o.trigger.stop())},a=op.last(u,200),c=function(t){g.start(t),i.on(),o.trigger.start()},l=function(t,n){a.cancel(),i.onEvent(t,e)};i.events.move.bind(function(n){e.mutate(t,n.info())});var s=function(){r=!0},d=function(){r=!1},m=function(t){return function(){var e=Array.prototype.slice.call(arguments,0);if(r)return t.apply(null,e)}},g=e.sink(Mg.api({forceDrop:u,drop:m(u),move:m(l),delayDrop:m(a.throttle)}),n),h=function(){g.destroy()};return{element:g.element,go:c,on:s,off:d,destroy:h,events:o.registry}},up={setup:ip},ap=function(t,e){var n=void 0!==e?e:{},r=void 0!==n.mode?n.mode:tp;return up.setup(t,r,e)},cp={transform:ap},lp=function(t){return fo.first(t).isSome()},sp=function(t,e,n){return fo.ancestor(t,e,n).isSome()},fp=function(t,e){return fo.sibling(t,e).isSome()},dp=function(t,e){return fo.child(t,e).isSome()},mp=function(t,e){return fo.descendant(t,e).isSome()},gp=function(t,e,n){return fo.closest(t,e,n).isSome()},pp={any:lp,ancestor:sp,sibling:fp,child:dp,descendant:mp,closest:gp},hp=Hs.resolve("resizer-bar-dragging"),vp=function(){var t=de.fromTag("div");return ei.setAll(t,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),ci.append(Fr.body(),t),t},bp=function(t,e){return t.inline?Og.body(Lm.getBody(t),vp()):Og.only(de.fromDom(t.getDoc()))},wp=function(t,e){t.inline&&vi.remove(e.parent())},yp={get:bp,remove:wp},xp=function(t){return Tp(function(e,n,r,o){return e(t)})},Cp=function(t){return Tp(function(e,n,r,o){return n(t)})},Sp=function(t,e){return Tp(function(n,r,o,i){return o(t,e)})},Rp=function(t){return Tp(function(e,n,r,o){return o(t)})},Tp=function(t){return{fold:t}},Ap={none:xp,first:Cp,middle:Sp,last:Rp},Dp=function(t,e){return Ao.table(t,e).bind(function(e){var n=Ao.cells(e);return Tt.findIndex(n,function(e){return Vn.eq(t,e)}).map(function(t){return{index:z.constant(t),all:z.constant(n)}})})},Ep=function(t,e){return Dp(t,e).fold(function(){return Ap.none(t)},function(e){return e.index()+1<e.all().length?Ap.middle(t,e.all()[e.index()+1]):Ap.last(t)})},kp=function(t,e){return Dp(t,e).fold(function(){return Ap.none()},function(e){return e.index()-1>=0?Ap.middle(t,e.all()[e.index()-1]):Ap.first(t)})},Op={next:Ep,prev:kp},Np=ba.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Bp=function(t,e,n,r){return t.fold(e,n,r)},Ip=function(t){return t.fold(z.identity,z.identity,z.identity)},Pp={before:Np.before,on:Np.on,after:Np.after,cata:Bp,getStart:Ip},Wp=ba.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Mp=Gt.immutable("start","soffset","finish","foffset"),_p=function(t){return Wp.exact(t.start(),t.soffset(),t.finish(),t.foffset())},Lp=function(t){return t.match({domRange:function(t){return de.fromDom(t.startContainer)},relative:function(t,e){return Pp.getStart(t)},exact:function(t,e,n,r){return t}})},Fp=function(t){var e=Lp(t);return dr.defaultView(e)},qp={domRange:Wp.domRange,relative:Wp.relative,exact:Wp.exact,exactFromRange:_p,range:Mp,getWin:Fp},zp=function(t,e,n,r){var o=dr.owner(t),i=o.dom().createRange();return i.setStart(t.dom(),e),i.setEnd(n.dom(),r),i},Hp=function(t,e,n,r){var o=zp(t,e,n,r);return de.fromDom(o.commonAncestorContainer)},jp=function(t,e,n,r){var o=zp(t,e,n,r),i=Vn.eq(t,n)&&e===r;return o.collapsed&&!i},Up={after:jp,commonAncestorContainer:Hp},Vp=function(t,e){var n=e||document,r=n.createDocumentFragment();return Tt.each(t,function(t){r.appendChild(t.dom())}),de.fromDom(r)},Gp={fromElements:Vp},Yp=function(t,e){var n=t.document.createRange();return Xp(n,e),n},Xp=function(t,e){t.selectNodeContents(e.dom())},$p=function(t,e){return e.compareBoundaryPoints(t.END_TO_START,t)<1&&e.compareBoundaryPoints(t.START_TO_END,t)>-1},Kp=function(t){return t.document.createRange()},Jp=function(t,e){e.fold(function(e){t.setStartBefore(e.dom())},function(e,n){t.setStart(e.dom(),n)},function(e){t.setStartAfter(e.dom())})},Qp=function(t,e){e.fold(function(e){t.setEndBefore(e.dom())},function(e,n){t.setEnd(e.dom(),n)},function(e){t.setEndAfter(e.dom())})},Zp=function(t,e){nh(t),t.insertNode(e.dom())},th=function(t,e,n){var r=t.document.createRange();return Jp(r,e),Qp(r,n),r},eh=function(t,e,n,r,o){var i=t.document.createRange();return i.setStart(e.dom(),n),i.setEnd(r.dom(),o),i},nh=function(t){t.deleteContents()},rh=function(t){var e=t.cloneContents();return de.fromDom(e)},oh=function(t){return{left:z.constant(t.left),top:z.constant(t.top),right:z.constant(t.right),bottom:z.constant(t.bottom),width:z.constant(t.width),height:z.constant(t.height)}},ih=function(t){var e=t.getClientRects(),n=e.length>0?e[0]:t.getBoundingClientRect();return n.width>0||n.height>0?X.some(n).map(oh):X.none()},uh=function(t){var e=t.getBoundingClientRect();return e.width>0||e.height>0?X.some(e).map(oh):X.none()},ah=function(t){return t.toString()},ch={create:Kp,replaceWith:Zp,selectNodeContents:Yp,selectNodeContentsUsing:Xp,relativeToNative:th,exactToNative:eh,deleteContents:nh,cloneFragment:rh,getFirstRect:ih,getBounds:uh,isWithin:$p,toString:ah},lh=ba.generate([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),sh=function(t,e,n){return e(de.fromDom(n.startContainer),n.startOffset,de.fromDom(n.endContainer),n.endOffset)},fh=function(t,e){return e.match({domRange:function(t){return{ltr:z.constant(t),rtl:X.none}},relative:function(e,n){return{ltr:Fe.cached(function(){return ch.relativeToNative(t,e,n)}),rtl:Fe.cached(function(){return X.some(ch.relativeToNative(t,n,e))})}},exact:function(e,n,r,o){return{ltr:Fe.cached(function(){return ch.exactToNative(t,e,n,r,o)}),rtl:Fe.cached(function(){return X.some(ch.exactToNative(t,r,o,e,n))})}}})},dh=function(t,e){var n=e.ltr();if(n.collapsed){return e.rtl().filter(function(t){return!1===t.collapsed}).map(function(t){return lh.rtl(de.fromDom(t.endContainer),t.endOffset,de.fromDom(t.startContainer),t.startOffset)}).getOrThunk(function(){return sh(0,lh.ltr,n)})}return sh(0,lh.ltr,n)},mh=function(t,e){var n=fh(t,e);return dh(0,n)},gh=function(t,e){return mh(t,e).match({ltr:function(e,n,r,o){var i=t.document.createRange();return i.setStart(e.dom(),n),i.setEnd(r.dom(),o),i},rtl:function(e,n,r,o){var i=t.document.createRange();return i.setStart(r.dom(),o),i.setEnd(e.dom(),n),i}})},ph={ltr:lh.ltr,rtl:lh.rtl,diagnose:mh,asLtrRange:gh},hh=function(t,e,n,r,o){if(0===o)return 0;if(e===r)return o-1;for(var i=r,u=1;u<o;u++){var a=t(u),c=Math.abs(e-a.left);if(n>a.bottom);else{if(n<a.top||c>i)return u-1;i=c}}return 0},vh=function(t,e,n){return e>=t.left&&e<=t.right&&n>=t.top&&n<=t.bottom},bh={inRect:vh,searchForPoint:hh},wh=function(t,e,n,r,o){var i=function(n){var r=t.dom().createRange();return r.setStart(e.dom(),n),r.collapse(!0),r},u=function(t){return i(t).getBoundingClientRect()},a=Mi.get(e).length,c=bh.searchForPoint(u,n,r,o.right,a);return i(c)},yh=function(t,e,n,r){var o=t.dom().createRange();o.selectNode(e.dom());var i=o.getClientRects();return us.findMap(i,function(t){return bh.inRect(t,n,r)?X.some(t):X.none()}).map(function(o){return wh(t,e,n,r,o)})},xh={locate:yh},Ch=function(t,e,n,r){var o=t.dom().createRange(),i=dr.children(e);return us.findMap(i,function(e){return o.selectNode(e.dom()),bh.inRect(o.getBoundingClientRect(),n,r)?Sh(t,e,n,r):X.none()})},Sh=function(t,e,n,r){return(Rr.isText(e)?xh.locate:Ch)(t,e,n,r)},Rh=function(t,e,n,r){var o=t.dom().createRange();o.selectNode(e.dom());var i=o.getBoundingClientRect(),u=Math.max(i.left,Math.min(i.right,n)),a=Math.max(i.top,Math.min(i.bottom,r));return Sh(t,e,u,a)},Th={locate:Rh},Ah=function(t,e){return e-t.left<t.right-e},Dh=function(t,e,n){var r=t.dom().createRange();return r.selectNode(e.dom()),r.collapse(n),r},Eh=function(t,e,n){var r=t.dom().createRange();r.selectNode(e.dom());var o=r.getBoundingClientRect(),i=Ah(o,n);return(!0===i?Yi.first:Yi.last)(e).map(function(e){return Dh(t,e,i)})},kh=function(t,e,n){var r=e.dom().getBoundingClientRect(),o=Ah(r,n);return X.some(Dh(t,e,o))},Oh=function(t,e,n){return(0===dr.children(e).length?kh:Eh)(t,e,n)},Nh={search:Oh},Bh=function(t,e,n){return X.from(t.dom().caretPositionFromPoint(e,n)).bind(function(e){if(null===e.offsetNode)return X.none();var n=t.dom().createRange();return n.setStart(e.offsetNode,e.offset),n.collapse(),X.some(n)})},Ih=function(t,e,n){return X.from(t.dom().caretRangeFromPoint(e,n))},Ph=function(t,e,n,r){var o=t.dom().createRange();o.selectNode(e.dom());var i=o.getBoundingClientRect(),u=Math.max(i.left,Math.min(i.right,n)),a=Math.max(i.top,Math.min(i.bottom,r));return Th.locate(t,e,u,a)},Wh=function(t,e,n){return de.fromPoint(t,e,n).bind(function(r){var o=function(){return Nh.search(t,r,e)};return 0===dr.children(r).length?o():Ph(t,r,e,n).orThunk(o)})},Mh=document.caretPositionFromPoint?Bh:document.caretRangeFromPoint?Ih:Wh,_h=function(t,e,n){var r=de.fromDom(t.document);return Mh(r,e,n).map(function(t){return qp.range(de.fromDom(t.startContainer),t.startOffset,de.fromDom(t.endContainer),t.endOffset)})},Lh={fromPoint:_h},Fh=function(t,e,n,r){var o=ch.create(t),i=ye.is(e,r)?[e]:[],u=i.concat(Jr.descendants(e,r));return Tt.filter(u,function(t){return ch.selectNodeContentsUsing(o,t),ch.isWithin(n,o)})},qh=function(t,e,n){var r=ph.asLtrRange(t,e),o=de.fromDom(r.commonAncestorContainer);return Rr.isElement(o)?Fh(t,o,r,n):[]},zh={find:qh},Hh=function(t,e){var n=Rr.name(t);return"input"===n?Pp.after(t):Tt.contains(["br","img"],n)?0===e?Pp.before(t):Pp.after(t):Pp.on(t,e)},jh=function(t,e){var n=t.fold(Pp.before,Hh,Pp.after),r=e.fold(Pp.before,Hh,Pp.after);return qp.relative(n,r)},Uh=function(t,e,n,r){var o=Hh(t,e),i=Hh(n,r);return qp.relative(o,i)},Vh=function(t){return t.match({domRange:function(t){var e=de.fromDom(t.startContainer),n=de.fromDom(t.endContainer);return Uh(e,t.startOffset,n,t.endOffset)},relative:jh,exact:Uh})},Gh={beforeSpecial:Hh,preprocess:Vh,preprocessRelative:jh,preprocessExact:Uh},Yh=function(t,e){X.from(t.getSelection()).each(function(t){t.removeAllRanges(),t.addRange(e)})},Xh=function(t,e,n,r,o){var i=ch.exactToNative(t,e,n,r,o);Yh(t,i)},$h=function(t,e,n){return zh.find(t,e,n)},Kh=function(t,e){return ph.diagnose(t,e).match({ltr:function(e,n,r,o){Xh(t,e,n,r,o)},rtl:function(e,n,r,o){var i=t.getSelection();i.extend?(i.collapse(e.dom(),n),i.extend(r.dom(),o)):Xh(t,r,o,e,n)}})},Jh=function(t,e,n,r,o){var i=Gh.preprocessExact(e,n,r,o);Kh(t,i)},Qh=function(t,e,n){var r=Gh.preprocessRelative(e,n);Kh(t,r)},Zh=function(t){var e=qp.getWin(t).dom(),n=function(t,n,r,o){return ch.exactToNative(e,t,n,r,o)},r=Gh.preprocess(t);return ph.diagnose(e,r).match({ltr:n,rtl:n})},tv=function(t){if(t.rangeCount>0){var e=t.getRangeAt(0),n=t.getRangeAt(t.rangeCount-1);return X.some(qp.range(de.fromDom(e.startContainer),e.startOffset,de.fromDom(n.endContainer),n.endOffset))}return X.none()},ev=function(t){var e=de.fromDom(t.anchorNode),n=de.fromDom(t.focusNode);return Up.after(e,t.anchorOffset,n,t.focusOffset)?X.some(qp.range(de.fromDom(t.anchorNode),t.anchorOffset,de.fromDom(t.focusNode),t.focusOffset)):tv(t)},nv=function(t,e){var n=ch.selectNodeContents(t,e);Yh(t,n)},rv=function(t,e){var n=ch.selectNodeContents(t,e);return qp.range(de.fromDom(n.startContainer),n.startOffset,de.fromDom(n.endContainer),n.endOffset)},ov=function(t){var e=t.getSelection();return e.rangeCount>0?ev(e):X.none()},iv=function(t){return ov(t).map(function(t){return qp.exact(t.start(),t.soffset(),t.finish(),t.foffset())})},uv=function(t,e){var n=ph.asLtrRange(t,e);return ch.getFirstRect(n)},av=function(t,e){var n=ph.asLtrRange(t,e);return ch.getBounds(n)},cv=function(t,e,n){return Lh.fromPoint(t,e,n)},lv=function(t,e){var n=ph.asLtrRange(t,e);return ch.toString(n)},sv=function(t){t.getSelection().removeAllRanges()},fv=function(t,e){var n=ph.asLtrRange(t,e);return ch.cloneFragment(n)},dv=function(t,e,n){var r=ph.asLtrRange(t,e),o=Gp.fromElements(n,t.document);ch.replaceWith(r,o)},mv=function(t,e){var n=ph.asLtrRange(t,e);ch.deleteContents(n)},gv=function(t,e,n,r){return Vn.eq(t,n)&&e===r},pv={setExact:Jh,getExact:ov,get:iv,setRelative:Qh,toNative:Zh,setToElement:nv,clear:sv,clone:fv,replace:dv,deleteAt:mv,forElement:rv,getFirstRect:uv,getBounds:av,getAtPoint:cv,findWithin:$h,getAsString:lv,isCollapsed:gv},hv=tinymce.util.Tools.resolve("tinymce.util.VK"),vv=function(t,e,n,r){return xv(t,e,Op.next(n),r)},bv=function(t,e,n,r){return xv(t,e,Op.prev(n),r)},wv=function(t,e){var n=qp.exact(e,0,e,0);return pv.toNative(n)},yv=function(t,e){var n=Jr.descendants(e,"tr");return Tt.last(n).bind(function(t){return fo.descendant(t,"td,th").map(function(t){return wv(0,t)})})},xv=function(t,e,n,r,o){return n.fold(X.none,X.none,function(t,e){return Yi.first(e).map(function(t){return wv(0,t)})},function(n){return Ao.table(n,e).bind(function(e){var o=Na.noMenu(n);return t.undoManager.transact(function(){r.insertRowsAfter(e,o)}),yv(0,e)})})},Cv=["table","li","dl"],Sv=function(t,e,n,r){if(t.keyCode===hv.TAB){var o=Lm.getBody(e),i=function(t){var e=Rr.name(t);return Vn.eq(t,o)||Tt.contains(Cv,e)},u=e.selection.getRng();if(u.collapsed){var a=de.fromDom(u.startContainer);Ao.cell(a,i).each(function(o){t.preventDefault(),(t.shiftKey?bv:vv)(e,i,o,n,r).each(function(t){e.selection.setRng(t)})})}}},Rv={handle:Sv},Tv=Gt.immutable("selection","kill"),Av={response:Tv},Dv=function(t){return function(e){return e===t}},Ev=Dv(38),kv=Dv(40),Ov=function(t){return t>=37&&t<=40},Nv={ltr:{isBackward:Dv(37),isForward:Dv(39)},rtl:{isBackward:Dv(39),isForward:Dv(37)
},isUp:Ev,isDown:kv,isNavigation:Ov},Bv=function(t,e){var n=ph.asLtrRange(t,e);return{start:z.constant(de.fromDom(n.startContainer)),soffset:z.constant(n.startOffset),finish:z.constant(de.fromDom(n.endContainer)),foffset:z.constant(n.endOffset)}},Iv=function(t,e,n,r){return{start:z.constant(Pp.on(t,e)),finish:z.constant(Pp.on(n,r))}},Pv={convertToRange:Bv,makeSitus:Iv},Wv=_n.detect().browser.isSafari(),Mv=function(t){var e=void 0!==t?t.dom():document,n=e.body.scrollLeft||e.documentElement.scrollLeft,r=e.body.scrollTop||e.documentElement.scrollTop;return Gc(n,r)},_v=function(t,e,n){(void 0!==n?n.dom():document).defaultView.scrollTo(t,e)},Lv=function(t,e,n){(void 0!==n?n.dom():document).defaultView.scrollBy(t,e)},Fv=function(t,e){var n=Qc.absolute(e),r=de.fromDom(t.document);_v(n.left(),n.top(),r)},qv=function(t,e){var n=Mv(t);e();var r=Mv(t);n.top()===r.top()&&n.left()===r.left()||_v(n.left(),n.top(),t)},zv=function(t){var e=X.none(),n=function(){e=X.some(Mv(t))},r=function(){e.each(function(e){_v(e.left(),e.top(),t)})};return n(),{save:n,restore:r}},Hv=function(t,e){Wv&&Lt.isFunction(t.dom().scrollIntoViewIfNeeded)?t.dom().scrollIntoViewIfNeeded(!1):t.dom().scrollIntoView(e)},jv=function(t,e){var n=e.dom().getBoundingClientRect(),r=t.dom().getBoundingClientRect();r.top<n.top?Hv(t,!0):r.bottom>n.bottom&&Hv(t,!1)},Uv=function(){var t=de.fromHtml('<div style="width: 100px; height: 100px; overflow: scroll; position: absolute; top: -9999px;"></div>');ci.after(Fr.body(),t);var e=t.dom().offsetWidth-t.dom().clientWidth;return vi.remove(t),e},Vv={get:Mv,to:_v,by:Lv,preserve:qv,capture:zv,intoView:Hv,intoViewIfNeeded:jv,setToElement:Fv,scrollBarWidth:Uv},Gv=function(t,e,n,r,o,i,u){return Vn.eq(n,o)&&r===i?X.none():fo.closest(n,"td,th",e).bind(function(n){return fo.closest(o,"td,th",e).bind(function(r){return Yv(t,e,n,r,u)})})},Yv=function(t,e,n,r,o){if(!Vn.eq(n,r))return fa.identify(n,r,e).bind(function(e){var r=e.boxes().getOr([]);return r.length>0?(o(t,r,e.start(),e.finish()),X.some(Av.response(X.some(Pv.makeSitus(n,0,n,ji.getEnd(n))),!0))):X.none()})},Xv=function(t,e,n,r,o){var i=function(t){return o.clear(n),o.selectRange(n,t.boxes(),t.start(),t.finish()),t.boxes()};return fa.shiftSelection(r,t,e,o.firstSelectedSelector(),o.lastSelectedSelector()).map(i)},$v={sync:Gv,detect:Yv,update:Xv},Kv=Gt.immutableBag(["left","top","right","bottom"],[]),Jv=function(t,e){return Kv({left:t.left(),top:t.top()+e,right:t.right(),bottom:t.bottom()+e})},Qv=function(t,e){return Kv({left:t.left(),top:t.top()-e,right:t.right(),bottom:t.bottom()-e})},Zv=function(t,e){var n=t.bottom()-t.top();return Kv({left:t.left(),top:e-n,right:t.right(),bottom:e})},tb=function(t,e){var n=t.bottom()-t.top();return Kv({left:t.left(),top:e,right:t.right(),bottom:e+n})},eb=function(t,e,n){return Kv({left:t.left()+e,top:t.top()+n,right:t.right()+e,bottom:t.bottom()+n})},nb=function(t){return t.top()},rb=function(t){return t.bottom()},ob=function(t){return"("+t.left()+", "+t.top()+") -> ("+t.right()+", "+t.bottom()+")"},ib={nu:Kv,moveUp:Qv,moveDown:Jv,moveBottomTo:Zv,moveTopTo:tb,getTop:nb,getBottom:rb,translate:eb,toString:ob},ub=function(t,e,n){return n>=0&&n<ji.getEnd(e)?t.getRangedRect(e,n,e,n+1):n>0?t.getRangedRect(e,n-1,e,n):X.none()},ab=function(t){return ib.nu({left:t.left,top:t.top,right:t.right,bottom:t.bottom})},cb=function(t,e){return X.some(t.getRect(e))},lb=function(t,e,n){return Rr.isElement(e)?cb(t,e).map(ab):Rr.isText(e)?ub(t,e,n).map(ab):X.none()},sb=function(t,e){return Rr.isElement(e)?cb(t,e).map(ab):Rr.isText(e)?t.getRangedRect(e,0,e,ji.getEnd(e)).map(ab):X.none()},fb={getBoxAt:lb,getEntireBox:sb},db=Gt.immutable("item","mode"),mb=function(t,e,n,r){var o=void 0!==r?r:gb;return t.property().parent(e).map(function(t){return db(t,o)})},gb=function(t,e,n,r){var o=void 0!==r?r:pb;return n.sibling(t,e).map(function(t){return db(t,o)})},pb=function(t,e,n,r){var o=void 0!==r?r:pb,i=t.property().children(e);return n.first(i).map(function(t){return db(t,o)})},hb=[{current:mb,next:gb,fallback:X.none()},{current:gb,next:pb,fallback:X.some(mb)},{current:pb,next:pb,fallback:X.some(gb)}],vb=function(t,e,n,r,o){var o=void 0!==o?o:hb;return Tt.find(o,function(t){return t.current===n}).bind(function(n){return n.current(t,e,r,n.next).orThunk(function(){return n.fallback.bind(function(n){return vb(t,e,n,r)})})})},bb={backtrack:mb,sidestep:gb,advance:pb,go:vb},wb=function(){return{sibling:function(t,e){return t.query().prevSibling(e)},first:function(t){return t.length>0?X.some(t[t.length-1]):X.none()}}},yb=function(){return{sibling:function(t,e){return t.query().nextSibling(e)},first:function(t){return t.length>0?X.some(t[0]):X.none()}}},xb={left:wb,right:yb},Cb=function(t,e,n,r,o,i){return bb.go(t,e,r,o).bind(function(e){return i(e.item())?X.none():n(e.item())?X.some(e.item()):Cb(t,e.item(),n,e.mode(),o,i)})},Sb=function(t,e,n,r){return Cb(t,e,n,bb.sidestep,xb.left(),r)},Rb=function(t,e,n,r){return Cb(t,e,n,bb.sidestep,xb.right(),r)},Tb={left:Sb,right:Rb},Ab=function(t,e){return 0===t.property().children(e).length},Db=function(t,e,n){return kb(t,e,z.curry(Ab,t),n)},Eb=function(t,e,n){return Ob(t,e,z.curry(Ab,t),n)},kb=function(t,e,n,r){return Tb.left(t,e,n,r)},Ob=function(t,e,n,r){return Tb.right(t,e,n,r)},Nb=function(){return{left:xb.left,right:xb.right}},Bb=function(t,e,n,r,o){return bb.go(t,e,n,r,o)},Ib={before:Db,after:Eb,seekLeft:kb,seekRight:Ob,walkers:Nb,walk:Bb,backtrack:bb.backtrack,sidestep:bb.sidestep,advance:bb.advance},Pb=o(),Wb=function(t,e,n){return Ib.gather(Pb,t,e,n)},Mb=function(t,e){return Ib.before(Pb,t,e)},_b=function(t,e){return Ib.after(Pb,t,e)},Lb=function(t,e,n){return Ib.seekLeft(Pb,t,e,n)},Fb=function(t,e,n){return Ib.seekRight(Pb,t,e,n)},qb=function(){return Ib.walkers()},zb=function(t,e,n,r){return Ib.walk(Pb,t,e,n,r)},Hb={gather:Wb,before:Mb,after:_b,seekLeft:Lb,seekRight:Fb,walkers:qb,walk:zb},jb=ba.generate([{none:[]},{retry:["caret"]}]),Ub=function(t,e){return t.left()<e.left()||Math.abs(e.right()-t.left())<1||t.left()>e.right()},Vb=function(t,e,n){return oo.closest(e,Xl.isBlock).fold(z.constant(!1),function(e){return fb.getEntireBox(t,e).exists(function(t){return Ub(n,t)})})},Gb=function(t,e,n,r,o){var i=ib.moveDown(o,5);return Math.abs(n.bottom()-r.bottom())<1?jb.retry(i):n.top()>o.bottom()?jb.retry(i):n.top()===o.bottom()?jb.retry(ib.moveDown(o,1)):Vb(t,e,o)?jb.retry(ib.translate(i,5,0)):jb.none()},Yb=function(t,e,n,r,o){var i=ib.moveUp(o,5);return Math.abs(n.top()-r.top())<1?jb.retry(i):n.bottom()<o.top()?jb.retry(i):n.bottom()===o.top()?jb.retry(ib.moveUp(o,1)):Vb(t,e,o)?jb.retry(ib.translate(i,5,0)):jb.none()},Xb={point:ib.getTop,adjuster:Yb,move:ib.moveUp,gather:Hb.before},$b={point:ib.getBottom,adjuster:Gb,move:ib.moveDown,gather:Hb.after},Kb=function(t,e,n){return t.elementFromPoint(e,n).filter(function(t){return"table"===Rr.name(t)}).isSome()},Jb=function(t,e,n,r,o){return Qb(t,e,n,e.move(r,5),o)},Qb=function(t,e,n,r,o){return 0===o?X.some(r):Kb(t,r.left(),e.point(r))?Jb(t,e,n,r,o-1):t.situsFromPoint(r.left(),e.point(r)).bind(function(i){return i.start().fold(X.none,function(i,u){return fb.getEntireBox(t,i,u).bind(function(u){return e.adjuster(t,i,u,n,r).fold(X.none,function(r){return Qb(t,e,n,r,o-1)})}).orThunk(function(){return X.some(r)})},X.none)})},Zb=function(t,e){return t.situsFromPoint(e.left(),e.bottom()+5)},tw=function(t,e){return t.situsFromPoint(e.left(),e.top()-5)},ew=function(t,e,n){return t.point(e)>n.getInnerHeight()?X.some(t.point(e)-n.getInnerHeight()):t.point(e)<0?X.some(-t.point(e)):X.none()},nw=function(t,e,n){var r=t.move(n,5),o=Qb(e,t,n,r,100).getOr(r);return ew(t,o,e).fold(function(){return e.situsFromPoint(o.left(),t.point(o))},function(n){return e.scrollBy(0,n),e.situsFromPoint(o.left(),t.point(o)-n)})},rw={tryUp:z.curry(nw,Xb),tryDown:z.curry(nw,$b),ieTryUp:tw,ieTryDown:Zb,getJumpSize:z.constant(5)},ow=ba.generate([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),iw=function(t,e,n){var r=t.getRect(e),o=t.getRect(n);return o.right>r.left&&o.left<r.right},uw=function(t,e,n,r,o,i,u){return fo.closest(r,"td,th",u).bind(function(n){return fo.closest(e,"td,th",u).map(function(e){return Vn.eq(n,e)?Vn.eq(r,n)&&ji.getEnd(n)===o?i(e):ow.none("in same cell"):Lu.sharedOne(aw,[n,e]).fold(function(){return iw(t,e,n)?ow.success():i(e)},function(t){return i(e)})})}).getOr(ow.none("default"))},aw=function(t){return fo.closest(t,"tr")},cw=function(t,e,n,r,o){return t.fold(e,n,r,o)},lw={verify:uw,cata:cw,adt:ow},sw=Gt.immutable("element","offset"),fw=Gt.immutable("element","deltaOffset"),dw=Gt.immutable("element","start","finish"),mw=Gt.immutable("begin","end"),gw=Gt.immutable("element","text"),pw={point:sw,delta:fw,range:dw,points:mw,text:gw},hw=Gt.immutable("ancestor","descendants","element","index"),vw=Gt.immutable("parent","children","element","index"),bw=function(t,e){return oo.closest(t,function(t){return dr.parent(t).exists(function(t){return Vn.eq(t,e)})})},ww=function(t){return dr.parent(t).bind(function(e){var n=dr.children(e);return yw(n,t).map(function(r){return vw(e,n,t,r)})})},yw=function(t,e){return Tt.findIndex(t,z.curry(Vn.eq,e))},xw=function(t,e){return dr.parent(t).bind(function(n){var r=Jr.children(n,e);return yw(r,t).map(function(e){return vw(n,r,t,e)})})},Cw=function(t,e,n){return fo.closest(t,e).bind(function(e){var r=Jr.descendants(e,n);return yw(r,t).map(function(n){return hw(e,r,t,n)})})},Sw={childOf:bw,indexOf:yw,indexInParent:ww,selectorsInParent:xw,descendantsInAncestor:Cw},Rw=function(t){return"br"===Rr.name(t)},Tw=function(t,e,n){return e(t,n).bind(function(t){return Rr.isText(t)&&0===Mi.get(t).trim().length?Tw(t,e,n):X.some(t)})},Aw=function(t,e,n){return n.traverse(e).orThunk(function(){return Tw(e,n.gather,t)}).map(n.relative)},Dw=function(t,e){return dr.child(t,e).filter(Rw).orThunk(function(){return dr.child(t,e-1).filter(Rw)})},Ew=function(t,e,n,r){return Dw(e,n).bind(function(e){return r.traverse(e).fold(function(){return Tw(e,r.gather,t).map(r.relative)},function(t){return Sw.indexInParent(t).map(function(t){return Pp.on(t.parent(),t.index())})})})},kw=function(t,e,n,r){return(Rw(e)?Aw(t,e,r):Ew(t,e,n,r)).map(function(t){return{start:z.constant(t),finish:z.constant(t)}})},Ow=function(t){return lw.cata(t,function(t){return X.none("BR ADT: none")},function(){return X.none()},function(t){return X.some(pw.point(t,0))},function(t){return X.some(pw.point(t,ji.getEnd(t)))})},Nw={tryBr:kw,process:Ow},Bw=_n.detect(),Iw=function(t,e,n){return t.getSelection().bind(function(r){return Nw.tryBr(e,r.finish(),r.foffset(),n).fold(function(){return X.some(pw.point(r.finish(),r.foffset()))},function(o){var i=t.fromSitus(o),u=lw.verify(t,r.finish(),r.foffset(),i.finish(),i.foffset(),n.failure,e);return Nw.process(u)})})},Pw=function(t,e,n,r,o,i){return 0===i?X.none():_w(t,e,n,r,o).bind(function(u){var a=t.fromSitus(u),c=lw.verify(t,n,r,a.finish(),a.foffset(),o.failure,e);return lw.cata(c,function(){return X.none()},function(){return X.some(u)},function(u){return Vn.eq(n,u)&&0===r?Ww(t,n,r,ib.moveUp,o):Pw(t,e,u,0,o,i-1)},function(u){return Vn.eq(n,u)&&r===ji.getEnd(u)?Ww(t,n,r,ib.moveDown,o):Pw(t,e,u,ji.getEnd(u),o,i-1)})})},Ww=function(t,e,n,r,o){return fb.getBoxAt(t,e,n).bind(function(e){return Mw(t,o,r(e,rw.getJumpSize()))})},Mw=function(t,e,n){return Bw.browser.isChrome()||Bw.browser.isSafari()||Bw.browser.isFirefox()||Bw.browser.isEdge()?e.otherRetry(t,n):Bw.browser.isIE()?e.ieRetry(t,n):X.none()},_w=function(t,e,n,r,o){return fb.getBoxAt(t,n,r).bind(function(e){return Mw(t,o,e)})},Lw=function(t,e,n){return Iw(t,e,n).bind(function(r){return Pw(t,e,r.element(),r.offset(),n,20).map(t.fromSitus)})},Fw={handle:Lw},qw=function(t){return oo.first(t).isSome()},zw=function(t,e,n){return oo.ancestor(t,e,n).isSome()},Hw=function(t,e,n){return oo.closest(t,e,n).isSome()},jw=function(t,e){return oo.sibling(t,e).isSome()},Uw=function(t,e){return oo.child(t,e).isSome()},Vw=function(t,e){return oo.descendant(t,e).isSome()},Gw={any:qw,ancestor:zw,closest:Hw,sibling:jw,child:Uw,descendant:Vw},Yw=_n.detect(),Xw=function(t,e){return Gw.ancestor(t,function(t){return dr.parent(t).exists(function(t){return Vn.eq(t,e)})})},$w=function(t,e,n,r,o){return fo.closest(r,"td,th",e).bind(function(r){return fo.closest(r,"table",e).bind(function(i){return Xw(o,i)?Fw.handle(t,e,n).bind(function(t){return fo.closest(t.finish(),"td,th",e).map(function(e){return{start:z.constant(r),finish:z.constant(e),range:z.constant(t)}})}):X.none()})})},Kw=function(t,e,n,r,o,i){return Yw.browser.isIE()?X.none():i(r,e).orThunk(function(){return $w(t,e,n,r,o).map(function(t){var e=t.range();return Av.response(X.some(Pv.makeSitus(e.start(),e.soffset(),e.finish(),e.foffset())),!0)})})},Jw=function(t,e){return fo.closest(t,"tr",e).bind(function(t){return fo.closest(t,"table",e).bind(function(n){var r=Jr.descendants(n,"tr");return Vn.eq(t,r[0])?Hb.seekLeft(n,function(t){return Yi.last(t).isSome()},e).map(function(t){var e=ji.getEnd(t);return Av.response(X.some(Pv.makeSitus(t,e,t,e)),!0)}):X.none()})})},Qw=function(t,e){return fo.closest(t,"tr",e).bind(function(t){return fo.closest(t,"table",e).bind(function(n){var r=Jr.descendants(n,"tr");return Vn.eq(t,r[r.length-1])?Hb.seekRight(n,function(t){return Yi.first(t).isSome()},e).map(function(t){return Av.response(X.some(Pv.makeSitus(t,0,t,0)),!0)}):X.none()})})},Zw=function(t,e,n,r,o,i,u){return $w(t,n,r,o,i).bind(function(t){return $v.detect(e,n,t.start(),t.finish(),u)})},ty={navigate:Kw,select:Zw,firstUpCheck:Jw,lastDownCheck:Qw},ey=function(t,e){return fo.closest(t,"td,th",e)},ny={down:{traverse:dr.nextSibling,gather:Hb.after,relative:Pp.before,otherRetry:rw.tryDown,ieRetry:rw.ieTryDown,failure:lw.adt.failedDown},up:{traverse:dr.prevSibling,gather:Hb.before,relative:Pp.before,otherRetry:rw.tryUp,ieRetry:rw.ieTryUp,failure:lw.adt.failedUp}},ry=Gt.immutable("rows","cols"),oy=function(t,e,n,r){var o=x(t),i=C(o,e,n,r);return{mousedown:i.mousedown,mouseover:i.mouseover,mouseup:i.mouseup}},iy=function(t,e,n,r){var o=x(t),i=function(){return r.clear(e),X.none()};return{keydown:function(t,u,a,c,l,s){var f=t.raw().which,d=!0===t.raw().shiftKey;return fa.retrieve(e,r.selectedSelector()).fold(function(){return Nv.isDown(f)&&d?z.curry(ty.select,o,e,n,ny.down,c,u,r.selectRange):Nv.isUp(f)&&d?z.curry(ty.select,o,e,n,ny.up,c,u,r.selectRange):Nv.isDown(f)?z.curry(ty.navigate,o,n,ny.down,c,u,ty.lastDownCheck):Nv.isUp(f)?z.curry(ty.navigate,o,n,ny.up,c,u,ty.firstUpCheck):X.none},function(t){var n=function(n){return function(){return us.findMap(n,function(n){return $v.update(n.rows(),n.cols(),e,t,r)}).fold(function(){return fa.getEdges(e,r.firstSelectedSelector(),r.lastSelectedSelector()).map(function(t){var n=Nv.isDown(f)||s.isForward(f)?Pp.after:Pp.before;return o.setRelativeSelection(Pp.on(t.first(),0),n(t.table())),r.clear(e),Av.response(X.none(),!0)})},function(t){return X.some(Av.response(X.none(),!0))})}};return Nv.isDown(f)&&d?n([ry(1,0)]):Nv.isUp(f)&&d?n([ry(-1,0)]):s.isBackward(f)&&d?n([ry(0,-1),ry(-1,0)]):s.isForward(f)&&d?n([ry(0,1),ry(1,0)]):Nv.isNavigation(f)&&!1===d?i:X.none})()},keyup:function(t,o,i,u,a){return fa.retrieve(e,r.selectedSelector()).fold(function(){var c=t.raw().which;return 0==(!0===t.raw().shiftKey)?X.none():Nv.isNavigation(c)?$v.sync(e,n,o,i,u,a,r.selectRange):X.none()},X.none)}}},uy={mouse:oy,keyboard:iy},ay=function(t,e){Tt.each(e,function(e){uf.add(t,e)})},cy=function(t,e){Tt.each(e,function(e){uf.remove(t,e)})},ly=function(t,e){Tt.each(e,function(e){uf.toggle(t,e)})},sy=function(t,e){return Tt.forall(e,function(e){return uf.has(t,e)})},fy=function(t,e){return Tt.exists(e,function(e){return uf.has(t,e)})},dy=function(t){for(var e=t.dom().classList,n=new Array(e.length),r=0;r<e.length;r++)n[r]=e.item(r);return n},my=function(t){return Qs.supports(t)?dy(t):Qs.get(t)},gy={add:ay,remove:cy,toggle:ly,hasAll:sy,hasAny:fy,get:my},py=function(t){return function(e){uf.add(e,t)}},hy=function(t){return function(e){uf.remove(e,t)}},vy=function(t){return function(e){gy.remove(e,t)}},by=function(t){return function(e){return uf.has(e,t)}},wy={addClass:py,removeClass:hy,removeClasses:vy,hasClass:by},yy=function(t){var e=wy.addClass(t.selected()),n=wy.removeClasses([t.selected(),t.lastSelected(),t.firstSelected()]),r=function(e){var r=Jr.descendants(e,t.selectedSelector());Tt.each(r,n)};return{clear:r,selectRange:function(n,o,i,u){r(n),Tt.each(o,e),uf.add(i,t.firstSelected()),uf.add(u,t.lastSelected())},selectedSelector:t.selectedSelector,firstSelectedSelector:t.firstSelectedSelector,lastSelectedSelector:t.lastSelectedSelector}},xy=function(t){var e=function(e){Wr.remove(e,t.selected()),Wr.remove(e,t.firstSelected()),Wr.remove(e,t.lastSelected())},n=function(e){Wr.set(e,t.selected(),"1")},r=function(n){var r=Jr.descendants(n,t.selectedSelector());Tt.each(r,e)};return{clear:r,selectRange:function(e,o,i,u){r(e),Tt.each(o,n),Wr.set(i,t.firstSelected(),"1"),Wr.set(u,t.lastSelected(),"1")},selectedSelector:t.selectedSelector,firstSelectedSelector:t.firstSelectedSelector,lastSelectedSelector:t.lastSelectedSelector}},Cy={byClass:yy,byAttr:xy},Sy=Xm.each,Ry=function(t){function e(e){return function(){t.execCommand(e)}}var n=[];Sy("inserttable tableprops deletetable | cell row column".split(" "),function(e){"|"===e?n.push({text:"-"}):n.push(t.menuItems[e])}),t.addButton("table",{type:"menubutton",title:"Table",menu:n}),t.addButton("tableprops",{title:"Table properties",onclick:z.curry(fg.open,t,!0),icon:"table"}),t.addButton("tabledelete",{title:"Delete table",onclick:e("mceTableDelete")}),t.addButton("tablecellprops",{title:"Cell properties",onclick:e("mceTableCellProps")}),t.addButton("tablemergecells",{title:"Merge cells",onclick:e("mceTableMergeCells")}),t.addButton("tablesplitcells",{title:"Split cell",onclick:e("mceTableSplitCells")}),t.addButton("tableinsertrowbefore",{title:"Insert row before",onclick:e("mceTableInsertRowBefore")}),t.addButton("tableinsertrowafter",{title:"Insert row after",onclick:e("mceTableInsertRowAfter")}),t.addButton("tabledeleterow",{title:"Delete row",onclick:e("mceTableDeleteRow")}),t.addButton("tablerowprops",{title:"Row properties",onclick:e("mceTableRowProps")}),t.addButton("tablecutrow",{title:"Cut row",onclick:e("mceTableCutRow")}),t.addButton("tablecopyrow",{title:"Copy row",onclick:e("mceTableCopyRow")}),t.addButton("tablepasterowbefore",{title:"Paste row before",onclick:e("mceTablePasteRowBefore")}),t.addButton("tablepasterowafter",{title:"Paste row after",onclick:e("mceTablePasteRowAfter")}),t.addButton("tableinsertcolbefore",{title:"Insert column before",onclick:e("mceTableInsertColBefore")}),t.addButton("tableinsertcolafter",{title:"Insert column after",onclick:e("mceTableInsertColAfter")}),t.addButton("tabledeletecol",{title:"Delete column",onclick:e("mceTableDeleteCol")})},Ty=function(t){var e=function(e){return t.dom.is(e,"table")&&t.getBody().contains(e)},n=t.settings.table_toolbar;""!==n&&!1!==n&&(n||(n="tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol"),t.addContextToolbar(e,n))},Ay={addButtons:Ry,addToolbars:Ty},Dy=function(t,e){function n(e){return function(){t.execCommand(e)}}var r=X.none(),o=[],i=[],u=[],a=[],c=function(t){t.disabled(!0)},l=function(t){t.disabled(!1)},s=function(){var t=this;o.push(t),r.fold(function(){c(t)},function(e){l(t)})},f=function(){var t=this;i.push(t),r.fold(function(){c(t)},function(e){l(t)})},d=function(){var t=this;u.push(t),r.fold(function(){c(t)},function(e){t.disabled(e.mergable().isNone())})},m=function(){var t=this;a.push(t),r.fold(function(){c(t)},function(e){t.disabled(e.unmergable().isNone())})},g=function(){r.fold(function(){Tt.each(o,c),Tt.each(i,c),Tt.each(u,c),Tt.each(a,c)},function(t){Tt.each(o,l),Tt.each(i,l),Tt.each(u,function(e){e.disabled(t.mergable().isNone())}),Tt.each(a,function(e){e.disabled(t.unmergable().isNone())})})};t.on("init",function(){t.on("nodechange",function(n){var o=X.from(t.dom.getParent(t.selection.getStart(),"th,td"));r=o.bind(function(t){var n=de.fromDom(t);return Ao.table(n).map(function(t){return Na.forMenu(e,t,n)})}),g()})});var p=function(t,e,n,r){var o,i,u,a,c,l=r.getEl().getElementsByTagName("table")[0],s=r.isRtl()||"tl-tr"===r.parent().rel;for(l.nextSibling.innerHTML=e+1+" x "+(n+1),s&&(e=9-e),i=0;i<10;i++)for(o=0;o<10;o++)a=l.rows[i].childNodes[o].firstChild,c=(s?o>=e:o<=e)&&i<=n,t.dom.toggleClass(a,"mce-active",c),c&&(u=a);return u.parentNode},h=!1===t.settings.table_grid?{text:"Table",icon:"table",context:"table",onclick:z.curry(fg.open,t)}:{text:"Table",icon:"table",context:"table",ariaHideMenu:!0,onclick:function(e){e.aria&&(this.parent().hideAll(),e.stopImmediatePropagation(),fg.open(t))},onshow:function(){p(t,0,0,this.menu.items()[0])},onhide:function(){var e=this.menu.items()[0].getEl().getElementsByTagName("a");t.dom.removeClass(e,"mce-active"),t.dom.addClass(e[0],"mce-active")},menu:[{type:"container",html:function(){var t="";t='<table role="grid" class="mce-grid mce-grid-border" aria-readonly="true">';for(var e=0;e<10;e++){t+="<tr>";for(var n=0;n<10;n++)t+='<td role="gridcell" tabindex="-1"><a id="mcegrid'+(10*e+n)+'" href="#" data-mce-x="'+n+'" data-mce-y="'+e+'"></a></td>';t+="</tr>"}return t+="</table>",t+='<div class="mce-text-center" role="presentation">1 x 1</div>'}(),onPostRender:function(){this.lastX=this.lastY=0},onmousemove:function(e){var n,r,o=e.target;"A"===o.tagName.toUpperCase()&&(n=parseInt(o.getAttribute("data-mce-x"),10),r=parseInt(o.getAttribute("data-mce-y"),10),(this.isRtl()||"tl-tr"===this.parent().rel)&&(n=9-n),n===this.lastX&&r===this.lastY||(p(t,n,r,e.control),this.lastX=n,this.lastY=r))},onclick:function(e){var n=this;"A"===e.target.tagName.toUpperCase()&&(e.preventDefault(),e.stopPropagation(),n.parent().cancel(),t.undoManager.transact(function(){Ja.insert(t,n.lastX+1,n.lastY+1)}),t.addVisual())}}]},v={text:"Table properties",context:"table",onPostRender:s,onclick:z.curry(fg.open,t,!0)},b={text:"Delete table",context:"table",onPostRender:s,cmd:"mceTableDelete"},w={text:"Row",context:"table",menu:[{text:"Insert row before",onclick:n("mceTableInsertRowBefore"),onPostRender:f},{text:"Insert row after",onclick:n("mceTableInsertRowAfter"),onPostRender:f},{text:"Delete row",onclick:n("mceTableDeleteRow"),onPostRender:f},{text:"Row properties",onclick:n("mceTableRowProps"),onPostRender:f},{text:"-"},{text:"Cut row",onclick:n("mceTableCutRow"),onPostRender:f},{text:"Copy row",onclick:n("mceTableCopyRow"),onPostRender:f},{text:"Paste row before",onclick:n("mceTablePasteRowBefore"),onPostRender:f},{text:"Paste row after",onclick:n("mceTablePasteRowAfter"),onPostRender:f}]},y={text:"Column",context:"table",menu:[{text:"Insert column before",onclick:n("mceTableInsertColBefore"),onPostRender:f},{text:"Insert column after",onclick:n("mceTableInsertColAfter"),onPostRender:f},{text:"Delete column",onclick:n("mceTableDeleteCol"),onPostRender:f}]},x={separator:"before",text:"Cell",context:"table",menu:[{text:"Cell properties",onclick:n("mceTableCellProps"),onPostRender:f},{text:"Merge cells",onclick:n("mceTableMergeCells"),onPostRender:d},{text:"Split cell",onclick:n("mceTableSplitCells"),onPostRender:m}]};t.addMenuItem("inserttable",h),t.addMenuItem("tableprops",v),t.addMenuItem("deletetable",b),t.addMenuItem("row",w),t.addMenuItem("column",y),t.addMenuItem("cell",x)},Ey={addMenuItems:Dy};D.add("table",T)}()}();