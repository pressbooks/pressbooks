!function(){!function(){"use strict";function e(e,t,n){var r=e.isiOS()&&!0===/ipad/i.test(n),o=e.isiOS()&&!r,i=e.isAndroid()&&3===e.version.major,u=e.isAndroid()&&4===e.version.major,a=r||i||u&&!0===/mobile/i.test(n),c=e.isiOS()||e.isAndroid(),l=c&&!a,s=t.isSafari()&&e.isiOS()&&!1===/safari/i.test(n);return{isiPad:E(r),isiPhone:E(o),isTablet:E(a),isPhone:E(l),isTouch:E(c),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:E(s)}}function t(e,t,n,r,o){return e(n,r)?q.some(n):G(o)&&o(n)?q.none():t(n,r,o)}function n(){var e=function(e){return Ue.fromDom(e.dom().cloneNode(!1))},t=function(e){return!!kn.isElement(e)&&("body"===kn.name(e)||K(gi,kn.name(e)))},n=function(e){return!!kn.isElement(e)&&K(["br","img","hr","input"],kn.name(e))},r=function(e,t){return e.dom().compareDocumentPosition(t.dom())},o=function(e,t){var n=jn.clone(e);jn.setAll(t,n)};return{up:E({selector:br.ancestor,closest:br.closest,predicate:fr.ancestor,all:wn.parents}),down:E({selector:or.descendants,predicate:Qn.descendants}),styles:E({get:ao.get,getRaw:ao.getRaw,set:ao.set,remove:ao.remove}),attrs:E({get:jn.get,set:jn.set,remove:jn.remove,copyTo:o}),insert:E({before:po.before,after:po.after,afterAll:yo.after,append:po.append,appendAll:yo.append,prepend:po.prepend,wrap:po.wrap}),remove:E({unwrap:So.unwrap,remove:So.remove}),create:E({nu:Ue.fromTag,clone:e,text:Ue.fromText}),query:E({comparePosition:r,prevSibling:wn.prevSibling,nextSibling:wn.nextSibling}),property:E({children:wn.children,name:kn.name,parent:wn.parent,isText:kn.isText,isComment:kn.isComment,isElement:kn.isElement,getText:zo.get,setText:zo.set,isBoundary:t,isEmptyTag:n}),eq:$t.eq,is:$t.is}}function r(e,t){var n=function(t,n){if(!Y(n)&&!n.match(/^[0-9]+$/))throw e+".set accepts only positive integer values. Value was "+n;var r=t.dom();Ur.isSupported(r)&&(r.style[e]=n+"px")},r=function(n){var r=t(n);if(r<=0||null===r){var o=ao.get(n,e);return parseFloat(o)||0}return r},o=r,i=function(e,t){return ne(t,function(t,n){var r=ao.get(e,n),o=void 0===r?0:parseInt(r,10);return isNaN(o)?t:t+o},0)};return{set:n,get:r,getOuter:o,aggregate:i,max:function(e,t,n){var r=i(e,n);return t>r?t-r:0}}}function o(e){var t=function(t){return e(t).isRtl()?uc.rtl:uc.ltr},n=function(e,n){return t(n).delta(e,n)},r=function(e,n){return t(n).positions(e,n)};return{delta:n,edge:function(e){return t(e).edge(e)},positions:r}}function i(e,t,n){var r=n||!1,o=function(){t(),r=!0},i=function(){e(),r=!1};return{on:o,off:i,toggle:function(){(r?i:o)()},isOn:function(){return r}}}function u(e){return e.control.rootControl.find("#style")[0].getEl().isEqualNode(document.activeElement)}function a(e,t,n,r){function o(e,n,r){(1===t.length||r)&&u.setAttrib(e,n,r)}function i(e,n,r){(1===t.length||r)&&u.setStyle(e,n,r)}var u=e.dom;Hd(e)&&ym.syncAdvancedStyleFields(e,r);var a=r.control.rootControl.toJSON();e.undoManager.transact(function(){am.each(t,function(t){o(t,"scope",a.scope),o(t,"style",a.style),o(t,"class",a.class),i(t,"height",Sd(a.height)),a.type!==t.parentNode.nodeName.toLowerCase()&&Am(e.dom,t,a.type),a.align!==n.align&&(mm.unApplyAlign(e,t),mm.applyAlign(e,t,a.align))}),e.focus()})}function c(e,t,n,r){if("TD"===t.tagName||"TH"===t.tagName)e.setStyle(t,n,r);else if(t.children)for(var o=0;o<t.children.length;o++)c(e,t.children[o],n,r)}function l(e){var t=ve.apply(null,e),n=[];return{bind:function(e){if(void 0===e)throw"Event bind error: undefined handler";n.push(e)},unbind:function(e){n=ee(n,function(t){return t!==e})},trigger:function(){var e=t.apply(null,arguments);Q(n,function(t){t(e)})}}}function s(e){var t=Uc({layerClass:mg.resolve("blocker")},e),n=Ue.fromTag("div");return jn.set(n,"role","presentation"),ao.setAll(n,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),Ul.add(n,mg.resolve("blocker")),Ul.add(n,t.layerClass),{element:function(){return n},destroy:function(){So.remove(n)}}}function f(){var e=q.none(),t=function(){e=q.none()},n=function(t,n){var r=e.map(function(e){return t.compare(e,n)});return e=q.some(n),r},r=function(e,t){t.extract(e).each(function(e){n(t,e).each(function(e){o.trigger.move(e)})})},o=ag.create({move:l(["info"])});return{onEvent:r,reset:t,events:o.registry}}function d(e){return{onEvent:function(e,t){},reset:S}}function m(){var e=d(),t=f(),n=e,r=function(){n.reset(),n=t},o=function(){n.reset(),n=e},i=function(e,t){n.onEvent(e,t)};return{on:r,off:o,isOn:function(){return n===t},onEvent:i,events:t.events}}function g(){var e=ag.create({drag:l(["xDelta","yDelta"])});return{mutate:function(t,n){e.trigger.drag(t,n)},events:e.registry}}function p(){var e=ag.create({drag:l(["xDelta","yDelta","target"])}),t=q.none(),n=g();return n.events.drag.bind(function(n){t.each(function(t){e.trigger.drag(n.xDelta(),n.yDelta(),t)})}),{assign:function(e){t=q.some(e)},get:function(){return t},mutate:n.mutate,events:e.registry}}function h(e,t,n){var r=p(),o=Ig.transform(r,{}),i=q.none(),u=function(e,t){return q.from(jn.get(e,t))};r.events.drag.bind(function(e){u(e.target(),"data-row").each(function(t){var n=df.getInt(e.target(),"top");ao.set(e.target(),"top",n+e.yDelta()+"px")}),u(e.target(),"data-column").each(function(t){var n=df.getInt(e.target(),"left");ao.set(e.target(),"left",n+e.xDelta()+"px")})});var a=function(e,t){return df.getInt(e,t)-parseInt(jn.get(e,"data-initial-"+t),10)};o.events.stop.bind(function(){r.get().each(function(r){i.each(function(o){u(r,"data-row").each(function(e){var t=a(r,"top");jn.remove(r,"data-initial-top"),h.trigger.adjustHeight(o,t,parseInt(e,10))}),u(r,"data-column").each(function(e){var t=a(r,"left");jn.remove(r,"data-initial-left"),h.trigger.adjustWidth(o,t,parseInt(e,10))}),is.refresh(e,o,n,t)})})});var c=function(t,n){h.trigger.startAdjust(),r.assign(t),jn.set(t,"data-initial-"+n,parseInt(ao.get(t,n),10)),Ul.add(t,jg),ao.set(t,"opacity","0.2"),o.go(e.parent())},s=Sg.bind(e.parent(),"mousedown",function(e){is.isRowBar(e.target())&&c(e.target(),"top"),is.isColBar(e.target())&&c(e.target(),"left")}),f=function(t){return $t.eq(t,e.view())},d=Sg.bind(e.view(),"mouseover",function(r){"table"===kn.name(r.target())||Hg.closest(r.target(),"table",f)?(i="table"===kn.name(r.target())?q.some(r.target()):br.ancestor(r.target(),"table",f),i.each(function(r){is.refresh(e,r,n,t)})):Gn.inBody(r.target())&&is.destroy(e)}),m=function(){s.unbind(),d.unbind(),o.destroy(),is.destroy(e)},g=function(r){is.refresh(e,r,n,t)},h=ag.create({adjustHeight:l(["table","delta","row"]),adjustWidth:l(["table","delta","column"]),startAdjust:l([])});return{destroy:m,refresh:g,on:o.on,off:o.off,hideBars:D(is.hide,e),showBars:D(is.show,e),events:h.registry}}function v(e,t){var n=ic.height,r=h(e,t,n),o=ag.create({beforeResize:l(["table"]),afterResize:l(["table"]),startDrag:l([])});return r.events.adjustHeight.bind(function(e){o.trigger.beforeResize(e.table());var t=n.delta(e.delta(),e.table());Hf.adjustHeight(e.table(),t,e.row(),n),o.trigger.afterResize(e.table())}),r.events.startAdjust.bind(function(e){o.trigger.startDrag()}),r.events.adjustWidth.bind(function(e){o.trigger.beforeResize(e.table());var n=t.delta(e.delta(),e.table());Hf.adjustWidth(e.table(),n,e.column(),t),o.trigger.afterResize(e.table())}),{on:r.on,off:r.off,hideBars:r.hideBars,showBars:r.showBars,destroy:r.destroy,events:o.registry}}function b(e){var t=function(t,n){return Ue.fromPoint(Ue.fromDom(e.document),t,n)},n=function(e){return e.dom().getBoundingClientRect()},r=function(t,n,r,o){var i=mp.exact(t,n,r,o);return zh.getFirstRect(e,i).map(function(e){return pe(e,k)})},o=function(){return zh.get(e).map(function(t){return cv.convertToRange(e,t)})},i=function(t){var n=mp.relative(t.start(),t.finish());return cv.convertToRange(e,n)},u=function(t,n){return zh.getAtPoint(e,t,n).map(function(e){return{start:E(ap.on(e.start(),e.soffset())),finish:E(ap.on(e.finish(),e.foffset()))}})},a=function(){zh.clear(e)},c=function(t){zh.setToElement(e,t)};return{elementFromPoint:t,getRect:n,getRangedRect:r,getSelection:o,fromSitus:i,situsFromPoint:u,clearSelection:a,setSelection:function(t){zh.setExact(e,t.start(),t.soffset(),t.finish(),t.foffset())},setRelativeSelection:function(t,n){zh.setRelative(e,t,n)},selectContents:c,getInnerHeight:function(){return e.innerHeight},getScrollY:function(){return wv.get(Ue.fromDom(e.document)).top()},scrollBy:function(t,n){wv.by(t,n,Ue.fromDom(e.document))}}}function w(e,t,n,r){var o=q.none(),i=function(){o=q.none()};return{mousedown:function(e){r.clear(t),o=Nw(e.target(),n)},mouseover:function(i){o.each(function(o){r.clear(t),Nw(i.target(),n).each(function(i){bu.identify(o,i,n).each(function(n){var u=n.boxes().getOr([]);(u.length>1||1===u.length&&!$t.eq(o,i))&&(r.selectRange(t,u,n.start(),n.finish()),e.selectContents(i))})})})},mouseup:function(){o.each(i)}}}function y(e,t){var n=Se(["mousedown","mouseover","mouseup","keyup","keydown"],[]),r=q.none(),o=Jw.byAttr(Ru);e.on("init",function(i){var u=e.getWin(),a=wd(e),c=Cd(e),l=function(){var t=e.selection,n=Ue.fromDom(t.getStart()),r=Ue.fromDom(t.getEnd());Vi.sharedOne(Pr.table,[n,r]).fold(function(){o.clear(a)},S)},s=Iw.mouse(u,a,c,o),f=Iw.keyboard(u,a,c,o),d=function(e){return!0===e.raw().shiftKey},m=function(t,n){d(t)&&(n.kill()&&t.kill(),n.selection().each(function(t){var n=mp.relative(t.start(),t.finish()),r=jp.asLtrRange(u,n);e.selection.setRng(r)}))},g=function(t){var n=v(t);if(n.raw().shiftKey&&iv.isNavigation(n.raw().which)){var r=e.selection.getRng(),o=Ue.fromDom(r.startContainer),i=Ue.fromDom(r.endContainer);f.keyup(n,o,r.startOffset,i,r.endOffset).each(function(e){m(n,e)})}},p=function(n){var r=v(n);t().each(function(e){e.hideBars()});var o=e.selection.getRng(),i=Ue.fromDom(e.selection.getStart()),u=Ue.fromDom(o.startContainer),a=Ue.fromDom(o.endContainer),c=Pd.directionAt(i).isRtl()?iv.rtl:iv.ltr;f.keydown(r,u,o.startOffset,a,o.endOffset,c).each(function(e){m(r,e)}),t().each(function(e){e.showBars()})},h=function(e){return e.hasOwnProperty("x")&&e.hasOwnProperty("y")},v=function(e){var t=Ue.fromDom(e.target),n=function(){e.stopPropagation()},r=function(){e.preventDefault()},o=T(r,n);return{target:E(t),x:E(h(e)?e.x:null),y:E(h(e)?e.y:null),stop:n,prevent:r,kill:o,raw:E(e)}},b=function(e){return 0===e.button},w=function(e){return void 0===e.buttons||0!=(1&e.buttons)},y=function(e){b(e)&&$w(e)&&s.mousedown(v(e))},x=function(e){w(e)&&$w(e)&&s.mouseover(v(e))},C=function(e){b(e)&&$w(e)&&s.mouseup(v(e))};e.on("mousedown",y),e.on("mouseover",x),e.on("mouseup",C),e.on("keyup",g),e.on("keydown",p),e.on("nodechange",l),r=q.some(n({mousedown:y,mouseover:x,mouseup:C,keyup:g,keydown:p}))});var i=function(){r.each(function(e){})};return{clear:o.clear,destroy:i}}function x(e){var t=Yg(e),n=y(e,t.lazyResize),r=om(e,t.lazyWire),o=Qw(e),i=lc(q.none());return tg.registerCommands(e,r,n,o,i),ju.registerEvents(e,o,r,n),oy.addMenuItems(e,o),ny.addButtons(e),ny.addToolbars(e),e.on("PreInit",function(){e.serializer.addTempAttr(Ru.firstSelected()),e.serializer.addTempAttr(Ru.lastSelected())}),Fd(e)&&e.on("keydown",function(n){Qh.handle(n,e,r,t.lazyWire)}),e.on("remove",function(){t.destroy(),n.destroy()}),ay(e,i)}function C(){}var R=tinymce.util.Tools.resolve("tinymce.PluginManager"),S=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},T=function(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return e(t.apply(null,arguments))}},E=function(e){return function(){return e}},A=function(e){return e},D=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=new Array(arguments.length-1),o=1;o<arguments.length;o++)r[o-1]=arguments[o];return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var o=new Array(arguments.length),i=0;i<o.length;i++)o[i]=arguments[i];var u=r.concat(o);return e.apply(null,u)}},N=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return!e.apply(null,arguments)}},O=function(e){return function(){throw new Error(e)}},k=function(e){return e()},P=E(!1),B=E(!0),I=P,W=B,M=function(){return L},L=function(){var e=function(e){return e.isNone()},t=function(e){return e()},n=function(e){return e},r=function(){},o=function(){return null},i=function(){},u={fold:function(e,t){return e()},is:I,isSome:I,isNone:W,getOr:n,getOrThunk:t,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:o,getOrUndefined:i,or:n,orThunk:t,map:M,ap:M,each:r,bind:M,flatten:M,exists:I,forall:W,filter:M,equals:e,equals_:e,toArray:function(){return[]},toString:E("none()")};return Object.freeze&&Object.freeze(u),u}(),_=function(e){var t=function(){return e},n=function(){return i},r=function(t){return _(t(e))},o=function(t){return t(e)},i={fold:function(t,n){return n(e)},is:function(t){return e===t},isSome:W,isNone:I,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:r,ap:function(t){return t.fold(M,function(t){return _(t(e))})},each:function(t){t(e)},bind:o,flatten:t,exists:o,forall:o,filter:function(t){return t(e)?i:L},equals:function(t){return t.is(e)},equals_:function(t,n){return t.fold(I,function(t){return n(e,t)})},toArray:function(){return[e]},toString:function(){return"some("+e+")"}};return i},F=function(e){return null===e||void 0===e?L:_(e)},q={some:_,none:M,from:F},H=function(e){if(null===e)return"null";var t=typeof e;return"object"===t&&Array.prototype.isPrototypeOf(e)?"array":"object"===t&&String.prototype.isPrototypeOf(e)?"string":t},j=function(e){return function(t){return H(t)===e}},z=j("string"),U=j("array"),V=j("boolean"),G=j("function"),Y=j("number"),X=function(){var e=Array.prototype.indexOf,t=function(t,n){return e.call(t,n)},n=function(e,t){return ie(e,t)};return void 0===e?n:t}(),K=function(e,t){return X(e,t)>-1},J=function(e,t){return oe(e,t).isSome()},$=function(e,t){for(var n=e.length,r=new Array(n),o=0;o<n;o++){var i=e[o];r[o]=t(i,o,e)}return r},Q=function(e,t){for(var n=0,r=e.length;n<r;n++){t(e[n],n,e)}},Z=function(e,t){for(var n=e.length-1;n>=0;n--){t(e[n],n,e)}},ee=function(e,t){for(var n=[],r=0,o=e.length;r<o;r++){var i=e[r];t(i,r,e)&&n.push(i)}return n},te=function(e,t,n){return Z(e,function(e){n=t(n,e)}),n},ne=function(e,t,n){return Q(e,function(e){n=t(n,e)}),n},re=function(e,t){for(var n=0,r=e.length;n<r;n++){var o=e[n];if(t(o,n,e))return q.some(o)}return q.none()},oe=function(e,t){for(var n=0,r=e.length;n<r;n++){if(t(e[n],n,e))return q.some(n)}return q.none()},ie=function(e,t){for(var n=0,r=e.length;n<r;++n)if(e[n]===t)return n;return-1},ue=Array.prototype.push,ae=function(e){for(var t=[],n=0,r=e.length;n<r;++n){if(!Array.prototype.isPrototypeOf(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);ue.apply(t,e[n])}return t},ce=function(e,t){var n=$(e,t);return ae(n)},le=function(e,t){for(var n=0,r=e.length;n<r;++n){if(!0!==t(e[n],n,e))return!1}return!0},se=Array.prototype.slice,fe=function(e){var t=se.call(e,0);return t.reverse(),t},de=function(e){return 0===e.length?q.none():q.some(e[e.length-1])},me=(G(Array.from)&&Array.from,Object.keys),ge=function(e,t){for(var n=me(e),r=0,o=n.length;r<o;r++){var i=n[r];t(e[i],i,e)}},pe=function(e,t){return he(e,function(e,n,r){return{k:n,v:t(e,n,r)}})},he=function(e,t){var n={};return ge(e,function(r,o){var i=t(r,o,e);n[i.k]=i.v}),n},ve=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(e.length!==t.length)throw new Error('Wrong number of arguments to struct. Expected "['+e.length+']", got '+t.length+" arguments");var r={};return Q(e,function(e,n){r[e]=E(t[n])}),r}},be=function(e){return e.slice(0).sort()},we=function(e,t){throw new Error("All required keys ("+be(e).join(", ")+") were not specified. Specified keys were: "+be(t).join(", ")+".")},ye=function(e){throw new Error("Unsupported keys for object: "+be(e).join(", "))},xe=function(e,t){if(!U(t))throw new Error("The "+e+" fields must be an array. Was: "+t+".");Q(t,function(t){if(!z(t))throw new Error("The value "+t+" in the "+e+" fields was not a string.")})},Ce=function(e,t){throw new Error("All values need to be of type: "+t+". Keys ("+be(e).join(", ")+") were not.")},Re=function(e){var t=be(e);re(t,function(e,n){return n<t.length-1&&e===t[n+1]}).each(function(e){throw new Error("The field: "+e+" occurs more than once in the combined fields: ["+t.join(", ")+"].")})},Se=function(e,t){var n=e.concat(t);if(0===n.length)throw new Error("You must specify at least one required or optional field.");return xe("required",e),xe("optional",t),Re(n),function(r){var o=me(r);le(e,function(e){return K(o,e)})||we(e,o);var i=ee(o,function(e){return!K(n,e)});i.length>0&&ye(i);var u={};return Q(e,function(e){u[e]=E(r[e])}),Q(t,function(e){u[e]=E(Object.prototype.hasOwnProperty.call(r,e)?q.some(r[e]):q.none())}),u}},Te=ve("width","height"),Ee=ve("rows","columns"),Ae=ve("row","column"),De=ve("x","y"),Ne=ve("element","rowspan","colspan"),Oe=ve("element","rowspan","colspan","isNew"),ke=ve("element","rowspan","colspan","row","column"),Pe=ve("element","cells","section"),Be=ve("element","isNew"),Ie=ve("element","cells","section","isNew"),We=ve("cells","section"),Me=ve("details","section"),Le=ve("startRow","startCol","finishRow","finishCol"),_e={dimensions:Te,grid:Ee,address:Ae,coords:De,extended:ke,detail:Ne,detailnew:Oe,rowdata:Pe,elementnew:Be,rowdatanew:Ie,rowcells:We,rowdetails:Me,bounds:Le},Fe=function(e,t){var n=t||document,r=n.createElement("div");if(r.innerHTML=e,!r.hasChildNodes()||r.childNodes.length>1)throw console.error("HTML does not have a single root node",e),"HTML must have a single root node";return je(r.childNodes[0])},qe=function(e,t){var n=t||document,r=n.createElement(e);return je(r)},He=function(e,t){var n=t||document,r=n.createTextNode(e);return je(r)},je=function(e){if(null===e||void 0===e)throw new Error("Node cannot be null or undefined");return{dom:E(e)}},ze=function(e,t,n){var r=e.dom();return q.from(r.elementFromPoint(t,n)).map(je)},Ue={fromHtml:Fe,fromTag:qe,fromText:He,fromDom:je,fromPoint:ze},Ve={ATTRIBUTE:Node.ATTRIBUTE_NODE,CDATA_SECTION:Node.CDATA_SECTION_NODE,COMMENT:Node.COMMENT_NODE,DOCUMENT:Node.DOCUMENT_NODE,DOCUMENT_TYPE:Node.DOCUMENT_TYPE_NODE,DOCUMENT_FRAGMENT:Node.DOCUMENT_FRAGMENT_NODE,ELEMENT:Node.ELEMENT_NODE,TEXT:Node.TEXT_NODE,PROCESSING_INSTRUCTION:Node.PROCESSING_INSTRUCTION_NODE,ENTITY_REFERENCE:Node.ENTITY_REFERENCE_NODE,ENTITY:Node.ENTITY_NODE,NOTATION:Node.NOTATION_NODE},Ge=Ve.ELEMENT,Ye=Ve.DOCUMENT,Xe=function(e,t){var n=e.dom();if(n.nodeType!==Ge)return!1;if(void 0!==n.matches)return n.matches(t);if(void 0!==n.msMatchesSelector)return n.msMatchesSelector(t);if(void 0!==n.webkitMatchesSelector)return n.webkitMatchesSelector(t);if(void 0!==n.mozMatchesSelector)return n.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},Ke=function(e){return e.nodeType!==Ge&&e.nodeType!==Ye||0===e.childElementCount},Je=function(e,t){var n=void 0===t?document:t.dom();return Ke(n)?[]:$(n.querySelectorAll(e),Ue.fromDom)},$e=function(e,t){var n=void 0===t?document:t.dom();return Ke(n)?q.none():q.from(n.querySelector(e)).map(Ue.fromDom)},Qe={all:Je,is:Xe,one:$e},Ze=function(e,t){var n=[],r=function(e){return n.push(e),t(e)},o=t(e);do{o=o.bind(r)}while(o.isSome());return n},et={toArray:Ze},tt="undefined"!=typeof window?window:Function("return this;")(),nt=function(e,t){for(var n=void 0!==t&&null!==t?t:tt,r=0;r<e.length&&void 0!==n&&null!==n;++r)n=n[e[r]];return n},rt=function(e,t){var n=e.split(".");return nt(n,t)},ot=function(e,t){return rt(e,t)},it=function(e,t){var n=ot(e,t);if(void 0===n||null===n)throw e+" not available on this browser";return n},ut={getOrDie:it},at=function(){return ut.getOrDie("Node")},ct=function(e,t,n){return 0!=(e.compareDocumentPosition(t)&n)},lt=function(e,t){return ct(e,t,at().DOCUMENT_POSITION_PRECEDING)},st=function(e,t){return ct(e,t,at().DOCUMENT_POSITION_CONTAINED_BY)},ft={documentPositionPreceding:lt,documentPositionContainedBy:st},dt=function(e){var t,n=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return n||(n=!0,t=e.apply(null,r)),t}},mt=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.test(t))return r}},gt=function(e,t){var n=mt(e,t);if(!n)return{major:0,minor:0};var r=function(e){return Number(t.replace(n,"$"+e))};return vt(r(1),r(2))},pt=function(e,t){var n=String(t).toLowerCase();return 0===e.length?ht():gt(e,n)},ht=function(){return vt(0,0)},vt=function(e,t){return{major:e,minor:t}},bt={nu:vt,detect:pt,unknown:ht},wt=function(e,t){return function(){return t===e}},yt=function(){return xt({current:void 0,version:bt.unknown()})},xt=function(e){var t=e.current;return{current:t,version:e.version,isEdge:wt("Edge",t),isChrome:wt("Chrome",t),isIE:wt("IE",t),isOpera:wt("Opera",t),isFirefox:wt("Firefox",t),isSafari:wt("Safari",t)}},Ct={unknown:yt,nu:xt,edge:E("Edge"),chrome:E("Chrome"),ie:E("IE"),opera:E("Opera"),firefox:E("Firefox"),safari:E("Safari")},Rt=function(e,t){return function(){return t===e}},St=function(){return Tt({current:void 0,version:bt.unknown()})},Tt=function(e){var t=e.current;return{current:t,version:e.version,isWindows:Rt("Windows",t),isiOS:Rt("iOS",t),isAndroid:Rt("Android",t),isOSX:Rt("OSX",t),isLinux:Rt("Linux",t),isSolaris:Rt("Solaris",t),isFreeBSD:Rt("FreeBSD",t)}},Et={unknown:St,nu:Tt,windows:E("Windows"),ios:E("iOS"),android:E("Android"),linux:E("Linux"),osx:E("OSX"),solaris:E("Solaris"),freebsd:E("FreeBSD")},At=function(e,t){var n=String(t).toLowerCase();return re(e,function(e){return e.search(n)})},Dt=function(e,t){return At(e,t).map(function(e){var n=bt.detect(e.versionRegexes,t);return{current:e.name,version:n}})},Nt=function(e,t){return At(e,t).map(function(e){var n=bt.detect(e.versionRegexes,t);return{current:e.name,version:n}})},Ot={detectBrowser:Dt,detectOs:Nt},kt=function(e,t,n){return""===t||!(e.length<t.length)&&e.substr(n,n+t.length)===t},Pt=function(e,t){return-1!==e.indexOf(t)},Bt=function(e,t){return kt(e,t,e.length-t.length)},It=function(e){return e.replace(/^\s+|\s+$/g,"")},Wt=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Mt=function(e){return function(t){return Pt(t,e)}},Lt=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return Pt(e,"edge/")&&Pt(e,"chrome")&&Pt(e,"safari")&&Pt(e,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Wt],search:function(e){return Pt(e,"chrome")&&!Pt(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return Pt(e,"msie")||Pt(e,"trident")}},{name:"Opera",versionRegexes:[Wt,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Mt("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Mt("firefox")},{name:"Safari",versionRegexes:[Wt,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(Pt(e,"safari")||Pt(e,"mobile/"))&&Pt(e,"applewebkit")}}],_t=[{name:"Windows",search:Mt("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return Pt(e,"iphone")||Pt(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Mt("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Mt("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Mt("linux"),versionRegexes:[]},{name:"Solaris",search:Mt("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Mt("freebsd"),versionRegexes:[]}],Ft={browsers:E(Lt),oses:E(_t)},qt=function(t){var n=Ft.browsers(),r=Ft.oses(),o=Ot.detectBrowser(n,t).fold(Ct.unknown,Ct.nu),i=Ot.detectOs(r,t).fold(Et.unknown,Et.nu);return{browser:o,os:i,deviceType:e(i,o,t)}},Ht={detect:qt},jt=dt(function(){var e=navigator.userAgent;return Ht.detect(e)}),zt={detect:jt},Ut=function(e,t){return e.dom()===t.dom()},Vt=function(e,t){return e.dom().isEqualNode(t.dom())},Gt=function(e,t){return J(t,D(Ut,e))},Yt=function(e,t){var n=e.dom(),r=t.dom();return n!==r&&n.contains(r)},Xt=function(e,t){return ft.documentPositionContainedBy(e.dom(),t.dom())},Kt=zt.detect().browser,Jt=Kt.isIE()?Xt:Yt,$t={eq:Ut,isEqualNode:Vt,member:Gt,contains:Jt,is:Qe.is},Qt=function(e){return Ue.fromDom(e.dom().ownerDocument)},Zt=function(e){return Ue.fromDom(e.dom().ownerDocument.documentElement)},en=function(e){var t=e.dom(),n=t.ownerDocument.defaultView;return Ue.fromDom(n)},tn=function(e){var t=e.dom();return q.from(t.parentNode).map(Ue.fromDom)},nn=function(e){return tn(e).bind(function(t){var n=fn(t);return oe(n,function(t){return $t.eq(e,t)})})},rn=function(e,t){for(var n=G(t)?t:E(!1),r=e.dom(),o=[];null!==r.parentNode&&void 0!==r.parentNode;){var i=r.parentNode,u=Ue.fromDom(i);if(o.push(u),!0===n(u))break;r=i}return o},on=function(e){var t=function(t){return ee(t,function(t){return!$t.eq(e,t)})};return tn(e).map(fn).map(t).getOr([])},un=function(e){var t=e.dom();return q.from(t.offsetParent).map(Ue.fromDom)},an=function(e){var t=e.dom();return q.from(t.previousSibling).map(Ue.fromDom)},cn=function(e){var t=e.dom();return q.from(t.nextSibling).map(Ue.fromDom)},ln=function(e){return fe(et.toArray(e,an))},sn=function(e){return et.toArray(e,cn)},fn=function(e){var t=e.dom();return $(t.childNodes,Ue.fromDom)},dn=function(e,t){var n=e.dom().childNodes;return q.from(n[t]).map(Ue.fromDom)},mn=function(e){return dn(e,0)},gn=function(e){return dn(e,e.dom().childNodes.length-1)},pn=function(e){return e.dom().childNodes.length},hn=function(e){return e.dom().hasChildNodes()},vn=ve("element","offset"),bn=function(e,t){var n=fn(e);return n.length>0&&t<n.length?vn(n[t],0):vn(e,t)},wn={owner:Qt,defaultView:en,documentElement:Zt,parent:tn,findIndex:nn,parents:rn,siblings:on,prevSibling:an,offsetParent:un,prevSiblings:ln,nextSibling:cn,nextSiblings:sn,children:fn,child:dn,firstChild:mn,lastChild:gn,childNodesCount:pn,hasChildNodes:hn,leaf:bn},yn=function(e,t){return xn(e,t,E(!0))},xn=function(e,t,n){return ce(wn.children(e),function(e){return Qe.is(e,t)?n(e)?[e]:[]:xn(e,t,n)})},Cn={firstLayer:yn,filterFirstLayer:xn},Rn=function(e){return e.dom().nodeName.toLowerCase()},Sn=function(e){return e.dom().nodeType},Tn=function(e){return e.dom().nodeValue},En=function(e){return function(t){return Sn(t)===e}},An=function(e){return Sn(e)===Ve.COMMENT||"#comment"===Rn(e)},Dn=En(Ve.ELEMENT),Nn=En(Ve.TEXT),On=En(Ve.DOCUMENT),kn={name:Rn,type:Sn,value:Tn,isElement:Dn,isText:Nn,isDocument:On,isComment:An},Pn=function(e,t,n){if(!(z(n)||V(n)||Y(n)))throw console.error("Invalid call to Attr.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")},Bn=function(e,t,n){Pn(e.dom(),t,n)},In=function(e,t){var n=e.dom();ge(t,function(e,t){Pn(n,t,e)})},Wn=function(e,t){var n=e.dom().getAttribute(t);return null===n?void 0:n},Mn=function(e,t){var n=e.dom();return!(!n||!n.hasAttribute)&&n.hasAttribute(t)},Ln=function(e,t){e.dom().removeAttribute(t)},_n=function(e){var t=e.dom().attributes;return void 0===t||null===t||0===t.length},Fn=function(e){return ne(e.dom().attributes,function(e,t){return e[t.name]=t.value,e},{})},qn=function(e,t,n){Mn(e,n)&&!Mn(t,n)&&Bn(t,n,Wn(e,n))},Hn=function(e,t,n){kn.isElement(e)&&kn.isElement(t)&&Q(n,function(n){qn(e,t,n)})},jn={clone:Fn,set:Bn,setAll:In,get:Wn,has:Mn,remove:Ln,hasNone:_n,transfer:Hn},zn=function(e){var t=kn.isText(e)?e.dom().parentNode:e.dom();return void 0!==t&&null!==t&&t.ownerDocument.body.contains(t)},Un=dt(function(){return Vn(Ue.fromDom(document))}),Vn=function(e){var t=e.dom().body;if(null===t||void 0===t)throw"Body is not available yet";return Ue.fromDom(t)},Gn={body:Un,getBody:Vn,inBody:zn},Yn=function(e){return $n(Gn.body(),e)},Xn=function(e,t,n){return ee(wn.parents(e,n),t)},Kn=function(e,t){return ee(wn.siblings(e),t)},Jn=function(e,t){return ee(wn.children(e),t)},$n=function(e,t){var n=[];return Q(wn.children(e),function(e){t(e)&&(n=n.concat([e])),n=n.concat($n(e,t))}),n},Qn={all:Yn,ancestors:Xn,siblings:Kn,children:Jn,descendants:$n},Zn=function(e){return Qe.all(e)},er=function(e,t,n){return Qn.ancestors(e,function(e){return Qe.is(e,t)},n)},tr=function(e,t){return Qn.siblings(e,function(e){return Qe.is(e,t)})},nr=function(e,t){return Qn.children(e,function(e){return Qe.is(e,t)})},rr=function(e,t){return Qe.all(t,e)},or={all:Zn,ancestors:er,siblings:tr,children:nr,descendants:rr},ir=function(e){return sr(Gn.body(),e)},ur=function(e,t,n){for(var r=e.dom(),o=G(n)?n:E(!1);r.parentNode;){r=r.parentNode;var i=Ue.fromDom(r);if(t(i))return q.some(i);if(o(i))break}return q.none()},ar=function(e,n,r){return t(function(e){return n(e)},ur,e,n,r)},cr=function(e,t){var n=e.dom();return n.parentNode?lr(Ue.fromDom(n.parentNode),function(n){return!$t.eq(e,n)&&t(n)}):q.none()},lr=function(e,t){return re(e.dom().childNodes,T(t,Ue.fromDom)).map(Ue.fromDom)},sr=function(e,t){var n=function(e){for(var r=0;r<e.childNodes.length;r++){if(t(Ue.fromDom(e.childNodes[r])))return q.some(Ue.fromDom(e.childNodes[r]));var o=n(e.childNodes[r]);if(o.isSome())return o}return q.none()};return n(e.dom())},fr={first:ir,ancestor:ur,closest:ar,sibling:cr,child:lr,descendant:sr},dr=function(e){return Qe.one(e)},mr=function(e,t,n){return fr.ancestor(e,function(e){return Qe.is(e,t)},n)},gr=function(e,t){return fr.sibling(e,function(e){return Qe.is(e,t)})},pr=function(e,t){return fr.child(e,function(e){return Qe.is(e,t)})},hr=function(e,t){return Qe.one(t,e)},vr=function(e,n,r){return t(Qe.is,mr,e,n,r)},br={first:dr,ancestor:mr,sibling:gr,child:pr,descendant:hr,closest:vr},wr=function(e,t,n){var r=void 0!==n?n:E(!1);if(r(t))return q.none();if(K(e,kn.name(t)))return q.some(t);var o=function(e){return Qe.is(e,"table")||r(e)};return br.ancestor(t,e.join(","),o)},yr=function(e,t){return wr(["td","th"],e,t)},xr=function(e){return Cn.firstLayer(e,"th,td")},Cr=function(e,t){return wr(["caption","tr","tbody","tfoot","thead"],e,t)},Rr=function(e,t){return wn.parent(t).map(function(t){return or.children(t,e)})},Sr=D(Rr,"th,td"),Tr=D(Rr,"tr"),Er=function(e){return br.descendant(e,"th,td")},Ar=function(e,t){return br.closest(e,"table",t)},Dr=function(e,t){return wr(["tr"],e,t)},Nr=function(e){return Cn.firstLayer(e,"tr")},Or=function(e,t){return parseInt(jn.get(e,t),10)},kr=function(e,t,n){var r=Or(e,t),o=Or(e,n);return _e.grid(r,o)},Pr={cell:yr,firstCell:Er,cells:xr,neighbourCells:Sr,table:Ar,row:Dr,rows:Nr,notCell:Cr,neighbourRows:Tr,attr:Or,grid:kr},Br=function(e){var t=Pr.rows(e);return $(t,function(e){var t=e,n=wn.parent(t),r=n.map(function(e){var t=kn.name(e);return"tfoot"===t||"thead"===t||"tbody"===t?t:"tbody"}).getOr("tbody"),o=$(Pr.cells(e),function(e){var t=jn.has(e,"rowspan")?parseInt(jn.get(e,"rowspan"),10):1,n=jn.has(e,"colspan")?parseInt(jn.get(e,"colspan"),10):1;return _e.detail(e,t,n)});return _e.rowdata(t,o,r)})},Ir=function(e,t){return $(e,function(e){var n=$(Pr.cells(e),function(e){var t=jn.has(e,"rowspan")?parseInt(jn.get(e,"rowspan"),10):1,n=jn.has(e,"colspan")?parseInt(jn.get(e,"colspan"),10):1;return _e.detail(e,t,n)});return _e.rowdata(e,n,t.section())})},Wr={fromTable:Br,fromPastedRows:Ir},Mr=function(e,t){return e+","+t},Lr=function(e,t,n){var r=e.access()[Mr(t,n)];return void 0!==r?q.some(r):q.none()},_r=function(e,t,n){var r=Fr(e,function(e){return n(t,e.element())});return r.length>0?q.some(r[0]):q.none()},Fr=function(e,t){var n=ce(e.all(),function(e){return e.cells()});return ee(n,t)},qr=function(e){var t={},n=[],r=e.length,o=0;Q(e,function(e,r){var i=[];Q(e.cells(),function(e,n){for(var u=0;void 0!==t[Mr(r,u)];)u++;for(var a=_e.extended(e.element(),e.rowspan(),e.colspan(),r,u),c=0;c<e.colspan();c++)for(var l=0;l<e.rowspan();l++){var s=r+l,f=u+c,d=Mr(s,f);t[d]=a,o=Math.max(o,f+1)}i.push(a)}),n.push(_e.rowdata(e.element(),i,e.section()))});var i=_e.grid(r,o);return{grid:E(i),access:E(t),all:E(n)}},Hr=function(e){var t=$(e.all(),function(e){return e.cells()});return ae(t)},jr={generate:qr,getAt:Lr,findItem:_r,filterItems:Fr,justCells:Hr},zr=function(e){return void 0!==e.style},Ur={isSupported:zr
},Vr=function(e,t,n){if(!z(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);Ur.isSupported(e)&&e.style.setProperty(t,n)},Gr=function(e,t){Ur.isSupported(e)&&e.style.removeProperty(t)},Yr=function(e,t,n){var r=e.dom();Vr(r,t,n)},Xr=function(e,t){var n=e.dom();ge(t,function(e,t){Vr(n,t,e)})},Kr=function(e,t){var n=e.dom();ge(t,function(e,t){e.fold(function(){Gr(n,t)},function(e){Vr(n,t,e)})})},Jr=function(e,t){var n=e.dom(),r=window.getComputedStyle(n),o=r.getPropertyValue(t),i=""!==o||Gn.inBody(e)?o:$r(n,t);return null===i?void 0:i},$r=function(e,t){return Ur.isSupported(e)?e.style.getPropertyValue(t):""},Qr=function(e,t){var n=e.dom(),r=$r(n,t);return q.from(r).filter(function(e){return e.length>0})},Zr=function(e){var t={},n=e.dom();if(Ur.isSupported(n))for(var r=0;r<n.style.length;r++){var o=n.style.item(r);t[o]=n.style[o]}return t},eo=function(e,t,n){var r=Ue.fromTag(e);return Yr(r,t,n),Qr(r,t).isSome()},to=function(e,t){var n=e.dom();Gr(n,t),jn.has(e,"style")&&""===It(jn.get(e,"style"))&&jn.remove(e,"style")},no=function(e,t){var n=jn.get(e,"style"),r=t(e);return(void 0===n?jn.remove:jn.set)(e,"style",n),r},ro=function(e,t){var n=e.dom(),r=t.dom();Ur.isSupported(n)&&Ur.isSupported(r)&&(r.style.cssText=n.style.cssText)},oo=function(e){return e.dom().offsetWidth},io=function(e,t,n){Qr(e,n).each(function(e){Qr(t,n).isNone()&&Yr(t,n,e)})},uo=function(e,t,n){kn.isElement(e)&&kn.isElement(t)&&Q(n,function(n){io(e,t,n)})},ao={copy:ro,set:Yr,preserve:no,setAll:Xr,setOptions:Kr,remove:to,get:Jr,getRaw:Qr,getAllRaw:Zr,isValidValue:eo,reflow:oo,transfer:uo},co=function(e,t){wn.parent(e).each(function(n){n.dom().insertBefore(t.dom(),e.dom())})},lo=function(e,t){wn.nextSibling(e).fold(function(){wn.parent(e).each(function(e){fo(e,t)})},function(e){co(e,t)})},so=function(e,t){wn.firstChild(e).fold(function(){fo(e,t)},function(n){e.dom().insertBefore(t.dom(),n.dom())})},fo=function(e,t){e.dom().appendChild(t.dom())},mo=function(e,t,n){wn.child(e,n).fold(function(){fo(e,t)},function(e){co(e,t)})},go=function(e,t){co(e,t),fo(t,e)},po={before:co,after:lo,prepend:so,append:fo,appendAt:mo,wrap:go},ho=function(e,t){Q(t,function(t){po.before(e,t)})},vo=function(e,t){Q(t,function(n,r){var o=0===r?e:t[r-1];po.after(o,n)})},bo=function(e,t){Q(t.slice().reverse(),function(t){po.prepend(e,t)})},wo=function(e,t){Q(t,function(t){po.append(e,t)})},yo={before:ho,after:vo,prepend:bo,append:wo},xo=function(e){e.dom().textContent="",Q(wn.children(e),function(e){Co(e)})},Co=function(e){var t=e.dom();null!==t.parentNode&&t.parentNode.removeChild(t)},Ro=function(e){var t=wn.children(e);t.length>0&&yo.before(e,t),Co(e)},So={empty:xo,remove:Co,unwrap:Ro},To=ve("minRow","minCol","maxRow","maxCol"),Eo=function(e,t){var n=e.grid().columns(),r=e.grid().rows(),o=r,i=n,u=0,a=0;return ge(e.access(),function(e){if(t(e)){var n=e.row(),r=n+e.rowspan()-1,c=e.column(),l=c+e.colspan()-1;n<o?o=n:r>u&&(u=r),c<i?i=c:l>a&&(a=l)}}),To(o,i,u,a)},Ao=function(e,t,n){var r=e[n].element(),o=Ue.fromTag("td");po.append(o,Ue.fromTag("br")),(t?po.append:po.prepend)(r,o)},Do=function(e,t,n,r){for(var o=t.grid().columns(),i=t.grid().rows(),u=0;u<i;u++)for(var a=!1,c=0;c<o;c++)if(!(u<n.minRow()||u>n.maxRow()||c<n.minCol()||c>n.maxCol())){var l=jr.getAt(t,u,c).filter(r).isNone();l?Ao(e,a,u):a=!0}},No=function(e,t){var n=ee(Cn.firstLayer(e,"tr"),function(e){return 0===e.dom().childElementCount});Q(n,So.remove),t.minCol()!==t.maxCol()&&t.minRow()!==t.maxRow()||Q(Cn.firstLayer(e,"th,td"),function(e){jn.remove(e,"rowspan"),jn.remove(e,"colspan")}),jn.remove(e,"width"),jn.remove(e,"height"),ao.remove(e,"width"),ao.remove(e,"height")},Oo=function(e,t){var n=function(e){return Qe.is(e.element(),t)},r=Wr.fromTable(e),o=jr.generate(r),i=Eo(o,n),u="th:not("+t+"),td:not("+t+")",a=Cn.filterFirstLayer(e,"th,td",function(e){return Qe.is(e,u)});return Q(a,So.remove),Do(r,o,i,n),No(e,i),e},ko={extract:Oo},Po=function(e,t){return Ue.fromDom(e.dom().cloneNode(t))},Bo=function(e){return Po(e,!1)},Io=function(e){return Po(e,!0)},Wo=function(e,t){var n=Ue.fromTag(t),r=jn.clone(e);return jn.setAll(n,r),n},Mo=function(e,t){var n=Wo(e,t),r=wn.children(Io(e));return yo.append(n,r),n},Lo=function(e,t){var n=Wo(e,t);po.before(e,n);var r=wn.children(e);return yo.append(n,r),So.remove(e),n},_o={shallow:Bo,shallowAs:Wo,deep:Io,copy:Mo,mutate:Lo},Fo=function(e,t){var n=function(n){if(!e(n))throw new Error("Can only get "+t+" value of a "+t+" node");return u(n).getOr("")},r=function(e){try{return o(e)}catch(e){return q.none()}},o=function(t){return e(t)?q.from(t.dom().nodeValue):q.none()},i=zt.detect().browser,u=i.isIE()&&10===i.version.major?r:o;return{get:n,getOption:u,set:function(n,r){if(!e(n))throw new Error("Can only set raw "+t+" value of a "+t+" node");n.dom().nodeValue=r}}}(kn.isText,"text"),qo=function(e){return Fo.get(e)},Ho=function(e){return Fo.getOption(e)},jo=function(e,t){Fo.set(e,t)},zo={get:qo,getOption:Ho,set:jo},Uo=function(e){return"img"===kn.name(e)?1:zo.getOption(e).fold(function(){return wn.children(e).length},function(e){return e.length})},Vo=function(e,t){return Uo(e)===t},Go=function(e,t){return 0===t},Yo=function(e){return zo.getOption(e).filter(function(e){return 0!==e.trim().length||e.indexOf(" ")>-1}).isSome()},Xo=["img","br"],Ko=function(e){return Yo(e)||K(Xo,kn.name(e))},Jo={getEnd:Uo,isEnd:Vo,isStart:Go,isCursorPosition:Ko},$o=function(e){return fr.descendant(e,Jo.isCursorPosition)},Qo=function(e){return Zo(e,Jo.isCursorPosition)},Zo=function(e,t){var n=function(e){for(var r=wn.children(e),o=r.length-1;o>=0;o--){var i=r[o];if(t(i))return q.some(i);var u=n(i);if(u.isSome())return u}return q.none()};return n(e)},ei={first:$o,last:Qo},ti=function(){var e=Ue.fromTag("td");return po.append(e,Ue.fromTag("br")),e},ni=function(e,t,n){var r=_o.copy(e,t);return ge(n,function(e,t){null===e?jn.remove(r,t):jn.set(r,t,e)}),r},ri=function(e){return e},oi=function(e){return function(){return Ue.fromTag("tr",e.dom())}},ii=function(e,t,n){return ei.first(e).map(function(r){var o=n.join(","),i=or.ancestors(r,o,function(t){return $t.eq(t,e)});return te(i,function(e,t){var n=_o.shallow(t);return jn.remove(n,"contenteditable"),po.append(e,n),n},t)}).getOr(t)},ui=function(e,t,n){var r=function(t){var r=wn.owner(t.element()),o=Ue.fromTag(kn.name(t.element()),r.dom()),i=n.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),u=i.length>0?ii(t.element(),o,i):o;return po.append(u,Ue.fromTag("br")),ao.copy(t.element(),o),ao.remove(o,"height"),1!==t.colspan()&&ao.remove(t.element(),"width"),e(t.element(),o),o};return{row:oi(t),cell:r,replace:ni,gap:ti}},ai=function(e){return{row:oi(e),cell:ti,replace:ri,gap:ti}},ci={cellOperations:ui,paste:ai},li=function(e,t){var n=t||document,r=n.createElement("div");return r.innerHTML=e,wn.children(Ue.fromDom(r))},si=function(e,t){return $(e,function(e){return Ue.fromTag(e,t)})},fi=function(e,t){return $(e,function(e){return Ue.fromText(e,t)})},di=function(e){return $(e,Ue.fromDom)},mi={fromHtml:li,fromTags:si,fromText:fi,fromDom:di},gi=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],pi=ve("left","right"),hi=function(e,t,n){var r=e.property().children(t);return oe(r,D(e.eq,n)).map(function(e){return{before:E(r.slice(0,e)),after:E(r.slice(e+1))}})},vi=function(e,t,n){return hi(e,t,n).map(function(n){var r=e.create().clone(t);return e.insert().appendAll(r,n.after()),e.insert().after(t,r),pi(t,r)})},bi=function(e,t,n){return hi(e,t,n).map(function(r){var o=e.create().clone(t);return e.insert().appendAll(o,r.before().concat([n])),e.insert().appendAll(t,r.after()),e.insert().before(t,o),pi(o,t)})},wi=function(e,t,n,r){var o=ve("first","second","splits"),i=function(t,u,a){var c=o(t,q.none(),a);return n(t)?o(t,u,a):e.property().parent(t).bind(function(o){return r(e,o,t).map(function(e){var t=[{first:e.left,second:e.right}],r=n(o)?o:e.left();return i(r,q.some(e.right()),a.concat(t))}).getOr(c)})};return i(t,q.none(),[])},yi={breakToLeft:bi,breakToRight:vi,breakPath:wi},xi=function(e,t,n,r){return r(e,t,n[0],n.slice(1))},Ci=function(e,t,n){return n.length>0?xi(e,t,n,Ri):q.none()},Ri=function(e,t,n,r){var o=t(e,n);return te(r,function(n,r){var o=t(e,r);return Si(e,n,o)},o)},Si=function(e,t,n){return t.bind(function(t){return n.filter(D(e.eq,t))})},Ti={oneAll:Ci},Ei=function(e,t){return D(e.eq,t)},Ai=function(e,t,n,r){var o=e.property().children(t);if(e.eq(t,n[0]))return q.some([n[0]]);if(e.eq(t,r[0]))return q.some([r[0]]);var i=function(n){var r=fe(n),i=oe(r,Ei(e,t)).getOr(-1),u=i<r.length-1?r[i+1]:r[i];return oe(o,Ei(e,u))},u=i(n),a=i(r);return u.bind(function(e){return a.map(function(t){var n=Math.min(e,t),r=Math.max(e,t);return o.slice(n,r+1)})})},Di=function(e,t,n,r){var o=void 0!==r?r:E(!1),i=[t].concat(e.up().all(t)),u=[n].concat(e.up().all(n)),a=function(e){return oe(e,o).fold(function(){return e},function(t){return e.slice(0,t+1)})},c=a(i),l=a(u),s=re(c,function(t){return J(l,Ei(e,t))});return{firstpath:E(c),secondpath:E(l),shared:E(s)}},Ni=function(e,t,n){var r=Di(e,t,n);return r.shared().bind(function(t){return Ai(e,t,r.firstpath(),r.secondpath())})},Oi={subset:Ni,ancestors:Di},ki=function(e,t,n){return Ti.oneAll(e,t,n)},Pi=function(e,t,n){return Oi.subset(e,t,n)},Bi=function(e,t,n,r){return Oi.ancestors(e,t,n,r)},Ii=function(e,t,n){return yi.breakToLeft(e,t,n)},Wi=function(e,t,n){return yi.breakToRight(e,t,n)},Mi=function(e,t,n,r){return yi.breakPath(e,t,n,r)},Li={sharedOne:ki,subset:Pi,ancestors:Bi,breakToLeft:Ii,breakToRight:Wi,breakPath:Mi},_i=n(),Fi=function(e,t){return Li.sharedOne(_i,function(t,n){return e(n)},t)},qi=function(e,t){return Li.subset(_i,e,t)},Hi=function(e,t,n){return Li.ancestors(_i,e,t,n)},ji=function(e,t){return Li.breakToLeft(_i,e,t)},zi=function(e,t){return Li.breakToRight(_i,e,t)},Ui=function(e,t,n){return Li.breakPath(_i,e,t,function(e,t,r){return n(t,r)})},Vi={sharedOne:Fi,subset:qi,ancestors:Hi,breakToLeft:ji,breakToRight:zi,breakPath:Ui},Gi=function(e,t){var n=t.column(),r=t.column()+t.colspan()-1,o=t.row(),i=t.row()+t.rowspan()-1;return n<=e.finishCol()&&r>=e.startCol()&&o<=e.finishRow()&&i>=e.startRow()},Yi=function(e,t){return t.column()>=e.startCol()&&t.column()+t.colspan()-1<=e.finishCol()&&t.row()>=e.startRow()&&t.row()+t.rowspan()-1<=e.finishRow()},Xi=function(e,t){for(var n=!0,r=D(Yi,t),o=t.startRow();o<=t.finishRow();o++)for(var i=t.startCol();i<=t.finishCol();i++)n=n&&jr.getAt(e,o,i).exists(r);return n?q.some(t):q.none()},Ki={inSelection:Gi,isWithin:Yi,isRectangular:Xi},Ji=function(e,t){return _e.bounds(Math.min(e.row(),t.row()),Math.min(e.column(),t.column()),Math.max(e.row()+e.rowspan()-1,t.row()+t.rowspan()-1),Math.max(e.column()+e.colspan()-1,t.column()+t.colspan()-1))},$i=function(e,t,n){var r=jr.findItem(e,t,$t.eq),o=jr.findItem(e,n,$t.eq);return r.bind(function(e){return o.map(function(t){return Ji(e,t)})})},Qi=function(e,t,n){return $i(e,t,n).bind(function(t){return Ki.isRectangular(e,t)})},Zi={getAnyBox:$i,getBox:Qi},eu=function(e,t,n,r){return jr.findItem(e,t,$t.eq).bind(function(t){var o=n>0?t.row()+t.rowspan()-1:t.row(),i=r>0?t.column()+t.colspan()-1:t.column();return jr.getAt(e,o+n,i+r).map(function(e){return e.element()})})},tu=function(e,t,n){return Zi.getAnyBox(e,t,n).map(function(t){var n=jr.filterItems(e,D(Ki.inSelection,t));return $(n,function(e){return e.element()})})},nu=function(e,t){var n=function(e,t){return $t.contains(t,e)};return jr.findItem(e,t,n).bind(function(e){return e.element()})},ru={moveBy:eu,intercepts:tu,parentCell:nu},ou=function(e,t,n){return Pr.table(e).bind(function(r){var o=cu(r);return ru.moveBy(o,e,t,n)})},iu=function(e,t,n){var r=cu(e);return ru.intercepts(r,t,n)},uu=function(e,t,n,r,o){var i=cu(e),u=$t.eq(e,n)?t:ru.parentCell(i,t),a=$t.eq(e,o)?r:ru.parentCell(i,r);return ru.intercepts(i,u,a)},au=function(e,t,n){var r=cu(e);return Zi.getBox(r,t,n)},cu=function(e){var t=Wr.fromTable(e);return jr.generate(t)},lu={moveBy:ou,intercepts:iu,nestedIntercepts:uu,getBox:au},su=function(e,t){return br.ancestor(e,"table")},fu=Se(["boxes","start","finish"],[]),du=function(e,t,n){var r=function(e){return function(t){return n(t)||$t.eq(t,e)}};return $t.eq(e,t)?q.some(fu({boxes:q.some([e]),start:e,finish:t})):su(e).bind(function(o){return su(t).bind(function(i){if($t.eq(o,i))return q.some(fu({boxes:lu.intercepts(o,e,t),start:e,finish:t}));if($t.contains(o,i)){var u=or.ancestors(t,"td,th",r(o)),a=u.length>0?u[u.length-1]:t;return q.some(fu({boxes:lu.nestedIntercepts(o,e,o,t,i),start:e,finish:a}))}if($t.contains(i,o)){var u=or.ancestors(e,"td,th",r(i)),c=u.length>0?u[u.length-1]:e;return q.some(fu({boxes:lu.nestedIntercepts(i,e,o,t,i),start:e,finish:c}))}return Vi.ancestors(e,t).shared().bind(function(u){return br.closest(u,"table",n).bind(function(n){var u=or.ancestors(t,"td,th",r(n)),a=u.length>0?u[u.length-1]:t,c=or.ancestors(e,"td,th",r(n)),l=c.length>0?c[c.length-1]:e;return q.some(fu({boxes:lu.nestedIntercepts(n,e,o,t,i),start:l,finish:a}))})})})})},mu=function(e,t){var n=or.descendants(e,t);return n.length>0?q.some(n):q.none()},gu=function(e,t){return re(e,function(e){return Qe.is(e,t)})},pu=function(e,t,n){return br.descendant(e,t).bind(function(t){return br.descendant(e,n).bind(function(e){return Vi.sharedOne(su,[t,e]).map(function(n){return{first:E(t),last:E(e),table:E(n)}})})})},hu=function(e,t){return br.ancestor(e,"table").bind(function(n){return br.descendant(n,t).bind(function(t){return du(t,e).bind(function(e){return e.boxes().map(function(t){return{boxes:E(t),start:E(e.start()),finish:E(e.finish())}})})})})},vu=function(e,t,n,r,o){return gu(e,o).bind(function(e){return lu.moveBy(e,t,n).bind(function(e){return hu(e,r)})})},bu={identify:du,retrieve:mu,shiftSelection:vu,getEdges:pu},wu=function(e,t){return bu.retrieve(e,t)},yu=function(e,t,n){return bu.getEdges(e,t,n).bind(function(t){var n=function(t){return $t.eq(e,t)},r=br.ancestor(t.first(),"thead,tfoot,tbody,table",n),o=br.ancestor(t.last(),"thead,tfoot,tbody,table",n);return r.bind(function(e){return o.bind(function(n){return $t.eq(e,n)?lu.getBox(t.table(),t.first(),t.last()):q.none()})})})},xu={retrieve:wu,retrieveBox:yu},Cu="data-mce-selected",Ru={selected:E(Cu),selectedSelector:E("td[data-mce-selected],th[data-mce-selected]"),attributeSelector:E("[data-mce-selected]"),firstSelected:E("data-mce-first-selected"),firstSelectedSelector:E("td[data-mce-first-selected],th[data-mce-first-selected]"),lastSelected:E("data-mce-last-selected"),lastSelectedSelector:E("td[data-mce-last-selected],th[data-mce-last-selected]")},Su=function(e){if(!U(e))throw new Error("cases must be an array");if(0===e.length)throw new Error("there must be at least one case");var t=[],n={};return Q(e,function(r,o){var i=me(r);if(1!==i.length)throw new Error("one and only one name per case");var u=i[0],a=r[u];if(void 0!==n[u])throw new Error("duplicate key detected:"+u);if("cata"===u)throw new Error("cannot have a case named cata (sorry)");if(!U(a))throw new Error("case arguments must be an array");t.push(u),n[u]=function(){var n=arguments.length;if(n!==a.length)throw new Error("Wrong number of arguments to case "+u+". Expected "+a.length+" ("+a+"), got "+n);for(var r=new Array(n),i=0;i<r.length;i++)r[i]=arguments[i];var c=function(e){var n=me(e);if(t.length!==n.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+n.join(","));if(!le(t,function(e){return K(n,e)}))throw new Error("Not all branches were specified when using match. Specified: "+n.join(", ")+"\nRequired: "+t.join(", "));return e[u].apply(null,r)};return{fold:function(){if(arguments.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+arguments.length);return arguments[o].apply(null,r)},match:c,log:function(e){console.log(e,{constructors:t,constructor:u,params:r})}}}}),n},Tu={generate:Su},Eu=Tu.generate([{none:[]},{multiple:["elements"]},{single:["selection"]}]),Au=function(e,t,n,r){return e.fold(t,n,r)},Du={cata:Au,none:Eu.none,multiple:Eu.multiple,single:Eu.single},Nu=function(e,t){return Du.cata(t.get(),E([]),A,E([e]))},Ou=function(e,t){var n=function(e){return jn.has(e,"rowspan")&&parseInt(jn.get(e,"rowspan"),10)>1||jn.has(e,"colspan")&&parseInt(jn.get(e,"colspan"),10)>1},r=Nu(e,t);return r.length>0&&le(r,n)?q.some(r):q.none()},ku=function(e,t){return Du.cata(t.get(),q.none,function(t,n){return 0===t.length?q.none():xu.retrieveBox(e,Ru.firstSelectedSelector(),Ru.lastSelectedSelector()).bind(function(e){return t.length>1?q.some({bounds:E(e),cells:E(t)}):q.none()})},q.none)},Pu={mergable:ku,unmergable:Ou,selection:Nu},Bu=function(e){return{element:E(e),mergable:q.none,unmergable:q.none,selection:E([e])}},Iu=function(e,t,n){return{element:E(n),mergable:E(Pu.mergable(t,e)),unmergable:E(Pu.unmergable(n,e)),selection:E(Pu.selection(n,e))}},Wu=function(e){return Bu(e)},Mu=ve("element","clipboard","generators"),Lu=function(e,t,n,r,o){return{element:E(n),mergable:q.none,unmergable:q.none,selection:E(Pu.selection(n,e)),clipboard:E(r),generators:E(o)}},_u={noMenu:Bu,forMenu:Iu,notCell:Wu,paste:Mu,pasteRows:Lu},Fu=function(e){return Pr.table(e[0]).map(_o.deep).map(function(e){return[ko.extract(e,Ru.attributeSelector())]})},qu=function(e,t){return e.selection.serializer.serialize(t.dom(),{})},Hu=function(e,t,n,r){e.on("BeforeGetContent",function(n){var r=function(t){n.preventDefault(),Fu(t).each(function(t){n.content=$(t,function(t){return qu(e,t)}).join("")})};!0===n.selection&&Du.cata(t.get(),S,r,S)}),e.on("BeforeSetContent",function(t){if(!0===t.selection&&!0===t.paste){q.from(e.dom.getParent(e.selection.getStart(),"th,td")).each(function(o){var i=Ue.fromDom(o);Pr.table(i).bind(function(o){var u=ee(mi.fromHtml(t.content),function(e){return"meta"!==kn.name(e)});if(1===u.length&&"table"===kn.name(u[0])){t.preventDefault();var a=Ue.fromDom(e.getDoc()),c=ci.paste(a),l=_u.paste(i,u[0],c);n.pasteCells(o,l).each(function(t){e.selection.setRng(t),e.focus(),r.clear(o)})}})})}})},ju={registerEvents:Hu},zu=r("height",function(e){var t=e.dom();return Gn.inBody(e)?t.getBoundingClientRect().height:t.offsetHeight}),Uu=function(e,t){zu.set(e,t)},Vu=function(e){return zu.get(e)},Gu=function(e){return zu.getOuter(e)},Yu=function(e,t){var n=["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"],r=zu.max(e,t,n);ao.set(e,"max-height",r+"px")},Xu={set:Uu,get:Vu,getOuter:Gu,setMax:Yu},Ku=r("width",function(e){return e.dom().offsetWidth}),Ju=function(e,t){Ku.set(e,t)},$u=function(e){return Ku.get(e)},Qu=function(e){return Ku.getOuter(e)},Zu=function(e,t){var n=["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"],r=Ku.max(e,t,n);ao.set(e,"max-width",r+"px")},ea={set:Ju,get:$u,getOuter:Qu,setMax:Zu},ta=zt.detect(),na=function(){return ta.browser.isIE()||ta.browser.isEdge()},ra=function(e,t){var n=parseFloat(e);return isNaN(n)?t:n},oa=function(e,t,n){return ra(ao.get(e,t),n)},ia=function(e){var t=oa(e,"padding-top",0),n=oa(e,"padding-bottom",0),r=oa(e,"border-top-width",0),o=oa(e,"border-bottom-width",0),i=e.dom().getBoundingClientRect().height,u=ao.get(e,"box-sizing"),a=r+o;return"border-box"===u?i:i-t-n-a},ua=function(e){return oa(e,"width",ea.get(e))},aa=function(e){return na()?ia(e):oa(e,"height",Xu.get(e))},ca={getWidth:ua,getHeight:aa},la=/(\d+(\.\d+)?)(\w|%)*/,sa=/(\d+(\.\d+)?)%/,fa=/(\d+(\.\d+)?)px|em/,da=function(e,t){ao.set(e,"width",t+"px")},ma=function(e,t){ao.set(e,"width",t+"%")},ga=function(e,t){ao.set(e,"height",t+"px")},pa=function(e){return ao.getRaw(e,"height").getOrThunk(function(){return ca.getHeight(e)+"px"})},ha=function(e,t,n,r){var o=Pr.table(e).map(function(e){var r=n(e);return Math.floor(t/100*r)}).getOr(t);return r(e,o),o},va=function(e,t,n,r){var o=parseInt(e,10);return Bt(e,"%")&&"table"!==kn.name(t)?ha(t,o,n,r):o},ba=function(e){var t=pa(e);return t?va(t,e,Xu.get,ga):Xu.get(e)},wa=function(e,t,n){return n(e)/ya(e,t)},ya=function(e,t){return jn.has(e,t)?parseInt(jn.get(e,t),10):1},xa=function(e){return ao.getRaw(e,"width").fold(function(){return q.from(jn.get(e,"width"))},function(e){return q.some(e)})},Ca=function(e,t){return e/t.pixelWidth()*100},Ra=function(e,t,n){if(sa.test(t)){var r=sa.exec(t);return parseFloat(r[1])}var o=ea.get(e);return Ca(o,n)},Sa=function(e,t){return xa(e).fold(function(){var n=ea.get(e);return Ca(n,t)},function(n){return Ra(e,n,t)})},Ta=function(e,t){return e/100*t.pixelWidth()},Ea=function(e,t,n){if(fa.test(t)){var r=fa.exec(t);return parseInt(r[1],10)}if(sa.test(t)){var o=sa.exec(t),i=parseFloat(o[1]);return Ta(i,n)}return ea.get(e)},Aa=function(e,t){return xa(e).fold(function(){return ea.get(e)},function(n){return Ea(e,n,t)})},Da=function(e){return wa(e,"rowspan",ba)},Na=function(e){return xa(e).bind(function(e){if(la.test(e)){var t=la.exec(e);return q.some({width:E(t[1]),unit:E(t[3])})}return q.none()})},Oa=function(e,t,n){ao.set(e,"width",t+n)},ka={percentageBasedSizeRegex:E(sa),pixelBasedSizeRegex:E(fa),setPixelWidth:da,setPercentageWidth:ma,setHeight:ga,getPixelWidth:Aa,getPercentageWidth:Sa,getGenericWidth:Na,setGenericWidth:Oa,getHeight:Da,getRawWidth:xa},Pa=function(e,t){ka.getGenericWidth(e).each(function(n){var r=n.width()/2;ka.setGenericWidth(e,r,n.unit()),ka.setGenericWidth(t,r,n.unit())})},Ba={halve:Pa},Ia=function(e,t){var n=t||Ue.fromDom(document.documentElement);return fr.ancestor(e,D($t.eq,n)).isSome()},Wa=function(e){var t=e.dom();return t===t.window&&e instanceof Window?e:kn.isDocument(e)?t.defaultView||t.parentWindow:null},Ma={attached:Ia,windowOf:Wa},La=function(e,t){var n=function(n,r){return La(e+n,t+r)};return{left:E(e),top:E(t),translate:n}},_a=La,Fa=function(e){var t=e.getBoundingClientRect();return _a(t.left,t.top)},qa=function(e,t){return void 0!==e?e:void 0!==t?t:0},Ha=function(e){var t=e.dom().ownerDocument,n=t.body,r=Ma.windowOf(Ue.fromDom(t)),o=t.documentElement,i=qa(r.pageYOffset,o.scrollTop),u=qa(r.pageXOffset,o.scrollLeft),a=qa(o.clientTop,n.clientTop),c=qa(o.clientLeft,n.clientLeft);return za(e).translate(u-c,i-a)},ja=function(e){var t=e.dom();return _a(t.offsetLeft,t.offsetTop)},za=function(e){var t=e.dom(),n=t.ownerDocument,r=n.body,o=Ue.fromDom(n.documentElement);return r===t?_a(r.offsetLeft,r.offsetTop):Ma.attached(e,o)?Fa(t):_a(0,0)},Ua={absolute:Ha,relative:ja,viewport:za},Va=ve("row","y"),Ga=ve("col","x"),Ya=function(e){return Ua.absolute(e).left()+ea.getOuter(e)},Xa=function(e){return Ua.absolute(e).left()},Ka=function(e,t){return Ga(e,Xa(t))},Ja=function(e,t){return Ga(e,Ya(t))},$a=function(e){return Ua.absolute(e).top()},Qa=function(e,t){return Va(e,$a(t))},Za=function(e,t){return Va(e,$a(t)+Xu.getOuter(t))},ec=function(e,t,n){if(0===n.length)return[];var r=$(n.slice(1),function(t,n){return t.map(function(t){return e(n,t)})}),o=n[n.length-1].map(function(e){return t(n.length-1,e)});return r.concat([o])},tc=function(e,t){return-e},nc={delta:A,positions:D(ec,Qa,Za),edge:$a},rc={delta:A,edge:Xa,positions:D(ec,Ka,Ja)},oc={delta:tc,edge:Ya,positions:D(ec,Ja,Ka)},ic={height:nc,rtl:oc,ltr:rc},uc={ltr:ic.ltr,rtl:ic.rtl},ac=function(e){var t=Wr.fromTable(e);return jr.generate(t).grid()},cc={getGridSize:ac},lc=function(e){var t=e,n=function(){return t};return{get:n,set:function(e){t=e},clone:function(){return lc(n())}}},sc=function(e,t){return fc(e,t,{validate:G,label:"function"})},fc=function(e,t,n){if(0===t.length)throw new Error("You must specify at least one required field.");return xe("required",t),Re(t),function(r){var o=me(r);le(t,function(e){return K(o,e)})||we(t,o),e(t,o);var i=ee(t,function(e){return!n.validate(r[e],e)});return i.length>0&&Ce(i,n.label),r}},dc=function(e,t){var n=ee(t,function(t){return!K(e,t)});n.length>0&&ye(n)},mc=function(e){return sc(dc,e)},gc=function(e){var t=jn.has(e,"colspan")?parseInt(jn.get(e,"colspan"),10):1,n=jn.has(e,"rowspan")?parseInt(jn.get(e,"rowspan"),10):1;return{element:E(e),colspan:E(t),rowspan:E(n)}},pc=function(e,t){bc(e);var n=lc(q.none()),r=void 0!==t?t:gc,o=function(t){return e.cell(t)},i=function(e){var t=r(e);return o(t)},u=function(e){var t=i(e);return n.get().isNone()&&n.set(q.some(t)),a=q.some({item:e,replacement:t}),t},a=q.none();return{getOrInit:function(e,t){return a.fold(function(){return u(e)},function(n){return t(e,n.item)?n.replacement:u(e)})},cursor:n.get}},hc=function(e,t){return function(n){var r=lc(q.none());bc(n);var o=[],i=function(e,t){return re(o,function(n){return t(n.item,e)})},u=function(i){var u=n.replace(i,t,{scope:e});return o.push({item:i,sub:u}),r.get().isNone()&&r.set(q.some(u)),u};return{replaceOrInit:function(e,t){return i(e,t).fold(function(){return u(e)},function(n){return t(e,n.item)?n.sub:u(e)})},cursor:r.get}}},vc=function(e){bc(e);var t=lc(q.none());return{combine:function(n){return t.get().isNone()&&t.set(q.some(n)),function(){var t=e.cell({element:E(n),colspan:E(1),rowspan:E(1)});return ao.remove(t,"width"),ao.remove(n,"width"),t}},cursor:t.get}},bc=mc(["cell","row","replace","gap"]),wc={modification:pc,transform:hc,merging:vc},yc=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],xc=function(e,t){var n=e.property().name(t);return K(["ol","ul"],n)},Cc=function(e,t){var n=e.property().name(t);return K(yc,n)},Rc=function(e,t){var n=e.property().name(t);return K(["address","pre","p","h1","h2","h3","h4","h5","h6"],n)},Sc=function(e,t){var n=e.property().name(t);return K(["h1","h2","h3","h4","h5","h6"],n)},Tc=function(e,t){return K(["div","li","td","th","blockquote","body","caption"],e.property().name(t))},Ec=function(e,t){return K(["br","img","hr","input"],e.property().name(t))},Ac=function(e,t){return"iframe"===e.property().name(t)},Dc=function(e,t){return!(Cc(e,t)||Ec(e,t))&&"li"!==e.property().name(t)},Nc={isBlock:Cc,isList:xc,isFormatting:Rc,isHeading:Sc,isContainer:Tc,isEmptyTag:Ec,isFrame:Ac,isInline:Dc},Oc=n(),kc=function(e){return Nc.isBlock(Oc,e)},Pc=function(e){return Nc.isList(Oc,e)},Bc=function(e){return Nc.isFormatting(Oc,e)},Ic=function(e){return Nc.isHeading(Oc,e)},Wc=function(e){return Nc.isContainer(Oc,e)},Mc=function(e){return Nc.isEmptyTag(Oc,e)},Lc=function(e){return Nc.isFrame(Oc,e)},_c=function(e){return Nc.isInline(Oc,e)},Fc={isBlock:kc,isList:Pc,isFormatting:Bc,isHeading:Ic,isContainer:Wc,isEmptyTag:Mc,isFrame:Lc,isInline:_c},qc=function(e){var t=function(e){return"br"===kn.name(e)},n=function(e){return le(e,function(e){return t(e)||kn.isText(e)&&0===zo.get(e).trim().length})},r=function(e){return"li"===kn.name(e)||fr.ancestor(e,Fc.isList).isSome()},o=function(e){return wn.nextSibling(e).map(function(e){return!!Fc.isBlock(e)||(Fc.isEmptyTag(e)?"img"!==kn.name(e):void 0)}).getOr(!1)},i=function(e){return ei.last(e).bind(function(n){var i=o(n);return wn.parent(n).map(function(o){return!0===i||r(o)||t(n)||Fc.isBlock(o)&&!$t.eq(e,o)?[]:[Ue.fromTag("br")]})}).getOr([])},u=function(){var t=ce(e,function(e){var t=wn.children(e);return n(t)?[]:t.concat(i(e))});return 0===t.length?[Ue.fromTag("br")]:t}();So.empty(e[0]),yo.append(e[0],u)},Hc={merge:qc},jc=Object.prototype.hasOwnProperty,zc=function(e,t){return t},Uc=function(e){return function(){for(var t=new Array(arguments.length),n=0;n<t.length;n++)t[n]=arguments[n];if(0===t.length)throw new Error("Can't merge zero objects");for(var r={},o=0;o<t.length;o++){var i=t[o];for(var u in i)jc.call(i,u)&&(r[u]=e(r[u],i[u]))}return r}}(zc),Vc=function(e){for(var t=[],n=function(e){t.push(e)},r=0;r<e.length;r++)e[r].each(n);return t},Gc=function(e,t){for(var n=0;n<e.length;n++){var r=t(e[n],n);if(r.isSome())return r}return q.none()},Yc=function(e,t,n){var r=e.cells(),o=r.slice(0,t),i=r.slice(t),u=o.concat([n]).concat(i);return Kc(e,u)},Xc=function(e,t,n){e.cells()[t]=n},Kc=function(e,t){return _e.rowcells(t,e.section())},Jc=function(e,t){var n=e.cells(),r=$(n,t);return _e.rowcells(r,e.section())},$c=function(e,t){return e.cells()[t]},Qc=function(e,t){return $c(e,t).element()},Zc=function(e){return e.cells().length},el={addCell:Yc,setCells:Kc,mutateCell:Xc,getCell:$c,getCellElement:Qc,mapCells:Jc,cellLength:Zc},tl=function(e,t){return $(e,function(e){return el.getCell(e,t)})},nl=function(e,t){return e[t]},rl=function(e,t){if(0===e.length)return 0;var n=e[0];return oe(e,function(e){return!t(n.element(),e.element())}).fold(function(){return e.length},function(e){return e})},ol=function(e,t,n,r){var o=nl(e,t).cells().slice(n),i=rl(o,r),u=tl(e,n).slice(t),a=rl(u,r);return{colspan:E(i),rowspan:E(a)}},il={subgrid:ol},ul=function(e,t){var n=$(e,function(e,t){return $(e.cells(),function(e,t){return!1})}),r=function(e,t,r,o){for(var i=e;i<e+r;i++)for(var u=t;u<t+o;u++)n[i][u]=!0};return $(e,function(o,i){var u=ce(o.cells(),function(o,u){if(!1===n[i][u]){var a=il.subgrid(e,i,u,t);return r(i,u,a.rowspan(),a.colspan()),[_e.detailnew(o.element(),a.rowspan(),a.colspan(),o.isNew())]}return[]});return _e.rowdetails(u,o.section())})},al=function(e,t,n){for(var r=[],o=0;o<e.grid().rows();o++){for(var i=[],u=0;u<e.grid().columns();u++){var a=jr.getAt(e,o,u).map(function(e){return _e.elementnew(e.element(),n)}).getOrThunk(function(){return _e.elementnew(t.gap(),!0)});i.push(a)}var c=_e.rowcells(i,e.all()[o].section());r.push(c)}return r},cl={toDetails:ul,toGrid:al},ll=function(e,t,n,r){n===r?jn.remove(e,t):jn.set(e,t,n)},sl=function(e,t){var n=[],r=[],o=function(t,o){var i=br.child(e,o).getOrThunk(function(){var t=Ue.fromTag(o,wn.owner(e).dom());return po.append(e,t),t});So.empty(i);var u=$(t,function(e){e.isNew()&&n.push(e.element());var t=e.element();return So.empty(t),Q(e.cells(),function(e){e.isNew()&&r.push(e.element()),ll(e.element(),"colspan",e.colspan(),1),ll(e.element(),"rowspan",e.rowspan(),1),po.append(t,e.element())}),t});yo.append(i,u)},i=function(t){br.child(e,t).each(So.remove)},u=function(e,t){e.length>0?o(e,t):i(t)},a=[],c=[],l=[];return Q(t,function(e){switch(e.section()){case"thead":a.push(e);break;case"tbody":c.push(e);break;case"tfoot":l.push(e)}}),u(a,"thead"),u(c,"tbody"),u(l,"tfoot"),{newRows:E(n),newCells:E(r)}},fl=function(e){return $(e,function(e){var t=_o.shallow(e.element());return Q(e.cells(),function(e){var n=_o.deep(e.element());ll(n,"colspan",e.colspan(),1),ll(n,"rowspan",e.rowspan(),1),po.append(t,n)}),t})},dl={render:sl,copy:fl},ml=function(e,t){for(var n=[],r=0;r<e;r++)n.push(t(r));return n},gl=function(e,t){for(var n=[],r=e;r<t;r++)n.push(r);return n},pl=function(e,t){var n=[];return Q(e,function(r,o){o<e.length-1&&!t(r,e[o+1])?n.push(r):o===e.length-1&&n.push(r)}),n},hl=function(e,t){if(t<0||t>=e.length-1)return q.none();var n=e[t].fold(function(){var n=fe(e.slice(0,t));return Gc(n,function(e,t){return e.map(function(e){return{value:e,delta:t+1}})})},function(e){return q.some({value:e,delta:0})}),r=e[t+1].fold(function(){var n=e.slice(t+1);return Gc(n,function(e,t){return e.map(function(e){return{value:e,delta:t+1}})})},function(e){return q.some({value:e,delta:1})});return n.bind(function(e){return r.map(function(t){var n=t.delta+e.delta;return Math.abs(t.value-e.value)/n})})},vl={repeat:ml,range:gl,unique:pl,deduce:hl},bl=function(e){var t=e.grid(),n=vl.range(0,t.columns()),r=vl.range(0,t.rows());return $(n,function(t){return wl(function(){return ce(r,function(n){return jr.getAt(e,n,t).filter(function(e){return e.column()===t}).fold(E([]),function(e){return[e]})})},function(e){return 1===e.colspan()},function(){return jr.getAt(e,0,t)})})},wl=function(e,t,n){var r=e();return re(r,t).orThunk(function(){return q.from(r[0]).orThunk(n)}).map(function(e){return e.element()})},yl=function(e){var t=e.grid(),n=vl.range(0,t.rows()),r=vl.range(0,t.columns());return $(n,function(t){return wl(function(){
return ce(r,function(n){return jr.getAt(e,t,n).filter(function(e){return e.row()===t}).fold(E([]),function(e){return[e]})})},function(e){return 1===e.rowspan()},function(){return jr.getAt(e,t,0)})})},xl={columns:bl,rows:yl},Cl=function(e,t,n,r,o){var i=Ue.fromTag("div");return ao.setAll(i,{position:"absolute",left:t-r/2+"px",top:n+"px",height:o+"px",width:r+"px"}),jn.setAll(i,{"data-column":e,role:"presentation"}),i},Rl=function(e,t,n,r,o){var i=Ue.fromTag("div");return ao.setAll(i,{position:"absolute",left:t+"px",top:n-o/2+"px",height:o+"px",width:r+"px"}),jn.setAll(i,{"data-row":e,role:"presentation"}),i},Sl={col:Cl,row:Rl},Tl=function(e){var t=e.replace(/\./g,"-");return{resolve:function(e){return t+"-"+e}}},El=Tl("ephox-snooker"),Al={resolve:El.resolve},Dl=function(e,t){var n=jn.get(e,t);return void 0===n||""===n?[]:n.split(" ")},Nl=function(e,t,n){var r=Dl(e,t),o=r.concat([n]);return jn.set(e,t,o.join(" ")),!0},Ol=function(e,t,n){var r=ee(Dl(e,t),function(e){return e!==n});return r.length>0?jn.set(e,t,r.join(" ")):jn.remove(e,t),!1},kl={read:Dl,add:Nl,remove:Ol},Pl=function(e){return void 0!==e.dom().classList},Bl=function(e){return kl.read(e,"class")},Il=function(e,t){return kl.add(e,"class",t)},Wl=function(e,t){return kl.remove(e,"class",t)},Ml=function(e,t){return K(Bl(e),t)?Wl(e,t):Il(e,t)},Ll={get:Bl,add:Il,remove:Wl,toggle:Ml,supports:Pl},_l=function(e,t){Ll.supports(e)?e.dom().classList.add(t):Ll.add(e,t)},Fl=function(e){0===(Ll.supports(e)?e.dom().classList:Ll.get(e)).length&&jn.remove(e,"class")},ql=function(e,t){if(Ll.supports(e)){e.dom().classList.remove(t)}else Ll.remove(e,t);Fl(e)},Hl=function(e,t){return Ll.supports(e)?e.dom().classList.toggle(t):Ll.toggle(e,t)},jl=function(e,t){var n=Ll.supports(e),r=e.dom().classList;return i(function(){n?r.remove(t):Ll.remove(e,t)},function(){n?r.add(t):Ll.add(e,t)},zl(e,t))},zl=function(e,t){return Ll.supports(e)&&e.dom().classList.contains(t)},Ul={add:_l,remove:ql,toggle:Hl,toggler:jl,has:zl},Vl=Al.resolve("resizer-bar"),Gl=Al.resolve("resizer-rows"),Yl=Al.resolve("resizer-cols"),Xl=function(e){var t=or.descendants(e.parent(),"."+Vl);Q(t,So.remove)},Kl=function(e,t,n){var r=e.origin();Q(t,function(t,o){t.each(function(t){var o=n(r,t);Ul.add(o,Vl),po.append(e.parent(),o)})})},Jl=function(e,t,n,r){Kl(e,t,function(e,t){var o=Sl.col(t.col(),t.x()-e.left(),n.top()-e.top(),7,r);return Ul.add(o,Yl),o})},$l=function(e,t,n,r){Kl(e,t,function(e,t){var o=Sl.row(t.row(),n.left()-e.left(),t.y()-e.top(),r,7);return Ul.add(o,Gl),o})},Ql=function(e,t,n,r,o,i){var u=Ua.absolute(t),a=n.length>0?o.positions(n,t):[];$l(e,a,u,ea.getOuter(t));var c=r.length>0?i.positions(r,t):[];Jl(e,c,u,Xu.getOuter(t))},Zl=function(e,t,n,r){Xl(e);var o=Wr.fromTable(t),i=jr.generate(o),u=xl.rows(i),a=xl.columns(i);Ql(e,t,u,a,n,r)},es=function(e,t){var n=or.descendants(e.parent(),"."+Vl);Q(n,t)},ts=function(e){es(e,function(e){ao.set(e,"display","none")})},ns=function(e){es(e,function(e){ao.set(e,"display","block")})},rs=function(e){return Ul.has(e,Gl)},os=function(e){return Ul.has(e,Yl)},is={refresh:Zl,hide:ts,show:ns,destroy:Xl,isRowBar:rs,isColBar:os},us=function(e,t){return cl.toGrid(e,t,!1)},as=function(e,t){var n=function(e){return Gc(e,function(e){return wn.parent(e.element()).map(function(e){var t=wn.parent(e).isNone();return _e.elementnew(e,t)})}).getOrThunk(function(){return _e.elementnew(t.row(),!0)})};return $(e,function(e){var t=n(e.details());return _e.rowdatanew(t.element(),e.details(),e.section(),t.isNew())})},cs=function(e,t){var n=cl.toDetails(e,$t.eq);return as(n,t)},ls=function(e,t){var n=ae($(e.all(),function(e){return e.cells()}));return re(n,function(e){return $t.eq(t,e.element())})},ss=function(e,t,n,r,o){return function(i,u,a,c,l){var s=Wr.fromTable(u),f=jr.generate(s);return t(f,a).map(function(t){var n=us(f,c),r=e(n,t,$t.eq,o(c)),i=cs(r.grid(),c);return{grid:E(i),cursor:r.cursor}}).fold(function(){return q.none()},function(e){var t=dl.render(u,e.grid());return n(u,e.grid(),l),r(u),is.refresh(i,u,ic.height,l),q.some({cursor:e.cursor,newRows:t.newRows,newCells:t.newCells})})}},fs=function(e,t){return Pr.cell(t.element()).bind(function(t){return ls(e,t)})},ds=function(e,t){return Pr.cell(t.element()).bind(function(n){return ls(e,n).map(function(e){return Uc(e,{generators:t.generators,clipboard:t.clipboard})})})},ms=function(e,t){var n=$(t.selection(),function(t){return Pr.cell(t).bind(function(t){return ls(e,t)})}),r=Vc(n);return r.length>0?q.some(Uc({cells:r},{generators:t.generators,clipboard:t.clipboard})):q.none()},gs=function(e,t){return t.mergable()},ps=function(e,t){return t.unmergable()},hs=function(e,t){var n=$(t.selection(),function(t){return Pr.cell(t).bind(function(t){return ls(e,t)})}),r=Vc(n);return r.length>0?q.some(r):q.none()},vs={run:ss,toDetailList:cs,onCell:fs,onCells:hs,onPaste:ds,onPasteRows:ms,onMergable:gs,onUnmergable:ps},bs=function(e){var t=function(t){return e===t},n=function(t){return bs(e)},r=function(t){return bs(e)},o=function(t){return bs(t(e))},i=function(t){t(e)},u=function(t){return t(e)},a=function(t,n){return n(e)},c=function(t){return t(e)},l=function(t){return t(e)},s=function(){return q.some(e)};return{is:t,isValue:B,isError:P,getOr:E(e),getOrThunk:E(e),getOrDie:E(e),or:n,orThunk:r,fold:a,map:o,each:i,bind:u,exists:c,forall:l,toOption:s}},ws=function(e){var t=function(e){return e()},n=function(){return O(String(e))()},r=function(e){return e},o=function(e){return e()},i=function(t){return ws(e)},u=function(t){return ws(e)};return{is:P,isValue:P,isError:B,getOr:A,getOrThunk:t,getOrDie:n,or:r,orThunk:o,fold:function(t,n){return t(e)},map:i,each:S,bind:u,exists:P,forall:B,toOption:q.none}},ys={value:bs,error:ws},xs=function(e,t,n){if(e.row()>=t.length||e.column()>el.cellLength(t[0]))return ys.error("invalid start address out of table bounds, row: "+e.row()+", column: "+e.column());var r=t.slice(e.row()),o=r[0].cells().slice(e.column()),i=el.cellLength(n[0]),u=n.length;return ys.value({rowDelta:E(r.length-u),colDelta:E(o.length-i)})},Cs=function(e,t){var n=el.cellLength(e[0]),r=el.cellLength(t[0]);return{rowDelta:E(0),colDelta:E(n-r)}},Rs=function(e,t){return $(e,function(){return _e.elementnew(t.cell(),!0)})},Ss=function(e,t,n){return e.concat(vl.repeat(t,function(t){return el.setCells(e[e.length-1],Rs(e[e.length-1].cells(),n))}))},Ts=function(e,t,n){return $(e,function(e){return el.setCells(e,e.cells().concat(Rs(vl.range(0,t),n)))})},Es=function(e,t,n){var r=t.colDelta()<0?Ts:A;return(t.rowDelta()<0?Ss:A)(r(e,Math.abs(t.colDelta()),n),Math.abs(t.rowDelta()),n)},As={measure:xs,measureWidth:Cs,tailor:Es},Ds=function(e,t,n,r){if(0===e.length)return e;for(var o=t.startRow();o<=t.finishRow();o++)for(var i=t.startCol();i<=t.finishCol();i++)el.mutateCell(e[o],i,_e.elementnew(r(),!1));return e},Ns=function(e,t,n,r){for(var o=!0,i=0;i<e.length;i++)for(var u=0;u<el.cellLength(e[0]);u++){var a=el.getCellElement(e[i],u),c=n(a,t);!0===c&&!1===o?el.mutateCell(e[i],u,_e.elementnew(r(),!0)):!0===c&&(o=!1)}return e},Os=function(e,t){return ne(e,function(e,n){return J(e,function(e){return t(e.element(),n.element())})?e:e.concat([n])},[])},ks=function(e,t,n,r){if(t>0&&t<e.length){var o=e[t-1].cells(),i=Os(o,n);Q(i,function(o){for(var i=q.none(),u=t;u<e.length;u++)for(var a=0;a<el.cellLength(e[0]);a++){var c=e[u].cells()[a],l=n(c.element(),o.element());l&&(i.isNone()&&(i=q.some(r())),i.each(function(t){el.mutateCell(e[u],a,_e.elementnew(t,!0))}))}})}return e},Ps={merge:Ds,unmerge:Ns,splitRows:ks},Bs=function(e,t,n,r){var o=el.getCell(e[t],n),i=D(r,o.element()),u=e[t];return e.length>1&&el.cellLength(u)>1&&(n>0&&i(el.getCellElement(u,n-1))||n<u.length-1&&i(el.getCellElement(u,n+1))||t>0&&i(el.getCellElement(e[t-1],n))||t<e.length-1&&i(el.getCellElement(e[t+1],n)))},Is=function(e,t,n,r,o){for(var i=e.row(),u=e.column(),a=n.length,c=el.cellLength(n[0]),l=i+a,s=u+c,f=i;f<l;f++)for(var d=u;d<s;d++){Bs(t,f,d,o)&&Ps.unmerge(t,el.getCellElement(t[f],d),o,r.cell);var m=el.getCellElement(n[f-i],d-u),g=r.replace(m);el.mutateCell(t[f],d,_e.elementnew(g,!0))}return t},Ws=function(e,t,n,r,o){return As.measure(e,t,n).map(function(i){var u=As.tailor(t,i,r);return Is(e,u,n,r,o)})},Ms=function(e,t,n,r,o){Ps.splitRows(t,e,o,r.cell);var i=As.measureWidth(n,t),u=As.tailor(n,i,r),a=As.measureWidth(t,u),c=As.tailor(t,a,r);return c.slice(0,e).concat(u).concat(c.slice(e,c.length))},Ls={merge:Ws,insert:Ms},_s=function(e,t,n,r,o){var i=e.slice(0,t),u=e.slice(t),a=el.mapCells(e[n],function(n,i){return t>0&&t<e.length&&r(el.getCellElement(e[t-1],i),el.getCellElement(e[t],i))?el.getCell(e[t],i):_e.elementnew(o(n.element(),r),!0)});return i.concat([a]).concat(u)},Fs=function(e,t,n,r,o){return $(e,function(e){var i=t>0&&t<el.cellLength(e)&&r(el.getCellElement(e,t-1),el.getCellElement(e,t)),u=i?el.getCell(e,t):_e.elementnew(o(el.getCellElement(e,n),r),!0);return el.addCell(e,t,u)})},qs=function(e,t,n,r,o){var i=n+1;return $(e,function(e,u){var a=u===t,c=a?_e.elementnew(o(el.getCellElement(e,n),r),!0):el.getCell(e,n);return el.addCell(e,i,c)})},Hs=function(e,t,n,r,o){var i=t+1,u=e.slice(0,i),a=e.slice(i),c=el.mapCells(e[t],function(e,t){return t===n?_e.elementnew(o(e.element(),r),!0):e});return u.concat([c]).concat(a)},js=function(e,t,n){var r=$(e,function(e){var r=e.cells().slice(0,t).concat(e.cells().slice(n+1));return _e.rowcells(r,e.section())});return ee(r,function(e){return e.cells().length>0})},zs=function(e,t,n){return e.slice(0,t).concat(e.slice(n+1))},Us={insertRowAt:_s,insertColumnAt:Fs,splitCellIntoColumns:qs,splitCellIntoRows:Hs,deleteRowsAt:zs,deleteColumnsAt:js},Vs=function(e,t,n,r){var o=function(e){return J(t,function(t){return n(e.element(),t.element())})};return $(e,function(e){return el.mapCells(e,function(e){return o(e)?_e.elementnew(r(e.element(),n),!0):e})})},Gs=function(e,t,n,r){return void 0!==el.getCellElement(e[t],n)&&t>0&&r(el.getCellElement(e[t-1],n),el.getCellElement(e[t],n))},Ys=function(e,t,n){return t>0&&n(el.getCellElement(e,t-1),el.getCellElement(e,t))},Xs=function(e,t,n,r){var o=ce(e,function(r,o){return Gs(e,o,t,n)||Ys(r,t,n)?[]:[el.getCell(r,t)]});return Vs(e,o,n,r)},Ks=function(e,t,n,r){var o=e[t],i=ce(o.cells(),function(r,i){return Gs(e,t,i,n)||Ys(o,i,n)?[]:[r]});return Vs(e,i,n,r)},Js={replaceColumn:Xs,replaceRow:Ks},$s=function(){return nf(function(e,t,n,r,o){return e()})},Qs=function(e){return nf(function(t,n,r,o,i){return n(e)})},Zs=function(e,t){return nf(function(n,r,o,i,u){return o(e,t)})},ef=function(e,t,n){return nf(function(r,o,i,u,a){return u(e,t,n)})},tf=function(e,t){return nf(function(n,r,o,i,u){return u(e,t)})},nf=function(e){return{fold:e}},rf={none:$s,only:Qs,left:Zs,middle:ef,right:tf},of=function(e,t){return 0===e.length?rf.none():1===e.length?rf.only(0):0===t?rf.left(0,1):t===e.length-1?rf.right(t-1,t):t>0&&t<e.length-1?rf.middle(t-1,t,t+1):rf.none()},uf=function(e,t,n,r){var o=e.slice(0),i=of(e,t),u=function(e){return $(e,E(0))},a=E(u(o)),c=function(e){return r.singleColumnWidth(o[e],n)},l=function(e,t){if(n>=0){var i=Math.max(r.minCellWidth(),o[t]-n);return u(o.slice(0,e)).concat([n,i-o[t]]).concat(u(o.slice(t+1)))}var a=Math.max(r.minCellWidth(),o[e]+n),c=o[e]-a;return u(o.slice(0,e)).concat([a-o[e],c]).concat(u(o.slice(t+1)))},s=l,f=function(e,t,n){return l(t,n)},d=function(e,t){if(n>=0)return u(o.slice(0,t)).concat([n]);var i=Math.max(r.minCellWidth(),o[t]+n);return u(o.slice(0,t)).concat([i-o[t]])};return i.fold(a,c,s,f,d)},af={determine:uf},cf=function(e,t){return jn.has(e,t)&&parseInt(jn.get(e,t),10)>1},lf=function(e){return cf(e,"colspan")},sf=function(e){return cf(e,"rowspan")},ff=function(e,t){return parseInt(ao.get(e,t),10)},df={hasColspan:lf,hasRowspan:sf,minWidth:E(10),minHeight:E(10),getInt:ff},mf=function(e,t,n){return ao.getRaw(e,t).fold(function(){return n(e)+"px"},function(e){return e})},gf=function(e){return mf(e,"width",ka.getPixelWidth)},pf=function(e){return mf(e,"height",ka.getHeight)},hf=function(e,t,n,r,o){var i=xl.columns(e),u=$(i,function(e){return e.map(t.edge)});return $(i,function(e,t){return e.filter(N(df.hasColspan)).fold(function(){var e=vl.deduce(u,t);return r(e)},function(e){return n(e,o)})})},vf=function(e){return e.map(function(e){return e+"px"}).getOr("")},bf=function(e,t){return hf(e,t,gf,vf)},wf=function(e,t,n){return hf(e,t,ka.getPercentageWidth,function(e){return e.fold(function(){return n.minCellWidth()},function(e){return e/n.pixelWidth()*100})},n)},yf=function(e,t,n){return hf(e,t,ka.getPixelWidth,function(e){return e.getOrThunk(n.minCellWidth)},n)},xf=function(e,t,n,r){var o=xl.rows(e),i=$(o,function(e){return e.map(t.edge)});return $(o,function(e,t){return e.filter(N(df.hasRowspan)).fold(function(){var e=vl.deduce(i,t);return r(e)},function(e){return n(e)})})},Cf=function(e,t){return xf(e,t,ka.getHeight,function(e){return e.getOrThunk(df.minHeight)})},Rf=function(e,t){return xf(e,t,pf,vf)},Sf={getRawWidths:bf,getPixelWidths:yf,getPercentageWidths:wf,getPixelHeights:Cf,getRawHeights:Rf},Tf=function(e,t,n){for(var r=0,o=e;o<t;o++)r+=void 0!==n[o]?n[o]:0;return r},Ef=function(e,t){var n=jr.justCells(e);return $(n,function(e){var n=Tf(e.column(),e.column()+e.colspan(),t);return{element:e.element,width:E(n),colspan:e.colspan}})},Af=function(e,t){var n=jr.justCells(e);return $(n,function(e){var n=Tf(e.row(),e.row()+e.rowspan(),t);return{element:e.element,height:E(n),rowspan:e.rowspan}})},Df=function(e,t){return $(e.all(),function(e,n){return{element:e.element,height:E(t[n])}})},Nf={recalculateWidth:Ef,recalculateHeight:Af,matchRowHeight:Df},Of=function(e,t){var n=parseFloat(e),r=ea.get(t),o=function(e){return e/r*100},i=function(e,t){return[100-e]},u=function(){return df.minWidth()/r*100},a=function(e,t,r){var o=n+r;ka.setPercentageWidth(e,o)};return{width:E(n),pixelWidth:E(r),getWidths:Sf.getPercentageWidths,getCellDelta:o,singleColumnWidth:i,minCellWidth:u,setElementWidth:ka.setPercentageWidth,setTableWidth:a}},kf=function(e){var t=parseInt(e,10),n=A,r=function(e,t){return[Math.max(df.minWidth(),e+t)-e]},o=function(e,t,n){var r=te(t,function(e,t){return e+t},0);ka.setPixelWidth(e,r)};return{width:E(t),pixelWidth:E(t),getWidths:Sf.getPixelWidths,getCellDelta:n,singleColumnWidth:r,minCellWidth:df.minWidth,setElementWidth:ka.setPixelWidth,setTableWidth:o}},Pf=function(e,t){if(ka.percentageBasedSizeRegex().test(t)){var n=ka.percentageBasedSizeRegex().exec(t);return Of(n[1],e)}if(ka.pixelBasedSizeRegex().test(t)){var r=ka.pixelBasedSizeRegex().exec(t);return kf(r[1])}var o=ea.get(e);return kf(o)},Bf=function(e){return ka.getRawWidth(e).fold(function(){var t=ea.get(e);return kf(t)},function(t){return Pf(e,t)})},If={getTableSize:Bf},Wf=function(e){return jr.generate(e)},Mf=function(e){return te(e,function(e,t){return e+t},0)},Lf=function(e){var t=Wr.fromTable(e);return Wf(t)},_f=function(e,t,n,r){var o=If.getTableSize(e),i=o.getCellDelta(t),u=Lf(e),a=o.getWidths(u,r,o),c=af.determine(a,n,i,o),l=$(c,function(e,t){return e+a[t]}),s=Nf.recalculateWidth(u,l);Q(s,function(e){o.setElementWidth(e.element(),e.width())}),n===u.grid().columns()-1&&o.setTableWidth(e,l,i)},Ff=function(e,t,n,r){var o=Lf(e),i=Sf.getPixelHeights(o,r),u=$(i,function(e,r){return n===r?Math.max(t+e,df.minHeight()):e}),a=Nf.recalculateHeight(o,u),c=Nf.matchRowHeight(o,u);Q(c,function(e){ka.setHeight(e.element(),e.height())}),Q(a,function(e){ka.setHeight(e.element(),e.height())});var l=Mf(u);ka.setHeight(e,l)},qf=function(e,t,n){var r=If.getTableSize(e),o=Wf(t),i=r.getWidths(o,n,r),u=Nf.recalculateWidth(o,i);Q(u,function(e){r.setElementWidth(e.element(),e.width())});var a=te(i,function(e,t){return t+e},0);u.length>0&&r.setElementWidth(e,a)},Hf={adjustWidth:_f,adjustHeight:Ff,adjustWidthTo:qf},jf=function(e){0===Pr.cells(e).length&&So.remove(e)},zf=ve("grid","cursor"),Uf=function(e,t,n){return Vf(e,t,n).orThunk(function(){return Vf(e,0,0)})},Vf=function(e,t,n){return q.from(e[t]).bind(function(e){return q.from(e.cells()[n]).bind(function(e){return q.from(e.element())})})},Gf=function(e,t,n){return zf(e,Vf(e,t,n))},Yf=function(e){return ne(e,function(e,t){return J(e,function(e){return e.row()===t.row()})?e:e.concat([t])},[]).sort(function(e,t){return e.row()-t.row()})},Xf=function(e){return ne(e,function(e,t){return J(e,function(e){return e.column()===t.column()})?e:e.concat([t])},[]).sort(function(e,t){return e.column()-t.column()})},Kf=function(e,t,n,r){var o=t.row(),i=t.row(),u=Us.insertRowAt(e,i,o,n,r.getOrInit);return Gf(u,i,t.column())},Jf=function(e,t,n,r){var o=t[0].row(),i=t[0].row(),u=Yf(t),a=ne(u,function(e,t){return Us.insertRowAt(e,i,o,n,r.getOrInit)},e);return Gf(a,i,t[0].column())},$f=function(e,t,n,r){var o=t.row(),i=t.row()+t.rowspan(),u=Us.insertRowAt(e,i,o,n,r.getOrInit);return Gf(u,i,t.column())},Qf=function(e,t,n,r){var o=Yf(t),i=o[o.length-1].row(),u=o[o.length-1].row()+o[o.length-1].rowspan(),a=ne(o,function(e,t){return Us.insertRowAt(e,u,i,n,r.getOrInit)},e);return Gf(a,u,t[0].column())},Zf=function(e,t,n,r){var o=t.column(),i=t.column(),u=Us.insertColumnAt(e,i,o,n,r.getOrInit);return Gf(u,t.row(),i)},ed=function(e,t,n,r){var o=Xf(t),i=o[0].column(),u=o[0].column(),a=ne(o,function(e,t){return Us.insertColumnAt(e,u,i,n,r.getOrInit)},e);return Gf(a,t[0].row(),u)},td=function(e,t,n,r){var o=t.column(),i=t.column()+t.colspan(),u=Us.insertColumnAt(e,i,o,n,r.getOrInit);return Gf(u,t.row(),i)},nd=function(e,t,n,r){var o=t[t.length-1].column(),i=t[t.length-1].column()+t[t.length-1].colspan(),u=Xf(t),a=ne(u,function(e,t){return Us.insertColumnAt(e,i,o,n,r.getOrInit)},e);return Gf(a,t[0].row(),i)},rd=function(e,t,n,r){var o=Js.replaceRow(e,t.row(),n,r.replaceOrInit);return Gf(o,t.row(),t.column())},od=function(e,t,n,r){var o=Js.replaceColumn(e,t.column(),n,r.replaceOrInit);return Gf(o,t.row(),t.column())},id=function(e,t,n,r){var o=Js.replaceRow(e,t.row(),n,r.replaceOrInit);return Gf(o,t.row(),t.column())},ud=function(e,t,n,r){var o=Js.replaceColumn(e,t.column(),n,r.replaceOrInit);return Gf(o,t.row(),t.column())},ad=function(e,t,n,r){var o=Us.splitCellIntoColumns(e,t.row(),t.column(),n,r.getOrInit);return Gf(o,t.row(),t.column())},cd=function(e,t,n,r){var o=Us.splitCellIntoRows(e,t.row(),t.column(),n,r.getOrInit);return Gf(o,t.row(),t.column())},ld=function(e,t,n,r){var o=Xf(t),i=Us.deleteColumnsAt(e,o[0].column(),o[o.length-1].column()),u=Uf(i,t[0].row(),t[0].column());return zf(i,u)},sd=function(e,t,n,r){var o=Yf(t),i=Us.deleteRowsAt(e,o[0].row(),o[o.length-1].row()),u=Uf(i,t[0].row(),t[0].column());return zf(i,u)},fd=function(e,t,n,r){var o=t.cells();Hc.merge(o);var i=Ps.merge(e,t.bounds(),n,E(o[0]));return zf(i,q.from(o[0]))},dd=function(e,t,n,r){var o=te(t,function(e,t){return Ps.unmerge(e,t,n,r.combine(t))},e);return zf(o,q.from(t[0]))},md=function(e,t,n,r){var o=function(e,t){var n=Wr.fromTable(e),r=jr.generate(n);return cl.toGrid(r,t,!0)}(t.clipboard(),t.generators()),i=_e.address(t.row(),t.column());return Ls.merge(i,e,o,t.generators(),n).fold(function(){return zf(e,q.some(t.element()))},function(e){var n=Uf(e,t.row(),t.column());return zf(e,n)})},gd=function(e,t,n){var r=Wr.fromPastedRows(e,n),o=jr.generate(r);return cl.toGrid(o,t,!0)},pd=function(e,t,n,r){var o=e[t.cells[0].row()],i=t.cells[0].row(),u=gd(t.clipboard(),t.generators(),o),a=Ls.insert(i,e,u,t.generators(),n),c=Uf(a,t.cells[0].row(),t.cells[0].column());return zf(a,c)},hd=function(e,t,n,r){var o=e[t.cells[0].row()],i=t.cells[t.cells.length-1].row()+t.cells[t.cells.length-1].rowspan(),u=gd(t.clipboard(),t.generators(),o),a=Ls.insert(i,e,u,t.generators(),n),c=Uf(a,t.cells[0].row(),t.cells[0].column());return zf(a,c)},vd=Hf.adjustWidthTo,bd={insertRowBefore:vs.run(Kf,vs.onCell,S,S,wc.modification),insertRowsBefore:vs.run(Jf,vs.onCells,S,S,wc.modification),insertRowAfter:vs.run($f,vs.onCell,S,S,wc.modification),insertRowsAfter:vs.run(Qf,vs.onCells,S,S,wc.modification),insertColumnBefore:vs.run(Zf,vs.onCell,vd,S,wc.modification),insertColumnsBefore:vs.run(ed,vs.onCells,vd,S,wc.modification),insertColumnAfter:vs.run(td,vs.onCell,vd,S,wc.modification),insertColumnsAfter:vs.run(nd,vs.onCells,vd,S,wc.modification),splitCellIntoColumns:vs.run(ad,vs.onCell,vd,S,wc.modification),splitCellIntoRows:vs.run(cd,vs.onCell,S,S,wc.modification),eraseColumns:vs.run(ld,vs.onCells,vd,jf,wc.modification),eraseRows:vs.run(sd,vs.onCells,S,jf,wc.modification),makeColumnHeader:vs.run(od,vs.onCell,S,S,wc.transform("row","th")),unmakeColumnHeader:vs.run(ud,vs.onCell,S,S,wc.transform(null,"td")),makeRowHeader:vs.run(rd,vs.onCell,S,S,wc.transform("col","th")),unmakeRowHeader:vs.run(id,vs.onCell,S,S,wc.transform(null,"td")),mergeCells:vs.run(fd,vs.onMergable,S,S,wc.merging),unmergeCells:vs.run(dd,vs.onUnmergable,vd,S,wc.merging),pasteCells:vs.run(md,vs.onPaste,vd,S,wc.modification),pasteRowsBefore:vs.run(pd,vs.onPasteRows,S,S,wc.modification),pasteRowsAfter:vs.run(hd,vs.onPasteRows,S,S,wc.modification)},wd=function(e){return Ue.fromDom(e.getBody())},yd=function(e){return e.getBoundingClientRect().width},xd=function(e){return e.getBoundingClientRect().height},Cd=function(e){return function(t){return $t.eq(t,wd(e))}},Rd=function(e){return e?e.replace(/px$/,""):""},Sd=function(e){return/^[0-9]+$/.test(e)&&(e+="px"),e},Td=function(e){var t=or.descendants(e,"td[data-mce-style],th[data-mce-style]");jn.remove(e,"data-mce-style"),Q(t,function(e){jn.remove(e,"data-mce-style")})},Ed=function(e,t){return function(n){return"rtl"===Ad(n)?t:e}},Ad=function(e){return"rtl"===ao.get(e,"direction")?"rtl":"ltr"},Dd={onDirection:Ed,getDirection:Ad},Nd={isRtl:E(!1)},Od={isRtl:E(!0)},kd=function(e){return"rtl"===Dd.getDirection(e)?Od:Nd},Pd={directionAt:kd},Bd=["tableprops","tabledelete","|","tableinsertrowbefore","tableinsertrowafter","tabledeleterow","|","tableinsertcolbefore","tableinsertcolafter","tabledeletecol"],Id={"border-collapse":"collapse",width:"100%"},Wd={border:"1"},Md=function(e){return e.getParam("table_default_attributes",Wd,"object")},Ld=function(e){return e.getParam("table_default_styles",Id,"object")},_d=function(e){return e.getParam("table_resize_bars",!0,"boolean")},Fd=function(e){return e.getParam("table_tab_navigation",!0,"boolean")},qd=function(e){return e.getParam("table_cell_advtab",!0,"boolean")},Hd=function(e){return e.getParam("table_row_advtab",!0,"boolean")},jd=function(e){return e.getParam("table_advtab",!0,"boolean")},zd=function(e){return e.getParam("table_appearance_options",!0,"boolean")},Ud=function(e){return e.getParam("table_grid",!0,"boolean")},Vd=function(e){return e.getParam("table_style_by_css",!1,"boolean")},Gd=function(e){return e.getParam("table_cell_class_list",[],"array")},Yd=function(e){return e.getParam("table_row_class_list",[],"array")},Xd=function(e){return e.getParam("table_class_list",[],"array")},Kd=function(e){return e.getParam("color_picker_callback")},Jd=function(e){return!1===e.getParam("table_responsive_width")},$d=function(e){var t=e.getParam("table_clone_elements");return z(t)?q.some(t.split(/[ ,]/)):Array.isArray(t)?q.some(t):q.none()},Qd=function(e){var t=e.getParam("object_resizing",!0);return"table"===t||t},Zd=function(e){var t=e.getParam("table_toolbar",Bd);return""===t||!1===t?[]:z(t)?t.split(/[ ,]/):U(t)?t:[]},em=function(e,t){return e.fire("newrow",{node:t})},tm=function(e,t){return e.fire("newcell",{node:t})},nm=function(e,t,n,r){e.fire("ObjectResizeStart",{target:t,width:n,height:r})},rm=function(e,t,n,r){e.fire("ObjectResized",{target:t,width:n,height:r})},om=function(e,t){var n=function(e){return"table"===kn.name(wd(e))},r=function(t){var r=cc.getGridSize(t);return!1===n(e)||r.rows()>1},i=function(t){var r=cc.getGridSize(t);return!1===n(e)||r.columns()>1},u=$d(e),a=function(t,n,r,i){return function(a,c){Td(a);var l=i(),s=Ue.fromDom(e.getDoc()),f=o(Pd.directionAt),d=ci.cellOperations(r,s,u);return n(a)?t(l,a,c,d,f).bind(function(t){return Q(t.newRows(),function(t){em(e,t.dom())}),Q(t.newCells(),function(t){tm(e,t.dom())}),t.cursor().map(function(t){var n=e.dom.createRng();return n.setStart(t.dom(),0),n.setEnd(t.dom(),0),n})}):q.none()}};return{deleteRow:a(bd.eraseRows,r,S,t),deleteColumn:a(bd.eraseColumns,i,S,t),insertRowsBefore:a(bd.insertRowsBefore,B,S,t),insertRowsAfter:a(bd.insertRowsAfter,B,S,t),insertColumnsBefore:a(bd.insertColumnsBefore,B,Ba.halve,t),insertColumnsAfter:a(bd.insertColumnsAfter,B,Ba.halve,t),mergeCells:a(bd.mergeCells,B,S,t),unmergeCells:a(bd.unmergeCells,B,S,t),pasteRowsBefore:a(bd.pasteRowsBefore,B,S,t),pasteRowsAfter:a(bd.pasteRowsAfter,B,S,t),pasteCells:a(bd.pasteCells,B,S,t)}},im=function(e,t,n){var r=Wr.fromTable(e),o=jr.generate(r);return vs.onCells(o,t).map(function(e){var t=cl.toGrid(o,n,!1),r=t.slice(e[0].row(),e[e.length-1].row()+e[e.length-1].rowspan()),i=vs.toDetailList(r,n);return dl.copy(i)})},um={copyRows:im},am=tinymce.util.Tools.resolve("tinymce.util.Tools"),cm=function(e,t,n){var r,o=e.select("td,th",t);return r=function(t,r){for(var o=0;o<r.length;o++){var i=e.getStyle(r[o],n);if(void 0===t&&(t=i),t!==i)return""}return t}(r,o)},lm=function(e,t,n){n&&e.formatter.apply("align"+n,{},t)},sm=function(e,t,n){n&&e.formatter.apply("valign"+n,{},t)},fm=function(e,t){am.each("left center right".split(" "),function(n){e.formatter.remove("align"+n,{},t)})},dm=function(e,t){am.each("top middle bottom".split(" "),function(n){e.formatter.remove("valign"+n,{},t)})},mm={applyAlign:lm,applyVAlign:sm,unApplyAlign:fm,unApplyVAlign:dm,getTDTHOverallStyle:cm},gm=function(e,t,n){var r=function(e,n){return n=n||[],am.each(e,function(e){var o={text:e.text||e.title};e.menu?o.menu=r(e.menu):(o.value=e.value,t&&t(o)),n.push(o)}),n};return r(e,n||[])},pm=function(e,t){u(t)?vm(e,t):hm(e,t)},hm=function(e,t){var n=e.dom,r=t.control.rootControl,o=r.toJSON(),i=n.parseStyle(o.style);i["border-style"]=o.borderStyle,i["border-color"]=o.borderColor,i["background-color"]=o.backgroundColor,i.width=o.width?Sd(o.width):"",i.height=o.height?Sd(o.height):"",r.find("#style").value(n.serializeStyle(n.parseStyle(n.serializeStyle(i))))},vm=function(e,t){var n=e.dom,r=t.control.rootControl,o=r.toJSON(),i=n.parseStyle(o.style);r.find("#borderStyle").value(i["border-style"]||""),r.find("#borderColor").value(i["border-color"]||""),r.find("#backgroundColor").value(i["background-color"]||""),r.find("#width").value(i.width||""),r.find("#height").value(i.height||"")},bm=function(e,t){var n=e.parseStyle(e.getAttrib(t,"style")),r={};return n["border-style"]&&(r.borderStyle=n["border-style"]),n["border-color"]&&(r.borderColor=n["border-color"]),n["background-color"]&&(r.backgroundColor=n["background-color"]),r.style=e.serializeStyle(n),r},wm=function(e){var t=function(){var t=Kd(e);if(t)return function(n){return t.call(e,function(e){n.control.value(e).fire("change")},n.control.value())}};return{title:"Advanced",type:"form",defaults:{onchange:D(hm,e)},items:[{label:"Style",name:"style",type:"textbox",onchange:D(vm,e)},{type:"form",padding:0,formItemDefaults:{layout:"grid",alignH:["start","right"]},defaults:{size:7},items:[{label:"Border style",type:"listbox",name:"borderStyle",width:90,onselect:D(hm,e),values:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{label:"Border color",type:"colorbox",name:"borderColor",onaction:t()},{label:"Background color",type:"colorbox",name:"backgroundColor",onaction:t()}]}]}},ym={createStyleForm:wm,buildListItems:gm,updateStyleField:hm,extractAdvancedStyles:bm,updateAdvancedFields:vm,syncAdvancedStyleFields:pm},xm=function(e,t){delete e.dataset.mceStyle,e.style.cssText+=";"+t},Cm=function(e,t){var n=e.dom,r={width:n.getStyle(t,"width")||n.getAttrib(t,"width"),height:n.getStyle(t,"height")||n.getAttrib(t,"height"),scope:n.getAttrib(t,"scope"),class:n.getAttrib(t,"class"),type:t.nodeName.toLowerCase(),style:"",align:"",valign:""};return am.each("left center right".split(" "),function(n){e.formatter.matchNode(t,"align"+n)&&(r.align=n)}),am.each("top middle bottom".split(" "),function(n){e.formatter.matchNode(t,"valign"+n)&&(r.valign=n)}),qd(e)&&am.extend(r,ym.extractAdvancedStyles(n,t)),r},Rm=function(e,t,n){function r(e,n,r){(1===t.length||r)&&u.setAttrib(e,n,r)}function o(e,n,r){(1===t.length||r)&&u.setStyle(e,n,r)}var i,u=e.dom;qd(e)&&ym.syncAdvancedStyleFields(e,n),i=n.control.rootControl.toJSON(),e.undoManager.transact(function(){am.each(t,function(n){r(n,"scope",i.scope),1===t.length?r(n,"style",i.style):xm(n,i.style),r(n,"class",i.class),o(n,"width",Sd(i.width)),o(n,"height",Sd(i.height)),i.type&&n.nodeName.toLowerCase()!==i.type&&(n=u.rename(n,i.type)),1===t.length&&(mm.unApplyAlign(e,n),mm.unApplyVAlign(e,n)),i.align&&mm.applyAlign(e,n,i.align),i.valign&&mm.applyVAlign(e,n,i.valign)}),e.focus()})},Sm=function(e){var t,n,r,o=[];if(o=e.dom.select("td[data-mce-selected],th[data-mce-selected]"),t=e.dom.getParent(e.selection.getStart(),"td,th"),!o.length&&t&&o.push(t),t=t||o[0]){n=o.length>1?{width:"",height:"",scope:"",class:"",align:"",valign:"",style:"",type:t.nodeName.toLowerCase()}:Cm(e,t),Gd(e).length>0&&(r={name:"class",type:"listbox",label:"Class",values:ym.buildListItems(Gd(e),function(t){t.value&&(t.textStyle=function(){return e.formatter.getCssText({block:"td",classes:[t.value]})})})});var i={type:"form",layout:"flex",direction:"column",labelGapCalc:"children",padding:0,items:[{type:"form",layout:"grid",columns:2,labelGapCalc:!1,padding:0,defaults:{type:"textbox",maxWidth:50},items:[{label:"Width",name:"width",onchange:D(ym.updateStyleField,e)},{label:"Height",name:"height",onchange:D(ym.updateStyleField,e)},{label:"Cell type",name:"type",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{label:"Scope",name:"scope",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{label:"H Align",name:"align",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"V Align",name:"valign",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}]},r]};qd(e)?e.windowManager.open({title:"Cell properties",bodyType:"tabpanel",data:n,body:[{title:"General",type:"form",items:i},ym.createStyleForm(e)],onsubmit:D(Rm,e,o)}):e.windowManager.open({title:"Cell properties",data:n,body:i,onsubmit:D(Rm,e,o)})}},Tm={open:Sm},Em=function(e,t){var n=e.dom,r={height:n.getStyle(t,"height")||n.getAttrib(t,"height"),scope:n.getAttrib(t,"scope"),class:n.getAttrib(t,"class"),align:"",style:"",type:t.parentNode.nodeName.toLowerCase()};return am.each("left center right".split(" "),function(n){e.formatter.matchNode(t,"align"+n)&&(r.align=n)}),Hd(e)&&am.extend(r,ym.extractAdvancedStyles(n,t)),r},Am=function(e,t,n){var r=e.getParent(t,"table"),o=t.parentNode,i=e.select(n,r)[0];i||(i=e.create(n),r.firstChild?"CAPTION"===r.firstChild.nodeName?e.insertAfter(i,r.firstChild):r.insertBefore(i,r.firstChild):r.appendChild(i)),i.appendChild(t),o.hasChildNodes()||e.remove(o)},Dm=function(e){var t,n,r,o,i,u,c=e.dom,l=[];t=c.getParent(e.selection.getStart(),"table"),n=c.getParent(e.selection.getStart(),"td,th"),am.each(t.rows,function(e){am.each(e.cells,function(t){if(c.getAttrib(t,"data-mce-selected")||t===n)return l.push(e),!1})}),(r=l[0])&&(i=l.length>1?{height:"",scope:"",style:"",class:"",align:"",type:r.parentNode.nodeName.toLowerCase()}:Em(e,r),Yd(e).length>0&&(o={name:"class",type:"listbox",label:"Class",values:ym.buildListItems(Yd(e),function(t){t.value&&(t.textStyle=function(){return e.formatter.getCssText({block:"tr",classes:[t.value]})})})}),u={type:"form",
columns:2,padding:0,defaults:{type:"textbox"},items:[{type:"listbox",name:"type",label:"Row type",text:"Header",maxWidth:null,values:[{text:"Header",value:"thead"},{text:"Body",value:"tbody"},{text:"Footer",value:"tfoot"}]},{type:"listbox",name:"align",label:"Alignment",text:"None",maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height"},o]},Hd(e)?e.windowManager.open({title:"Row properties",data:i,bodyType:"tabpanel",body:[{title:"General",type:"form",items:u},ym.createStyleForm(e)],onsubmit:D(a,e,l,i)}):e.windowManager.open({title:"Row properties",data:i,body:u,onsubmit:D(a,e,l,i)}))},Nm={open:Dm},Om=tinymce.util.Tools.resolve("tinymce.Env"),km={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},percentages:!0},Pm=function(){return Ue.fromTag("table")},Bm=function(){return Ue.fromTag("tbody")},Im=function(){return Ue.fromTag("tr")},Wm=function(){return Ue.fromTag("th")},Mm=function(){return Ue.fromTag("td")},Lm=function(e,t,n,r,o){void 0===o&&(o=km);var i=Pm();ao.setAll(i,o.styles),jn.setAll(i,o.attributes);var u=Bm();po.append(i,u);for(var a=[],c=0;c<e;c++){for(var l=Im(),s=0;s<t;s++){var f=c<n||s<r?Wm():Mm();s<r&&jn.set(f,"scope","row"),c<n&&jn.set(f,"scope","col"),po.append(f,Ue.fromTag("br")),o.percentages&&ao.set(f,"width",100/t+"%"),po.append(l,f)}a.push(l)}return yo.append(u,a),i},_m=function(e){return e.dom().innerHTML},Fm=function(e,t){var n=wn.owner(e),r=n.dom(),o=Ue.fromDom(r.createDocumentFragment()),i=mi.fromHtml(t,r);yo.append(o,i),So.empty(e),po.append(e,o)},qm=function(e){var t=Ue.fromTag("div"),n=Ue.fromDom(e.dom().cloneNode(!0));return po.append(t,n),_m(t)},Hm={get:_m,set:Fm,getOuter:qm},jm=function(e,t){e.selection.select(t.dom(),!0),e.selection.collapse(!0)},zm=function(e,t){br.descendant(t,"td,th").each(D(jm,e))},Um=function(e,t){Q(or.descendants(t,"tr"),function(t){em(e,t.dom()),Q(or.descendants(t,"th,td"),function(t){tm(e,t.dom())})})},Vm=function(e){return z(e)&&-1!==e.indexOf("%")},Gm=function(e,t,n){var r=Ld(e),o={styles:r,attributes:Md(e),percentages:Vm(r.width)&&!Jd(e)},i=Lm(n,t,0,0,o);jn.set(i,"data-mce-id","__mce");var u=Hm.getOuter(i);return e.insertContent(u),br.descendant(wd(e),'table[data-mce-id="__mce"]').map(function(t){return Jd(e)&&ao.set(t,"width",ao.get(t,"width")),jn.remove(t,"data-mce-id"),Um(e,t),zm(e,t),t.dom()}).getOr(null)},Ym={insert:Gm},Xm=function(e,t){var n=e.dom,r={width:n.getStyle(t,"width")||n.getAttrib(t,"width"),height:n.getStyle(t,"height")||n.getAttrib(t,"height"),cellspacing:n.getStyle(t,"border-spacing")||n.getAttrib(t,"cellspacing"),cellpadding:n.getAttrib(t,"data-mce-cell-padding")||n.getAttrib(t,"cellpadding")||mm.getTDTHOverallStyle(e.dom,t,"padding"),border:n.getAttrib(t,"data-mce-border")||n.getAttrib(t,"border")||mm.getTDTHOverallStyle(e.dom,t,"border"),borderColor:n.getAttrib(t,"data-mce-border-color"),caption:!!n.select("caption",t)[0],class:n.getAttrib(t,"class")};return am.each("left center right".split(" "),function(n){e.formatter.matchNode(t,"align"+n)&&(r.align=n)}),jd(e)&&am.extend(r,ym.extractAdvancedStyles(n,t)),r},Km=function(e,t,n){var r=e.dom,o={},i={};if(o.class=n.class,i.height=Sd(n.height),r.getAttrib(t,"width")&&!Vd(e)?o.width=Rd(n.width):i.width=Sd(n.width),Vd(e)?(i["border-width"]=Sd(n.border),i["border-spacing"]=Sd(n.cellspacing),am.extend(o,{"data-mce-border-color":n.borderColor,"data-mce-cell-padding":n.cellpadding,"data-mce-border":n.border})):am.extend(o,{border:n.border,cellpadding:n.cellpadding,cellspacing:n.cellspacing}),Vd(e)&&t.children)for(var u=0;u<t.children.length;u++)c(r,t.children[u],{"border-width":Sd(n.border),"border-color":n.borderColor,padding:Sd(n.cellpadding)});n.style?am.extend(i,r.parseStyle(n.style)):i=am.extend({},r.parseStyle(r.getAttrib(t,"style")),i),o.style=r.serializeStyle(i),r.setAttribs(t,o)},Jm=function(e,t,n){var r,o,i=e.dom;jd(e)&&ym.syncAdvancedStyleFields(e,n),o=n.control.rootControl.toJSON(),!1===o.class&&delete o.class,e.undoManager.transact(function(){t||(t=Ym.insert(e,o.cols||1,o.rows||1)),Km(e,t,o),r=i.select("caption",t)[0],r&&!o.caption&&i.remove(r),!r&&o.caption&&(r=i.create("caption"),r.innerHTML=Om.ie?" ":'<br data-mce-bogus="1"/>',t.insertBefore(r,t.firstChild)),mm.unApplyAlign(e,t),o.align&&mm.applyAlign(e,t,o.align),e.focus(),e.addVisual()})},$m=function(e,t){var n,r,o,i,u,a=e.dom,c={};!0===t?(n=a.getParent(e.selection.getStart(),"table"))&&(c=Xm(e,n)):(r={label:"Cols",name:"cols"},o={label:"Rows",name:"rows"}),Xd(e).length>0&&(c.class&&(c.class=c.class.replace(/\s*mce\-item\-table\s*/g,"")),i={name:"class",type:"listbox",label:"Class",values:ym.buildListItems(Xd(e),function(t){t.value&&(t.textStyle=function(){return e.formatter.getCssText({block:"table",classes:[t.value]})})})}),u={type:"form",layout:"flex",direction:"column",labelGapCalc:"children",padding:0,items:[{type:"form",labelGapCalc:!1,padding:0,layout:"grid",columns:2,defaults:{type:"textbox",maxWidth:50},items:zd(e)?[r,o,{label:"Width",name:"width",onchange:D(ym.updateStyleField,e)},{label:"Height",name:"height",onchange:D(ym.updateStyleField,e)},{label:"Cell spacing",name:"cellspacing"},{label:"Cell padding",name:"cellpadding"},{label:"Border",name:"border"},{label:"Caption",name:"caption",type:"checkbox"}]:[r,o,{label:"Width",name:"width",onchange:D(ym.updateStyleField,e)},{label:"Height",name:"height",onchange:D(ym.updateStyleField,e)}]},{label:"Alignment",name:"align",type:"listbox",text:"None",values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},i]},jd(e)?e.windowManager.open({title:"Table properties",data:c,bodyType:"tabpanel",body:[{title:"General",type:"form",items:u},ym.createStyleForm(e)],onsubmit:D(Jm,e,n)}):e.windowManager.open({title:"Table properties",data:c,body:u,onsubmit:D(Jm,e,n)})},Qm={open:$m},Zm=am.each,eg=function(e,t,n,r,o){var i=Cd(e),u=function(){var t=Ue.fromDom(e.dom.getParent(e.selection.getStart(),"th,td"));Pr.table(t,i).filter(N(i)).each(function(t){var n=Ue.fromText("");po.after(t,n),So.remove(t);var r=e.dom.createRng();r.setStart(n.dom(),0),r.setEnd(n.dom(),0),e.selection.setRng(r)})},a=function(){return Ue.fromDom(e.dom.getParent(e.selection.getStart(),"th,td"))},c=function(e){return Pr.table(e,i)},l=function(e){return{width:yd(e.dom()),height:yd(e.dom())}},s=function(e,t,n){var r=l(n);t.width===r.width&&t.height===r.height||(nm(e,n.dom(),t.width,t.height),rm(e,n.dom(),r.width,r.height))},f=function(t){var o=a();c(o).each(function(i){var u=_u.forMenu(r,i,o),a=l(i);t(i,u).each(function(t){s(e,a,i),e.selection.setRng(t),e.focus(),n.clear(i),Td(i)})})},d=function(t){var n=a();return c(n).bind(function(t){var o=Ue.fromDom(e.getDoc()),i=_u.forMenu(r,t,n),u=ci.cellOperations(S,o,q.none());return um.copyRows(t,i,u)})},m=function(t){o.get().each(function(o){var i=$(o,function(e){return _o.deep(e)}),u=a();c(u).bind(function(o){var a=Ue.fromDom(e.getDoc()),c=ci.paste(a),l=_u.pasteRows(r,o,u,i,c);t(o,l).each(function(t){e.selection.setRng(t),e.focus(),n.clear(o)})})})};Zm({mceTableSplitCells:function(){f(t.unmergeCells)},mceTableMergeCells:function(){f(t.mergeCells)},mceTableInsertRowBefore:function(){f(t.insertRowsBefore)},mceTableInsertRowAfter:function(){f(t.insertRowsAfter)},mceTableInsertColBefore:function(){f(t.insertColumnsBefore)},mceTableInsertColAfter:function(){f(t.insertColumnsAfter)},mceTableDeleteCol:function(){f(t.deleteColumn)},mceTableDeleteRow:function(){f(t.deleteRow)},mceTableCutRow:function(e){o.set(d()),f(t.deleteRow)},mceTableCopyRow:function(e){o.set(d())},mceTablePasteRowBefore:function(e){m(t.pasteRowsBefore)},mceTablePasteRowAfter:function(e){m(t.pasteRowsAfter)},mceTableDelete:u},function(t,n){e.addCommand(n,t)}),Zm({mceInsertTable:D(Qm.open,e),mceTableProps:D(Qm.open,e,!0),mceTableRowProps:D(Nm.open,e),mceTableCellProps:D(Tm.open,e)},function(t,n){e.addCommand(n,function(e,n){t(n)})})},tg={registerCommands:eg},ng=function(e){var t=q.from(e.dom().documentElement).map(Ue.fromDom).getOr(e);return{parent:E(t),view:E(e),origin:E(_a(0,0))}},rg=function(e,t){var n=D(Ua.absolute,t);return{parent:E(t),view:E(e),origin:n}},og=function(e,t){return{parent:E(t),view:E(e),origin:E(_a(0,0))}},ig={only:ng,detached:rg,body:og},ug=function(e){return{registry:pe(e,function(e){return{bind:e.bind,unbind:e.unbind}}),trigger:pe(e,function(e){return e.trigger})}},ag={create:ug},cg=mc(["compare","extract","mutate","sink"]),lg=mc(["element","start","stop","destroy"]),sg=mc(["forceDrop","drop","move","delayDrop"]),fg={mode:cg,sink:lg,api:sg},dg=Tl("ephox-dragster"),mg={resolve:dg.resolve},gg=function(e,t,n,r,o,i,u){return{target:E(e),x:E(t),y:E(n),stop:r,prevent:o,kill:i,raw:E(u)}},pg=function(e,t){return function(n){if(e(n)){var r=Ue.fromDom(n.target),o=function(){n.stopPropagation()},i=function(){n.preventDefault()},u=T(i,o),a=gg(r,n.clientX,n.clientY,o,i,u,n);t(a)}}},hg=function(e,t,n,r,o){var i=pg(n,r);return e.dom().addEventListener(t,i,o),{unbind:D(wg,e,t,i,o)}},vg=function(e,t,n,r){return hg(e,t,n,r,!1)},bg=function(e,t,n,r){return hg(e,t,n,r,!0)},wg=function(e,t,n,r){e.dom().removeEventListener(t,n,r)},yg={bind:vg,capture:bg},xg=E(!0),Cg=function(e,t,n){return yg.bind(e,t,xg,n)},Rg=function(e,t,n){return yg.capture(e,t,xg,n)},Sg={bind:Cg,capture:Rg},Tg=function(e,t){return _a(t.left()-e.left(),t.top()-e.top())},Eg=function(e){return q.some(_a(e.x(),e.y()))},Ag=function(e,t){e.mutate(t.left(),t.top())},Dg=function(e,t){var n=s(t),r=Sg.bind(n.element(),"mousedown",e.forceDrop),o=Sg.bind(n.element(),"mouseup",e.drop),i=Sg.bind(n.element(),"mousemove",e.move),u=Sg.bind(n.element(),"mouseout",e.delayDrop),a=function(){n.destroy(),o.unbind(),i.unbind(),u.unbind(),r.unbind()},c=function(e){po.append(e,n.element())},l=function(){So.remove(n.element())};return fg.sink({element:n.element,start:c,stop:l,destroy:a})},Ng=fg.mode({compare:Tg,extract:Eg,sink:Dg,mutate:Ag}),Og=function(e,t){var n=null;return{cancel:function(){null!==n&&(clearTimeout(n),n=null)},throttle:function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];null!==n&&clearTimeout(n),n=setTimeout(function(){e.apply(null,r),n=null},t)}}},kg=function(e,t,n){var r=!1,o=ag.create({start:l([]),stop:l([])}),i=m(),u=function(){p.stop(),i.isOn()&&(i.off(),o.trigger.stop())},a=Og(u,200),c=function(e){p.start(e),i.on(),o.trigger.start()},s=function(e,n){a.cancel(),i.onEvent(e,t)};i.events.move.bind(function(n){t.mutate(e,n.info())});var f=function(){r=!0},d=function(){r=!1},g=function(e){return function(){var t=Array.prototype.slice.call(arguments,0);if(r)return e.apply(null,t)}},p=t.sink(fg.api({forceDrop:u,drop:g(u),move:g(s),delayDrop:g(a.throttle)}),n),h=function(){p.destroy()};return{element:p.element,go:c,on:f,off:d,destroy:h,events:o.registry}},Pg={setup:kg},Bg=function(e,t){var n=void 0!==t?t:{},r=void 0!==n.mode?n.mode:Ng;return Pg.setup(e,r,t)},Ig={transform:Bg},Wg=function(e){return br.first(e).isSome()},Mg=function(e,t,n){return br.ancestor(e,t,n).isSome()},Lg=function(e,t){return br.sibling(e,t).isSome()},_g=function(e,t){return br.child(e,t).isSome()},Fg=function(e,t){return br.descendant(e,t).isSome()},qg=function(e,t,n){return br.closest(e,t,n).isSome()},Hg={any:Wg,ancestor:Mg,sibling:Lg,child:_g,descendant:Fg,closest:qg},jg=Al.resolve("resizer-bar-dragging"),zg=function(){var e=Ue.fromTag("div");return ao.setAll(e,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),po.append(Gn.body(),e),e},Ug=function(e,t){return e.inline?ig.body(wd(e),zg()):ig.only(Ue.fromDom(e.getDoc()))},Vg=function(e,t){e.inline&&So.remove(t.parent())},Gg={get:Ug,remove:Vg},Yg=function(e){var t,n,r=q.none(),i=q.none(),u=q.none(),a=/(\d+(\.\d+)?)%/,c=function(e){return"TABLE"===e.nodeName},l=function(t){return e.dom.getStyle(t,"width")||e.dom.getAttrib(t,"width")},s=function(){return i},f=function(){return u.getOr(ig.only(Ue.fromDom(e.getBody())))},d=function(){i.each(function(e){e.destroy()}),u.each(function(t){Gg.remove(e,t)})};return e.on("init",function(){var t=o(Pd.directionAt),n=Gg.get(e);if(u=q.some(n),Qd(e)&&_d(e)){var a=v(n,t);a.on(),a.events.startDrag.bind(function(t){r=q.some(e.selection.getRng())}),a.events.beforeResize.bind(function(t){var n=t.table().dom();nm(e,n,yd(n),xd(n))}),a.events.afterResize.bind(function(t){var n=t.table(),o=n.dom();Td(n),r.each(function(t){e.selection.setRng(t),e.focus()}),rm(e,o,yd(o),xd(o)),e.undoManager.add()}),i=q.some(a)}}),e.on("ObjectResizeStart",function(e){var r=e.target;c(r)&&(t=e.width,n=l(r))}),e.on("ObjectResized",function(r){var o=r.target;if(c(o)){var i=o;if(a.test(n)){var u=parseFloat(a.exec(n)[1]),l=r.width*u/t;e.dom.setStyle(i,"width",l+"%")}else{var s=[];am.each(i.rows,function(t){am.each(t.cells,function(t){var n=e.dom.getStyle(t,"width",!0);s.push({cell:t,width:n})})}),am.each(s,function(t){e.dom.setStyle(t.cell,"width",t.width),e.dom.setAttrib(t.cell,"width",null)})}}}),{lazyResize:s,lazyWire:f,destroy:d}},Xg=function(e){return Qg(function(t,n,r,o){return t(e)})},Kg=function(e){return Qg(function(t,n,r,o){return n(e)})},Jg=function(e,t){return Qg(function(n,r,o,i){return o(e,t)})},$g=function(e){return Qg(function(t,n,r,o){return o(e)})},Qg=function(e){return{fold:e}},Zg={none:Xg,first:Kg,middle:Jg,last:$g},ep=function(e,t){return Pr.table(e,t).bind(function(t){var n=Pr.cells(t);return oe(n,function(t){return $t.eq(e,t)}).map(function(e){return{index:E(e),all:E(n)}})})},tp=function(e,t){return ep(e,t).fold(function(){return Zg.none(e)},function(t){return t.index()+1<t.all().length?Zg.middle(e,t.all()[t.index()+1]):Zg.last(e)})},np=function(e,t){return ep(e,t).fold(function(){return Zg.none()},function(t){return t.index()-1>=0?Zg.middle(e,t.all()[t.index()-1]):Zg.first(e)})},rp={next:tp,prev:np},op=Tu.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),ip=function(e,t,n,r){return e.fold(t,n,r)},up=function(e){return e.fold(A,A,A)},ap={before:op.before,on:op.on,after:op.after,cata:ip,getStart:up},cp=Tu.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),lp=ve("start","soffset","finish","foffset"),sp=function(e){return cp.exact(e.start(),e.soffset(),e.finish(),e.foffset())},fp=function(e){return e.match({domRange:function(e){return Ue.fromDom(e.startContainer)},relative:function(e,t){return ap.getStart(e)},exact:function(e,t,n,r){return e}})},dp=function(e){var t=fp(e);return wn.defaultView(t)},mp={domRange:cp.domRange,relative:cp.relative,exact:cp.exact,exactFromRange:sp,range:lp,getWin:dp},gp=function(e,t,n,r){var o=wn.owner(e),i=o.dom().createRange();return i.setStart(e.dom(),t),i.setEnd(n.dom(),r),i},pp=function(e,t,n,r){var o=gp(e,t,n,r);return Ue.fromDom(o.commonAncestorContainer)},hp=function(e,t,n,r){var o=gp(e,t,n,r),i=$t.eq(e,n)&&t===r;return o.collapsed&&!i},vp={after:hp,commonAncestorContainer:pp},bp=function(e,t){var n=t||document,r=n.createDocumentFragment();return Q(e,function(e){r.appendChild(e.dom())}),Ue.fromDom(r)},wp={fromElements:bp},yp=function(e,t){var n=e.document.createRange();return xp(n,t),n},xp=function(e,t){e.selectNodeContents(t.dom())},Cp=function(e,t){return t.compareBoundaryPoints(e.END_TO_START,e)<1&&t.compareBoundaryPoints(e.START_TO_END,e)>-1},Rp=function(e){return e.document.createRange()},Sp=function(e,t){t.fold(function(t){e.setStartBefore(t.dom())},function(t,n){e.setStart(t.dom(),n)},function(t){e.setStartAfter(t.dom())})},Tp=function(e,t){t.fold(function(t){e.setEndBefore(t.dom())},function(t,n){e.setEnd(t.dom(),n)},function(t){e.setEndAfter(t.dom())})},Ep=function(e,t){Np(e),e.insertNode(t.dom())},Ap=function(e,t,n){var r=e.document.createRange();return Sp(r,t),Tp(r,n),r},Dp=function(e,t,n,r,o){var i=e.document.createRange();return i.setStart(t.dom(),n),i.setEnd(r.dom(),o),i},Np=function(e){e.deleteContents()},Op=function(e){var t=e.cloneContents();return Ue.fromDom(t)},kp=function(e){return{left:E(e.left),top:E(e.top),right:E(e.right),bottom:E(e.bottom),width:E(e.width),height:E(e.height)}},Pp=function(e){var t=e.getClientRects(),n=t.length>0?t[0]:e.getBoundingClientRect();return n.width>0||n.height>0?q.some(n).map(kp):q.none()},Bp=function(e){var t=e.getBoundingClientRect();return t.width>0||t.height>0?q.some(t).map(kp):q.none()},Ip=function(e){return e.toString()},Wp={create:Rp,replaceWith:Ep,selectNodeContents:yp,selectNodeContentsUsing:xp,relativeToNative:Ap,exactToNative:Dp,deleteContents:Np,cloneFragment:Op,getFirstRect:Pp,getBounds:Bp,isWithin:Cp,toString:Ip},Mp=Tu.generate([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Lp=function(e,t,n){return t(Ue.fromDom(n.startContainer),n.startOffset,Ue.fromDom(n.endContainer),n.endOffset)},_p=function(e,t){return t.match({domRange:function(e){return{ltr:E(e),rtl:q.none}},relative:function(t,n){return{ltr:dt(function(){return Wp.relativeToNative(e,t,n)}),rtl:dt(function(){return q.some(Wp.relativeToNative(e,n,t))})}},exact:function(t,n,r,o){return{ltr:dt(function(){return Wp.exactToNative(e,t,n,r,o)}),rtl:dt(function(){return q.some(Wp.exactToNative(e,r,o,t,n))})}}})},Fp=function(e,t){var n=t.ltr();if(n.collapsed){return t.rtl().filter(function(e){return!1===e.collapsed}).map(function(e){return Mp.rtl(Ue.fromDom(e.endContainer),e.endOffset,Ue.fromDom(e.startContainer),e.startOffset)}).getOrThunk(function(){return Lp(0,Mp.ltr,n)})}return Lp(0,Mp.ltr,n)},qp=function(e,t){var n=_p(e,t);return Fp(0,n)},Hp=function(e,t){return qp(e,t).match({ltr:function(t,n,r,o){var i=e.document.createRange();return i.setStart(t.dom(),n),i.setEnd(r.dom(),o),i},rtl:function(t,n,r,o){var i=e.document.createRange();return i.setStart(r.dom(),o),i.setEnd(t.dom(),n),i}})},jp={ltr:Mp.ltr,rtl:Mp.rtl,diagnose:qp,asLtrRange:Hp},zp=function(e,t,n,r,o){if(0===o)return 0;if(t===r)return o-1;for(var i=r,u=1;u<o;u++){var a=e(u),c=Math.abs(t-a.left);if(n<=a.bottom){if(n<a.top||c>i)return u-1;i=c}}return 0},Up=function(e,t,n){return t>=e.left&&t<=e.right&&n>=e.top&&n<=e.bottom},Vp={inRect:Up,searchForPoint:zp},Gp=function(e,t,n,r,o){var i=function(n){var r=e.dom().createRange();return r.setStart(t.dom(),n),r.collapse(!0),r},u=function(e){return i(e).getBoundingClientRect()},a=zo.get(t).length,c=Vp.searchForPoint(u,n,r,o.right,a);return i(c)},Yp=function(e,t,n,r){var o=e.dom().createRange();o.selectNode(t.dom());var i=o.getClientRects();return Gc(i,function(e){return Vp.inRect(e,n,r)?q.some(e):q.none()}).map(function(o){return Gp(e,t,n,r,o)})},Xp={locate:Yp},Kp=function(e,t,n,r){var o=e.dom().createRange(),i=wn.children(t);return Gc(i,function(t){return o.selectNode(t.dom()),Vp.inRect(o.getBoundingClientRect(),n,r)?Jp(e,t,n,r):q.none()})},Jp=function(e,t,n,r){return(kn.isText(t)?Xp.locate:Kp)(e,t,n,r)},$p=function(e,t,n,r){var o=e.dom().createRange();o.selectNode(t.dom());var i=o.getBoundingClientRect(),u=Math.max(i.left,Math.min(i.right,n)),a=Math.max(i.top,Math.min(i.bottom,r));return Jp(e,t,u,a)},Qp={locate:$p},Zp=function(e,t){return t-e.left<e.right-t},eh=function(e,t,n){var r=e.dom().createRange();return r.selectNode(t.dom()),r.collapse(n),r},th=function(e,t,n){var r=e.dom().createRange();r.selectNode(t.dom());var o=r.getBoundingClientRect(),i=Zp(o,n);return(!0===i?ei.first:ei.last)(t).map(function(t){return eh(e,t,i)})},nh=function(e,t,n){var r=t.dom().getBoundingClientRect(),o=Zp(r,n);return q.some(eh(e,t,o))},rh=function(e,t,n){return(0===wn.children(t).length?nh:th)(e,t,n)},oh={search:rh},ih=function(e,t,n){return q.from(e.dom().caretPositionFromPoint(t,n)).bind(function(t){if(null===t.offsetNode)return q.none();var n=e.dom().createRange();return n.setStart(t.offsetNode,t.offset),n.collapse(),q.some(n)})},uh=function(e,t,n){return q.from(e.dom().caretRangeFromPoint(t,n))},ah=function(e,t,n,r){var o=e.dom().createRange();o.selectNode(t.dom());var i=o.getBoundingClientRect(),u=Math.max(i.left,Math.min(i.right,n)),a=Math.max(i.top,Math.min(i.bottom,r));return Qp.locate(e,t,u,a)},ch=function(e,t,n){return Ue.fromPoint(e,t,n).bind(function(r){var o=function(){return oh.search(e,r,t)};return 0===wn.children(r).length?o():ah(e,r,t,n).orThunk(o)})},lh=document.caretPositionFromPoint?ih:document.caretRangeFromPoint?uh:ch,sh=function(e,t,n){var r=Ue.fromDom(e.document);return lh(r,t,n).map(function(e){return mp.range(Ue.fromDom(e.startContainer),e.startOffset,Ue.fromDom(e.endContainer),e.endOffset)})},fh={fromPoint:sh},dh=function(e,t,n,r){var o=Wp.create(e),i=Qe.is(t,r)?[t]:[],u=i.concat(or.descendants(t,r));return ee(u,function(e){return Wp.selectNodeContentsUsing(o,e),Wp.isWithin(n,o)})},mh=function(e,t,n){var r=jp.asLtrRange(e,t),o=Ue.fromDom(r.commonAncestorContainer);return kn.isElement(o)?dh(e,o,r,n):[]},gh={find:mh},ph=function(e,t){var n=kn.name(e);return"input"===n?ap.after(e):K(["br","img"],n)?0===t?ap.before(e):ap.after(e):ap.on(e,t)},hh=function(e,t){var n=e.fold(ap.before,ph,ap.after),r=t.fold(ap.before,ph,ap.after);return mp.relative(n,r)},vh=function(e,t,n,r){var o=ph(e,t),i=ph(n,r);return mp.relative(o,i)},bh=function(e){return e.match({domRange:function(e){var t=Ue.fromDom(e.startContainer),n=Ue.fromDom(e.endContainer);return vh(t,e.startOffset,n,e.endOffset)},relative:hh,exact:vh})},wh={beforeSpecial:ph,preprocess:bh,preprocessRelative:hh,preprocessExact:vh},yh=function(e,t){q.from(e.getSelection()).each(function(e){e.removeAllRanges(),e.addRange(t)})},xh=function(e,t,n,r,o){var i=Wp.exactToNative(e,t,n,r,o);yh(e,i)},Ch=function(e,t,n){return gh.find(e,t,n)},Rh=function(e,t,n,r,o,i){t.collapse(n.dom(),r),t.extend(o.dom(),i)},Sh=function(e,t){return jp.diagnose(e,t).match({ltr:function(t,n,r,o){xh(e,t,n,r,o)},rtl:function(t,n,r,o){var i=e.getSelection();if(i.setBaseAndExtent)i.setBaseAndExtent(t.dom(),n,r.dom(),o);else if(i.extend)try{Rh(0,i,t,n,r,o)}catch(i){xh(e,r,o,t,n)}else xh(e,r,o,t,n)}})},Th=function(e,t,n,r,o){var i=wh.preprocessExact(t,n,r,o);Sh(e,i)},Eh=function(e,t,n){var r=wh.preprocessRelative(t,n);Sh(e,r)},Ah=function(e){var t=mp.getWin(e).dom(),n=function(e,n,r,o){return Wp.exactToNative(t,e,n,r,o)},r=wh.preprocess(e);return jp.diagnose(t,r).match({ltr:n,rtl:n})},Dh=function(e){if(e.rangeCount>0){var t=e.getRangeAt(0),n=e.getRangeAt(e.rangeCount-1);return q.some(mp.range(Ue.fromDom(t.startContainer),t.startOffset,Ue.fromDom(n.endContainer),n.endOffset))}return q.none()},Nh=function(e){var t=Ue.fromDom(e.anchorNode),n=Ue.fromDom(e.focusNode);return vp.after(t,e.anchorOffset,n,e.focusOffset)?q.some(mp.range(Ue.fromDom(e.anchorNode),e.anchorOffset,Ue.fromDom(e.focusNode),e.focusOffset)):Dh(e)},Oh=function(e,t){var n=Wp.selectNodeContents(e,t);yh(e,n)},kh=function(e,t){var n=Wp.selectNodeContents(e,t);return mp.range(Ue.fromDom(n.startContainer),n.startOffset,Ue.fromDom(n.endContainer),n.endOffset)},Ph=function(e){return q.from(e.getSelection()).filter(function(e){return e.rangeCount>0}).bind(Nh)},Bh=function(e){return Ph(e).map(function(e){return mp.exact(e.start(),e.soffset(),e.finish(),e.foffset())})},Ih=function(e,t){var n=jp.asLtrRange(e,t);return Wp.getFirstRect(n)},Wh=function(e,t){var n=jp.asLtrRange(e,t);return Wp.getBounds(n)},Mh=function(e,t,n){return fh.fromPoint(e,t,n)},Lh=function(e,t){var n=jp.asLtrRange(e,t);return Wp.toString(n)},_h=function(e){e.getSelection().removeAllRanges()},Fh=function(e,t){var n=jp.asLtrRange(e,t);return Wp.cloneFragment(n)},qh=function(e,t,n){var r=jp.asLtrRange(e,t),o=wp.fromElements(n,e.document);Wp.replaceWith(r,o)},Hh=function(e,t){var n=jp.asLtrRange(e,t);Wp.deleteContents(n)},jh=function(e,t,n,r){return $t.eq(e,n)&&t===r},zh={setExact:Th,getExact:Ph,get:Bh,setRelative:Eh,toNative:Ah,setToElement:Oh,clear:_h,clone:Fh,replace:qh,deleteAt:Hh,forElement:kh,getFirstRect:Ih,getBounds:Wh,getAtPoint:Mh,findWithin:Ch,getAsString:Lh,isCollapsed:jh},Uh=tinymce.util.Tools.resolve("tinymce.util.VK"),Vh=function(e,t,n,r){return Kh(e,t,rp.next(n),r)},Gh=function(e,t,n,r){return Kh(e,t,rp.prev(n),r)},Yh=function(e,t){var n=mp.exact(t,0,t,0);return zh.toNative(n)},Xh=function(e,t){var n=or.descendants(t,"tr");return de(n).bind(function(e){return br.descendant(e,"td,th").map(function(e){return Yh(0,e)})})},Kh=function(e,t,n,r,o){return n.fold(q.none,q.none,function(e,t){return ei.first(t).map(function(e){return Yh(0,e)})},function(n){return Pr.table(n,t).bind(function(t){var o=_u.noMenu(n);return e.undoManager.transact(function(){r.insertRowsAfter(t,o)}),Xh(0,t)})})},Jh=["table","li","dl"],$h=function(e,t,n,r){if(e.keyCode===Uh.TAB){var o=wd(t),i=function(e){var t=kn.name(e);return $t.eq(e,o)||K(Jh,t)},u=t.selection.getRng();if(u.collapsed){var a=Ue.fromDom(u.startContainer);Pr.cell(a,i).each(function(o){e.preventDefault(),(e.shiftKey?Gh:Vh)(t,i,o,n,r).each(function(e){t.selection.setRng(e)})})}}},Qh={handle:$h},Zh=ve("selection","kill"),ev={response:Zh},tv=function(e){return function(t){return t===e}},nv=tv(38),rv=tv(40),ov=function(e){return e>=37&&e<=40},iv={ltr:{isBackward:tv(37),isForward:tv(39)},rtl:{isBackward:tv(39),isForward:tv(37)},isUp:nv,isDown:rv,isNavigation:ov},uv=function(e,t){var n=jp.asLtrRange(e,t);return{start:E(Ue.fromDom(n.startContainer)),soffset:E(n.startOffset),finish:E(Ue.fromDom(n.endContainer)),foffset:E(n.endOffset)}},av=function(e,t,n,r){return{start:E(ap.on(e,t)),finish:E(ap.on(n,r))}},cv={convertToRange:uv,makeSitus:av},lv=zt.detect().browser.isSafari(),sv=function(e){var t=void 0!==e?e.dom():document,n=t.body.scrollLeft||t.documentElement.scrollLeft,r=t.body.scrollTop||t.documentElement.scrollTop;return _a(n,r)},fv=function(e,t,n){(void 0!==n?n.dom():document).defaultView.scrollTo(e,t)},dv=function(e,t,n){(void 0!==n?n.dom():document).defaultView.scrollBy(e,t)},mv=function(e,t){var n=Ua.absolute(t),r=Ue.fromDom(e.document);fv(n.left(),n.top(),r)},gv=function(e,t){var n=sv(e);t();var r=sv(e);n.top()===r.top()&&n.left()===r.left()||fv(n.left(),n.top(),e)},pv=function(e){var t=q.none(),n=function(){t=q.some(sv(e))},r=function(){t.each(function(t){fv(t.left(),t.top(),e)})};return n(),{save:n,restore:r}},hv=function(e,t){lv&&G(e.dom().scrollIntoViewIfNeeded)?e.dom().scrollIntoViewIfNeeded(!1):e.dom().scrollIntoView(t)},vv=function(e,t){var n=t.dom().getBoundingClientRect(),r=e.dom().getBoundingClientRect();r.top<n.top?hv(e,!0):r.bottom>n.bottom&&hv(e,!1)},bv=function(){var e=Ue.fromHtml('<div style="width: 100px; height: 100px; overflow: scroll; position: absolute; top: -9999px;"></div>');po.after(Gn.body(),e);var t=e.dom().offsetWidth-e.dom().clientWidth;return So.remove(e),t},wv={get:sv,to:fv,by:dv,preserve:gv,capture:pv,intoView:hv,intoViewIfNeeded:vv,setToElement:mv,scrollBarWidth:bv},yv=function(e,t,n,r,o,i,u){return $t.eq(n,o)&&r===i?q.none():br.closest(n,"td,th",t).bind(function(n){return br.closest(o,"td,th",t).bind(function(r){return xv(e,t,n,r,u)})})},xv=function(e,t,n,r,o){return $t.eq(n,r)?q.none():bu.identify(n,r,t).bind(function(t){var r=t.boxes().getOr([]);return r.length>0?(o(e,r,t.start(),t.finish()),q.some(ev.response(q.some(cv.makeSitus(n,0,n,Jo.getEnd(n))),!0))):q.none()})},Cv=function(e,t,n,r,o){var i=function(e){return o.clear(n),o.selectRange(n,e.boxes(),e.start(),e.finish()),e.boxes()};return bu.shiftSelection(r,e,t,o.firstSelectedSelector(),o.lastSelectedSelector()).map(i)},Rv={sync:yv,detect:xv,update:Cv},Sv=Se(["left","top","right","bottom"],[]),Tv=function(e,t){return Sv({left:e.left(),top:e.top()+t,right:e.right(),bottom:e.bottom()+t})},Ev=function(e,t){return Sv({left:e.left(),top:e.top()-t,right:e.right(),bottom:e.bottom()-t})},Av=function(e,t){var n=e.bottom()-e.top();return Sv({left:e.left(),top:t-n,right:e.right(),bottom:t})},Dv=function(e,t){var n=e.bottom()-e.top();return Sv({left:e.left(),top:t,right:e.right(),bottom:t+n})},Nv=function(e,t,n){return Sv({left:e.left()+t,top:e.top()+n,right:e.right()+t,bottom:e.bottom()+n})},Ov=function(e){return e.top()},kv=function(e){return e.bottom()},Pv=function(e){return"("+e.left()+", "+e.top()+") -> ("+e.right()+", "+e.bottom()+")"},Bv={nu:Sv,moveUp:Ev,moveDown:Tv,moveBottomTo:Av,moveTopTo:Dv,getTop:Ov,getBottom:kv,translate:Nv,toString:Pv},Iv=function(e,t,n){return n>=0&&n<Jo.getEnd(t)?e.getRangedRect(t,n,t,n+1):n>0?e.getRangedRect(t,n-1,t,n):q.none()},Wv=function(e){return Bv.nu({left:e.left,top:e.top,right:e.right,bottom:e.bottom})},Mv=function(e,t){return q.some(e.getRect(t))},Lv=function(e,t,n){return kn.isElement(t)?Mv(e,t).map(Wv):kn.isText(t)?Iv(e,t,n).map(Wv):q.none()},_v=function(e,t){return kn.isElement(t)?Mv(e,t).map(Wv):kn.isText(t)?e.getRangedRect(t,0,t,Jo.getEnd(t)).map(Wv):q.none()},Fv={getBoxAt:Lv,getEntireBox:_v},qv=ve("item","mode"),Hv=function(e,t,n,r){var o=void 0!==r?r:jv;return e.property().parent(t).map(function(e){return qv(e,o)})},jv=function(e,t,n,r){var o=void 0!==r?r:zv;return n.sibling(e,t).map(function(e){return qv(e,o)})},zv=function(e,t,n,r){var o=void 0!==r?r:zv,i=e.property().children(t);return n.first(i).map(function(e){return qv(e,o)})},Uv=[{current:Hv,next:jv,fallback:q.none()},{current:jv,next:zv,fallback:q.some(Hv)},{current:zv,next:zv,fallback:q.some(jv)}],Vv=function(e,t,n,r,o){var o=void 0!==o?o:Uv;return re(o,function(e){return e.current===n}).bind(function(n){return n.current(e,t,r,n.next).orThunk(function(){return n.fallback.bind(function(n){return Vv(e,t,n,r)})})})},Gv={backtrack:Hv,sidestep:jv,advance:zv,go:Vv},Yv=function(){return{sibling:function(e,t){return e.query().prevSibling(t)},first:function(e){return e.length>0?q.some(e[e.length-1]):q.none()}}},Xv=function(){return{sibling:function(e,t){return e.query().nextSibling(t)},first:function(e){return e.length>0?q.some(e[0]):q.none()}}},Kv={left:Yv,right:Xv},Jv=function(e,t,n,r,o,i){return Gv.go(e,t,r,o).bind(function(t){return i(t.item())?q.none():n(t.item())?q.some(t.item()):Jv(e,t.item(),n,t.mode(),o,i)})},$v=function(e,t,n,r){return Jv(e,t,n,Gv.sidestep,Kv.left(),r)},Qv=function(e,t,n,r){return Jv(e,t,n,Gv.sidestep,Kv.right(),r)},Zv={left:$v,right:Qv},eb=function(e,t){return 0===e.property().children(t).length},tb=function(e,t,n){return rb(e,t,D(eb,e),n)},nb=function(e,t,n){return ob(e,t,D(eb,e),n)},rb=function(e,t,n,r){return Zv.left(e,t,n,r)},ob=function(e,t,n,r){return Zv.right(e,t,n,r)},ib=function(){return{left:Kv.left,right:Kv.right}},ub=function(e,t,n,r,o){return Gv.go(e,t,n,r,o)},ab={before:tb,after:nb,seekLeft:rb,seekRight:ob,walkers:ib,walk:ub,backtrack:Gv.backtrack,sidestep:Gv.sidestep,advance:Gv.advance},cb=n(),lb=function(e,t,n){return ab.gather(cb,e,t,n)},sb=function(e,t){return ab.before(cb,e,t)},fb=function(e,t){return ab.after(cb,e,t)},db=function(e,t,n){return ab.seekLeft(cb,e,t,n)},mb=function(e,t,n){return ab.seekRight(cb,e,t,n)},gb=function(){return ab.walkers()},pb=function(e,t,n,r){return ab.walk(cb,e,t,n,r)},hb={gather:lb,before:sb,after:fb,seekLeft:db,seekRight:mb,walkers:gb,walk:pb},vb=Tu.generate([{none:[]},{retry:["caret"]}]),bb=function(e,t){return e.left()<t.left()||Math.abs(t.right()-e.left())<1||e.left()>t.right()},wb=function(e,t,n){return fr.closest(t,Fc.isBlock).fold(E(!1),function(t){return Fv.getEntireBox(e,t).exists(function(e){return bb(n,e)})})},yb=function(e,t,n,r,o){var i=Bv.moveDown(o,5);return Math.abs(n.bottom()-r.bottom())<1?vb.retry(i):n.top()>o.bottom()?vb.retry(i):n.top()===o.bottom()?vb.retry(Bv.moveDown(o,1)):wb(e,t,o)?vb.retry(Bv.translate(i,5,0)):vb.none()},xb=function(e,t,n,r,o){var i=Bv.moveUp(o,5);return Math.abs(n.top()-r.top())<1?vb.retry(i):n.bottom()<o.top()?vb.retry(i):n.bottom()===o.top()?vb.retry(Bv.moveUp(o,1)):wb(e,t,o)?vb.retry(Bv.translate(i,5,0)):vb.none()},Cb={point:Bv.getTop,adjuster:xb,move:Bv.moveUp,gather:hb.before},Rb={point:Bv.getBottom,adjuster:yb,move:Bv.moveDown,gather:hb.after},Sb=function(e,t,n){return e.elementFromPoint(t,n).filter(function(e){return"table"===kn.name(e)}).isSome()},Tb=function(e,t,n,r,o){return Eb(e,t,n,t.move(r,5),o)},Eb=function(e,t,n,r,o){return 0===o?q.some(r):Sb(e,r.left(),t.point(r))?Tb(e,t,n,r,o-1):e.situsFromPoint(r.left(),t.point(r)).bind(function(i){
return i.start().fold(q.none,function(i,u){return Fv.getEntireBox(e,i,u).bind(function(u){return t.adjuster(e,i,u,n,r).fold(q.none,function(r){return Eb(e,t,n,r,o-1)})}).orThunk(function(){return q.some(r)})},q.none)})},Ab=function(e,t){return e.situsFromPoint(t.left(),t.bottom()+5)},Db=function(e,t){return e.situsFromPoint(t.left(),t.top()-5)},Nb=function(e,t,n){return e.point(t)>n.getInnerHeight()?q.some(e.point(t)-n.getInnerHeight()):e.point(t)<0?q.some(-e.point(t)):q.none()},Ob=function(e,t,n){var r=e.move(n,5),o=Eb(t,e,n,r,100).getOr(r);return Nb(e,o,t).fold(function(){return t.situsFromPoint(o.left(),e.point(o))},function(n){return t.scrollBy(0,n),t.situsFromPoint(o.left(),e.point(o)-n)})},kb={tryUp:D(Ob,Cb),tryDown:D(Ob,Rb),ieTryUp:Db,ieTryDown:Ab,getJumpSize:E(5)},Pb=Tu.generate([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),Bb=function(e,t,n){var r=e.getRect(t),o=e.getRect(n);return o.right>r.left&&o.left<r.right},Ib=function(e,t,n,r,o,i,u){return br.closest(r,"td,th",u).bind(function(n){return br.closest(t,"td,th",u).map(function(t){return $t.eq(n,t)?$t.eq(r,n)&&Jo.getEnd(n)===o?i(t):Pb.none("in same cell"):Vi.sharedOne(Wb,[n,t]).fold(function(){return Bb(e,t,n)?Pb.success():i(t)},function(e){return i(t)})})}).getOr(Pb.none("default"))},Wb=function(e){return br.closest(e,"tr")},Mb=function(e,t,n,r,o){return e.fold(t,n,r,o)},Lb={verify:Ib,cata:Mb,adt:Pb},_b=ve("element","offset"),Fb=ve("element","deltaOffset"),qb=ve("element","start","finish"),Hb=ve("begin","end"),jb=ve("element","text"),zb={point:_b,delta:Fb,range:qb,points:Hb,text:jb},Ub=ve("ancestor","descendants","element","index"),Vb=ve("parent","children","element","index"),Gb=function(e,t){return fr.closest(e,function(e){return wn.parent(e).exists(function(e){return $t.eq(e,t)})})},Yb=function(e){return wn.parent(e).bind(function(t){var n=wn.children(t);return Xb(n,e).map(function(r){return Vb(t,n,e,r)})})},Xb=function(e,t){return oe(e,D($t.eq,t))},Kb=function(e,t){return wn.parent(e).bind(function(n){var r=or.children(n,t);return Xb(r,e).map(function(t){return Vb(n,r,e,t)})})},Jb=function(e,t,n){return br.closest(e,t).bind(function(t){var r=or.descendants(t,n);return Xb(r,e).map(function(n){return Ub(t,r,e,n)})})},$b={childOf:Gb,indexOf:Xb,indexInParent:Yb,selectorsInParent:Kb,descendantsInAncestor:Jb},Qb=function(e){return"br"===kn.name(e)},Zb=function(e,t,n){return t(e,n).bind(function(e){return kn.isText(e)&&0===zo.get(e).trim().length?Zb(e,t,n):q.some(e)})},ew=function(e,t,n){return n.traverse(t).orThunk(function(){return Zb(t,n.gather,e)}).map(n.relative)},tw=function(e,t){return wn.child(e,t).filter(Qb).orThunk(function(){return wn.child(e,t-1).filter(Qb)})},nw=function(e,t,n,r){return tw(t,n).bind(function(t){return r.traverse(t).fold(function(){return Zb(t,r.gather,e).map(r.relative)},function(e){return $b.indexInParent(e).map(function(e){return ap.on(e.parent(),e.index())})})})},rw=function(e,t,n,r){return(Qb(t)?ew(e,t,r):nw(e,t,n,r)).map(function(e){return{start:E(e),finish:E(e)}})},ow=function(e){return Lb.cata(e,function(e){return q.none()},function(){return q.none()},function(e){return q.some(zb.point(e,0))},function(e){return q.some(zb.point(e,Jo.getEnd(e)))})},iw={tryBr:rw,process:ow},uw=zt.detect(),aw=function(e,t,n){return e.getSelection().bind(function(r){return iw.tryBr(t,r.finish(),r.foffset(),n).fold(function(){return q.some(zb.point(r.finish(),r.foffset()))},function(o){var i=e.fromSitus(o),u=Lb.verify(e,r.finish(),r.foffset(),i.finish(),i.foffset(),n.failure,t);return iw.process(u)})})},cw=function(e,t,n,r,o,i){return 0===i?q.none():fw(e,t,n,r,o).bind(function(u){var a=e.fromSitus(u),c=Lb.verify(e,n,r,a.finish(),a.foffset(),o.failure,t);return Lb.cata(c,function(){return q.none()},function(){return q.some(u)},function(u){return $t.eq(n,u)&&0===r?lw(e,n,r,Bv.moveUp,o):cw(e,t,u,0,o,i-1)},function(u){return $t.eq(n,u)&&r===Jo.getEnd(u)?lw(e,n,r,Bv.moveDown,o):cw(e,t,u,Jo.getEnd(u),o,i-1)})})},lw=function(e,t,n,r,o){return Fv.getBoxAt(e,t,n).bind(function(t){return sw(e,o,r(t,kb.getJumpSize()))})},sw=function(e,t,n){return uw.browser.isChrome()||uw.browser.isSafari()||uw.browser.isFirefox()||uw.browser.isEdge()?t.otherRetry(e,n):uw.browser.isIE()?t.ieRetry(e,n):q.none()},fw=function(e,t,n,r,o){return Fv.getBoxAt(e,n,r).bind(function(t){return sw(e,o,t)})},dw=function(e,t,n){return aw(e,t,n).bind(function(r){return cw(e,t,r.element(),r.offset(),n,20).map(e.fromSitus)})},mw={handle:dw},gw=function(e){return fr.first(e).isSome()},pw=function(e,t,n){return fr.ancestor(e,t,n).isSome()},hw=function(e,t,n){return fr.closest(e,t,n).isSome()},vw=function(e,t){return fr.sibling(e,t).isSome()},bw=function(e,t){return fr.child(e,t).isSome()},ww=function(e,t){return fr.descendant(e,t).isSome()},yw={any:gw,ancestor:pw,closest:hw,sibling:vw,child:bw,descendant:ww},xw=zt.detect(),Cw=function(e,t){return yw.ancestor(e,function(e){return wn.parent(e).exists(function(e){return $t.eq(e,t)})})},Rw=function(e,t,n,r,o){return br.closest(r,"td,th",t).bind(function(r){return br.closest(r,"table",t).bind(function(i){return Cw(o,i)?mw.handle(e,t,n).bind(function(e){return br.closest(e.finish(),"td,th",t).map(function(t){return{start:E(r),finish:E(t),range:E(e)}})}):q.none()})})},Sw=function(e,t,n,r,o,i){return xw.browser.isIE()?q.none():i(r,t).orThunk(function(){return Rw(e,t,n,r,o).map(function(e){var t=e.range();return ev.response(q.some(cv.makeSitus(t.start(),t.soffset(),t.finish(),t.foffset())),!0)})})},Tw=function(e,t){return br.closest(e,"tr",t).bind(function(e){return br.closest(e,"table",t).bind(function(n){var r=or.descendants(n,"tr");return $t.eq(e,r[0])?hb.seekLeft(n,function(e){return ei.last(e).isSome()},t).map(function(e){var t=Jo.getEnd(e);return ev.response(q.some(cv.makeSitus(e,t,e,t)),!0)}):q.none()})})},Ew=function(e,t){return br.closest(e,"tr",t).bind(function(e){return br.closest(e,"table",t).bind(function(n){var r=or.descendants(n,"tr");return $t.eq(e,r[r.length-1])?hb.seekRight(n,function(e){return ei.first(e).isSome()},t).map(function(e){return ev.response(q.some(cv.makeSitus(e,0,e,0)),!0)}):q.none()})})},Aw=function(e,t,n,r,o,i,u){return Rw(e,n,r,o,i).bind(function(e){return Rv.detect(t,n,e.start(),e.finish(),u)})},Dw={navigate:Sw,select:Aw,firstUpCheck:Tw,lastDownCheck:Ew},Nw=function(e,t){return br.closest(e,"td,th",t)},Ow={down:{traverse:wn.nextSibling,gather:hb.after,relative:ap.before,otherRetry:kb.tryDown,ieRetry:kb.ieTryDown,failure:Lb.adt.failedDown},up:{traverse:wn.prevSibling,gather:hb.before,relative:ap.before,otherRetry:kb.tryUp,ieRetry:kb.ieTryUp,failure:Lb.adt.failedUp}},kw=ve("rows","cols"),Pw=function(e,t,n,r){var o=b(e),i=w(o,t,n,r);return{mousedown:i.mousedown,mouseover:i.mouseover,mouseup:i.mouseup}},Bw=function(e,t,n,r){var o=b(e),i=function(){return r.clear(t),q.none()};return{keydown:function(e,u,a,c,l,s){var f=e.raw().which,d=!0===e.raw().shiftKey;return bu.retrieve(t,r.selectedSelector()).fold(function(){return iv.isDown(f)&&d?D(Dw.select,o,t,n,Ow.down,c,u,r.selectRange):iv.isUp(f)&&d?D(Dw.select,o,t,n,Ow.up,c,u,r.selectRange):iv.isDown(f)?D(Dw.navigate,o,n,Ow.down,c,u,Dw.lastDownCheck):iv.isUp(f)?D(Dw.navigate,o,n,Ow.up,c,u,Dw.firstUpCheck):q.none},function(e){var n=function(n){return function(){return Gc(n,function(n){return Rv.update(n.rows(),n.cols(),t,e,r)}).fold(function(){return bu.getEdges(t,r.firstSelectedSelector(),r.lastSelectedSelector()).map(function(e){var n=iv.isDown(f)||s.isForward(f)?ap.after:ap.before;return o.setRelativeSelection(ap.on(e.first(),0),n(e.table())),r.clear(t),ev.response(q.none(),!0)})},function(e){return q.some(ev.response(q.none(),!0))})}};return iv.isDown(f)&&d?n([kw(1,0)]):iv.isUp(f)&&d?n([kw(-1,0)]):s.isBackward(f)&&d?n([kw(0,-1),kw(-1,0)]):s.isForward(f)&&d?n([kw(0,1),kw(1,0)]):iv.isNavigation(f)&&!1===d?i:q.none})()},keyup:function(e,o,i,u,a){return bu.retrieve(t,r.selectedSelector()).fold(function(){var c=e.raw().which;return 0==(!0===e.raw().shiftKey)?q.none():iv.isNavigation(c)?Rv.sync(t,n,o,i,u,a,r.selectRange):q.none()},q.none)}}},Iw={mouse:Pw,keyboard:Bw},Ww=function(e,t){Q(t,function(t){Ul.add(e,t)})},Mw=function(e,t){Q(t,function(t){Ul.remove(e,t)})},Lw=function(e,t){Q(t,function(t){Ul.toggle(e,t)})},_w=function(e,t){return le(t,function(t){return Ul.has(e,t)})},Fw=function(e,t){return J(t,function(t){return Ul.has(e,t)})},qw=function(e){for(var t=e.dom().classList,n=new Array(t.length),r=0;r<t.length;r++)n[r]=t.item(r);return n},Hw=function(e){return Ll.supports(e)?qw(e):Ll.get(e)},jw={add:Ww,remove:Mw,toggle:Lw,hasAll:_w,hasAny:Fw,get:Hw},zw=function(e){return function(t){Ul.add(t,e)}},Uw=function(e){return function(t){Ul.remove(t,e)}},Vw=function(e){return function(t){jw.remove(t,e)}},Gw=function(e){return function(t){return Ul.has(t,e)}},Yw={addClass:zw,removeClass:Uw,removeClasses:Vw,hasClass:Gw},Xw=function(e){var t=Yw.addClass(e.selected()),n=Yw.removeClasses([e.selected(),e.lastSelected(),e.firstSelected()]),r=function(t){var r=or.descendants(t,e.selectedSelector());Q(r,n)};return{clear:r,selectRange:function(n,o,i,u){r(n),Q(o,t),Ul.add(i,e.firstSelected()),Ul.add(u,e.lastSelected())},selectedSelector:e.selectedSelector,firstSelectedSelector:e.firstSelectedSelector,lastSelectedSelector:e.lastSelectedSelector}},Kw=function(e){var t=function(t){jn.remove(t,e.selected()),jn.remove(t,e.firstSelected()),jn.remove(t,e.lastSelected())},n=function(t){jn.set(t,e.selected(),"1")},r=function(n){var r=or.descendants(n,e.selectedSelector());Q(r,t)};return{clear:r,selectRange:function(t,o,i,u){r(t),Q(o,n),jn.set(i,e.firstSelected(),"1"),jn.set(u,e.lastSelected(),"1")},selectedSelector:e.selectedSelector,firstSelectedSelector:e.firstSelectedSelector,lastSelectedSelector:e.lastSelectedSelector}},Jw={byClass:Xw,byAttr:Kw},$w=function(e){return!1===Ul.has(Ue.fromDom(e.target),"ephox-snooker-resizer-bar")},Qw=function(e){return{get:function(){var t=wd(e);return xu.retrieve(t,Ru.selectedSelector()).fold(function(){return void 0===e.selection.getStart()?Du.none():Du.single(e.selection)},function(e){return Du.multiple(e)})}}},Zw=am.each,ey=function(e){function t(t){return function(){e.execCommand(t)}}var n=[];Zw("inserttable tableprops deletetable | cell row column".split(" "),function(t){"|"===t?n.push({text:"-"}):n.push(e.menuItems[t])}),e.addButton("table",{type:"menubutton",title:"Table",menu:n}),e.addButton("tableprops",{title:"Table properties",onclick:t("mceTableProps"),icon:"table"}),e.addButton("tabledelete",{title:"Delete table",onclick:t("mceTableDelete")}),e.addButton("tablecellprops",{title:"Cell properties",onclick:t("mceTableCellProps")}),e.addButton("tablemergecells",{title:"Merge cells",onclick:t("mceTableMergeCells")}),e.addButton("tablesplitcells",{title:"Split cell",onclick:t("mceTableSplitCells")}),e.addButton("tableinsertrowbefore",{title:"Insert row before",onclick:t("mceTableInsertRowBefore")}),e.addButton("tableinsertrowafter",{title:"Insert row after",onclick:t("mceTableInsertRowAfter")}),e.addButton("tabledeleterow",{title:"Delete row",onclick:t("mceTableDeleteRow")}),e.addButton("tablerowprops",{title:"Row properties",onclick:t("mceTableRowProps")}),e.addButton("tablecutrow",{title:"Cut row",onclick:t("mceTableCutRow")}),e.addButton("tablecopyrow",{title:"Copy row",onclick:t("mceTableCopyRow")}),e.addButton("tablepasterowbefore",{title:"Paste row before",onclick:t("mceTablePasteRowBefore")}),e.addButton("tablepasterowafter",{title:"Paste row after",onclick:t("mceTablePasteRowAfter")}),e.addButton("tableinsertcolbefore",{title:"Insert column before",onclick:t("mceTableInsertColBefore")}),e.addButton("tableinsertcolafter",{title:"Insert column after",onclick:t("mceTableInsertColAfter")}),e.addButton("tabledeletecol",{title:"Delete column",onclick:t("mceTableDeleteCol")})},ty=function(e){var t=function(t){return e.dom.is(t,"table")&&e.getBody().contains(t)},n=Zd(e);n.length>0&&e.addContextToolbar(t,n.join(" "))},ny={addButtons:ey,addToolbars:ty},ry=function(e,t){function n(t){return function(){e.execCommand(t)}}var r=q.none(),o=[],i=[],u=[],a=[],c=function(e){e.disabled(!0)},l=function(e){e.disabled(!1)},s=function(){var e=this;o.push(e),r.fold(function(){c(e)},function(t){l(e)})},f=function(){var e=this;i.push(e),r.fold(function(){c(e)},function(t){l(e)})},d=function(){var e=this;u.push(e),r.fold(function(){c(e)},function(t){e.disabled(t.mergable().isNone())})},m=function(){var e=this;a.push(e),r.fold(function(){c(e)},function(t){e.disabled(t.unmergable().isNone())})},g=function(){r.fold(function(){Q(o,c),Q(i,c),Q(u,c),Q(a,c)},function(e){Q(o,l),Q(i,l),Q(u,function(t){t.disabled(e.mergable().isNone())}),Q(a,function(t){t.disabled(e.unmergable().isNone())})})};e.on("init",function(){e.on("nodechange",function(n){var o=q.from(e.dom.getParent(e.selection.getStart(),"th,td"));r=o.bind(function(e){var n=Ue.fromDom(e);return Pr.table(n).map(function(e){return _u.forMenu(t,e,n)})}),g()})});var p=function(e,t,n,r){var o,i,u,a,c,l=r.getEl().getElementsByTagName("table")[0],s=r.isRtl()||"tl-tr"===r.parent().rel;for(l.nextSibling.innerHTML=t+1+" x "+(n+1),s&&(t=9-t),i=0;i<10;i++)for(o=0;o<10;o++)a=l.rows[i].childNodes[o].firstChild,c=(s?o>=t:o<=t)&&i<=n,e.dom.toggleClass(a,"mce-active",c),c&&(u=a);return u.parentNode},h=!1===Ud(e)?{text:"Table",icon:"table",context:"table",onclick:n("mceInsertTable")}:{text:"Table",icon:"table",context:"table",ariaHideMenu:!0,onclick:function(t){t.aria&&(this.parent().hideAll(),t.stopImmediatePropagation(),e.execCommand("mceInsertTable"))},onshow:function(){p(e,0,0,this.menu.items()[0])},onhide:function(){var t=this.menu.items()[0].getEl().getElementsByTagName("a");e.dom.removeClass(t,"mce-active"),e.dom.addClass(t[0],"mce-active")},menu:[{type:"container",html:function(){var e="";e='<table role="grid" class="mce-grid mce-grid-border" aria-readonly="true">';for(var t=0;t<10;t++){e+="<tr>";for(var n=0;n<10;n++)e+='<td role="gridcell" tabindex="-1"><a id="mcegrid'+(10*t+n)+'" href="#" data-mce-x="'+n+'" data-mce-y="'+t+'"></a></td>';e+="</tr>"}return e+="</table>",e+='<div class="mce-text-center" role="presentation">1 x 1</div>'}(),onPostRender:function(){this.lastX=this.lastY=0},onmousemove:function(t){var n,r,o=t.target;"A"===o.tagName.toUpperCase()&&(n=parseInt(o.getAttribute("data-mce-x"),10),r=parseInt(o.getAttribute("data-mce-y"),10),(this.isRtl()||"tl-tr"===this.parent().rel)&&(n=9-n),n===this.lastX&&r===this.lastY||(p(e,n,r,t.control),this.lastX=n,this.lastY=r))},onclick:function(t){var n=this;"A"===t.target.tagName.toUpperCase()&&(t.preventDefault(),t.stopPropagation(),n.parent().cancel(),e.undoManager.transact(function(){Ym.insert(e,n.lastX+1,n.lastY+1)}),e.addVisual())}}]},v={text:"Table properties",context:"table",onPostRender:s,onclick:n("mceTableProps")},b={text:"Delete table",context:"table",onPostRender:s,cmd:"mceTableDelete"},w={text:"Row",context:"table",menu:[{text:"Insert row before",onclick:n("mceTableInsertRowBefore"),onPostRender:f},{text:"Insert row after",onclick:n("mceTableInsertRowAfter"),onPostRender:f},{text:"Delete row",onclick:n("mceTableDeleteRow"),onPostRender:f},{text:"Row properties",onclick:n("mceTableRowProps"),onPostRender:f},{text:"-"},{text:"Cut row",onclick:n("mceTableCutRow"),onPostRender:f},{text:"Copy row",onclick:n("mceTableCopyRow"),onPostRender:f},{text:"Paste row before",onclick:n("mceTablePasteRowBefore"),onPostRender:f},{text:"Paste row after",onclick:n("mceTablePasteRowAfter"),onPostRender:f}]},y={text:"Column",context:"table",menu:[{text:"Insert column before",onclick:n("mceTableInsertColBefore"),onPostRender:f},{text:"Insert column after",onclick:n("mceTableInsertColAfter"),onPostRender:f},{text:"Delete column",onclick:n("mceTableDeleteCol"),onPostRender:f}]},x={separator:"before",text:"Cell",context:"table",menu:[{text:"Cell properties",onclick:n("mceTableCellProps"),onPostRender:f},{text:"Merge cells",onclick:n("mceTableMergeCells"),onPostRender:d},{text:"Split cell",onclick:n("mceTableSplitCells"),onPostRender:m}]};e.addMenuItem("inserttable",h),e.addMenuItem("tableprops",v),e.addMenuItem("deletetable",b),e.addMenuItem("row",w),e.addMenuItem("column",y),e.addMenuItem("cell",x)},oy={addMenuItems:ry},iy=function(e){return e.get().fold(function(){},function(e){return $(e,function(e){return e.dom()})})},uy=function(e,t){var n=$(e,Ue.fromDom);t.set(q.from(n))},ay=function(e,t){return{insertTable:function(t,n){return Ym.insert(e,t,n)},setClipboardRows:function(e){return uy(e,t)},getClipboardRows:function(){return iy(t)}}};R.add("table",x)}()}();