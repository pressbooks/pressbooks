!function(){!function(){"use strict";function t(e,n,r,o){if("TD"===n.tagName||"TH"===n.tagName)e.setStyle(n,r,o);else if(n.children)for(var i=0;i<n.children.length;i++)t(e,n.children[i],r,o)}function e(t,e,n){function r(t,e,n){n&&u.setAttrib(t,e,n)}function o(t,e,n){n&&u.setStyle(t,e,n)}var i,u=t.dom;Vm.updateStyleField(t,n),i=n.control.rootControl.toJSON(),t.undoManager.transact(function(){Im.each(e,function(n){r(n,"scope",i.scope),r(n,"style",i.style),r(n,"class",i.class),o(n,"height",Cm.addSizeSuffix(i.height)),i.type!==n.parentNode.nodeName.toLowerCase()&&Qm(t.dom,n,i.type),1===e.length&&qm.unApplyAlign(t,n),i.align&&qm.applyAlign(t,n,i.align)}),t.focus()})}function n(t){var e=this,n=pp(t),r=yy(t,n.lazyResize),o=Om(t,n.lazyWire),i=xy(t);fg.registerCommands(t,o,r,i),ha.registerEvents(t,i,o,r),Dy.addMenuItems(t,i),Ty.addButtons(t),Ty.addToolbars(t),t.on("PreInit",function(){t.serializer.addTempAttr(Ju.firstSelected()),t.serializer.addTempAttr(Ju.lastSelected())}),!1!==t.settings.table_tab_navigation&&t.on("keydown",function(e){wv.handle(e,t,o,n.lazyWire)}),t.on("remove",function(){n.destroy(),r.destroy()}),e.insertTable=function(e,n){return Ba.insert(t,e,n)},e.setClipboardRows=fg.setClipboardRows,e.getClipboardRows=fg.getClipboardRows}var r=tinymce.util.Tools.resolve("tinymce.PluginManager"),o=function(){},i=function(t){return function(){return t()}},u=function(t,e){return function(){return t(e.apply(null,arguments))}},a=function(t){return function(){return t}},c=function(t){return t},l=function(t,e){return t===e},s=function(t){for(var e=new Array(arguments.length-1),n=1;n<arguments.length;n++)e[n-1]=arguments[n];return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];var o=e.concat(n);return t.apply(null,o)}},f=function(t){return function(){return!t.apply(null,arguments)}},d=function(t){return function(){throw new Error(t)}},m=function(t){return t()},g=function(t){t()},p=a(!1),h=a(!0),v={noop:o,noarg:i,compose:u,constant:a,identity:c,tripleEquals:l,curry:s,not:f,die:d,apply:m,call:g,never:p,always:h},b=v.never,w=v.always,y=function(){return x},x=function(){var t=function(t){return t.isNone()},e=function(t){return t()},n=function(t){return t},r=function(){},o={fold:function(t,e){return t()},is:b,isSome:b,isNone:w,getOr:n,getOrThunk:e,getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},or:n,orThunk:e,map:y,ap:y,each:r,bind:y,flatten:y,exists:b,forall:w,filter:y,equals:t,equals_:t,toArray:function(){return[]},toString:v.constant("none()")};return Object.freeze&&Object.freeze(o),o}(),C=function(t){var e=function(){return t},n=function(){return i},r=function(e){return C(e(t))},o=function(e){return e(t)},i={fold:function(e,n){return n(t)},is:function(e){return t===e},isSome:w,isNone:b,getOr:e,getOrThunk:e,getOrDie:e,or:n,orThunk:n,map:r,ap:function(e){return e.fold(y,function(e){return C(e(t))})},each:function(e){e(t)},bind:o,flatten:e,exists:o,forall:o,filter:function(e){return e(t)?i:x},equals:function(e){return e.is(t)},equals_:function(e,n){return e.fold(b,function(e){return n(t,e)})},toArray:function(){return[t]},toString:function(){return"some("+t+")"}};return i},S=function(t){return null===t||void 0===t?x:C(t)},R={some:C,none:y,from:S},T=function(){var t=Array.prototype.indexOf,e=function(e,n){return t.call(e,n)},n=function(t,e){return z(t,e)};return void 0===t?n:e}(),A=function(t,e){var n=T(t,e);return-1===n?R.none():R.some(n)},D=function(t,e){return T(t,e)>-1},E=function(t,e){return q(t,e).isSome()},k=function(t,e){for(var n=[],r=0;r<t;r++)n.push(e(r));return n},O=function(t,e){for(var n=[],r=0;r<t.length;r+=e){var o=t.slice(r,r+e);n.push(o)}return n},N=function(t,e){for(var n=t.length,r=new Array(n),o=0;o<n;o++){var i=t[o];r[o]=e(i,o,t)}return r},B=function(t,e){for(var n=0,r=t.length;n<r;n++){e(t[n],n,t)}},I=function(t,e){for(var n=t.length-1;n>=0;n--){e(t[n],n,t)}},P=function(t,e){for(var n=[],r=[],o=0,i=t.length;o<i;o++){var u=t[o];(e(u,o,t)?n:r).push(u)}return{pass:n,fail:r}},W=function(t,e){for(var n=[],r=0,o=t.length;r<o;r++){var i=t[r];e(i,r,t)&&n.push(i)}return n},M=function(t,e){if(0===t.length)return[];for(var n=e(t[0]),r=[],o=[],i=0,u=t.length;i<u;i++){var a=t[i],c=e(a);c!==n&&(r.push(o),o=[]),n=c,o.push(a)}return 0!==o.length&&r.push(o),r},_=function(t,e,n){return I(t,function(t){n=e(n,t)}),n},L=function(t,e,n){return B(t,function(t){n=e(n,t)}),n},F=function(t,e){for(var n=0,r=t.length;n<r;n++){var o=t[n];if(e(o,n,t))return R.some(o)}return R.none()},q=function(t,e){for(var n=0,r=t.length;n<r;n++){if(e(t[n],n,t))return R.some(n)}return R.none()},z=function(t,e){for(var n=0,r=t.length;n<r;++n)if(t[n]===e)return n;return-1},H=Array.prototype.push,j=function(t){for(var e=[],n=0,r=t.length;n<r;++n){if(!Array.prototype.isPrototypeOf(t[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+t);H.apply(e,t[n])}return e},U=function(t,e){var n=N(t,e);return j(n)},V=function(t,e){for(var n=0,r=t.length;n<r;++n){if(!0!==e(t[n],n,t))return!1}return!0},G=function(t,e){return t.length===e.length&&V(t,function(t,n){return t===e[n]})},Y=Array.prototype.slice,X=function(t){var e=Y.call(t,0);return e.reverse(),e},$=function(t,e){return W(t,function(t){return!D(e,t)})},K=function(t,e){for(var n={},r=0,o=t.length;r<o;r++){var i=t[r];n[String(i)]=e(i,r)}return n},J=function(t){return[t]},Q=function(t,e){var n=Y.call(t,0);return n.sort(e),n},Z=function(t){return 0===t.length?R.none():R.some(t[0])},tt=function(t){return 0===t.length?R.none():R.some(t[t.length-1])},et={map:N,each:B,eachr:I,partition:P,filter:W,groupBy:M,indexOf:A,foldr:_,foldl:L,find:F,findIndex:q,flatten:j,bind:U,forall:V,exists:E,contains:D,equal:G,reverse:X,chunk:O,difference:$,mapToObject:K,pure:J,sort:Q,range:k,head:Z,last:tt},nt=function(){var t=Object.keys,e=function(t){var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(n);return e};return void 0===t?e:t}(),rt=function(t,e){for(var n=nt(t),r=0,o=n.length;r<o;r++){var i=n[r];e(t[i],i,t)}},ot=function(t,e){return it(t,function(t,n,r){return{k:n,v:e(t,n,r)}})},it=function(t,e){var n={};return rt(t,function(r,o){var i=e(r,o,t);n[i.k]=i.v}),n},ut=function(t,e){var n={},r={};return rt(t,function(t,o){(e(t,o)?n:r)[o]=t}),{t:n,f:r}},at=function(t,e){var n=[];return rt(t,function(t,r){n.push(e(t,r))}),n},ct=function(t,e){for(var n=nt(t),r=0,o=n.length;r<o;r++){var i=n[r],u=t[i];if(e(u,i,t))return R.some(u)}return R.none()},lt=function(t){return at(t,function(t){return t})},st=function(t){return lt(t).length},ft={bifilter:ut,each:rt,map:ot,mapToArray:at,tupleMap:it,find:ct,keys:nt,values:lt,size:st},dt=function(){var t=arguments;return function(){for(var e=new Array(arguments.length),n=0;n<e.length;n++)e[n]=arguments[n];if(t.length!==e.length)throw new Error('Wrong number of arguments to struct. Expected "['+t.length+']", got '+e.length+" arguments");var r={};return et.each(t,function(t,n){r[t]=v.constant(e[n])}),r}},mt=function(t){if(null===t)return"null";var e=typeof t;return"object"===e&&Array.prototype.isPrototypeOf(t)?"array":"object"===e&&String.prototype.isPrototypeOf(t)?"string":e},gt=function(t){return function(e){return mt(e)===t}},pt={isString:gt("string"),isObject:gt("object"),isArray:gt("array"),isNull:gt("null"),isBoolean:gt("boolean"),isUndefined:gt("undefined"),isFunction:gt("function"),isNumber:gt("number")},ht=function(t){return t.slice(0).sort()},vt=function(t,e){throw new Error("All required keys ("+ht(t).join(", ")+") were not specified. Specified keys were: "+ht(e).join(", ")+".")},bt=function(t){throw new Error("Unsupported keys for object: "+ht(t).join(", "))},wt=function(t,e){if(!pt.isArray(e))throw new Error("The "+t+" fields must be an array. Was: "+e+".");et.each(e,function(e){if(!pt.isString(e))throw new Error("The value "+e+" in the "+t+" fields was not a string.")})},yt=function(t,e){throw new Error("All values need to be of type: "+e+". Keys ("+ht(t).join(", ")+") were not.")},xt=function(t){var e=ht(t);et.find(e,function(t,n){return n<e.length-1&&t===e[n+1]}).each(function(t){throw new Error("The field: "+t+" occurs more than once in the combined fields: ["+e.join(", ")+"].")})},Ct={sort:ht,reqMessage:vt,unsuppMessage:bt,validateStrArr:wt,invalidTypeMessage:yt,checkDupes:xt},St=function(t,e){var n=t.concat(e);if(0===n.length)throw new Error("You must specify at least one required or optional field.");return Ct.validateStrArr("required",t),Ct.validateStrArr("optional",e),Ct.checkDupes(n),function(r){var o=ft.keys(r);et.forall(t,function(t){return et.contains(o,t)})||Ct.reqMessage(t,o);var i=et.filter(o,function(t){return!et.contains(n,t)});i.length>0&&Ct.unsuppMessage(i);var u={};return et.each(t,function(t){u[t]=v.constant(r[t])}),et.each(e,function(t){u[t]=v.constant(Object.prototype.hasOwnProperty.call(r,t)?R.some(r[t]):R.none())}),u}},Rt={immutable:dt,immutableBag:St},Tt=Rt.immutable("width","height"),At=Rt.immutable("rows","columns"),Dt=Rt.immutable("row","column"),Et=Rt.immutable("x","y"),kt=Rt.immutable("element","rowspan","colspan"),Ot=Rt.immutable("element","rowspan","colspan","isNew"),Nt=Rt.immutable("element","rowspan","colspan","row","column"),Bt=Rt.immutable("element","cells","section"),It=Rt.immutable("element","isNew"),Pt=Rt.immutable("element","cells","section","isNew"),Wt=Rt.immutable("cells","section"),Mt=Rt.immutable("details","section"),_t=Rt.immutable("startRow","startCol","finishRow","finishCol"),Lt={dimensions:Tt,grid:At,address:Dt,coords:Et,extended:Nt,detail:kt,detailnew:Ot,rowdata:Bt,elementnew:It,rowdatanew:Pt,rowcells:Wt,rowdetails:Mt,bounds:_t},Ft=function(t,e){var n=e||document,r=n.createElement("div");if(r.innerHTML=t,!r.hasChildNodes()||r.childNodes.length>1)throw console.error("HTML does not have a single root node",t),"HTML must have a single root node";return Ht(r.childNodes[0])},qt=function(t,e){var n=e||document,r=n.createElement(t);return Ht(r)},zt=function(t,e){var n=e||document,r=n.createTextNode(t);return Ht(r)},Ht=function(t){if(null===t||void 0===t)throw new Error("Node cannot be null or undefined");return{dom:v.constant(t)}},jt=function(t,e,n){return R.from(t.dom().elementFromPoint(e,n)).map(Ht)},Ut={fromHtml:Ft,fromTag:qt,fromText:zt,fromDom:Ht,fromPoint:jt},Vt={ATTRIBUTE:2,CDATA_SECTION:4,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,ELEMENT:1,TEXT:3,PROCESSING_INSTRUCTION:7,ENTITY_REFERENCE:5,ENTITY:6,NOTATION:12},Gt=Vt.ELEMENT,Yt=Vt.DOCUMENT,Xt=function(t,e){var n=t.dom();if(n.nodeType!==Gt)return!1;if(void 0!==n.matches)return n.matches(e);if(void 0!==n.msMatchesSelector)return n.msMatchesSelector(e);if(void 0!==n.webkitMatchesSelector)return n.webkitMatchesSelector(e);if(void 0!==n.mozMatchesSelector)return n.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")},$t=function(t){return t.nodeType!==Gt&&t.nodeType!==Yt||0===t.childElementCount},Kt=function(t,e){var n=void 0===e?document:e.dom();return $t(n)?[]:et.map(n.querySelectorAll(t),Ut.fromDom)},Jt=function(t,e){var n=void 0===e?document:e.dom();return $t(n)?R.none():R.from(n.querySelector(t)).map(Ut.fromDom)},Qt={all:Kt,is:Xt,one:Jt},Zt=function(t,e){var n=[],r=function(t){return n.push(t),e(t)},o=e(t);do{o=o.bind(r)}while(o.isSome());return n},te={toArray:Zt},ee="undefined"!=typeof window?window:Function("return this;")(),ne=function(t,e){for(var n=void 0!==e&&null!==e?e:ee,r=0;r<t.length&&void 0!==n&&null!==n;++r)n=n[t[r]];return n},re=function(t,e){var n=t.split(".");return ne(n,e)},oe=function(t,e){return void 0!==t[e]&&null!==t[e]||(t[e]={}),t[e]},ie=function(t,e){for(var n=void 0!==e?e:ee,r=0;r<t.length;++r)n=oe(n,t[r]);return n},ue=function(t,e){var n=t.split(".");return ie(n,e)},ae={path:ne,resolve:re,forge:ie,namespace:ue},ce=function(t,e){return ae.resolve(t,e)},le=function(t,e){var n=ce(t,e);if(void 0===n||null===n)throw t+" not available on this browser";return n},se={getOrDie:le},fe=function(){return se.getOrDie("Node")},de=function(t,e,n){return 0!=(t.compareDocumentPosition(e)&n)},me=function(t,e){return de(t,e,fe().DOCUMENT_POSITION_PRECEDING)},ge=function(t,e){return de(t,e,fe().DOCUMENT_POSITION_CONTAINED_BY)},pe={documentPositionPreceding:me,documentPositionContainedBy:ge},he=function(t){var e,n=!1;return function(){return n||(n=!0,e=t.apply(null,arguments)),e}},ve={cached:he},be=function(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(r.test(e))return r}},we=function(t,e){var n=be(t,e);if(!n)return{major:0,minor:0};var r=function(t){return Number(e.replace(n,"$"+t))};return Ce(r(1),r(2))},ye=function(t,e){var n=String(e).toLowerCase();return 0===t.length?xe():we(t,n)},xe=function(){return Ce(0,0)},Ce=function(t,e){return{major:t,minor:e}},Se={nu:Ce,detect:ye,unknown:xe},Re=function(t,e){return function(){return e===t}},Te=function(){return Ae({current:void 0,version:Se.unknown()})},Ae=function(t){var e=t.current;return{current:e,version:t.version,isEdge:Re("Edge",e),isChrome:Re("Chrome",e),isIE:Re("IE",e),isOpera:Re("Opera",e),isFirefox:Re("Firefox",e),isSafari:Re("Safari",e)}},De={unknown:Te,nu:Ae,edge:v.constant("Edge"),chrome:v.constant("Chrome"),ie:v.constant("IE"),opera:v.constant("Opera"),firefox:v.constant("Firefox"),safari:v.constant("Safari")},Ee=function(t,e){return function(){return e===t}},ke=function(){return Oe({current:void 0,version:Se.unknown()})},Oe=function(t){var e=t.current;return{current:e,version:t.version,isWindows:Ee("Windows",e),isiOS:Ee("iOS",e),isAndroid:Ee("Android",e),isOSX:Ee("OSX",e),isLinux:Ee("Linux",e),isSolaris:Ee("Solaris",e),isFreeBSD:Ee("FreeBSD",e)}},Ne={unknown:ke,nu:Oe,windows:v.constant("Windows"),ios:v.constant("iOS"),android:v.constant("Android"),linux:v.constant("Linux"),osx:v.constant("OSX"),solaris:v.constant("Solaris"),freebsd:v.constant("FreeBSD")},Be=function(t,e,n){var r=t.isiOS()&&!0===/ipad/i.test(n),o=t.isiOS()&&!r,i=t.isAndroid()&&3===t.version.major,u=t.isAndroid()&&4===t.version.major,a=r||i||u&&!0===/mobile/i.test(n),c=t.isiOS()||t.isAndroid(),l=c&&!a,s=e.isSafari()&&t.isiOS()&&!1===/safari/i.test(n);return{isiPad:v.constant(r),isiPhone:v.constant(o),isTablet:v.constant(a),isPhone:v.constant(l),isTouch:v.constant(c),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:v.constant(s)}},Ie=function(t,e){var n=String(e).toLowerCase();return et.find(t,function(t){return t.search(n)})},Pe=function(t,e){return Ie(t,e).map(function(t){var n=Se.detect(t.versionRegexes,e);return{current:t.name,version:n}})},We=function(t,e){return Ie(t,e).map(function(t){var n=Se.detect(t.versionRegexes,e);return{current:t.name,version:n}})},Me={detectBrowser:Pe,detectOs:We},_e=function(t,e){return e+t},Le=function(t,e){return t+e},Fe=function(t,e){return t.substring(e)},qe=function(t,e){return t.substring(0,t.length-e)},ze={addToStart:_e,addToEnd:Le,removeFromStart:Fe,removeFromEnd:qe},He=function(t,e){return t.substr(0,e)},je=function(t,e){return t.substr(t.length-e,t.length)},Ue=function(t){return""===t?R.none():R.some(t.substr(0,1))},Ve=function(t){return""===t?R.none():R.some(t.substring(1))},Ge={first:He,last:je,head:Ue,tail:Ve},Ye=function(t,e,n){return""===e||!(t.length<e.length)&&t.substr(n,n+e.length)===e},Xe=function(t,e){var n=function(t){var e=typeof t;return"string"===e||"number"===e};return t.replace(/\${([^{}]*)}/g,function(t,r){var o=e[r];return n(o)?o:t})},$e=function(t,e){return en(t,e)?ze.removeFromStart(t,e.length):t},Ke=function(t,e){return nn(t,e)?ze.removeFromEnd(t,e.length):t},Je=function(t,e){return en(t,e)?t:ze.addToStart(t,e)},Qe=function(t,e){return nn(t,e)?t:ze.addToEnd(t,e)},Ze=function(t,e){return-1!==t.indexOf(e)},tn=function(t){return Ge.head(t).bind(function(e){return Ge.tail(t).map(function(t){return e.toUpperCase()+t})}).getOr(t)},en=function(t,e){return Ye(t,e,0)},nn=function(t,e){return Ye(t,e,t.length-e.length)},rn=function(t){return t.replace(/^\s+|\s+$/g,"")},on=function(t){return t.replace(/^\s+/g,"")},un=function(t){return t.replace(/\s+$/g,"")},an={supplant:Xe,startsWith:en,removeLeading:$e,removeTrailing:Ke,ensureLeading:Je,ensureTrailing:Qe,endsWith:nn,contains:Ze,trim:rn,lTrim:on,rTrim:un,capitalize:tn},cn=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,ln=function(t){return function(e){return an.contains(e,t)}},sn=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return an.contains(t,"edge/")&&an.contains(t,"chrome")&&an.contains(t,"safari")&&an.contains(t,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,cn],search:function(t){return an.contains(t,"chrome")&&!an.contains(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return an.contains(t,"msie")||an.contains(t,"trident")}},{name:"Opera",versionRegexes:[cn,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:ln("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:ln("firefox")},{name:"Safari",versionRegexes:[cn,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return(an.contains(t,"safari")||an.contains(t,"mobile/"))&&an.contains(t,"applewebkit")}}],fn=[{name:"Windows",search:ln("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return an.contains(t,"iphone")||an.contains(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:ln("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:ln("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:ln("linux"),versionRegexes:[]},{name:"Solaris",search:ln("sunos"),versionRegexes:[]},{name:"FreeBSD",search:ln("freebsd"),versionRegexes:[]}],dn={browsers:v.constant(sn),oses:v.constant(fn)},mn=function(t){var e=dn.browsers(),n=dn.oses(),r=Me.detectBrowser(e,t).fold(De.unknown,De.nu),o=Me.detectOs(n,t).fold(Ne.unknown,Ne.nu);return{browser:r,os:o,deviceType:Be(o,r,t)}},gn={detect:mn},pn=ve.cached(function(){var t=navigator.userAgent;return gn.detect(t)}),hn={detect:pn},vn=function(t,e){return t.dom()===e.dom()},bn=function(t,e){return t.dom().isEqualNode(e.dom())},wn=function(t,e){return et.exists(e,v.curry(vn,t))},yn=function(t,e){var n=t.dom(),r=e.dom();return n!==r&&n.contains(r)},xn=function(t,e){return pe.documentPositionContainedBy(t.dom(),e.dom())},Cn=hn.detect().browser,Sn=Cn.isIE()?xn:yn,Rn={eq:vn,isEqualNode:bn,member:wn,contains:Sn,is:Qt.is},Tn=function(t){return Ut.fromDom(t.dom().ownerDocument)},An=function(t){var e=Tn(t);return Ut.fromDom(e.dom().documentElement)},Dn=function(t){var e=t.dom(),n=e.ownerDocument.defaultView;return Ut.fromDom(n)},En=function(t){var e=t.dom();return R.from(e.parentNode).map(Ut.fromDom)},kn=function(t){return En(t).bind(function(e){var n=_n(e);return et.findIndex(n,function(e){return Rn.eq(t,e)})})},On=function(t,e){for(var n=pt.isFunction(e)?e:v.constant(!1),r=t.dom(),o=[];null!==r.parentNode&&void 0!==r.parentNode;){var i=r.parentNode,u=Ut.fromDom(i);if(o.push(u),!0===n(u))break;r=i}return o},Nn=function(t){var e=function(e){return et.filter(e,function(e){return!Rn.eq(t,e)})};return En(t).map(_n).map(e).getOr([])},Bn=function(t){var e=t.dom();return R.from(e.offsetParent).map(Ut.fromDom)},In=function(t){var e=t.dom();return R.from(e.previousSibling).map(Ut.fromDom)},Pn=function(t){var e=t.dom();return R.from(e.nextSibling).map(Ut.fromDom)},Wn=function(t){return et.reverse(te.toArray(t,In))},Mn=function(t){return te.toArray(t,Pn)},_n=function(t){var e=t.dom();return et.map(e.childNodes,Ut.fromDom)},Ln=function(t,e){var n=t.dom().childNodes;return R.from(n[e]).map(Ut.fromDom)},Fn=function(t){return Ln(t,0)},qn=function(t){return Ln(t,t.dom().childNodes.length-1)},zn=function(t){return t.dom().childNodes.length},Hn=function(t){return t.dom().hasChildNodes()},jn=Rt.immutable("element","offset"),Un=function(t,e){var n=_n(t);return n.length>0&&e<n.length?jn(n[e],0):jn(t,e)},Vn={owner:Tn,defaultView:Dn,documentElement:An,parent:En,findIndex:kn,parents:On,siblings:Nn,prevSibling:In,offsetParent:Bn,prevSiblings:Wn,nextSibling:Pn,nextSiblings:Mn,children:_n,child:Ln,firstChild:Fn,lastChild:qn,childNodesCount:zn,hasChildNodes:Hn,leaf:Un},Gn=function(t,e){return Yn(t,e,v.constant(!0))},Yn=function(t,e,n){return et.bind(Vn.children(t),function(t){return Qt.is(t,e)?n(t)?[t]:[]:Yn(t,e,n)})},Xn={firstLayer:Gn,filterFirstLayer:Yn},$n=function(t){return t.dom().nodeName.toLowerCase()},Kn=function(t){return t.dom().nodeType},Jn=function(t){return t.dom().nodeValue},Qn=function(t){return function(e){return Kn(e)===t}},Zn=function(t){return Kn(t)===Vt.COMMENT||"#comment"===$n(t)},tr=Qn(Vt.ELEMENT),er=Qn(Vt.TEXT),nr=Qn(Vt.DOCUMENT),rr={name:$n,type:Kn,value:Jn,isElement:tr,isText:er,isDocument:nr,isComment:Zn},or=function(t,e,n){if(!(pt.isString(n)||pt.isBoolean(n)||pt.isNumber(n)))throw console.error("Invalid call to Attr.set. Key ",e,":: Value ",n,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(e,n+"")},ir=function(t,e,n){or(t.dom(),e,n)},ur=function(t,e){var n=t.dom();ft.each(e,function(t,e){or(n,e,t)})},ar=function(t,e){var n=t.dom().getAttribute(e);return null===n?void 0:n},cr=function(t,e){var n=t.dom();return!(!n||!n.hasAttribute)&&n.hasAttribute(e)},lr=function(t,e){t.dom().removeAttribute(e)},sr=function(t){var e=t.dom().attributes;return void 0===e||null===e||0===e.length},fr=function(t){return et.foldl(t.dom().attributes,function(t,e){return t[e.name]=e.value,t},{})},dr=function(t,e,n){cr(t,n)&&!cr(e,n)&&ir(e,n,ar(t,n))},mr=function(t,e,n){rr.isElement(t)&&rr.isElement(e)&&et.each(n,function(n){dr(t,e,n)})},gr={clone:fr,set:ir,setAll:ur,get:ar,has:cr,remove:lr,hasNone:sr,transfer:mr},pr=function(t){var e=rr.isText(t)?t.dom().parentNode:t.dom();return void 0!==e&&null!==e&&e.ownerDocument.body.contains(e)},hr=ve.cached(function(){return vr(Ut.fromDom(document))}),vr=function(t){var e=t.dom().body;if(null===e||void 0===e)throw"Body is not available yet";return Ut.fromDom(e)},br={body:hr,getBody:vr,inBody:pr},wr=function(t){return Sr(br.body(),t)},yr=function(t,e,n){return et.filter(Vn.parents(t,n),e)},xr=function(t,e){return et.filter(Vn.siblings(t),e)},Cr=function(t,e){return et.filter(Vn.children(t),e)},Sr=function(t,e){var n=[];return et.each(Vn.children(t),function(t){e(t)&&(n=n.concat([t])),n=n.concat(Sr(t,e))}),n},Rr={all:wr,ancestors:yr,siblings:xr,children:Cr,descendants:Sr},Tr=function(t){return Qt.all(t)},Ar=function(t,e,n){return Rr.ancestors(t,function(t){return Qt.is(t,e)},n)},Dr=function(t,e){return Rr.siblings(t,function(t){return Qt.is(t,e)})},Er=function(t,e){return Rr.children(t,function(t){return Qt.is(t,e)})},kr=function(t,e){return Qt.all(e,t)},Or={all:Tr,ancestors:Ar,siblings:Dr,children:Er,descendants:kr},Nr=function(t,e,n,r,o){return t(n,r)?R.some(n):pt.isFunction(o)&&o(n)?R.none():e(n,r,o)},Br=function(t){return _r(br.body(),t)},Ir=function(t,e,n){for(var r=t.dom(),o=pt.isFunction(n)?n:v.constant(!1);r.parentNode;){r=r.parentNode;var i=Ut.fromDom(r);if(e(i))return R.some(i);if(o(i))break}return R.none()},Pr=function(t,e,n){return Nr(function(t){return e(t)},Ir,t,e,n)},Wr=function(t,e){var n=t.dom();return n.parentNode?Mr(Ut.fromDom(n.parentNode),function(n){return!Rn.eq(t,n)&&e(n)}):R.none()},Mr=function(t,e){return et.find(t.dom().childNodes,v.compose(e,Ut.fromDom)).map(Ut.fromDom)},_r=function(t,e){var n=function(t){for(var r=0;r<t.childNodes.length;r++){if(e(Ut.fromDom(t.childNodes[r])))return R.some(Ut.fromDom(t.childNodes[r]));var o=n(t.childNodes[r]);if(o.isSome())return o}return R.none()};return n(t.dom())},Lr={first:Br,ancestor:Ir,closest:Pr,sibling:Wr,child:Mr,descendant:_r},Fr=function(t){return Qt.one(t)},qr=function(t,e,n){return Lr.ancestor(t,function(t){return Qt.is(t,e)},n)},zr=function(t,e){return Lr.sibling(t,function(t){return Qt.is(t,e)})},Hr=function(t,e){return Lr.child(t,function(t){return Qt.is(t,e)})},jr=function(t,e){return Qt.one(e,t)},Ur=function(t,e,n){return Nr(Qt.is,qr,t,e,n)},Vr={first:Fr,ancestor:qr,sibling:zr,child:Hr,descendant:jr,closest:Ur},Gr=function(t,e,n){var r=void 0!==n?n:v.constant(!1);if(r(e))return R.none();if(et.contains(t,rr.name(e)))return R.some(e);var o=function(t){return Qt.is(t,"table")||r(t)};return Vr.ancestor(e,t.join(","),o)},Yr=function(t,e){return Gr(["td","th"],t,e)},Xr=function(t){return Xn.firstLayer(t,"th,td")},$r=function(t,e){return Gr(["caption","tr","tbody","tfoot","thead"],t,e)},Kr=function(t,e){return Vn.parent(e).map(function(e){return Or.children(e,t)})},Jr=v.curry(Kr,"th,td"),Qr=v.curry(Kr,"tr"),Zr=function(t){return Vr.descendant(t,"th,td")},to=function(t,e){return Vr.closest(t,"table",e)},eo=function(t,e){return Gr(["tr"],t,e)},no=function(t){return Xn.firstLayer(t,"tr")},ro=function(t,e){return parseInt(gr.get(t,e),10)},oo=function(t,e,n){var r=ro(t,e),o=ro(t,n);return Lt.grid(r,o)},io={cell:Yr,firstCell:Zr,cells:Xr,neighbourCells:Jr,table:to,row:eo,rows:no,notCell:$r,neighbourRows:Qr,attr:ro,grid:oo},uo=function(t){var e=io.rows(t);return et.map(e,function(t){var e=t,n=Vn.parent(e),r=n.bind(function(t){var e=rr.name(t);return"tfoot"===e||"thead"===e||"tbody"===e?e:"tbody"}),o=et.map(io.cells(t),function(t){var e=gr.has(t,"rowspan")?parseInt(gr.get(t,"rowspan"),10):1,n=gr.has(t,"colspan")?parseInt(gr.get(t,"colspan"),10):1;return Lt.detail(t,e,n)});return Lt.rowdata(e,o,r)})},ao=function(t,e){return et.map(t,function(t){var n=et.map(io.cells(t),function(t){var e=gr.has(t,"rowspan")?parseInt(gr.get(t,"rowspan"),10):1,n=gr.has(t,"colspan")?parseInt(gr.get(t,"colspan"),10):1;return Lt.detail(t,e,n)});return Lt.rowdata(t,n,e.section())})},co={fromTable:uo,fromPastedRows:ao},lo=function(t,e){return t+","+e},so=function(t,e,n){var r=t.access()[lo(e,n)];return void 0!==r?R.some(r):R.none()},fo=function(t,e,n){var r=mo(t,function(t){return n(e,t.element())});return r.length>0?R.some(r[0]):R.none()},mo=function(t,e){var n=et.bind(t.all(),function(t){return t.cells()});return et.filter(n,e)},go=function(t){var e={},n=[],r=t.length,o=0;et.each(t,function(t,r){var i=[];et.each(t.cells(),function(t,n){for(var u=0;void 0!==e[lo(r,u)];)u++;for(var a=Lt.extended(t.element(),t.rowspan(),t.colspan(),r,u),c=0;c<t.colspan();c++)for(var l=0;l<t.rowspan();l++){var s=r+l,f=u+c,d=lo(s,f);e[d]=a,o=Math.max(o,f+1)}i.push(a)}),n.push(Lt.rowdata(t.element(),i,t.section()))});var i=Lt.grid(r,o);return{grid:v.constant(i),access:v.constant(e),all:v.constant(n)}},po=function(t){var e=et.map(t.all(),function(t){return t.cells()});return et.flatten(e)},ho={generate:go,getAt:so,findItem:fo,filterItems:mo,justCells:po},vo=function(t){return void 0!==t.style},bo={isSupported:vo},wo=function(t,e,n){if(!pt.isString(n))throw console.error("Invalid call to CSS.set. Property ",e,":: Value ",n,":: Element ",t),new Error("CSS value must be a string: "+n);bo.isSupported(t)&&t.style.setProperty(e,n)},yo=function(t,e){bo.isSupported(t)&&t.style.removeProperty(e)},xo=function(t,e,n){var r=t.dom();wo(r,e,n)},Co=function(t,e){var n=t.dom();ft.each(e,function(t,e){wo(n,e,t)})},So=function(t,e){var n=t.dom();ft.each(e,function(t,e){t.fold(function(){yo(n,e)},function(t){wo(n,e,t)})})},Ro=function(t,e){var n=t.dom(),r=window.getComputedStyle(n),o=r.getPropertyValue(e),i=""!==o||br.inBody(t)?o:To(n,e);return null===i?void 0:i},To=function(t,e){return bo.isSupported(t)?t.style.getPropertyValue(e):""},Ao=function(t,e){var n=t.dom(),r=To(n,e);return R.from(r).filter(function(t){return t.length>0})},Do=function(t){var e={},n=t.dom();if(bo.isSupported(n))for(var r=0;r<n.style.length;r++){var o=n.style.item(r);e[o]=n.style[o]}return e},Eo=function(t,e,n){var r=Ut.fromTag(t);return xo(r,e,n),Ao(r,e).isSome()},ko=function(t,e){var n=t.dom();yo(n,e),gr.has(t,"style")&&""===an.trim(gr.get(t,"style"))&&gr.remove(t,"style")},Oo=function(t,e){var n=gr.get(t,"style"),r=e(t);return(void 0===n?gr.remove:gr.set)(t,"style",n),r},No=function(t,e){var n=t.dom(),r=e.dom();bo.isSupported(n)&&bo.isSupported(r)&&(r.style.cssText=n.style.cssText)},Bo=function(t){return t.dom().offsetWidth},Io=function(t,e,n){Ao(t,n).each(function(t){Ao(e,n).isNone()&&xo(e,n,t)})},Po=function(t,e,n){rr.isElement(t)&&rr.isElement(e)&&et.each(n,function(n){Io(t,e,n)})},Wo={copy:No,set:xo,preserve:Oo,setAll:Co,setOptions:So,remove:ko,get:Ro,getRaw:Ao,getAllRaw:Do,isValidValue:Eo,reflow:Bo,transfer:Po},Mo=function(t,e){Vn.parent(t).each(function(n){n.dom().insertBefore(e.dom(),t.dom())})},_o=function(t,e){Vn.nextSibling(t).fold(function(){Vn.parent(t).each(function(t){Fo(t,e)})},function(t){Mo(t,e)})},Lo=function(t,e){Vn.firstChild(t).fold(function(){Fo(t,e)},function(n){t.dom().insertBefore(e.dom(),n.dom())})},Fo=function(t,e){t.dom().appendChild(e.dom())},qo=function(t,e,n){Vn.child(t,n).fold(function(){Fo(t,e)},function(t){Mo(t,e)})},zo=function(t,e){Mo(t,e),Fo(e,t)},Ho={before:Mo,after:_o,prepend:Lo,append:Fo,appendAt:qo,wrap:zo},jo=function(t,e){et.each(e,function(e){Ho.before(t,e)})},Uo=function(t,e){et.each(e,function(n,r){var o=0===r?t:e[r-1];Ho.after(o,n)})},Vo=function(t,e){et.each(e.slice().reverse(),function(e){Ho.prepend(t,e)})},Go=function(t,e){et.each(e,function(e){Ho.append(t,e)})},Yo={before:jo,after:Uo,prepend:Vo,append:Go},Xo=function(t){t.dom().textContent="",et.each(Vn.children(t),function(t){$o(t)})},$o=function(t){var e=t.dom();null!==e.parentNode&&e.parentNode.removeChild(e)},Ko=function(t){var e=Vn.children(t);e.length>0&&Yo.before(t,e),$o(t)},Jo={empty:Xo,remove:$o,unwrap:Ko},Qo=Rt.immutable("minRow","minCol","maxRow","maxCol"),Zo=function(t,e){var n=t.grid().columns(),r=t.grid().rows(),o=r,i=n,u=0,a=0;return ft.each(t.access(),function(t){if(e(t)){var n=t.row(),r=n+t.rowspan()-1,c=t.column(),l=c+t.colspan()-1;n<o?o=n:r>u&&(u=r),c<i?i=c:l>a&&(a=l)}}),Qo(o,i,u,a)},ti=function(t,e,n){var r=t[n].element(),o=Ut.fromTag("td");Ho.append(o,Ut.fromTag("br")),(e?Ho.append:Ho.prepend)(r,o)},ei=function(t,e,n,r){for(var o=e.grid().columns(),i=e.grid().rows(),u=0;u<i;u++)for(var a=!1,c=0;c<o;c++)if(!(u<n.minRow()||u>n.maxRow()||c<n.minCol()||c>n.maxCol())){var l=ho.getAt(e,u,c).filter(r).isNone();l?ti(t,a,u):a=!0}},ni=function(t,e){var n=et.filter(Xn.firstLayer(t,"tr"),function(t){return 0===t.dom().childElementCount});et.each(n,Jo.remove),e.minCol()!==e.maxCol()&&e.minRow()!==e.maxRow()||et.each(Xn.firstLayer(t,"th,td"),function(t){gr.remove(t,"rowspan"),gr.remove(t,"colspan")}),gr.remove(t,"width"),gr.remove(t,"height"),Wo.remove(t,"width"),Wo.remove(t,"height")},ri=function(t,e){var n=function(t){return Qt.is(t.element(),e)},r=co.fromTable(t),o=ho.generate(r),i=Zo(o,n),u="th:not("+e+"),td:not("+e+")",a=Xn.filterFirstLayer(t,"th,td",function(t){return Qt.is(t,u)});return et.each(a,Jo.remove),ei(r,o,i,n),ni(t,i),t},oi={extract:ri},ii=function(t,e){return Ut.fromDom(t.dom().cloneNode(e))},ui=function(t){return ii(t,!1)},ai=function(t){return ii(t,!0)},ci=function(t,e){var n=Ut.fromTag(e),r=gr.clone(t);return gr.setAll(n,r),n},li=function(t,e){var n=ci(t,e),r=Vn.children(ai(t));return Yo.append(n,r),n},si=function(t,e){var n=ci(t,e);Ho.before(t,n);var r=Vn.children(t);return Yo.append(n,r),Jo.remove(t),n},fi={shallow:ui,shallowAs:ci,deep:ai,copy:li,mutate:si},di=function(t,e){var n=function(n){if(!t(n))throw new Error("Can only get "+e+" value of a "+e+" node");return u(n).getOr("")},r=function(t){try{return o(t)}catch(t){return R.none()}},o=function(e){return t(e)?R.from(e.dom().nodeValue):R.none()},i=hn.detect().browser,u=i.isIE()&&10===i.version.major?r:o;return{get:n,getOption:u,set:function(n,r){if(!t(n))throw new Error("Can only set raw "+e+" value of a "+e+" node");n.dom().nodeValue=r}}}(rr.isText,"text"),mi=function(t){return di.get(t)},gi=function(t){return di.getOption(t)},pi=function(t,e){di.set(t,e)},hi={get:mi,getOption:gi,set:pi},vi=function(t){return"img"===rr.name(t)?1:hi.getOption(t).fold(function(){return Vn.children(t).length},function(t){return t.length})},bi=function(t,e){return vi(t)===e},wi=function(t,e){return 0===e},yi=function(t){return hi.getOption(t).filter(function(t){
return 0!==t.trim().length||t.indexOf("Â ")>-1}).isSome()},xi=["img","br"],Ci=function(t){return yi(t)||et.contains(xi,rr.name(t))},Si={getEnd:vi,isEnd:bi,isStart:wi,isCursorPosition:Ci},Ri=function(t){return Lr.descendant(t,Si.isCursorPosition)},Ti=function(t){return Ai(t,Si.isCursorPosition)},Ai=function(t,e){var n=function(t){for(var r=Vn.children(t),o=r.length-1;o>=0;o--){var i=r[o];if(e(i))return R.some(i);var u=n(i);if(u.isSome())return u}return R.none()};return n(t)},Di={first:Ri,last:Ti},Ei=function(){var t=Ut.fromTag("td");return Ho.append(t,Ut.fromTag("br")),t},ki=function(t,e,n){var r=fi.copy(t,e);return ft.each(n,function(t,e){null===t?gr.remove(r,e):gr.set(r,e,t)}),r},Oi=function(t){return t},Ni=function(t){return function(){return Ut.fromTag("tr",t.dom())}},Bi=function(t,e,n){return Di.first(t).map(function(r){var o=n.join(","),i=Or.ancestors(r,o,function(e){return Rn.eq(e,t)});return et.foldr(i,function(t,e){var n=fi.shallow(e);return Ho.append(t,n),n},e)}).getOr(e)},Ii=function(t,e,n){var r=function(e){var r=Vn.owner(e.element()),o=Ut.fromTag(rr.name(e.element()),r.dom()),i=n.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),u=i.length>0?Bi(e.element(),o,i):o;return Ho.append(u,Ut.fromTag("br")),Wo.copy(e.element(),o),Wo.remove(o,"height"),1!==e.colspan()&&Wo.remove(e.element(),"width"),t(e.element(),o),o};return{row:Ni(e),cell:r,replace:ki,gap:Ei}},Pi=function(t){return{row:Ni(t),cell:Ei,replace:Oi,gap:Ei}},Wi={cellOperations:Ii,paste:Pi},Mi=function(t,e){var n=e||document,r=n.createElement("div");return r.innerHTML=t,Vn.children(Ut.fromDom(r))},_i=function(t,e){return et.map(t,function(t){return Ut.fromTag(t,e)})},Li=function(t,e){return et.map(t,function(t){return Ut.fromText(t,e)})},Fi=function(t){return et.map(t,Ut.fromDom)},qi={fromHtml:Mi,fromTags:_i,fromText:Li,fromDom:Fi},zi=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],Hi=function(){var t=function(t){return Ut.fromDom(t.dom().cloneNode(!1))},e=function(t){return!!rr.isElement(t)&&("body"===rr.name(t)||et.contains(zi,rr.name(t)))},n=function(t){return!!rr.isElement(t)&&et.contains(["br","img","hr","input"],rr.name(t))},r=function(t,e){return t.dom().compareDocumentPosition(e.dom())},o=function(t,e){var n=gr.clone(t);gr.setAll(e,n)};return{up:v.constant({selector:Vr.ancestor,closest:Vr.closest,predicate:Lr.ancestor,all:Vn.parents}),down:v.constant({selector:Or.descendants,predicate:Rr.descendants}),styles:v.constant({get:Wo.get,getRaw:Wo.getRaw,set:Wo.set,remove:Wo.remove}),attrs:v.constant({get:gr.get,set:gr.set,remove:gr.remove,copyTo:o}),insert:v.constant({before:Ho.before,after:Ho.after,afterAll:Yo.after,append:Ho.append,appendAll:Yo.append,prepend:Ho.prepend,wrap:Ho.wrap}),remove:v.constant({unwrap:Jo.unwrap,remove:Jo.remove}),create:v.constant({nu:Ut.fromTag,clone:t,text:Ut.fromText}),query:v.constant({comparePosition:r,prevSibling:Vn.prevSibling,nextSibling:Vn.nextSibling}),property:v.constant({children:Vn.children,name:rr.name,parent:Vn.parent,isText:rr.isText,isComment:rr.isComment,isElement:rr.isElement,getText:hi.get,setText:hi.set,isBoundary:e,isEmptyTag:n}),eq:Rn.eq,is:Rn.is}},ji=Rt.immutable("left","right"),Ui=function(t,e,n){var r=t.property().children(e);return et.findIndex(r,v.curry(t.eq,n)).map(function(t){return{before:v.constant(r.slice(0,t)),after:v.constant(r.slice(t+1))}})},Vi=function(t,e,n){return Ui(t,e,n).map(function(n){var r=t.create().clone(e);return t.insert().appendAll(r,n.after()),t.insert().after(e,r),ji(e,r)})},Gi=function(t,e,n){return Ui(t,e,n).map(function(r){var o=t.create().clone(e);return t.insert().appendAll(o,r.before().concat([n])),t.insert().appendAll(e,r.after()),t.insert().before(e,o),ji(o,e)})},Yi=function(t,e,n,r){var o=Rt.immutable("first","second","splits"),i=function(e,u,a){var c=o(e,R.none(),a);return n(e)?o(e,u,a):t.property().parent(e).bind(function(o){return r(t,o,e).map(function(t){var e=[{first:t.left,second:t.right}],r=n(o)?o:t.left();return i(r,R.some(t.right()),a.concat(e))}).getOr(c)})};return i(e,R.none(),[])},Xi={breakToLeft:Gi,breakToRight:Vi,breakPath:Yi},$i=function(t,e,n,r){return r(t,e,n[0],n.slice(1))},Ki=function(t,e,n){return n.length>0?$i(t,e,n,Ji):R.none()},Ji=function(t,e,n,r){var o=e(t,n);return et.foldr(r,function(n,r){var o=e(t,r);return Qi(t,n,o)},o)},Qi=function(t,e,n){return e.bind(function(e){return n.filter(v.curry(t.eq,e))})},Zi={oneAll:Ki},tu=function(t,e){return v.curry(t.eq,e)},eu=function(t,e,n,r){var o=t.property().children(e);if(t.eq(e,n[0]))return R.some([n[0]]);if(t.eq(e,r[0]))return R.some([r[0]]);var i=function(n){var r=et.reverse(n),i=et.findIndex(r,tu(t,e)).getOr(-1),u=i<r.length-1?r[i+1]:r[i];return et.findIndex(o,tu(t,u))},u=i(n),a=i(r);return u.bind(function(t){return a.map(function(e){var n=Math.min(t,e),r=Math.max(t,e);return o.slice(n,r+1)})})},nu=function(t,e,n,r){var o=void 0!==r?r:v.constant(!1),i=[e].concat(t.up().all(e)),u=[n].concat(t.up().all(n)),a=function(t){return et.findIndex(t,o).fold(function(){return t},function(e){return t.slice(0,e+1)})},c=a(i),l=a(u),s=et.find(c,function(e){return et.exists(l,tu(t,e))});return{firstpath:v.constant(c),secondpath:v.constant(l),shared:v.constant(s)}},ru=function(t,e,n){var r=nu(t,e,n);return r.shared().bind(function(e){return eu(t,e,r.firstpath(),r.secondpath())})},ou={subset:ru,ancestors:nu},iu=function(t,e,n){return Zi.oneAll(t,e,n)},uu=function(t,e,n){return ou.subset(t,e,n)},au=function(t,e,n,r){return ou.ancestors(t,e,n,r)},cu=function(t,e,n){return Xi.breakToLeft(t,e,n)},lu=function(t,e,n){return Xi.breakToRight(t,e,n)},su=function(t,e,n,r){return Xi.breakPath(t,e,n,r)},fu={sharedOne:iu,subset:uu,ancestors:au,breakToLeft:cu,breakToRight:lu,breakPath:su},du=Hi(),mu=function(t,e){return fu.sharedOne(du,function(e,n){return t(n)},e)},gu=function(t,e){return fu.subset(du,t,e)},pu=function(t,e,n){return fu.ancestors(du,t,e,n)},hu=function(t,e){return fu.breakToLeft(du,t,e)},vu=function(t,e){return fu.breakToRight(du,t,e)},bu=function(t,e,n){return fu.breakPath(du,t,e,function(t,e,r){return n(e,r)})},wu={sharedOne:mu,subset:gu,ancestors:pu,breakToLeft:hu,breakToRight:vu,breakPath:bu},yu=function(t,e){var n=e.column(),r=e.column()+e.colspan()-1,o=e.row(),i=e.row()+e.rowspan()-1;return n<=t.finishCol()&&r>=t.startCol()&&o<=t.finishRow()&&i>=t.startRow()},xu=function(t,e){return e.column()>=t.startCol()&&e.column()+e.colspan()-1<=t.finishCol()&&e.row()>=t.startRow()&&e.row()+e.rowspan()-1<=t.finishRow()},Cu=function(t,e){for(var n=!0,r=v.curry(xu,e),o=e.startRow();o<=e.finishRow();o++)for(var i=e.startCol();i<=e.finishCol();i++)n=n&&ho.getAt(t,o,i).exists(r);return n?R.some(e):R.none()},Su={inSelection:yu,isWithin:xu,isRectangular:Cu},Ru=function(t,e){return Lt.bounds(Math.min(t.row(),e.row()),Math.min(t.column(),e.column()),Math.max(t.row()+t.rowspan()-1,e.row()+e.rowspan()-1),Math.max(t.column()+t.colspan()-1,e.column()+e.colspan()-1))},Tu=function(t,e,n){var r=ho.findItem(t,e,Rn.eq),o=ho.findItem(t,n,Rn.eq);return r.bind(function(t){return o.map(function(e){return Ru(t,e)})})},Au=function(t,e,n){return Tu(t,e,n).bind(function(e){return Su.isRectangular(t,e)})},Du={getAnyBox:Tu,getBox:Au},Eu=function(t,e,n,r){return ho.findItem(t,e,Rn.eq).bind(function(e){var o=n>0?e.row()+e.rowspan()-1:e.row(),i=r>0?e.column()+e.colspan()-1:e.column();return ho.getAt(t,o+n,i+r).map(function(t){return t.element()})})},ku=function(t,e,n){return Du.getAnyBox(t,e,n).map(function(e){var n=ho.filterItems(t,v.curry(Su.inSelection,e));return et.map(n,function(t){return t.element()})})},Ou=function(t,e){var n=function(t,e){return Rn.contains(e,t)};return ho.findItem(t,e,n).bind(function(t){return t.element()})},Nu={moveBy:Eu,intercepts:ku,parentCell:Ou},Bu=function(t,e,n){return io.table(t).bind(function(r){var o=Mu(r);return Nu.moveBy(o,t,e,n)})},Iu=function(t,e,n){var r=Mu(t);return Nu.intercepts(r,e,n)},Pu=function(t,e,n,r,o){var i=Mu(t),u=Rn.eq(t,n)?e:Nu.parentCell(i,e),a=Rn.eq(t,o)?r:Nu.parentCell(i,r);return Nu.intercepts(i,u,a)},Wu=function(t,e,n){var r=Mu(t);return Du.getBox(r,e,n)},Mu=function(t){var e=co.fromTable(t);return ho.generate(e)},_u={moveBy:Bu,intercepts:Iu,nestedIntercepts:Pu,getBox:Wu},Lu=function(t,e){return Vr.ancestor(t,"table")},Fu=Rt.immutableBag(["boxes","start","finish"],[]),qu=function(t,e,n){var r=function(t){return function(e){return n(e)||Rn.eq(e,t)}};return Rn.eq(t,e)?R.some(Fu({boxes:R.some([t]),start:t,finish:e})):Lu(t).bind(function(o){return Lu(e).bind(function(i){if(Rn.eq(o,i))return R.some(Fu({boxes:_u.intercepts(o,t,e),start:t,finish:e}));if(Rn.contains(o,i)){var u=Or.ancestors(e,"td,th",r(o)),a=u.length>0?u[u.length-1]:e;return R.some(Fu({boxes:_u.nestedIntercepts(o,t,o,e,i),start:t,finish:a}))}if(Rn.contains(i,o)){var u=Or.ancestors(t,"td,th",r(i)),c=u.length>0?u[u.length-1]:t;return R.some(Fu({boxes:_u.nestedIntercepts(i,t,o,e,i),start:t,finish:c}))}return wu.ancestors(t,e).shared().bind(function(u){return Vr.closest(u,"table",n).bind(function(n){var u=Or.ancestors(e,"td,th",r(n)),a=u.length>0?u[u.length-1]:e,c=Or.ancestors(t,"td,th",r(n)),l=c.length>0?c[c.length-1]:t;return R.some(Fu({boxes:_u.nestedIntercepts(n,t,o,e,i),start:l,finish:a}))})})})})},zu=function(t,e){var n=Or.descendants(t,e);return n.length>0?R.some(n):R.none()},Hu=function(t,e){return et.find(t,function(t){return Qt.is(t,e)})},ju=function(t,e,n){return Vr.descendant(t,e).bind(function(e){return Vr.descendant(t,n).bind(function(t){return wu.sharedOne(Lu,[e,t]).map(function(n){return{first:v.constant(e),last:v.constant(t),table:v.constant(n)}})})})},Uu=function(t,e){return Vr.ancestor(t,"table").bind(function(n){return Vr.descendant(n,e).bind(function(e){return qu(e,t).bind(function(t){return t.boxes().map(function(e){return{boxes:v.constant(e),start:v.constant(t.start()),finish:v.constant(t.finish())}})})})})},Vu=function(t,e,n,r,o){return Hu(t,o).bind(function(t){return _u.moveBy(t,e,n).bind(function(t){return Uu(t,r)})})},Gu={identify:qu,retrieve:zu,shiftSelection:Vu,getEdges:ju},Yu=function(t,e){return Gu.retrieve(t,e)},Xu=function(t,e,n){return Gu.getEdges(t,e,n).bind(function(e){var n=function(e){return Rn.eq(t,e)},r=Vr.ancestor(e.first(),"thead,tfoot,tbody,table",n),o=Vr.ancestor(e.last(),"thead,tfoot,tbody,table",n);return r.bind(function(t){return o.bind(function(n){return Rn.eq(t,n)?_u.getBox(e.table(),e.first(),e.last()):R.none()})})})},$u={retrieve:Yu,retrieveBox:Xu},Ku="data-mce-selected",Ju={selected:v.constant(Ku),selectedSelector:v.constant("td[data-mce-selected],th[data-mce-selected]"),attributeSelector:v.constant("[data-mce-selected]"),firstSelected:v.constant("data-mce-first-selected"),firstSelectedSelector:v.constant("td[data-mce-first-selected],th[data-mce-first-selected]"),lastSelected:v.constant("data-mce-last-selected"),lastSelectedSelector:v.constant("td[data-mce-last-selected],th[data-mce-last-selected]")},Qu=function(t){if(!pt.isArray(t))throw new Error("cases must be an array");if(0===t.length)throw new Error("there must be at least one case");var e=[],n={};return et.each(t,function(r,o){var i=ft.keys(r);if(1!==i.length)throw new Error("one and only one name per case");var u=i[0],a=r[u];if(void 0!==n[u])throw new Error("duplicate key detected:"+u);if("cata"===u)throw new Error("cannot have a case named cata (sorry)");if(!pt.isArray(a))throw new Error("case arguments must be an array");e.push(u),n[u]=function(){var n=arguments.length;if(n!==a.length)throw new Error("Wrong number of arguments to case "+u+". Expected "+a.length+" ("+a+"), got "+n);for(var r=new Array(n),i=0;i<r.length;i++)r[i]=arguments[i];var c=function(t){var n=ft.keys(t);if(e.length!==n.length)throw new Error("Wrong number of arguments to match. Expected: "+e.join(",")+"\nActual: "+n.join(","));if(!et.forall(e,function(t){return et.contains(n,t)}))throw new Error("Not all branches were specified when using match. Specified: "+n.join(", ")+"\nRequired: "+e.join(", "));return t[u].apply(null,r)};return{fold:function(){if(arguments.length!==t.length)throw new Error("Wrong number of arguments to fold. Expected "+t.length+", got "+arguments.length);return arguments[o].apply(null,r)},match:c,log:function(t){console.log(t,{constructors:e,constructor:u,params:r})}}}}),n},Zu={generate:Qu},ta=Zu.generate([{none:[]},{multiple:["elements"]},{single:["selection"]}]),ea=function(t,e,n,r){return t.fold(e,n,r)},na={cata:ea,none:ta.none,multiple:ta.multiple,single:ta.single},ra=function(t,e){return na.cata(e.get(),v.constant([]),v.identity,v.constant([t]))},oa=function(t,e){var n=function(t){return gr.has(t,"rowspan")&&parseInt(gr.get(t,"rowspan"),10)>1||gr.has(t,"colspan")&&parseInt(gr.get(t,"colspan"),10)>1},r=ra(t,e);return r.length>0&&et.forall(r,n)?R.some(r):R.none()},ia=function(t,e){return na.cata(e.get(),R.none,function(e,n){return 0===e.length?R.none():$u.retrieveBox(t,Ju.firstSelectedSelector(),Ju.lastSelectedSelector()).bind(function(t){return e.length>1?R.some({bounds:v.constant(t),cells:v.constant(e)}):R.none()})},R.none)},ua={mergable:ia,unmergable:oa,selection:ra},aa=function(t){return{element:v.constant(t),mergable:R.none,unmergable:R.none,selection:v.constant([t])}},ca=function(t,e,n){return{element:v.constant(n),mergable:v.constant(ua.mergable(e,t)),unmergable:v.constant(ua.unmergable(n,t)),selection:v.constant(ua.selection(n,t))}},la=function(t){return aa(t)},sa=Rt.immutable("element","clipboard","generators"),fa=function(t,e,n,r,o){return{element:v.constant(n),mergable:R.none,unmergable:R.none,selection:v.constant(ua.selection(n,t)),clipboard:v.constant(r),generators:v.constant(o)}},da={noMenu:aa,forMenu:ca,notCell:la,paste:sa,pasteRows:fa},ma=function(t){return io.table(t[0]).map(fi.deep).map(function(t){return[oi.extract(t,Ju.attributeSelector())]})},ga=function(t,e){return t.selection.serializer.serialize(e.dom(),{})},pa=function(t,e,n,r){t.on("BeforeGetContent",function(n){var r=function(e){n.preventDefault(),ma(e).each(function(e){n.content=et.map(e,function(e){return ga(t,e)}).join("")})};!0===n.selection&&na.cata(e.get(),v.noop,r,v.noop)}),t.on("BeforeSetContent",function(e){if(!0===e.selection&&!0===e.paste){R.from(t.dom.getParent(t.selection.getStart(),"th,td")).each(function(o){var i=Ut.fromDom(o);io.table(i).bind(function(o){var u=et.filter(qi.fromHtml(e.content),function(t){return"meta"!==rr.name(t)});if(1===u.length&&"table"===rr.name(u[0])){e.preventDefault();var a=Ut.fromDom(t.getDoc()),c=Wi.paste(a),l=da.paste(i,u[0],c);n.pasteCells(o,l).each(function(e){t.selection.setRng(e),t.focus(),r.clear(o)})}})})}})},ha={registerEvents:pa},va=function(){return Ut.fromTag("table")},ba=function(){return Ut.fromTag("tbody")},wa=function(){return Ut.fromTag("tr")},ya=function(){return Ut.fromTag("th")},xa=function(){return Ut.fromTag("td")},Ca=function(t,e,n,r){var o=va();Wo.setAll(o,{"border-collapse":"collapse",width:"100%"}),gr.set(o,"border","1");var i=ba();Ho.append(o,i);for(var u=[],a=0;a<t;a++){for(var c=wa(),l=0;l<e;l++){var s=a<n||l<r?ya():xa();l<r&&gr.set(s,"scope","row"),a<n&&gr.set(s,"scope","col"),Ho.append(s,Ut.fromTag("br")),Wo.set(s,"width",100/e+"%"),Ho.append(c,s)}u.push(c)}return Yo.append(i,u),o},Sa={render:Ca},Ra={render:Sa.render},Ta=function(t){return t.dom().innerHTML},Aa=function(t,e){var n=Vn.owner(t),r=n.dom(),o=Ut.fromDom(r.createDocumentFragment()),i=qi.fromHtml(e,r);Yo.append(o,i),Jo.empty(t),Ho.append(t,o)},Da=function(t){var e=Ut.fromTag("div"),n=Ut.fromDom(t.dom().cloneNode(!0));return Ho.append(e,n),Ta(e)},Ea={get:Ta,set:Aa,getOuter:Da},ka=function(t,e){t.selection.select(e.dom(),!0),t.selection.collapse(!0)},Oa=function(t,e){Vr.descendant(e,"td,th").each(v.curry(ka,t))},Na=function(t,e,n){var r,o=Ra.render(n,e,0,0);gr.set(o,"id","__mce");var i=Ea.getOuter(o);return t.insertContent(i),r=t.dom.get("__mce"),t.dom.setAttrib(r,"id",null),t.$("tr",r).each(function(e,n){t.fire("newrow",{node:n}),t.$("th,td",n).each(function(e,n){t.fire("newcell",{node:n})})}),t.dom.setAttribs(r,t.settings.table_default_attributes||{}),t.dom.setStyles(r,t.settings.table_default_styles||{}),Oa(t,Ut.fromDom(r)),r},Ba={insert:Na},Ia=function(t,e){var n=function(e,n){if(!pt.isNumber(n)&&!n.match(/^[0-9]+$/))throw t+".set accepts only positive integer values. Value was "+n;var r=e.dom();bo.isSupported(r)&&(r.style[t]=n+"px")},r=function(n){var r=e(n);if(r<=0||null===r){var o=Wo.get(n,t);return parseFloat(o)||0}return r},o=r,i=function(t,e){return et.foldl(e,function(e,n){var r=Wo.get(t,n),o=void 0===r?0:parseInt(r,10);return isNaN(o)?e:e+o},0)};return{set:n,get:r,getOuter:o,aggregate:i,max:function(t,e,n){var r=i(t,n);return e>r?e-r:0}}},Pa=Ia("height",function(t){return br.inBody(t)?t.dom().getBoundingClientRect().height:t.dom().offsetHeight}),Wa=function(t,e){Pa.set(t,e)},Ma=function(t){return Pa.get(t)},_a=function(t){return Pa.getOuter(t)},La=function(t,e){var n=["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"],r=Pa.max(t,e,n);Wo.set(t,"max-height",r+"px")},Fa={set:Wa,get:Ma,getOuter:_a,setMax:La},qa=Ia("width",function(t){return t.dom().offsetWidth}),za=function(t,e){qa.set(t,e)},Ha=function(t){return qa.get(t)},ja=function(t){return qa.getOuter(t)},Ua=function(t,e){var n=["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"],r=qa.max(t,e,n);Wo.set(t,"max-width",r+"px")},Va={set:za,get:Ha,getOuter:ja,setMax:Ua},Ga=hn.detect(),Ya=function(){return Ga.browser.isIE()||Ga.browser.isEdge()},Xa=function(t,e){var n=parseFloat(t);return isNaN(n)?e:n},$a=function(t,e,n){return Xa(Wo.get(t,e),n)},Ka=function(t){var e=$a(t,"padding-top",0),n=$a(t,"padding-bottom",0),r=$a(t,"border-top-width",0),o=$a(t,"border-bottom-width",0),i=t.dom().getBoundingClientRect().height,u=Wo.get(t,"box-sizing"),a=r+o;return"border-box"===u?i:i-e-n-a},Ja=function(t){return $a(t,"width",Va.get(t))},Qa=function(t){return Ya()?Ka(t):$a(t,"height",Fa.get(t))},Za={getWidth:Ja,getHeight:Qa},tc=/(\d+(\.\d+)?)(\w|%)*/,ec=/(\d+(\.\d+)?)%/,nc=/(\d+(\.\d+)?)px|em/,rc=function(t,e){Wo.set(t,"width",e+"px")},oc=function(t,e){Wo.set(t,"width",e+"%")},ic=function(t,e){Wo.set(t,"height",e+"px")},uc=function(t){return Wo.getRaw(t,"height").getOrThunk(function(){return Za.getHeight(t)+"px"})},ac=function(t,e,n,r){var o=io.table(t).map(function(t){var r=n(t);return Math.floor(e/100*r)}).getOr(e);return r(t,o),o},cc=function(t,e,n,r){var o=parseInt(t,10);return an.endsWith(t,"%")&&"table"!==rr.name(e)?ac(e,o,n,r):o},lc=function(t){var e=uc(t);return e?cc(e,t,Fa.get,ic):Fa.get(t)},sc=function(t,e,n){return n(t)/fc(t,e)},fc=function(t,e){return gr.has(t,e)?parseInt(gr.get(t,e),10):1},dc=function(t){return Wo.getRaw(t,"width").fold(function(){return R.from(gr.get(t,"width"))},function(t){return R.some(t)})},mc=function(t,e){return t/e.pixelWidth()*100},gc=function(t,e,n){if(ec.test(e)){var r=ec.exec(e);return parseFloat(r[1])}var o=Va.get(t),i=parseInt(o,10);return mc(i,n)},pc=function(t,e){return dc(t).fold(function(){var n=Va.get(t),r=parseInt(n,10);return mc(r,e)},function(n){return gc(t,n,e)})},hc=function(t,e){return t/100*e.pixelWidth()},vc=function(t,e,n){if(nc.test(e)){var r=nc.exec(e);return parseInt(r[1],10)}if(ec.test(e)){var o=ec.exec(e),i=parseFloat(o[1]);return hc(i,n)}var u=Va.get(t);return parseInt(u,10)},bc=function(t,e){return dc(t).fold(function(){var e=Va.get(t);return parseInt(e,10)},function(n){return vc(t,n,e)})},wc=function(t){return sc(t,"rowspan",lc)},yc=function(t){return dc(t).bind(function(t){if(tc.test(t)){var e=tc.exec(t);return R.some({width:v.constant(e[1]),unit:v.constant(e[3])})}return R.none()})},xc=function(t,e,n){Wo.set(t,"width",e+n)},Cc={percentageBasedSizeRegex:v.constant(ec),pixelBasedSizeRegex:v.constant(nc),setPixelWidth:rc,setPercentageWidth:oc,setHeight:ic,getPixelWidth:bc,getPercentageWidth:pc,getGenericWidth:yc,setGenericWidth:xc,getHeight:wc,getRawWidth:dc},Sc=function(t,e){Cc.getGenericWidth(t).each(function(n){var r=n.width()/2;Cc.setGenericWidth(t,r,n.unit()),Cc.setGenericWidth(e,r,n.unit())})},Rc={halve:Sc},Tc=function(t,e){var n=e||Ut.fromDom(document.documentElement);return Lr.ancestor(t,v.curry(Rn.eq,n)).isSome()},Ac=function(t){var e=t.dom();return e===e.window?t:rr.isDocument(t)?e.defaultView||e.parentWindow:null},Dc={attached:Tc,windowOf:Ac},Ec=function(t,e){var n=function(n,r){return Ec(t+n,e+r)};return{left:v.constant(t),top:v.constant(e),translate:n}},kc=function(t){var e=t.getBoundingClientRect();return Ec(e.left,e.top)},Oc=function(t,e){return void 0!==t?t:void 0!==e?e:0},Nc=function(t){var e=t.dom().ownerDocument,n=e.body,r=Dc.windowOf(Ut.fromDom(e)),o=e.documentElement,i=Oc(r.pageYOffset,o.scrollTop),u=Oc(r.pageXOffset,o.scrollLeft),a=Oc(o.clientTop,n.clientTop),c=Oc(o.clientLeft,n.clientLeft);return Ic(t).translate(u-c,i-a)},Bc=function(t){var e=t.dom();return Ec(e.offsetLeft,e.offsetTop)},Ic=function(t){var e=t.dom(),n=e.ownerDocument,r=n.body,o=Ut.fromDom(n.documentElement);return r===e?Ec(r.offsetLeft,r.offsetTop):Dc.attached(t,o)?kc(e):Ec(0,0)},Pc={absolute:Nc,relative:Bc,viewport:Ic},Wc=Rt.immutable("row","y"),Mc=Rt.immutable("col","x"),_c=function(t){return Pc.absolute(t).left()+Va.getOuter(t)},Lc=function(t){return Pc.absolute(t).left()},Fc=function(t,e){return Mc(t,Lc(e))},qc=function(t,e){return Mc(t,_c(e))},zc=function(t){return Pc.absolute(t).top()},Hc=function(t,e){return Wc(t,zc(e))},jc=function(t,e){return Wc(t,zc(e)+Fa.getOuter(e))},Uc=function(t,e,n){if(0===n.length)return[];var r=et.map(n.slice(1),function(e,n){return e.map(function(e){return t(n,e)})}),o=n[n.length-1].map(function(t){return e(n.length-1,t)});return r.concat([o])},Vc=function(t,e){return-t},Gc={delta:v.identity,positions:v.curry(Uc,Hc,jc),edge:zc},Yc={delta:v.identity,edge:Lc,positions:v.curry(Uc,Fc,qc)},Xc={delta:Vc,edge:_c,positions:v.curry(Uc,qc,Fc)},$c={height:Gc,rtl:Xc,ltr:Yc},Kc={ltr:$c.ltr,rtl:$c.rtl},Jc=function(t){var e=function(e){return t(e).isRtl()?Kc.rtl:Kc.ltr},n=function(t,n){return e(n).delta(t,n)},r=function(t,n){return e(n).positions(t,n)};return{delta:n,edge:function(t){return e(t).edge(t)},positions:r}},Qc=function(t){var e=co.fromTable(t);return ho.generate(e).grid()},Zc={getGridSize:Qc},tl=function(t){var e=t,n=function(){return e};return{get:n,set:function(t){e=t},clone:function(){return tl(n())}}},el=function(t,e){return nl(t,e,{validate:pt.isFunction,label:"function"})},nl=function(t,e,n){if(0===e.length)throw new Error("You must specify at least one required field.");return Ct.validateStrArr("required",e),Ct.checkDupes(e),function(r){var o=ft.keys(r);et.forall(e,function(t){return et.contains(o,t)})||Ct.reqMessage(e,o),t(e,o);var i=et.filter(e,function(t){return!n.validate(r[t],t)});return i.length>0&&Ct.invalidTypeMessage(i,n.label),r}},rl=function(t,e){var n=et.filter(e,function(e){return!et.contains(t,e)});n.length>0&&Ct.unsuppMessage(n)},ol=v.noop,il={exactly:v.curry(el,rl),ensure:v.curry(el,ol),ensureWith:v.curry(nl,ol)},ul=function(t){var e=gr.has(t,"colspan")?parseInt(gr.get(t,"colspan"),10):1,n=gr.has(t,"rowspan")?parseInt(gr.get(t,"rowspan"),10):1;return{element:v.constant(t),colspan:v.constant(e),rowspan:v.constant(n)}},al=function(t,e){sl(t);var n=tl(R.none()),r=void 0!==e?e:ul,o=function(e){return t.cell(e)},i=function(t){var e=r(t);return o(e)},u=function(t){var e=i(t);return n.get().isNone()&&n.set(R.some(e)),a=R.some({item:t,replacement:e}),e},a=R.none();return{getOrInit:function(t,e){return a.fold(function(){return u(t)},function(n){return e(t,n.item)?n.replacement:u(t)})},cursor:n.get}},cl=function(t,e){return function(n){var r=tl(R.none());sl(n);var o=[],i=function(t,e){return et.find(o,function(n){return e(n.item,t)})},u=function(i){var u=n.replace(i,e,{scope:t});return o.push({item:i,sub:u}),r.get().isNone()&&r.set(R.some(u)),u};return{replaceOrInit:function(t,e){return i(t,e).fold(function(){return u(t)},function(n){return e(t,n.item)?n.sub:u(t)})},cursor:r.get}}},ll=function(t){sl(t);var e=tl(R.none());return{combine:function(n){return e.get().isNone()&&e.set(R.some(n)),function(){var e=t.cell({element:v.constant(n),colspan:v.constant(1),rowspan:v.constant(1)});return Wo.remove(e,"width"),Wo.remove(n,"width"),e}},cursor:e.get}},sl=il.exactly(["cell","row","replace","gap"]),fl={modification:al,transform:cl,merging:ll},dl=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],ml=function(t,e){var n=t.property().name(e);return et.contains(["ol","ul"],n)},gl=function(t,e){var n=t.property().name(e);return et.contains(dl,n)},pl=function(t,e){var n=t.property().name(e);return et.contains(["address","pre","p","h1","h2","h3","h4","h5","h6"],n)},hl=function(t,e){var n=t.property().name(e);return et.contains(["h1","h2","h3","h4","h5","h6"],n)},vl=function(t,e){return et.contains(["div","li","td","th","blockquote","body","caption"],t.property().name(e))},bl=function(t,e){return et.contains(["br","img","hr","input"],t.property().name(e))},wl=function(t,e){return"iframe"===t.property().name(e)},yl=function(t,e){return!(gl(t,e)||bl(t,e))&&"li"!==t.property().name(e)},xl={isBlock:gl,isList:ml,isFormatting:pl,isHeading:hl,isContainer:vl,isEmptyTag:bl,isFrame:wl,isInline:yl},Cl=Hi(),Sl=function(t){return xl.isBlock(Cl,t)},Rl=function(t){return xl.isList(Cl,t)},Tl=function(t){return xl.isFormatting(Cl,t)},Al=function(t){return xl.isHeading(Cl,t)},Dl=function(t){return xl.isContainer(Cl,t)},El=function(t){return xl.isEmptyTag(Cl,t)},kl=function(t){return xl.isFrame(Cl,t)},Ol=function(t){return xl.isInline(Cl,t)},Nl={isBlock:Sl,isList:Rl,isFormatting:Tl,isHeading:Al,isContainer:Dl,isEmptyTag:El,isFrame:kl,isInline:Ol},Bl=function(t){var e=function(t){return"br"===rr.name(t)},n=function(t){return et.forall(t,function(t){return e(t)||rr.isText(t)&&0===hi.get(t).trim().length})},r=function(t){return"li"===rr.name(t)||Lr.ancestor(t,Nl.isList).isSome()},o=function(t){return Vn.nextSibling(t).map(function(t){return!!Nl.isBlock(t)||(Nl.isEmptyTag(t)?"img"!==rr.name(t):void 0)}).getOr(!1)},i=function(t){return Di.last(t).bind(function(n){var i=o(n);return Vn.parent(n).map(function(o){return!0===i||r(o)||e(n)||Nl.isBlock(o)&&!Rn.eq(t,o)?[]:[Ut.fromTag("br")]})}).getOr([])},u=function(){var e=et.bind(t,function(t){var e=Vn.children(t);return n(e)?[]:e.concat(i(t))});return 0===e.length?[Ut.fromTag("br")]:e}();Jo.empty(t[0]),Yo.append(t[0],u)},Il={merge:Bl},Pl=function(t,e){return e},Wl=function(t,e){return pt.isObject(t)&&pt.isObject(e)?_l(t,e):e},Ml=function(t){return function(){for(var e=new Array(arguments.length),n=0;n<e.length;n++)e[n]=arguments[n];if(0===e.length)throw new Error("Can't merge zero objects");for(var r={},o=0;o<e.length;o++){var i=e[o];for(var u in i)i.hasOwnProperty(u)&&(r[u]=t(r[u],i[u]))}return r}},_l=Ml(Wl),Ll=Ml(Pl),Fl={deepMerge:_l,merge:Ll},ql=function(t){for(var e=[],n=function(t){e.push(t)},r=0;r<t.length;r++)t[r].each(n);return e},zl=function(t,e){for(var n=0;n<t.length;n++){var r=e(t[n],n);if(r.isSome())return r}return R.none()},Hl=function(t,e){for(var n=[],r=0;r<t.length;r++){var o=t[r];if(!o.isSome())return R.none();n.push(o.getOrDie())}return R.some(e.apply(null,n))},jl={cat:ql,findMap:zl,liftN:Hl},Ul=function(t,e,n){var r=t.cells(),o=r.slice(0,e),i=r.slice(e),u=o.concat([n]).concat(i);return Gl(t,u)},Vl=function(t,e,n){t.cells()[e]=n},Gl=function(t,e){return Lt.rowcells(e,t.section())},Yl=function(t,e){var n=t.cells(),r=et.map(n,e);return Lt.rowcells(r,t.section())},Xl=function(t,e){return t.cells()[e]},$l=function(t,e){return Xl(t,e).element()},Kl=function(t){return t.cells().length},Jl={addCell:Ul,setCells:Gl,mutateCell:Vl,getCell:Xl,getCellElement:$l,mapCells:Yl,cellLength:Kl},Ql=function(t,e){return et.map(t,function(t){return Jl.getCell(t,e)})},Zl=function(t,e){return t[e]},ts=function(t,e){if(0===t.length)return 0;var n=t[0];return et.findIndex(t,function(t){return!e(n.element(),t.element())}).fold(function(){return t.length},function(t){return t})},es=function(t,e,n,r){var o=Zl(t,e).cells().slice(n),i=ts(o,r),u=Ql(t,n).slice(e),a=ts(u,r);return{colspan:v.constant(i),rowspan:v.constant(a)}},ns={subgrid:es},rs=function(t,e){var n=et.map(t,function(t,e){return et.map(t.cells(),function(t,e){return!1})}),r=function(t,e,r,o){for(var i=t;i<t+r;i++)for(var u=e;u<e+o;u++)n[i][u]=!0};return et.map(t,function(o,i){var u=et.bind(o.cells(),function(o,u){if(!1===n[i][u]){var a=ns.subgrid(t,i,u,e);return r(i,u,a.rowspan(),a.colspan()),[Lt.detailnew(o.element(),a.rowspan(),a.colspan(),o.isNew())]}return[]});return Lt.rowdetails(u,o.section())})},os=function(t,e,n){for(var r=[],o=0;o<t.grid().rows();o++){for(var i=[],u=0;u<t.grid().columns();u++){var a=ho.getAt(t,o,u).map(function(t){return Lt.elementnew(t.element(),n)}).getOrThunk(function(){return Lt.elementnew(e.gap(),!0)});i.push(a)}var c=Lt.rowcells(i,t.all()[o].section());r.push(c)}return r},is={toDetails:rs,toGrid:os},us=function(t,e,n,r){n===r?gr.remove(t,e):gr.set(t,e,n)},as=function(t,e){var n=[],r=[],o=function(e,o){var i=Vr.child(t,o).getOrThunk(function(){var e=Ut.fromTag(o,Vn.owner(t).dom());return Ho.append(t,e),e});Jo.empty(i);var u=et.map(e,function(t){t.isNew()&&n.push(t.element());var e=t.element();return Jo.empty(e),et.each(t.cells(),function(t){t.isNew()&&r.push(t.element()),us(t.element(),"colspan",t.colspan(),1),us(t.element(),"rowspan",t.rowspan(),1),Ho.append(e,t.element())}),e});Yo.append(i,u)},i=function(e){Vr.child(t,e).bind(Jo.remove)},u=function(t,e){t.length>0?o(t,e):i(e)},a=[],c=[],l=[];return et.each(e,function(t){switch(t.section()){case"thead":a.push(t);break;case"tbody":c.push(t);break;case"tfoot":l.push(t)}}),u(a,"thead"),u(c,"tbody"),u(l,"tfoot"),{newRows:v.constant(n),newCells:v.constant(r)}},cs=function(t){return et.map(t,function(t){var e=fi.shallow(t.element());return et.each(t.cells(),function(t){var n=fi.deep(t.element());us(n,"colspan",t.colspan(),1),us(n,"rowspan",t.rowspan(),1),Ho.append(e,n)}),e})},ls={render:as,copy:cs},ss=function(t,e){for(var n=[],r=0;r<t;r++)n.push(e(r));return n},fs=function(t,e){for(var n=[],r=t;r<e;r++)n.push(r);return n},ds=function(t,e){var n=[];return et.each(t,function(r,o){o<t.length-1&&!e(r,t[o+1])?n.push(r):o===t.length-1&&n.push(r)}),n},ms=function(t,e){if(e<0||e>=t.length-1)return R.none();var n=t[e].fold(function(){var n=et.reverse(t.slice(0,e));return jl.findMap(n,function(t,e){return t.map(function(t){return{value:t,delta:e+1}})})},function(t){return R.some({value:t,delta:0})}),r=t[e+1].fold(function(){var n=t.slice(e+1);return jl.findMap(n,function(t,e){return t.map(function(t){return{value:t,delta:e+1}})})},function(t){return R.some({value:t,delta:1})});return n.bind(function(t){return r.map(function(e){var n=e.delta+t.delta;return Math.abs(e.value-t.value)/n})})},gs={repeat:ss,range:fs,unique:ds,deduce:ms},ps=function(t){var e=t.grid(),n=gs.range(0,e.columns()),r=gs.range(0,e.rows());return et.map(n,function(e){return hs(function(){return et.bind(r,function(n){return ho.getAt(t,n,e).filter(function(t){return t.column()===e}).fold(v.constant([]),function(t){return[t]})})},function(t){return 1===t.colspan()},function(){return ho.getAt(t,0,e)})})},hs=function(t,e,n){var r=t();return et.find(r,e).orThunk(function(){return R.from(r[0]).orThunk(n)}).map(function(t){return t.element()})},vs=function(t){var e=t.grid(),n=gs.range(0,e.rows()),r=gs.range(0,e.columns());return et.map(n,function(e){return hs(function(){return et.bind(r,function(n){return ho.getAt(t,e,n).filter(function(t){return t.row()===e}).fold(v.constant([]),function(t){return[t]})})},function(t){return 1===t.rowspan()},function(){return ho.getAt(t,e,0)})})},bs={columns:ps,rows:vs},ws=function(t,e,n,r,o){var i=Ut.fromTag("div");return Wo.setAll(i,{
position:"absolute",left:e-r/2+"px",top:n+"px",height:o+"px",width:r+"px"}),gr.setAll(i,{"data-column":t,role:"presentation"}),i},ys=function(t,e,n,r,o){var i=Ut.fromTag("div");return Wo.setAll(i,{position:"absolute",left:e+"px",top:n-o/2+"px",height:o+"px",width:r+"px"}),gr.setAll(i,{"data-row":t,role:"presentation"}),i},xs={col:ws,row:ys},Cs=function(t){var e=t.replace(/\./g,"-");return{resolve:function(t){return e+"-"+t}}},Ss={css:Cs},Rs=Ss.css("ephox-snooker"),Ts={resolve:Rs.resolve},As=function(t,e,n){var r=n||!1,o=function(){e(),r=!0},i=function(){t(),r=!1};return{on:o,off:i,toggle:function(){(r?i:o)()},isOn:function(){return r}}},Ds=function(t,e){var n=gr.get(t,e);return void 0===n||""===n?[]:n.split(" ")},Es=function(t,e,n){var r=Ds(t,e),o=r.concat([n]);gr.set(t,e,o.join(" "))},ks=function(t,e,n){var r=et.filter(Ds(t,e),function(t){return t!==n});r.length>0?gr.set(t,e,r.join(" ")):gr.remove(t,e)},Os={read:Ds,add:Es,remove:ks},Ns=function(t){return void 0!==t.dom().classList},Bs=function(t){return Os.read(t,"class")},Is=function(t,e){return Os.add(t,"class",e)},Ps=function(t,e){return Os.remove(t,"class",e)},Ws=function(t,e){et.contains(Bs(t),e)?Ps(t,e):Is(t,e)},Ms={get:Bs,add:Is,remove:Ps,toggle:Ws,supports:Ns},_s=function(t,e){Ms.supports(t)?t.dom().classList.add(e):Ms.add(t,e)},Ls=function(t){0===(Ms.supports(t)?t.dom().classList:Ms.get(t)).length&&gr.remove(t,"class")},Fs=function(t,e){if(Ms.supports(t)){t.dom().classList.remove(e)}else Ms.remove(t,e);Ls(t)},qs=function(t,e){return Ms.supports(t)?t.dom().classList.toggle(e):Ms.toggle(t,e)},zs=function(t,e){var n=Ms.supports(t),r=t.dom().classList;return As(function(){n?r.remove(e):Ms.remove(t,e)},function(){n?r.add(e):Ms.add(t,e)},Hs(t,e))},Hs=function(t,e){return Ms.supports(t)&&t.dom().classList.contains(e)},js={add:_s,remove:Fs,toggle:qs,toggler:zs,has:Hs},Us=Ts.resolve("resizer-bar"),Vs=Ts.resolve("resizer-rows"),Gs=Ts.resolve("resizer-cols"),Ys=function(t){var e=Or.descendants(t.parent(),"."+Us);et.each(e,Jo.remove)},Xs=function(t,e,n){var r=t.origin();et.each(e,function(e,o){e.each(function(e){var o=n(r,e);js.add(o,Us),Ho.append(t.parent(),o)})})},$s=function(t,e,n,r){Xs(t,e,function(t,e){var o=xs.col(e.col(),e.x()-t.left(),n.top()-t.top(),7,r);return js.add(o,Gs),o})},Ks=function(t,e,n,r){Xs(t,e,function(t,e){var o=xs.row(e.row(),n.left()-t.left(),e.y()-t.top(),r,7);return js.add(o,Vs),o})},Js=function(t,e,n,r,o,i){var u=Pc.absolute(e),a=n.length>0?o.positions(n,e):[];Ks(t,a,u,Va.getOuter(e));var c=r.length>0?i.positions(r,e):[];$s(t,c,u,Fa.getOuter(e))},Qs=function(t,e,n,r){Ys(t);var o=co.fromTable(e),i=ho.generate(o),u=bs.rows(i),a=bs.columns(i);Js(t,e,u,a,n,r)},Zs=function(t,e){var n=Or.descendants(t.parent(),"."+Us);et.each(n,e)},tf=function(t){Zs(t,function(t){Wo.set(t,"display","none")})},ef=function(t){Zs(t,function(t){Wo.set(t,"display","block")})},nf=function(t){return js.has(t,Vs)},rf=function(t){return js.has(t,Gs)},of={refresh:Qs,hide:tf,show:ef,destroy:Ys,isRowBar:nf,isColBar:rf},uf=function(t,e){return is.toGrid(t,e,!1)},af=function(t,e){var n=function(t){return jl.findMap(t,function(t){return Vn.parent(t.element()).map(function(t){var e=Vn.parent(t).isNone();return Lt.elementnew(t,e)})}).getOrThunk(function(){return Lt.elementnew(e.row(),!0)})};return et.map(t,function(t){var e=n(t.details());return Lt.rowdatanew(e.element(),t.details(),t.section(),e.isNew())})},cf=function(t,e){var n=is.toDetails(t,Rn.eq);return af(n,e)},lf=function(t,e){var n=et.flatten(et.map(t.all(),function(t){return t.cells()}));return et.find(n,function(t){return Rn.eq(e,t.element())})},sf=function(t,e,n,r,o){return function(i,u,a,c,l){var s=co.fromTable(u),f=ho.generate(s);return e(f,a).map(function(e){var n=uf(f,c),r=t(n,e,Rn.eq,o(c)),i=cf(r.grid(),c);return{grid:v.constant(i),cursor:r.cursor}}).fold(function(){return R.none()},function(t){var e=ls.render(u,t.grid());return n(u,t.grid(),l),r(u),of.refresh(i,u,$c.height,l),R.some({cursor:t.cursor,newRows:e.newRows,newCells:e.newCells})})}},ff=function(t,e){return io.cell(e.element()).bind(function(e){return lf(t,e)})},df=function(t,e){return io.cell(e.element()).bind(function(n){return lf(t,n).map(function(t){return Fl.merge(t,{generators:e.generators,clipboard:e.clipboard})})})},mf=function(t,e){var n=et.map(e.selection(),function(e){return io.cell(e).bind(function(e){return lf(t,e)})}),r=jl.cat(n);return r.length>0?R.some(Fl.merge({cells:r},{generators:e.generators,clipboard:e.clipboard})):R.none()},gf=function(t,e){return e.mergable()},pf=function(t,e){return e.unmergable()},hf=function(t,e){var n=et.map(e.selection(),function(e){return io.cell(e).bind(function(e){return lf(t,e)})}),r=jl.cat(n);return r.length>0?R.some(r):R.none()},vf={run:sf,toDetailList:cf,onCell:ff,onCells:hf,onPaste:df,onPasteRows:mf,onMergable:gf,onUnmergable:pf},bf=function(t){var e=function(e){return t===e},n=function(e){return bf(t)},r=function(e){return bf(t)},o=function(e){return bf(e(t))},i=function(e){e(t)},u=function(e){return e(t)},a=function(e,n){return n(t)},c=function(e){return e(t)},l=function(e){return e(t)},s=function(){return R.some(t)};return{is:e,isValue:v.constant(!0),isError:v.constant(!1),getOr:v.constant(t),getOrThunk:v.constant(t),getOrDie:v.constant(t),or:n,orThunk:r,fold:a,map:o,each:i,bind:u,exists:c,forall:l,toOption:s}},wf=function(t){var e=function(t){return t()},n=function(){return v.die(t)()},r=function(t){return t},o=function(t){return t()},i=function(e){return wf(t)},u=function(e){return wf(t)},a=function(e,n){return e(t)};return{is:v.constant(!1),isValue:v.constant(!1),isError:v.constant(!0),getOr:v.identity,getOrThunk:e,getOrDie:n,or:r,orThunk:o,fold:a,map:i,each:v.noop,bind:u,exists:v.constant(!1),forall:v.constant(!0),toOption:R.none}},yf={value:bf,error:wf},xf=function(t,e,n){if(t.row()>=e.length||t.column()>Jl.cellLength(e[0]))return yf.error("invalid start address out of table bounds, row: "+t.row()+", column: "+t.column());var r=e.slice(t.row()),o=r[0].cells().slice(t.column()),i=Jl.cellLength(n[0]),u=n.length;return yf.value({rowDelta:v.constant(r.length-u),colDelta:v.constant(o.length-i)})},Cf=function(t,e){var n=Jl.cellLength(t[0]),r=Jl.cellLength(e[0]);return{rowDelta:v.constant(0),colDelta:v.constant(n-r)}},Sf=function(t,e){return et.map(t,function(){return Lt.elementnew(e.cell(),!0)})},Rf=function(t,e,n){return t.concat(gs.repeat(e,function(e){return Jl.setCells(t[t.length-1],Sf(t[t.length-1].cells(),n))}))},Tf=function(t,e,n){return et.map(t,function(t){return Jl.setCells(t,t.cells().concat(Sf(gs.range(0,e),n)))})},Af=function(t,e,n){var r=e.colDelta()<0?Tf:v.identity;return(e.rowDelta()<0?Rf:v.identity)(r(t,Math.abs(e.colDelta()),n),Math.abs(e.rowDelta()),n)},Df={measure:xf,measureWidth:Cf,tailor:Af},Ef=function(t,e,n,r){if(0===t.length)return t;for(var o=e.startRow();o<=e.finishRow();o++)for(var i=e.startCol();i<=e.finishCol();i++)Jl.mutateCell(t[o],i,Lt.elementnew(r(),!1));return t},kf=function(t,e,n,r){for(var o=!0,i=0;i<t.length;i++)for(var u=0;u<Jl.cellLength(t[0]);u++){var a=Jl.getCellElement(t[i],u),c=n(a,e);!0===c&&!1===o?Jl.mutateCell(t[i],u,Lt.elementnew(r(),!0)):!0===c&&(o=!1)}return t},Of=function(t,e){return et.foldl(t,function(t,n){return et.exists(t,function(t){return e(t.element(),n.element())})?t:t.concat([n])},[])},Nf=function(t,e,n,r){if(e>0&&e<t.length){var o=t[e-1].cells(),i=Of(o,n);et.each(i,function(o){for(var i=R.none(),u=e;u<t.length;u++)for(var a=0;a<Jl.cellLength(t[0]);a++){var c=t[u].cells()[a],l=n(c.element(),o.element());l&&(i.isNone()&&(i=R.some(r())),i.each(function(e){Jl.mutateCell(t[u],a,Lt.elementnew(e,!0))}))}})}return t},Bf={merge:Ef,unmerge:kf,splitRows:Nf},If=function(t,e,n,r){var o=Jl.getCell(t[e],n),i=v.curry(r,o.element()),u=t[e];return t.length>1&&Jl.cellLength(u)>1&&(n>0&&i(Jl.getCellElement(u,n-1))||n<u.length-1&&i(Jl.getCellElement(u,n+1))||e>0&&i(Jl.getCellElement(t[e-1],n))||e<t.length-1&&i(Jl.getCellElement(t[e+1],n)))},Pf=function(t,e,n,r,o){for(var i=t.row(),u=t.column(),a=n.length,c=Jl.cellLength(n[0]),l=i+a,s=u+c,f=i;f<l;f++)for(var d=u;d<s;d++){If(e,f,d,o)&&Bf.unmerge(e,Jl.getCellElement(e[f],d),o,r.cell);var m=Jl.getCellElement(n[f-i],d-u),g=r.replace(m);Jl.mutateCell(e[f],d,Lt.elementnew(g,!0))}return e},Wf=function(t,e,n,r,o){return Df.measure(t,e,n).map(function(i){var u=Df.tailor(e,i,r);return Pf(t,u,n,r,o)})},Mf=function(t,e,n,r,o){Bf.splitRows(e,t,o,r.cell);var i=Df.measureWidth(n,e),u=Df.tailor(n,i,r),a=Df.measureWidth(e,u),c=Df.tailor(e,a,r);return c.slice(0,t).concat(u).concat(c.slice(t,c.length))},_f={merge:Wf,insert:Mf},Lf=function(t,e,n,r,o){var i=t.slice(0,e),u=t.slice(e),a=Jl.mapCells(t[n],function(n,i){return e>0&&e<t.length&&r(Jl.getCellElement(t[e-1],i),Jl.getCellElement(t[e],i))?Jl.getCell(t[e],i):Lt.elementnew(o(n.element(),r),!0)});return i.concat([a]).concat(u)},Ff=function(t,e,n,r,o){return et.map(t,function(t){var i=e>0&&e<Jl.cellLength(t)&&r(Jl.getCellElement(t,e-1),Jl.getCellElement(t,e)),u=i?Jl.getCell(t,e):Lt.elementnew(o(Jl.getCellElement(t,n),r),!0);return Jl.addCell(t,e,u)})},qf=function(t,e,n,r,o){var i=n+1;return et.map(t,function(t,u){var a=u===e,c=a?Lt.elementnew(o(Jl.getCellElement(t,n),r),!0):Jl.getCell(t,n);return Jl.addCell(t,i,c)})},zf=function(t,e,n,r,o){var i=e+1,u=t.slice(0,i),a=t.slice(i),c=Jl.mapCells(t[e],function(t,e){return e===n?Lt.elementnew(o(t.element(),r),!0):t});return u.concat([c]).concat(a)},Hf=function(t,e,n){var r=et.map(t,function(t){var r=t.cells().slice(0,e).concat(t.cells().slice(n+1));return Lt.rowcells(r,t.section())});return et.filter(r,function(t){return t.cells().length>0})},jf=function(t,e,n){return t.slice(0,e).concat(t.slice(n+1))},Uf={insertRowAt:Lf,insertColumnAt:Ff,splitCellIntoColumns:qf,splitCellIntoRows:zf,deleteRowsAt:jf,deleteColumnsAt:Hf},Vf=function(t,e,n,r){var o=function(t){return et.exists(e,function(e){return n(t.element(),e.element())})};return et.map(t,function(t){return Jl.mapCells(t,function(t){return o(t)?Lt.elementnew(r(t.element(),n),!0):t})})},Gf=function(t,e,n,r){return void 0!==Jl.getCellElement(t[e],n)&&e>0&&r(Jl.getCellElement(t[e-1],n),Jl.getCellElement(t[e],n))},Yf=function(t,e,n){return e>0&&n(Jl.getCellElement(t,e-1),Jl.getCellElement(t,e))},Xf=function(t,e,n,r){var o=et.bind(t,function(r,o){return Gf(t,o,e,n)||Yf(r,e,n)?[]:[Jl.getCell(r,e)]});return Vf(t,o,n,r)},$f=function(t,e,n,r){var o=t[e],i=et.bind(o.cells(),function(r,i){return Gf(t,e,i,n)||Yf(o,i,n)?[]:[r]});return Vf(t,i,n,r)},Kf={replaceColumn:Xf,replaceRow:$f},Jf=function(){return nd(function(t,e,n,r,o){return t()})},Qf=function(t){return nd(function(e,n,r,o,i){return n(t)})},Zf=function(t,e){return nd(function(n,r,o,i,u){return o(t,e)})},td=function(t,e,n){return nd(function(r,o,i,u,a){return u(t,e,n)})},ed=function(t,e){return nd(function(n,r,o,i,u){return u(t,e)})},nd=function(t){return{fold:t}},rd={none:Jf,only:Qf,left:Zf,middle:td,right:ed},od=function(t,e){return 0===t.length?rd.none():1===t.length?rd.only(0):0===e?rd.left(0,1):e===t.length-1?rd.right(e-1,e):e>0&&e<t.length-1?rd.middle(e-1,e,e+1):rd.none()},id=function(t,e,n,r){var o=t.slice(0),i=od(t,e),u=function(t){return et.map(t,v.constant(0))},a=v.constant(u(o)),c=function(t){return r.singleColumnWidth(o[t],n)},l=function(t,e){if(n>=0){var i=Math.max(r.minCellWidth(),o[e]-n);return u(o.slice(0,t)).concat([n,i-o[e]]).concat(u(o.slice(e+1)))}var a=Math.max(r.minCellWidth(),o[t]+n),c=o[t]-a;return u(o.slice(0,t)).concat([a-o[t],c]).concat(u(o.slice(e+1)))},s=l,f=function(t,e,n){return l(e,n)},d=function(t,e){if(n>=0)return u(o.slice(0,e)).concat([n]);var i=Math.max(r.minCellWidth(),o[e]+n);return u(o.slice(0,e)).concat([i-o[e]])};return i.fold(a,c,s,f,d)},ud={determine:id},ad=function(t,e){return gr.has(t,e)&&parseInt(gr.get(t,e),10)>1},cd=function(t){return ad(t,"colspan")},ld=function(t){return ad(t,"rowspan")},sd=function(t,e){return parseInt(Wo.get(t,e),10)},fd={hasColspan:cd,hasRowspan:ld,minWidth:v.constant(10),minHeight:v.constant(10),getInt:sd},dd=function(t,e,n){return Wo.getRaw(t,e).fold(function(){return n(t)+"px"},function(t){return t})},md=function(t){return dd(t,"width",Cc.getPixelWidth)},gd=function(t){return dd(t,"height",Cc.getHeight)},pd=function(t,e,n,r,o){var i=bs.columns(t),u=et.map(i,function(t){return t.map(e.edge)});return et.map(i,function(t,e){return t.filter(v.not(fd.hasColspan)).fold(function(){var t=gs.deduce(u,e);return r(t)},function(t){return n(t,o)})})},hd=function(t){return t.map(function(t){return t+"px"}).getOr("")},vd=function(t,e){return pd(t,e,md,hd)},bd=function(t,e,n){return pd(t,e,Cc.getPercentageWidth,function(t){return t.fold(function(){return n.minCellWidth()},function(t){return t/n.pixelWidth()*100})},n)},wd=function(t,e,n){return pd(t,e,Cc.getPixelWidth,function(t){return t.getOrThunk(n.minCellWidth)},n)},yd=function(t,e,n,r){var o=bs.rows(t),i=et.map(o,function(t){return t.map(e.edge)});return et.map(o,function(t,e){return t.filter(v.not(fd.hasRowspan)).fold(function(){var t=gs.deduce(i,e);return r(t)},function(t){return n(t)})})},xd=function(t,e){return yd(t,e,Cc.getHeight,function(t){return t.getOrThunk(fd.minHeight)})},Cd=function(t,e){return yd(t,e,gd,hd)},Sd={getRawWidths:vd,getPixelWidths:wd,getPercentageWidths:bd,getPixelHeights:xd,getRawHeights:Cd},Rd=function(t,e,n){for(var r=0,o=t;o<e;o++)r+=void 0!==n[o]?n[o]:0;return r},Td=function(t,e){var n=ho.justCells(t);return et.map(n,function(t){var n=Rd(t.column(),t.column()+t.colspan(),e);return{element:t.element,width:v.constant(n),colspan:t.colspan}})},Ad=function(t,e){var n=ho.justCells(t);return et.map(n,function(t){var n=Rd(t.row(),t.row()+t.rowspan(),e);return{element:t.element,height:v.constant(n),rowspan:t.rowspan}})},Dd=function(t,e){return et.map(t.all(),function(t,n){return{element:t.element,height:v.constant(e[n])}})},Ed={recalculateWidth:Td,recalculateHeight:Ad,matchRowHeight:Dd},kd=function(t,e){var n=parseFloat(t),r=Va.get(e),o=function(t){return t/r*100},i=function(t,e){return[100-t]},u=function(){return fd.minWidth()/r*100},a=function(t,e,r){var o=n+r;Cc.setPercentageWidth(t,o)};return{width:v.constant(n),pixelWidth:v.constant(r),getWidths:Sd.getPercentageWidths,getCellDelta:o,singleColumnWidth:i,minCellWidth:u,setElementWidth:Cc.setPercentageWidth,setTableWidth:a}},Od=function(t){var e=parseInt(t,10),n=v.identity,r=function(t,e){return[Math.max(fd.minWidth(),t+e)-t]},o=function(t,e,n){var r=et.foldr(e,function(t,e){return t+e},0);Cc.setPixelWidth(t,r)};return{width:v.constant(e),pixelWidth:v.constant(e),getWidths:Sd.getPixelWidths,getCellDelta:n,singleColumnWidth:r,minCellWidth:fd.minWidth,setElementWidth:Cc.setPixelWidth,setTableWidth:o}},Nd=function(t,e){if(Cc.percentageBasedSizeRegex().test(e)){var n=Cc.percentageBasedSizeRegex().exec(e);return kd(n[1],t)}if(Cc.pixelBasedSizeRegex().test(e)){var r=Cc.pixelBasedSizeRegex().exec(e);return Od(r[1])}var o=Va.get(t);return Od(o)},Bd=function(t){return Cc.getRawWidth(t).fold(function(){var e=Va.get(t);return Od(e)},function(e){return Nd(t,e)})},Id={getTableSize:Bd},Pd=function(t){return ho.generate(t)},Wd=function(t){return et.foldr(t,function(t,e){return t+e},0)},Md=function(t){var e=co.fromTable(t);return Pd(e)},_d=function(t,e,n,r){var o=Id.getTableSize(t),i=o.getCellDelta(e),u=Md(t),a=o.getWidths(u,r,o),c=ud.determine(a,n,i,o),l=et.map(c,function(t,e){return t+a[e]}),s=Ed.recalculateWidth(u,l);et.each(s,function(t){o.setElementWidth(t.element(),t.width())}),n===u.grid().columns()-1&&o.setTableWidth(t,l,i)},Ld=function(t,e,n,r){var o=Md(t),i=Sd.getPixelHeights(o,r),u=et.map(i,function(t,r){return n===r?Math.max(e+t,fd.minHeight()):t}),a=Ed.recalculateHeight(o,u),c=Ed.matchRowHeight(o,u);et.each(c,function(t){Cc.setHeight(t.element(),t.height())}),et.each(a,function(t){Cc.setHeight(t.element(),t.height())});var l=Wd(u);Cc.setHeight(t,l)},Fd=function(t,e,n){var r=Id.getTableSize(t),o=Pd(e),i=r.getWidths(o,n,r),u=Ed.recalculateWidth(o,i);et.each(u,function(t){r.setElementWidth(t.element(),t.width())});var a=et.foldr(i,function(t,e){return e+t},0);u.length>0&&r.setElementWidth(t,a)},qd={adjustWidth:_d,adjustHeight:Ld,adjustWidthTo:Fd},zd=function(t){0===io.cells(t).length&&Jo.remove(t)},Hd=Rt.immutable("grid","cursor"),jd=function(t,e,n){return Ud(t,e,n).orThunk(function(){return Ud(t,0,0)})},Ud=function(t,e,n){return R.from(t[e]).bind(function(t){return R.from(t.cells()[n]).bind(function(t){return R.from(t.element())})})},Vd=function(t,e,n){return Hd(t,Ud(t,e,n))},Gd=function(t){return et.foldl(t,function(t,e){return et.exists(t,function(t){return t.row()===e.row()})?t:t.concat([e])},[]).sort(function(t,e){return t.row()-e.row()})},Yd=function(t){return et.foldl(t,function(t,e){return et.exists(t,function(t){return t.column()===e.column()})?t:t.concat([e])},[]).sort(function(t,e){return t.column()-e.column()})},Xd=function(t,e,n,r){var o=e.row(),i=e.row(),u=Uf.insertRowAt(t,i,o,n,r.getOrInit);return Vd(u,i,e.column())},$d=function(t,e,n,r){var o=e[0].row(),i=e[0].row(),u=Gd(e),a=et.foldl(u,function(t,e){return Uf.insertRowAt(t,i,o,n,r.getOrInit)},t);return Vd(a,i,e[0].column())},Kd=function(t,e,n,r){var o=e.row(),i=e.row()+e.rowspan(),u=Uf.insertRowAt(t,i,o,n,r.getOrInit);return Vd(u,i,e.column())},Jd=function(t,e,n,r){var o=Gd(e),i=o[o.length-1].row(),u=o[o.length-1].row()+o[o.length-1].rowspan(),a=et.foldl(o,function(t,e){return Uf.insertRowAt(t,u,i,n,r.getOrInit)},t);return Vd(a,u,e[0].column())},Qd=function(t,e,n,r){var o=e.column(),i=e.column(),u=Uf.insertColumnAt(t,i,o,n,r.getOrInit);return Vd(u,e.row(),i)},Zd=function(t,e,n,r){var o=Yd(e),i=o[0].column(),u=o[0].column(),a=et.foldl(o,function(t,e){return Uf.insertColumnAt(t,u,i,n,r.getOrInit)},t);return Vd(a,e[0].row(),u)},tm=function(t,e,n,r){var o=e.column(),i=e.column()+e.colspan(),u=Uf.insertColumnAt(t,i,o,n,r.getOrInit);return Vd(u,e.row(),i)},em=function(t,e,n,r){var o=e[e.length-1].column(),i=e[e.length-1].column()+e[e.length-1].colspan(),u=Yd(e),a=et.foldl(u,function(t,e){return Uf.insertColumnAt(t,i,o,n,r.getOrInit)},t);return Vd(a,e[0].row(),i)},nm=function(t,e,n,r){var o=Kf.replaceRow(t,e.row(),n,r.replaceOrInit);return Vd(o,e.row(),e.column())},rm=function(t,e,n,r){var o=Kf.replaceColumn(t,e.column(),n,r.replaceOrInit);return Vd(o,e.row(),e.column())},om=function(t,e,n,r){var o=Kf.replaceRow(t,e.row(),n,r.replaceOrInit);return Vd(o,e.row(),e.column())},im=function(t,e,n,r){var o=Kf.replaceColumn(t,e.column(),n,r.replaceOrInit);return Vd(o,e.row(),e.column())},um=function(t,e,n,r){var o=Uf.splitCellIntoColumns(t,e.row(),e.column(),n,r.getOrInit);return Vd(o,e.row(),e.column())},am=function(t,e,n,r){var o=Uf.splitCellIntoRows(t,e.row(),e.column(),n,r.getOrInit);return Vd(o,e.row(),e.column())},cm=function(t,e,n,r){var o=Yd(e),i=Uf.deleteColumnsAt(t,o[0].column(),o[o.length-1].column()),u=jd(i,e[0].row(),e[0].column());return Hd(i,u)},lm=function(t,e,n,r){var o=Gd(e),i=Uf.deleteRowsAt(t,o[0].row(),o[o.length-1].row()),u=jd(i,e[0].row(),e[0].column());return Hd(i,u)},sm=function(t,e,n,r){var o=e.cells();Il.merge(o);var i=Bf.merge(t,e.bounds(),n,v.constant(o[0]));return Hd(i,R.from(o[0]))},fm=function(t,e,n,r){var o=et.foldr(e,function(t,e){return Bf.unmerge(t,e,n,r.combine(e))},t);return Hd(o,R.from(e[0]))},dm=function(t,e,n,r){var o=function(t,e){var n=co.fromTable(t),r=ho.generate(n);return is.toGrid(r,e,!0)}(e.clipboard(),e.generators()),i=Lt.address(e.row(),e.column());return _f.merge(i,t,o,e.generators(),n).fold(function(){return Hd(t,R.some(e.element()))},function(t){var n=jd(t,e.row(),e.column());return Hd(t,n)})},mm=function(t,e,n){var r=co.fromPastedRows(t,n),o=ho.generate(r);return is.toGrid(o,e,!0)},gm=function(t,e,n,r){var o=t[e.cells[0].row()],i=e.cells[0].row(),u=mm(e.clipboard(),e.generators(),o),a=_f.insert(i,t,u,e.generators(),n),c=jd(a,e.cells[0].row(),e.cells[0].column());return Hd(a,c)},pm=function(t,e,n,r){var o=t[e.cells[0].row()],i=e.cells[e.cells.length-1].row()+e.cells[e.cells.length-1].rowspan(),u=mm(e.clipboard(),e.generators(),o),a=_f.insert(i,t,u,e.generators(),n),c=jd(a,e.cells[0].row(),e.cells[0].column());return Hd(a,c)},hm=qd.adjustWidthTo,vm={insertRowBefore:vf.run(Xd,vf.onCell,v.noop,v.noop,fl.modification),insertRowsBefore:vf.run($d,vf.onCells,v.noop,v.noop,fl.modification),insertRowAfter:vf.run(Kd,vf.onCell,v.noop,v.noop,fl.modification),insertRowsAfter:vf.run(Jd,vf.onCells,v.noop,v.noop,fl.modification),insertColumnBefore:vf.run(Qd,vf.onCell,hm,v.noop,fl.modification),insertColumnsBefore:vf.run(Zd,vf.onCells,hm,v.noop,fl.modification),insertColumnAfter:vf.run(tm,vf.onCell,hm,v.noop,fl.modification),insertColumnsAfter:vf.run(em,vf.onCells,hm,v.noop,fl.modification),splitCellIntoColumns:vf.run(um,vf.onCell,hm,v.noop,fl.modification),splitCellIntoRows:vf.run(am,vf.onCell,v.noop,v.noop,fl.modification),eraseColumns:vf.run(cm,vf.onCells,hm,zd,fl.modification),eraseRows:vf.run(lm,vf.onCells,v.noop,zd,fl.modification),makeColumnHeader:vf.run(rm,vf.onCell,v.noop,v.noop,fl.transform("row","th")),unmakeColumnHeader:vf.run(im,vf.onCell,v.noop,v.noop,fl.transform(null,"td")),makeRowHeader:vf.run(nm,vf.onCell,v.noop,v.noop,fl.transform("col","th")),unmakeRowHeader:vf.run(om,vf.onCell,v.noop,v.noop,fl.transform(null,"td")),mergeCells:vf.run(sm,vf.onMergable,v.noop,v.noop,fl.merging),unmergeCells:vf.run(fm,vf.onUnmergable,hm,v.noop,fl.merging),pasteCells:vf.run(dm,vf.onPaste,hm,v.noop,fl.modification),pasteRowsBefore:vf.run(gm,vf.onPasteRows,v.noop,v.noop,fl.modification),pasteRowsAfter:vf.run(pm,vf.onPasteRows,v.noop,v.noop,fl.modification)},bm=function(t){return Ut.fromDom(t.getBody())},wm=function(t){return function(e){return Rn.eq(e,bm(t))}},ym=function(t){return t?t.replace(/px$/,""):""},xm=function(t){return/^[0-9]+$/.test(t)&&(t+="px"),t},Cm={getBody:bm,getIsRoot:wm,addSizeSuffix:xm,removePxSuffix:ym},Sm=function(t,e){return function(n){return"rtl"===Rm(n)?e:t}},Rm=function(t){return"rtl"===Wo.get(t,"direction")?"rtl":"ltr"},Tm={onDirection:Sm,getDirection:Rm},Am={isRtl:v.constant(!1)},Dm={isRtl:v.constant(!0)},Em=function(t){return"rtl"===Tm.getDirection(t)?Dm:Am},km={directionAt:Em},Om=function(t,e){var n,r=function(t){return"table"===rr.name(Cm.getBody(t))},o=function(e){var n=Zc.getGridSize(e);return!1===r(t)||n.rows()>1},i=function(e){var n=Zc.getGridSize(e);return!1===r(t)||n.columns()>1},u=function(e){return t.fire("newrow",{node:e.dom()}),e.dom()},a=function(e){return t.fire("newcell",{node:e.dom()}),e.dom()};!1!==t.settings.table_clone_elements&&("string"==typeof t.settings.table_clone_elements?n=t.settings.table_clone_elements.split(/[ ,]/):Array.isArray(t.settings.table_clone_elements)&&(n=t.settings.table_clone_elements));var c=R.from(n),l=function(e,n,r,o){return function(i,l){var s=Or.descendants(i,"td[data-mce-style],th[data-mce-style]");et.each(s,function(t){gr.remove(t,"data-mce-style")});var f=o(),d=Ut.fromDom(t.getDoc()),m=Jc(km.directionAt),g=Wi.cellOperations(r,d,c);return n(i)?e(f,i,l,g,m).bind(function(e){return et.each(e.newRows(),function(t){u(t)}),et.each(e.newCells(),function(t){a(t)}),e.cursor().map(function(e){var n=t.dom.createRng();return n.setStart(e.dom(),0),n.setEnd(e.dom(),0),n})}):R.none()}};return{deleteRow:l(vm.eraseRows,o,v.noop,e),deleteColumn:l(vm.eraseColumns,i,v.noop,e),insertRowsBefore:l(vm.insertRowsBefore,v.always,v.noop,e),insertRowsAfter:l(vm.insertRowsAfter,v.always,v.noop,e),insertColumnsBefore:l(vm.insertColumnsBefore,v.always,Rc.halve,e),insertColumnsAfter:l(vm.insertColumnsAfter,v.always,Rc.halve,e),mergeCells:l(vm.mergeCells,v.always,v.noop,e),unmergeCells:l(vm.unmergeCells,v.always,v.noop,e),pasteRowsBefore:l(vm.pasteRowsBefore,v.always,v.noop,e),pasteRowsAfter:l(vm.pasteRowsAfter,v.always,v.noop,e),pasteCells:l(vm.pasteCells,v.always,v.noop,e)}},Nm=function(t,e,n){var r=co.fromTable(t),o=ho.generate(r);return vf.onCells(o,e).map(function(t){var e=is.toGrid(o,n,!1),r=e.slice(t[0].row(),t[t.length-1].row()+t[t.length-1].rowspan()),i=vf.toDetailList(r,n);return ls.copy(i)})},Bm={copyRows:Nm},Im=tinymce.util.Tools.resolve("tinymce.util.Tools"),Pm=tinymce.util.Tools.resolve("tinymce.Env"),Wm=function(t,e,n){var r,o=t.select("td,th",e);return r=function(e,r){for(var o=0;o<r.length;o++){var i=t.getStyle(r[o],n);if(void 0===e&&(e=i),e!==i)return""}return e}(r,o)},Mm=function(t,e,n){n&&t.formatter.apply("align"+n,{},e)},_m=function(t,e,n){n&&t.formatter.apply("valign"+n,{},e)},Lm=function(t,e){Im.each("left center right".split(" "),function(n){t.formatter.remove("align"+n,{},e)})},Fm=function(t,e){Im.each("top middle bottom".split(" "),function(n){t.formatter.remove("valign"+n,{},e)})},qm={applyAlign:Mm,applyVAlign:_m,unApplyAlign:Lm,unApplyVAlign:Fm,getTDTHOverallStyle:Wm},zm=function(t,e,n){var r=function(t,n){return n=n||[],Im.each(t,function(t){var o={text:t.text||t.title};t.menu?o.menu=r(t.menu):(o.value=t.value,e&&e(o)),n.push(o)}),n};return r(t,n||[])},Hm=function(t,e){var n=t.dom,r=e.control.rootControl,o=r.toJSON(),i=n.parseStyle(o.style);"style"===e.control.name()?(r.find("#borderStyle").value(i["border-style"]||"")[0].fire("select"),r.find("#borderColor").value(i["border-color"]||"")[0].fire("change"),r.find("#backgroundColor").value(i["background-color"]||"")[0].fire("change"),r.find("#width").value(i.width||"").fire("change"),r.find("#height").value(i.height||"").fire("change")):(i["border-style"]=o.borderStyle,i["border-color"]=o.borderColor,i["background-color"]=o.backgroundColor,i.width=o.width?Cm.addSizeSuffix(o.width):"",i.height=o.height?Cm.addSizeSuffix(o.height):""),r.find("#style").value(n.serializeStyle(n.parseStyle(n.serializeStyle(i))))},jm=function(t,e){var n=t.parseStyle(t.getAttrib(e,"style")),r={};return n["border-style"]&&(r.borderStyle=n["border-style"]),n["border-color"]&&(r.borderColor=n["border-color"]),n["background-color"]&&(r.backgroundColor=n["background-color"]),r.style=t.serializeStyle(n),r},Um=function(t){var e=function(){var e=t.settings.color_picker_callback;if(e)return function(n){return e.call(t,function(t){n.control.value(t).fire("change")},n.control.value())}};return{title:"Advanced",type:"form",defaults:{onchange:v.curry(Hm,t)},items:[{label:"Style",name:"style",type:"textbox"},{type:"form",padding:0,formItemDefaults:{layout:"grid",alignH:["start","right"]},defaults:{size:7},items:[{label:"Border style",type:"listbox",name:"borderStyle",width:90,onselect:v.curry(Hm,t),values:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{label:"Border color",type:"colorbox",name:"borderColor",onaction:e()},{label:"Background color",type:"colorbox",name:"backgroundColor",onaction:e()}]}]}},Vm={createStyleForm:Um,buildListItems:zm,updateStyleField:Hm,extractAdvancedStyles:jm},Gm=function(t,e){var n=t.dom,r={width:n.getStyle(e,"width")||n.getAttrib(e,"width"),height:n.getStyle(e,"height")||n.getAttrib(e,"height"),cellspacing:n.getStyle(e,"border-spacing")||n.getAttrib(e,"cellspacing"),cellpadding:n.getAttrib(e,"data-mce-cell-padding")||n.getAttrib(e,"cellpadding")||qm.getTDTHOverallStyle(t.dom,e,"padding"),border:n.getAttrib(e,"data-mce-border")||n.getAttrib(e,"border")||qm.getTDTHOverallStyle(t.dom,e,"border"),borderColor:n.getAttrib(e,"data-mce-border-color"),caption:!!n.select("caption",e)[0],class:n.getAttrib(e,"class")};return Im.each("left center right".split(" "),function(n){t.formatter.matchNode(e,"align"+n)&&(r.align=n)}),!1!==t.settings.table_advtab&&Im.extend(r,Vm.extractAdvancedStyles(n,e)),r},Ym=function(e,n,r){var o=e.dom,i={},u={};if(i.class=r.class,u.height=Cm.addSizeSuffix(r.height),o.getAttrib(n,"width")&&!e.settings.table_style_by_css?i.width=Cm.removePxSuffix(r.width):u.width=Cm.addSizeSuffix(r.width),e.settings.table_style_by_css?(u["border-width"]=Cm.addSizeSuffix(r.border),u["border-spacing"]=Cm.addSizeSuffix(r.cellspacing),Im.extend(i,{"data-mce-border-color":r.borderColor,"data-mce-cell-padding":r.cellpadding,"data-mce-border":r.border})):Im.extend(i,{border:r.border,cellpadding:r.cellpadding,cellspacing:r.cellspacing}),e.settings.table_style_by_css&&n.children)for(var a=0;a<n.children.length;a++)t(o,n.children[a],{"border-width":Cm.addSizeSuffix(r.border),"border-color":r.borderColor,padding:Cm.addSizeSuffix(r.cellpadding)});r.style?Im.extend(u,o.parseStyle(r.style)):u=Im.extend({},o.parseStyle(o.getAttrib(n,"style")),u),i.style=o.serializeStyle(u),o.setAttribs(n,i)},Xm=function(t,e,n){var r,o,i=t.dom;Vm.updateStyleField(t,n),o=n.control.rootControl.toJSON(),!1===o.class&&delete o.class,t.undoManager.transact(function(){e||(e=Ba.insert(t,o.cols||1,o.rows||1)),Ym(t,e,o),r=i.select("caption",e)[0],r&&!o.caption&&i.remove(r),!r&&o.caption&&(r=i.create("caption"),r.innerHTML=Pm.ie?"Â ":'<br data-mce-bogus="1"/>',e.insertBefore(r,e.firstChild)),qm.unApplyAlign(t,e),o.align&&qm.applyAlign(t,e,o.align),t.focus(),t.addVisual()})},$m=function(t,e){var n,r,o,i,u,a=t.dom,c={};!0===e?(n=a.getParent(t.selection.getStart(),"table"))&&(c=Gm(t,n)):(r={label:"Cols",name:"cols"},o={label:"Rows",name:"rows"}),t.settings.table_class_list&&(c.class&&(c.class=c.class.replace(/\s*mce\-item\-table\s*/g,"")),i={name:"class",type:"listbox",label:"Class",values:Vm.buildListItems(t.settings.table_class_list,function(e){e.value&&(e.textStyle=function(){return t.formatter.getCssText({block:"table",classes:[e.value]})})})}),u={type:"form",layout:"flex",direction:"column",labelGapCalc:"children",padding:0,items:[{type:"form",labelGapCalc:!1,padding:0,layout:"grid",columns:2,defaults:{type:"textbox",maxWidth:50},items:!1!==t.settings.table_appearance_options?[r,o,{label:"Width",name:"width",onchange:v.curry(Vm.updateStyleField,t)},{label:"Height",name:"height",onchange:v.curry(Vm.updateStyleField,t)},{label:"Cell spacing",name:"cellspacing"},{label:"Cell padding",name:"cellpadding"},{label:"Border",name:"border"},{label:"Caption",name:"caption",type:"checkbox"}]:[r,o,{label:"Width",name:"width",onchange:v.curry(Vm.updateStyleField,t)},{label:"Height",name:"height",onchange:v.curry(Vm.updateStyleField,t)}]},{label:"Alignment",name:"align",type:"listbox",text:"None",values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},i]},!1!==t.settings.table_advtab?t.windowManager.open({title:"Table properties",data:c,bodyType:"tabpanel",body:[{title:"General",type:"form",items:u},Vm.createStyleForm(t)],onsubmit:v.curry(Xm,t,n)}):t.windowManager.open({title:"Table properties",data:c,body:u,onsubmit:v.curry(Xm,t,n)})},Km={open:$m},Jm=function(t,e){var n=t.dom,r={height:n.getStyle(e,"height")||n.getAttrib(e,"height"),scope:n.getAttrib(e,"scope"),class:n.getAttrib(e,"class")};return r.type=e.parentNode.nodeName.toLowerCase(),Im.each("left center right".split(" "),function(n){t.formatter.matchNode(e,"align"+n)&&(r.align=n)}),!1!==t.settings.table_row_advtab&&Im.extend(r,Vm.extractAdvancedStyles(n,e)),r},Qm=function(t,e,n){var r=t.getParent(e,"table"),o=e.parentNode,i=t.select(n,r)[0];i||(i=t.create(n),r.firstChild?"CAPTION"===r.firstChild.nodeName?t.insertAfter(i,r.firstChild):r.insertBefore(i,r.firstChild):r.appendChild(i)),i.appendChild(e),o.hasChildNodes()||t.remove(o)},Zm=function(t){var n,r,o,i,u,a,c=t.dom,l=[];n=c.getParent(t.selection.getStart(),"table"),r=c.getParent(t.selection.getStart(),"td,th"),Im.each(n.rows,function(t){Im.each(t.cells,function(e){if(c.getAttrib(e,"data-mce-selected")||e===r)return l.push(t),!1})}),(o=l[0])&&(u=l.length>1?{height:"",scope:"",class:"",align:"",type:o.parentNode.nodeName.toLowerCase()}:Jm(t,o),t.settings.table_row_class_list&&(i={name:"class",type:"listbox",label:"Class",values:Vm.buildListItems(t.settings.table_row_class_list,function(e){e.value&&(e.textStyle=function(){return t.formatter.getCssText({block:"tr",classes:[e.value]})})})}),a={type:"form",columns:2,padding:0,defaults:{
type:"textbox"},items:[{type:"listbox",name:"type",label:"Row type",text:"Header",maxWidth:null,values:[{text:"Header",value:"thead"},{text:"Body",value:"tbody"},{text:"Footer",value:"tfoot"}]},{type:"listbox",name:"align",label:"Alignment",text:"None",maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height"},i]},!1!==t.settings.table_row_advtab?t.windowManager.open({title:"Row properties",data:u,bodyType:"tabpanel",body:[{title:"General",type:"form",items:a},Vm.createStyleForm(t)],onsubmit:v.curry(e,t,l)}):t.windowManager.open({title:"Row properties",data:u,body:a,onsubmit:v.curry(e,t,l)}))},tg={open:Zm},eg=function(t,e){t.style.cssText+=";"+e},ng=function(t,e){var n=t.dom,r={width:n.getStyle(e,"width")||n.getAttrib(e,"width"),height:n.getStyle(e,"height")||n.getAttrib(e,"height"),scope:n.getAttrib(e,"scope"),class:n.getAttrib(e,"class")};return r.type=e.nodeName.toLowerCase(),Im.each("left center right".split(" "),function(n){t.formatter.matchNode(e,"align"+n)&&(r.align=n)}),Im.each("top middle bottom".split(" "),function(n){t.formatter.matchNode(e,"valign"+n)&&(r.valign=n)}),!1!==t.settings.table_cell_advtab&&Im.extend(r,Vm.extractAdvancedStyles(n,e)),r},rg=function(t,e,n){function r(t,e,n){n&&u.setAttrib(t,e,n)}function o(t,e,n){n&&u.setStyle(t,e,n)}var i,u=t.dom;Vm.updateStyleField(t,n),i=n.control.rootControl.toJSON(),t.undoManager.transact(function(){Im.each(e,function(n){r(n,"scope",i.scope),1===e.length?r(n,"style",i.style):eg(n,i.style),r(n,"class",i.class),o(n,"width",Cm.addSizeSuffix(i.width)),o(n,"height",Cm.addSizeSuffix(i.height)),i.type&&n.nodeName.toLowerCase()!==i.type&&(n=u.rename(n,i.type)),1===e.length&&(qm.unApplyAlign(t,n),qm.unApplyVAlign(t,n)),i.align&&qm.applyAlign(t,n,i.align),i.valign&&qm.applyVAlign(t,n,i.valign)}),t.focus()})},og=function(t){var e,n,r,o=[];if(o=t.dom.select("td[data-mce-selected],th[data-mce-selected]"),e=t.dom.getParent(t.selection.getStart(),"td,th"),!o.length&&e&&o.push(e),e=e||o[0]){n=o.length>1?{width:"",height:"",scope:"",class:"",align:"",style:"",type:e.nodeName.toLowerCase()}:ng(t,e),t.settings.table_cell_class_list&&(r={name:"class",type:"listbox",label:"Class",values:Vm.buildListItems(t.settings.table_cell_class_list,function(e){e.value&&(e.textStyle=function(){return t.formatter.getCssText({block:"td",classes:[e.value]})})})});var i={type:"form",layout:"flex",direction:"column",labelGapCalc:"children",padding:0,items:[{type:"form",layout:"grid",columns:2,labelGapCalc:!1,padding:0,defaults:{type:"textbox",maxWidth:50},items:[{label:"Width",name:"width",onchange:v.curry(Vm.updateStyleField,t)},{label:"Height",name:"height",onchange:v.curry(Vm.updateStyleField,t)},{label:"Cell type",name:"type",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{label:"Scope",name:"scope",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{label:"H Align",name:"align",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"V Align",name:"valign",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}]},r]};!1!==t.settings.table_cell_advtab?t.windowManager.open({title:"Cell properties",bodyType:"tabpanel",data:n,body:[{title:"General",type:"form",items:i},Vm.createStyleForm(t)],onsubmit:v.curry(rg,t,o)}):t.windowManager.open({title:"Cell properties",data:n,body:i,onsubmit:v.curry(rg,t,o)})}},ig={open:og},ug=Im.each,ag=R.none(),cg=function(){return ag.fold(function(){},function(t){return et.map(t,function(t){return t.dom()})})},lg=function(t){var e=et.map(t,Ut.fromDom);ag=R.from(e)},sg=function(t,e,n,r){var o=Cm.getIsRoot(t),i=function(){var e=Ut.fromDom(t.dom.getParent(t.selection.getStart(),"th,td"));io.table(e,o).filter(v.not(o)).each(function(e){var n=Ut.fromText("");Ho.after(e,n),Jo.remove(e);var r=t.dom.createRng();r.setStart(n.dom(),0),r.setEnd(n.dom(),0),t.selection.setRng(r)})},u=function(){return Ut.fromDom(t.dom.getParent(t.selection.getStart(),"th,td"))},a=function(t){return io.table(t,o)},c=function(e){var o=u();a(o).each(function(i){var u=da.forMenu(r,i,o);e(i,u).each(function(e){t.selection.setRng(e),t.focus(),n.clear(i)})})},l=function(e){var n=u();return a(n).bind(function(e){var o=Ut.fromDom(t.getDoc()),i=da.forMenu(r,e,n),u=Wi.cellOperations(v.noop,o,R.none());return Bm.copyRows(e,i,u)})},s=function(e){ag.each(function(o){var i=et.map(o,function(t){return fi.deep(t)}),c=u();a(c).bind(function(o){var u=Ut.fromDom(t.getDoc()),a=Wi.paste(u),l=da.pasteRows(r,o,c,i,a);e(o,l).each(function(e){t.selection.setRng(e),t.focus(),n.clear(o)})})})};ug({mceTableSplitCells:function(){c(e.unmergeCells)},mceTableMergeCells:function(){c(e.mergeCells)},mceTableInsertRowBefore:function(){c(e.insertRowsBefore)},mceTableInsertRowAfter:function(){c(e.insertRowsAfter)},mceTableInsertColBefore:function(){c(e.insertColumnsBefore)},mceTableInsertColAfter:function(){c(e.insertColumnsAfter)},mceTableDeleteCol:function(){c(e.deleteColumn)},mceTableDeleteRow:function(){c(e.deleteRow)},mceTableCutRow:function(t){ag=l(),c(e.deleteRow)},mceTableCopyRow:function(t){ag=l()},mceTablePasteRowBefore:function(t){s(e.pasteRowsBefore)},mceTablePasteRowAfter:function(t){s(e.pasteRowsAfter)},mceTableDelete:i},function(e,n){t.addCommand(n,e)}),ug({mceInsertTable:v.curry(Km.open,t),mceTableProps:v.curry(Km.open,t,!0),mceTableRowProps:v.curry(tg.open,t),mceTableCellProps:v.curry(ig.open,t)},function(e,n){t.addCommand(n,function(t,n){e(n)})})},fg={registerCommands:sg,getClipboardRows:cg,setClipboardRows:lg},dg=function(t){var e=R.from(t.dom().documentElement).map(Ut.fromDom).getOr(t);return{parent:v.constant(e),view:v.constant(t),origin:v.constant(Ec(0,0))}},mg=function(t,e){var n=v.curry(Pc.absolute,e);return{parent:v.constant(e),view:v.constant(t),origin:n}},gg=function(t,e){return{parent:v.constant(e),view:v.constant(t),origin:v.constant(Ec(0,0))}},pg={only:dg,detached:mg,body:gg},hg=function(t){var e=Rt.immutable.apply(null,t),n=[];return{bind:function(t){if(void 0===t)throw"Event bind error: undefined handler";n.push(t)},unbind:function(t){n=et.filter(n,function(e){return e!==t})},trigger:function(){var t=e.apply(null,arguments);et.each(n,function(e){e(t)})}}},vg=function(t){return{registry:ft.map(t,function(t){return{bind:t.bind,unbind:t.unbind}}),trigger:ft.map(t,function(t){return t.trigger})}},bg={create:vg},wg=il.exactly(["compare","extract","mutate","sink"]),yg=il.exactly(["element","start","stop","destroy"]),xg=il.exactly(["forceDrop","drop","move","delayDrop"]),Cg={mode:wg,sink:yg,api:xg},Sg=Ss.css("ephox-dragster"),Rg={resolve:Sg.resolve},Tg=function(t){var e=Fl.merge({layerClass:Rg.resolve("blocker")},t),n=Ut.fromTag("div");return gr.set(n,"role","presentation"),Wo.setAll(n,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),js.add(n,Rg.resolve("blocker")),js.add(n,e.layerClass),{element:function(){return n},destroy:function(){Jo.remove(n)}}},Ag=function(t,e,n,r,o,i,u){return{target:v.constant(t),x:v.constant(e),y:v.constant(n),stop:r,prevent:o,kill:i,raw:v.constant(u)}},Dg=function(t,e){return function(n){if(t(n)){var r=Ut.fromDom(n.target),o=function(){n.stopPropagation()},i=function(){n.preventDefault()},u=v.compose(i,o),a=Ag(r,n.clientX,n.clientY,o,i,u,n);e(a)}}},Eg=function(t,e,n,r,o){var i=Dg(n,r);return t.dom().addEventListener(e,i,o),{unbind:v.curry(Ng,t,e,i,o)}},kg=function(t,e,n,r){return Eg(t,e,n,r,!1)},Og=function(t,e,n,r){return Eg(t,e,n,r,!0)},Ng=function(t,e,n,r){t.dom().removeEventListener(e,n,r)},Bg={bind:kg,capture:Og},Ig=v.constant(!0),Pg=function(t,e,n){return Bg.bind(t,e,Ig,n)},Wg=function(t,e,n){return Bg.capture(t,e,Ig,n)},Mg={bind:Pg,capture:Wg},_g=function(t,e){return Ec(e.left()-t.left(),e.top()-t.top())},Lg=function(t){return R.some(Ec(t.x(),t.y()))},Fg=function(t,e){t.mutate(e.left(),e.top())},qg=function(t,e){var n=Tg(e),r=Mg.bind(n.element(),"mousedown",t.forceDrop),o=Mg.bind(n.element(),"mouseup",t.drop),i=Mg.bind(n.element(),"mousemove",t.move),u=Mg.bind(n.element(),"mouseout",t.delayDrop),a=function(){n.destroy(),o.unbind(),i.unbind(),u.unbind(),r.unbind()},c=function(t){Ho.append(t,n.element())},l=function(){Jo.remove(n.element())};return Cg.sink({element:n.element,start:c,stop:l,destroy:a})},zg=Cg.mode({compare:_g,extract:Lg,sink:qg,mutate:Fg}),Hg=function(){var t=R.none(),e=function(){t=R.none()},n=function(e,n){var r=t.map(function(t){return e.compare(t,n)});return t=R.some(n),r},r=function(t,e){e.extract(t).each(function(t){n(e,t).each(function(t){o.trigger.move(t)})})},o=bg.create({move:hg(["info"])});return{onEvent:r,reset:e,events:o.registry}},jg=function(t){return{onEvent:function(t,e){},reset:v.noop}},Ug=function(){var t=jg(),e=Hg(),n=t,r=function(){n.reset(),n=e},o=function(){n.reset(),n=t},i=function(t,e){n.onEvent(t,e)};return{on:r,off:o,isOn:function(){return n===e},onEvent:i,events:e.events}},Vg=function(t,e){var n=null,r=null;return{cancel:function(){null!==n&&(clearTimeout(n),n=null,r=null)},throttle:function(){r=arguments,null===n&&(n=setTimeout(function(){t.apply(null,r),n=null,r=null},e))}}},Gg=function(t,e){var n=null;return{cancel:function(){null!==n&&(clearTimeout(n),n=null)},throttle:function(){var r=arguments;null===n&&(n=setTimeout(function(){t.apply(null,r),n=null,r=null},e))}}},Yg=function(t,e){var n=null;return{cancel:function(){null!==n&&(clearTimeout(n),n=null)},throttle:function(){var r=arguments;null!==n&&clearTimeout(n),n=setTimeout(function(){t.apply(null,r),n=null,r=null},e)}}},Xg={adaptable:Vg,first:Gg,last:Yg},$g=function(t,e,n){var r=!1,o=bg.create({start:hg([]),stop:hg([])}),i=Ug(),u=function(){m.stop(),i.isOn()&&(i.off(),o.trigger.stop())},a=Xg.last(u,200),c=function(t){m.start(t),i.on(),o.trigger.start()},l=function(t,n){a.cancel(),i.onEvent(t,e)};i.events.move.bind(function(n){e.mutate(t,n.info())});var s=function(){r=!0},f=function(){r=!1},d=function(t){return function(){var e=Array.prototype.slice.call(arguments,0);if(r)return t.apply(null,e)}},m=e.sink(Cg.api({forceDrop:u,drop:d(u),move:d(l),delayDrop:d(a.throttle)}),n),g=function(){m.destroy()};return{element:m.element,go:c,on:s,off:f,destroy:g,events:o.registry}},Kg={setup:$g},Jg=function(t,e){var n=void 0!==e?e:{},r=void 0!==n.mode?n.mode:zg;return Kg.setup(t,r,e)},Qg={transform:Jg},Zg=function(){var t=bg.create({drag:hg(["xDelta","yDelta"])});return{mutate:function(e,n){t.trigger.drag(e,n)},events:t.registry}},tp=function(){var t=bg.create({drag:hg(["xDelta","yDelta","target"])}),e=R.none(),n=Zg();return n.events.drag.bind(function(n){e.each(function(e){t.trigger.drag(n.xDelta(),n.yDelta(),e)})}),{assign:function(t){e=R.some(t)},get:function(){return e},mutate:n.mutate,events:t.registry}},ep=function(t){return Vr.first(t).isSome()},np=function(t,e,n){return Vr.ancestor(t,e,n).isSome()},rp=function(t,e){return Vr.sibling(t,e).isSome()},op=function(t,e){return Vr.child(t,e).isSome()},ip=function(t,e){return Vr.descendant(t,e).isSome()},up=function(t,e,n){return Vr.closest(t,e,n).isSome()},ap={any:ep,ancestor:np,sibling:rp,child:op,descendant:ip,closest:up},cp=Ts.resolve("resizer-bar-dragging"),lp=function(t,e,n){var r=tp(),o=Qg.transform(r,{}),i=R.none(),u=function(t,e){return R.from(gr.get(t,e))};r.events.drag.bind(function(t){u(t.target(),"data-row").each(function(e){var n=fd.getInt(t.target(),"top");Wo.set(t.target(),"top",n+t.yDelta()+"px")}),u(t.target(),"data-column").each(function(e){var n=fd.getInt(t.target(),"left");Wo.set(t.target(),"left",n+t.xDelta()+"px")})});var a=function(t,e){return fd.getInt(t,e)-parseInt(gr.get(t,"data-initial-"+e),10)};o.events.stop.bind(function(){r.get().each(function(r){i.each(function(o){u(r,"data-row").each(function(t){var e=a(r,"top");gr.remove(r,"data-initial-top"),g.trigger.adjustHeight(o,e,parseInt(t,10))}),u(r,"data-column").each(function(t){var e=a(r,"left");gr.remove(r,"data-initial-left"),g.trigger.adjustWidth(o,e,parseInt(t,10))}),of.refresh(t,o,n,e)})})});var c=function(e,n){g.trigger.startAdjust(),r.assign(e),gr.set(e,"data-initial-"+n,parseInt(Wo.get(e,n),10)),js.add(e,cp),Wo.set(e,"opacity","0.2"),o.go(t.parent())},l=Mg.bind(t.parent(),"mousedown",function(t){of.isRowBar(t.target())&&c(t.target(),"top"),of.isColBar(t.target())&&c(t.target(),"left")}),s=function(e){return Rn.eq(e,t.view())},f=Mg.bind(t.view(),"mouseover",function(r){"table"===rr.name(r.target())||ap.ancestor(r.target(),"table",s)?(i="table"===rr.name(r.target())?R.some(r.target()):Vr.ancestor(r.target(),"table",s),i.each(function(r){of.refresh(t,r,n,e)})):br.inBody(r.target())&&of.destroy(t)}),d=function(){l.unbind(),f.unbind(),o.destroy(),of.destroy(t)},m=function(r){of.refresh(t,r,n,e)},g=bg.create({adjustHeight:hg(["table","delta","row"]),adjustWidth:hg(["table","delta","column"]),startAdjust:hg([])});return{destroy:d,refresh:m,on:o.on,off:o.off,hideBars:v.curry(of.hide,t),showBars:v.curry(of.show,t),events:g.registry}},sp=function(t,e){var n=$c.height,r=lp(t,e,n),o=bg.create({beforeResize:hg(["table"]),afterResize:hg(["table"]),startDrag:hg([])});return r.events.adjustHeight.bind(function(t){o.trigger.beforeResize(t.table());var e=n.delta(t.delta(),t.table());qd.adjustHeight(t.table(),e,t.row(),n),o.trigger.afterResize(t.table())}),r.events.startAdjust.bind(function(t){o.trigger.startDrag()}),r.events.adjustWidth.bind(function(t){o.trigger.beforeResize(t.table());var n=e.delta(t.delta(),t.table());qd.adjustWidth(t.table(),n,t.column(),e),o.trigger.afterResize(t.table())}),{on:r.on,off:r.off,hideBars:r.hideBars,showBars:r.showBars,destroy:r.destroy,events:o.registry}},fp=function(){var t=Ut.fromTag("div");return Wo.setAll(t,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),Ho.append(br.body(),t),t},dp=function(t,e){return t.inline?pg.body(Cm.getBody(t),fp()):pg.only(Ut.fromDom(t.getDoc()))},mp=function(t,e){t.inline&&Jo.remove(e.parent())},gp={get:dp,remove:mp},pp=function(t){var e,n,r=R.none(),o=R.none(),i=R.none(),u=/(\d+(\.\d+)?)%/,a=function(t){return"TABLE"===t.nodeName},c=function(e){return t.dom.getStyle(e,"width")||t.dom.getAttrib(e,"width")},l=function(){return o},s=function(){return i.getOr(pg.only(Ut.fromDom(t.getBody())))},f=function(){o.each(function(t){t.destroy()}),i.each(function(e){gp.remove(t,e)})};return t.on("init",function(){var e=Jc(km.directionAt),n=gp.get(t);if(i=R.some(n),t.settings.object_resizing&&!1!==t.settings.table_resize_bars&&(!0===t.settings.object_resizing||"table"===t.settings.object_resizing)){var u=sp(n,e);u.on(),u.events.startDrag.bind(function(e){r=R.some(t.selection.getRng())}),u.events.afterResize.bind(function(e){var n=e.table(),o=Or.descendants(n,"td[data-mce-style],th[data-mce-style]");et.each(o,function(t){gr.remove(t,"data-mce-style")}),r.each(function(e){t.selection.setRng(e),t.focus()}),t.undoManager.add()}),o=R.some(u)}}),t.on("ObjectResizeStart",function(t){a(t.target)&&(e=t.width,n=c(t.target))}),t.on("ObjectResized",function(r){if(a(r.target)){var o=r.target;if(u.test(n)){var i=parseFloat(u.exec(n)[1]),c=r.width*i/e;t.dom.setStyle(o,"width",c+"%")}else{var l=[];Im.each(o.rows,function(e){Im.each(e.cells,function(e){var n=t.dom.getStyle(e,"width",!0);l.push({cell:e,width:n})})}),Im.each(l,function(e){t.dom.setStyle(e.cell,"width",e.width),t.dom.setAttrib(e.cell,"width",null)})}}}),{lazyResize:l,lazyWire:s,destroy:f}},hp=function(t){return yp(function(e,n,r,o){return e(t)})},vp=function(t){return yp(function(e,n,r,o){return n(t)})},bp=function(t,e){return yp(function(n,r,o,i){return o(t,e)})},wp=function(t){return yp(function(e,n,r,o){return o(t)})},yp=function(t){return{fold:t}},xp={none:hp,first:vp,middle:bp,last:wp},Cp=function(t,e){return io.table(t,e).bind(function(e){var n=io.cells(e);return et.findIndex(n,function(e){return Rn.eq(t,e)}).map(function(t){return{index:v.constant(t),all:v.constant(n)}})})},Sp=function(t,e){return Cp(t,e).fold(function(){return xp.none(t)},function(e){return e.index()+1<e.all().length?xp.middle(t,e.all()[e.index()+1]):xp.last(t)})},Rp=function(t,e){return Cp(t,e).fold(function(){return xp.none()},function(e){return e.index()-1>=0?xp.middle(t,e.all()[e.index()-1]):xp.first(t)})},Tp={next:Sp,prev:Rp},Ap=Zu.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Dp=function(t,e,n,r){return t.fold(e,n,r)},Ep=function(t){return t.fold(v.identity,v.identity,v.identity)},kp={before:Ap.before,on:Ap.on,after:Ap.after,cata:Dp,getStart:Ep},Op=Zu.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Np=Rt.immutable("start","soffset","finish","foffset"),Bp=function(t){return Op.exact(t.start(),t.soffset(),t.finish(),t.foffset())},Ip=function(t){return t.match({domRange:function(t){return Ut.fromDom(t.startContainer)},relative:function(t,e){return kp.getStart(t)},exact:function(t,e,n,r){return t}})},Pp=function(t){var e=Ip(t);return Vn.defaultView(e)},Wp={domRange:Op.domRange,relative:Op.relative,exact:Op.exact,exactFromRange:Bp,range:Np,getWin:Pp},Mp=function(t,e,n,r){var o=Vn.owner(t),i=o.dom().createRange();return i.setStart(t.dom(),e),i.setEnd(n.dom(),r),i},_p=function(t,e,n,r){var o=Mp(t,e,n,r);return Ut.fromDom(o.commonAncestorContainer)},Lp=function(t,e,n,r){var o=Mp(t,e,n,r),i=Rn.eq(t,n)&&e===r;return o.collapsed&&!i},Fp={after:Lp,commonAncestorContainer:_p},qp=function(t,e){var n=e||document,r=n.createDocumentFragment();return et.each(t,function(t){r.appendChild(t.dom())}),Ut.fromDom(r)},zp={fromElements:qp},Hp=function(t,e){var n=t.document.createRange();return jp(n,e),n},jp=function(t,e){t.selectNodeContents(e.dom())},Up=function(t,e){return e.compareBoundaryPoints(t.END_TO_START,t)<1&&e.compareBoundaryPoints(t.START_TO_END,t)>-1},Vp=function(t){return t.document.createRange()},Gp=function(t,e){e.fold(function(e){t.setStartBefore(e.dom())},function(e,n){t.setStart(e.dom(),n)},function(e){t.setStartAfter(e.dom())})},Yp=function(t,e){e.fold(function(e){t.setEndBefore(e.dom())},function(e,n){t.setEnd(e.dom(),n)},function(e){t.setEndAfter(e.dom())})},Xp=function(t,e){Jp(t),t.insertNode(e.dom())},$p=function(t,e,n){var r=t.document.createRange();return Gp(r,e),Yp(r,n),r},Kp=function(t,e,n,r,o){var i=t.document.createRange();return i.setStart(e.dom(),n),i.setEnd(r.dom(),o),i},Jp=function(t){t.deleteContents()},Qp=function(t){var e=t.cloneContents();return Ut.fromDom(e)},Zp=function(t){return{left:v.constant(t.left),top:v.constant(t.top),right:v.constant(t.right),bottom:v.constant(t.bottom),width:v.constant(t.width),height:v.constant(t.height)}},th=function(t){var e=t.getClientRects(),n=e.length>0?e[0]:t.getBoundingClientRect();return n.width>0||n.height>0?R.some(n).map(Zp):R.none()},eh=function(t){var e=t.getBoundingClientRect();return e.width>0||e.height>0?R.some(e).map(Zp):R.none()},nh=function(t){return t.toString()},rh={create:Vp,replaceWith:Xp,selectNodeContents:Hp,selectNodeContentsUsing:jp,relativeToNative:$p,exactToNative:Kp,deleteContents:Jp,cloneFragment:Qp,getFirstRect:th,getBounds:eh,isWithin:Up,toString:nh},oh=Zu.generate([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),ih=function(t,e,n){return e(Ut.fromDom(n.startContainer),n.startOffset,Ut.fromDom(n.endContainer),n.endOffset)},uh=function(t,e){return e.match({domRange:function(t){return{ltr:v.constant(t),rtl:R.none}},relative:function(e,n){return{ltr:ve.cached(function(){return rh.relativeToNative(t,e,n)}),rtl:ve.cached(function(){return R.some(rh.relativeToNative(t,n,e))})}},exact:function(e,n,r,o){return{ltr:ve.cached(function(){return rh.exactToNative(t,e,n,r,o)}),rtl:ve.cached(function(){return R.some(rh.exactToNative(t,r,o,e,n))})}}})},ah=function(t,e){var n=e.ltr();if(n.collapsed){return e.rtl().filter(function(t){return!1===t.collapsed}).map(function(t){return oh.rtl(Ut.fromDom(t.endContainer),t.endOffset,Ut.fromDom(t.startContainer),t.startOffset)}).getOrThunk(function(){return ih(0,oh.ltr,n)})}return ih(0,oh.ltr,n)},ch=function(t,e){var n=uh(t,e);return ah(0,n)},lh=function(t,e){return ch(t,e).match({ltr:function(e,n,r,o){var i=t.document.createRange();return i.setStart(e.dom(),n),i.setEnd(r.dom(),o),i},rtl:function(e,n,r,o){var i=t.document.createRange();return i.setStart(r.dom(),o),i.setEnd(e.dom(),n),i}})},sh={ltr:oh.ltr,rtl:oh.rtl,diagnose:ch,asLtrRange:lh},fh=function(t,e,n,r,o){if(0===o)return 0;if(e===r)return o-1;for(var i=r,u=1;u<o;u++){var a=t(u),c=Math.abs(e-a.left);if(n>a.bottom);else{if(n<a.top||c>i)return u-1;i=c}}return 0},dh=function(t,e,n){return e>=t.left&&e<=t.right&&n>=t.top&&n<=t.bottom},mh={inRect:dh,searchForPoint:fh},gh=function(t,e,n,r,o){var i=function(n){var r=t.dom().createRange();return r.setStart(e.dom(),n),r.collapse(!0),r},u=function(t){return i(t).getBoundingClientRect()},a=hi.get(e).length,c=mh.searchForPoint(u,n,r,o.right,a);return i(c)},ph=function(t,e,n,r){var o=t.dom().createRange();o.selectNode(e.dom());var i=o.getClientRects();return jl.findMap(i,function(t){return mh.inRect(t,n,r)?R.some(t):R.none()}).map(function(o){return gh(t,e,n,r,o)})},hh={locate:ph},vh=function(t,e,n,r){var o=t.dom().createRange(),i=Vn.children(e);return jl.findMap(i,function(e){return o.selectNode(e.dom()),mh.inRect(o.getBoundingClientRect(),n,r)?bh(t,e,n,r):R.none()})},bh=function(t,e,n,r){return(rr.isText(e)?hh.locate:vh)(t,e,n,r)},wh=function(t,e,n,r){var o=t.dom().createRange();o.selectNode(e.dom());var i=o.getBoundingClientRect(),u=Math.max(i.left,Math.min(i.right,n)),a=Math.max(i.top,Math.min(i.bottom,r));return bh(t,e,u,a)},yh={locate:wh},xh=function(t,e){return e-t.left<t.right-e},Ch=function(t,e,n){var r=t.dom().createRange();return r.selectNode(e.dom()),r.collapse(n),r},Sh=function(t,e,n){var r=t.dom().createRange();r.selectNode(e.dom());var o=r.getBoundingClientRect(),i=xh(o,n);return(!0===i?Di.first:Di.last)(e).map(function(e){return Ch(t,e,i)})},Rh=function(t,e,n){var r=e.dom().getBoundingClientRect(),o=xh(r,n);return R.some(Ch(t,e,o))},Th=function(t,e,n){return(0===Vn.children(e).length?Rh:Sh)(t,e,n)},Ah={search:Th},Dh=function(t,e,n){return R.from(t.dom().caretPositionFromPoint(e,n)).bind(function(e){if(null===e.offsetNode)return R.none();var n=t.dom().createRange();return n.setStart(e.offsetNode,e.offset),n.collapse(),R.some(n)})},Eh=function(t,e,n){return R.from(t.dom().caretRangeFromPoint(e,n))},kh=function(t,e,n,r){var o=t.dom().createRange();o.selectNode(e.dom());var i=o.getBoundingClientRect(),u=Math.max(i.left,Math.min(i.right,n)),a=Math.max(i.top,Math.min(i.bottom,r));return yh.locate(t,e,u,a)},Oh=function(t,e,n){return Ut.fromPoint(t,e,n).bind(function(r){var o=function(){return Ah.search(t,r,e)};return 0===Vn.children(r).length?o():kh(t,r,e,n).orThunk(o)})},Nh=document.caretPositionFromPoint?Dh:document.caretRangeFromPoint?Eh:Oh,Bh=function(t,e,n){var r=Ut.fromDom(t.document);return Nh(r,e,n).map(function(t){return Wp.range(Ut.fromDom(t.startContainer),t.startOffset,Ut.fromDom(t.endContainer),t.endOffset)})},Ih={fromPoint:Bh},Ph=function(t,e,n,r){var o=rh.create(t),i=Qt.is(e,r)?[e]:[],u=i.concat(Or.descendants(e,r));return et.filter(u,function(t){return rh.selectNodeContentsUsing(o,t),rh.isWithin(n,o)})},Wh=function(t,e,n){var r=sh.asLtrRange(t,e),o=Ut.fromDom(r.commonAncestorContainer);return rr.isElement(o)?Ph(t,o,r,n):[]},Mh={find:Wh},_h=function(t,e){var n=rr.name(t);return"input"===n?kp.after(t):et.contains(["br","img"],n)?0===e?kp.before(t):kp.after(t):kp.on(t,e)},Lh=function(t,e){var n=t.fold(kp.before,_h,kp.after),r=e.fold(kp.before,_h,kp.after);return Wp.relative(n,r)},Fh=function(t,e,n,r){var o=_h(t,e),i=_h(n,r);return Wp.relative(o,i)},qh=function(t){return t.match({domRange:function(t){var e=Ut.fromDom(t.startContainer),n=Ut.fromDom(t.endContainer);return Fh(e,t.startOffset,n,t.endOffset)},relative:Lh,exact:Fh})},zh={beforeSpecial:_h,preprocess:qh,preprocessRelative:Lh,preprocessExact:Fh},Hh=function(t,e){R.from(t.getSelection()).each(function(t){t.removeAllRanges(),t.addRange(e)})},jh=function(t,e,n,r,o){var i=rh.exactToNative(t,e,n,r,o);Hh(t,i)},Uh=function(t,e,n){return Mh.find(t,e,n)},Vh=function(t,e){return sh.diagnose(t,e).match({ltr:function(e,n,r,o){jh(t,e,n,r,o)},rtl:function(e,n,r,o){var i=t.getSelection();i.extend?(i.collapse(e.dom(),n),i.extend(r.dom(),o)):jh(t,r,o,e,n)}})},Gh=function(t,e,n,r,o){var i=zh.preprocessExact(e,n,r,o);Vh(t,i)},Yh=function(t,e,n){var r=zh.preprocessRelative(e,n);Vh(t,r)},Xh=function(t){var e=Wp.getWin(t).dom(),n=function(t,n,r,o){return rh.exactToNative(e,t,n,r,o)},r=zh.preprocess(t);return sh.diagnose(e,r).match({ltr:n,rtl:n})},$h=function(t){if(t.rangeCount>0){var e=t.getRangeAt(0),n=t.getRangeAt(t.rangeCount-1);return R.some(Wp.range(Ut.fromDom(e.startContainer),e.startOffset,Ut.fromDom(n.endContainer),n.endOffset))}return R.none()},Kh=function(t){var e=Ut.fromDom(t.anchorNode),n=Ut.fromDom(t.focusNode);return Fp.after(e,t.anchorOffset,n,t.focusOffset)?R.some(Wp.range(Ut.fromDom(t.anchorNode),t.anchorOffset,Ut.fromDom(t.focusNode),t.focusOffset)):$h(t)},Jh=function(t,e){var n=rh.selectNodeContents(t,e);Hh(t,n)},Qh=function(t,e){var n=rh.selectNodeContents(t,e);return Wp.range(Ut.fromDom(n.startContainer),n.startOffset,Ut.fromDom(n.endContainer),n.endOffset)},Zh=function(t){var e=t.getSelection();return e.rangeCount>0?Kh(e):R.none()},tv=function(t){return Zh(t).map(function(t){return Wp.exact(t.start(),t.soffset(),t.finish(),t.foffset())})},ev=function(t,e){var n=sh.asLtrRange(t,e);return rh.getFirstRect(n)},nv=function(t,e){var n=sh.asLtrRange(t,e);return rh.getBounds(n)},rv=function(t,e,n){return Ih.fromPoint(t,e,n)},ov=function(t,e){var n=sh.asLtrRange(t,e);return rh.toString(n)},iv=function(t){t.getSelection().removeAllRanges()},uv=function(t,e){var n=sh.asLtrRange(t,e);return rh.cloneFragment(n)},av=function(t,e,n){var r=sh.asLtrRange(t,e),o=zp.fromElements(n,t.document);rh.replaceWith(r,o)},cv=function(t,e){var n=sh.asLtrRange(t,e);rh.deleteContents(n)},lv=function(t,e,n,r){return Rn.eq(t,n)&&e===r},sv={setExact:Gh,getExact:Zh,get:tv,setRelative:Yh,toNative:Xh,setToElement:Jh,clear:iv,clone:uv,replace:av,deleteAt:cv,forElement:Qh,getFirstRect:ev,getBounds:nv,getAtPoint:rv,findWithin:Uh,getAsString:ov,isCollapsed:lv},fv=tinymce.util.Tools.resolve("tinymce.util.VK"),dv=function(t,e,n,r){return hv(t,e,Tp.next(n),r)},mv=function(t,e,n,r){return hv(t,e,Tp.prev(n),r)},gv=function(t,e){var n=Wp.exact(e,0,e,0);return sv.toNative(n)},pv=function(t,e){var n=Or.descendants(e,"tr");return et.last(n).bind(function(t){return Vr.descendant(t,"td,th").map(function(t){return gv(0,t)})})},hv=function(t,e,n,r,o){return n.fold(R.none,R.none,function(t,e){return Di.first(e).map(function(t){return gv(0,t)})},function(n){return io.table(n,e).bind(function(e){var o=da.noMenu(n);return t.undoManager.transact(function(){r.insertRowsAfter(e,o)}),pv(0,e)})})},vv=["table","li","dl"],bv=function(t,e,n,r){if(t.keyCode===fv.TAB){var o=Cm.getBody(e),i=function(t){var e=rr.name(t);return Rn.eq(t,o)||et.contains(vv,e)},u=e.selection.getRng();if(u.collapsed){var a=Ut.fromDom(u.startContainer);io.cell(a,i).each(function(o){t.preventDefault(),(t.shiftKey?mv:dv)(e,i,o,n,r).each(function(t){e.selection.setRng(t)})})}}},wv={handle:bv},yv=Rt.immutable("selection","kill"),xv={response:yv},Cv=function(t){return function(e){return e===t}},Sv=Cv(38),Rv=Cv(40),Tv=function(t){return t>=37&&t<=40},Av={ltr:{isBackward:Cv(37),isForward:Cv(39)},rtl:{isBackward:Cv(39),isForward:Cv(37)},isUp:Sv,isDown:Rv,isNavigation:Tv},Dv=function(t,e){var n=sh.asLtrRange(t,e);return{start:v.constant(Ut.fromDom(n.startContainer)),soffset:v.constant(n.startOffset),finish:v.constant(Ut.fromDom(n.endContainer)),foffset:v.constant(n.endOffset)}},Ev=function(t,e,n,r){return{start:v.constant(kp.on(t,e)),finish:v.constant(kp.on(n,r))}},kv={convertToRange:Dv,makeSitus:Ev},Ov=hn.detect().browser.isSafari(),Nv=function(t){var e=void 0!==t?t.dom():document,n=e.body.scrollLeft||e.documentElement.scrollLeft,r=e.body.scrollTop||e.documentElement.scrollTop;return Ec(n,r)},Bv=function(t,e,n){(void 0!==n?n.dom():document).defaultView.scrollTo(t,e)},Iv=function(t,e,n){(void 0!==n?n.dom():document).defaultView.scrollBy(t,e)},Pv=function(t,e){var n=Pc.absolute(e),r=Ut.fromDom(t.document);Bv(n.left(),n.top(),r)},Wv=function(t,e){var n=Nv(t);e();var r=Nv(t);n.top()===r.top()&&n.left()===r.left()||Bv(n.left(),n.top(),t)},Mv=function(t){var e=R.none(),n=function(){e=R.some(Nv(t))},r=function(){e.each(function(e){Bv(e.left(),e.top(),t)})};return n(),{save:n,restore:r}},_v=function(t,e){Ov&&pt.isFunction(t.dom().scrollIntoViewIfNeeded)?t.dom().scrollIntoViewIfNeeded(!1):t.dom().scrollIntoView(e)},Lv=function(t,e){var n=e.dom().getBoundingClientRect(),r=t.dom().getBoundingClientRect();r.top<n.top?_v(t,!0):r.bottom>n.bottom&&_v(t,!1)},Fv=function(){var t=Ut.fromHtml('<div style="width: 100px; height: 100px; overflow: scroll; position: absolute; top: -9999px;"></div>');Ho.after(br.body(),t);var e=t.dom().offsetWidth-t.dom().clientWidth;return Jo.remove(t),e},qv={get:Nv,to:Bv,by:Iv,preserve:Wv,capture:Mv,intoView:_v,intoViewIfNeeded:Lv,setToElement:Pv,scrollBarWidth:Fv},zv=function(t){var e=function(e,n){return R.from(t.document.elementFromPoint(e,n)).map(Ut.fromDom)},n=function(t){return t.dom().getBoundingClientRect()},r=function(e,n,r,o){var i=Wp.exact(e,n,r,o);return sv.getFirstRect(t,i).map(function(t){return ft.map(t,v.apply)})},o=function(){return sv.get(t).map(function(e){return kv.convertToRange(t,e)})},i=function(e){var n=Wp.relative(e.start(),e.finish());return kv.convertToRange(t,n)},u=function(e,n){return sv.getAtPoint(t,e,n).map(function(t){return{start:v.constant(kp.on(t.start(),t.soffset())),finish:v.constant(kp.on(t.finish(),t.foffset()))}})},a=function(){sv.clear(t)},c=function(e){sv.setToElement(t,e)};return{elementFromPoint:e,getRect:n,getRangedRect:r,getSelection:o,fromSitus:i,situsFromPoint:u,clearSelection:a,setSelection:function(e){sv.setExact(t,e.start(),e.soffset(),e.finish(),e.foffset())},setRelativeSelection:function(e,n){sv.setRelative(t,e,n)},selectContents:c,getInnerHeight:function(){return t.innerHeight},getScrollY:function(){return qv.get(Ut.fromDom(t.document)).top()},scrollBy:function(e,n){qv.by(e,n,Ut.fromDom(t.document))}}},Hv=function(t,e,n,r,o,i,u){return Rn.eq(n,o)&&r===i?R.none():Vr.closest(n,"td,th",e).bind(function(n){return Vr.closest(o,"td,th",e).bind(function(r){return jv(t,e,n,r,u)})})},jv=function(t,e,n,r,o){if(!Rn.eq(n,r))return Gu.identify(n,r,e).bind(function(e){var r=e.boxes().getOr([]);return r.length>0?(o(t,r,e.start(),e.finish()),R.some(xv.response(R.some(kv.makeSitus(n,0,n,Si.getEnd(n))),!0))):R.none()})},Uv=function(t,e,n,r,o){var i=function(t){return o.clear(n),o.selectRange(n,t.boxes(),t.start(),t.finish()),t.boxes()};return Gu.shiftSelection(r,t,e,o.firstSelectedSelector(),o.lastSelectedSelector()).map(i)},Vv={sync:Hv,detect:jv,update:Uv},Gv=Rt.immutableBag(["left","top","right","bottom"],[]),Yv=function(t,e){return Gv({left:t.left(),top:t.top()+e,right:t.right(),bottom:t.bottom()+e})},Xv=function(t,e){return Gv({left:t.left(),top:t.top()-e,right:t.right(),bottom:t.bottom()-e})},$v=function(t,e){var n=t.bottom()-t.top();return Gv({left:t.left(),top:e-n,right:t.right(),bottom:e})},Kv=function(t,e){var n=t.bottom()-t.top();return Gv({left:t.left(),top:e,right:t.right(),bottom:e+n})},Jv=function(t,e,n){return Gv({left:t.left()+e,top:t.top()+n,right:t.right()+e,bottom:t.bottom()+n})},Qv=function(t){return t.top()},Zv=function(t){return t.bottom()},tb=function(t){return"("+t.left()+", "+t.top()+") -> ("+t.right()+", "+t.bottom()+")"},eb={nu:Gv,moveUp:Xv,
moveDown:Yv,moveBottomTo:$v,moveTopTo:Kv,getTop:Qv,getBottom:Zv,translate:Jv,toString:tb},nb=function(t,e,n){return n>=0&&n<Si.getEnd(e)?t.getRangedRect(e,n,e,n+1):n>0?t.getRangedRect(e,n-1,e,n):R.none()},rb=function(t){return eb.nu({left:t.left,top:t.top,right:t.right,bottom:t.bottom})},ob=function(t,e){return R.some(t.getRect(e))},ib=function(t,e,n){return rr.isElement(e)?ob(t,e).map(rb):rr.isText(e)?nb(t,e,n).map(rb):R.none()},ub=function(t,e){return rr.isElement(e)?ob(t,e).map(rb):rr.isText(e)?t.getRangedRect(e,0,e,Si.getEnd(e)).map(rb):R.none()},ab={getBoxAt:ib,getEntireBox:ub},cb=Rt.immutable("item","mode"),lb=function(t,e,n,r){var o=void 0!==r?r:sb;return t.property().parent(e).map(function(t){return cb(t,o)})},sb=function(t,e,n,r){var o=void 0!==r?r:fb;return n.sibling(t,e).map(function(t){return cb(t,o)})},fb=function(t,e,n,r){var o=void 0!==r?r:fb,i=t.property().children(e);return n.first(i).map(function(t){return cb(t,o)})},db=[{current:lb,next:sb,fallback:R.none()},{current:sb,next:fb,fallback:R.some(lb)},{current:fb,next:fb,fallback:R.some(sb)}],mb=function(t,e,n,r,o){var o=void 0!==o?o:db;return et.find(o,function(t){return t.current===n}).bind(function(n){return n.current(t,e,r,n.next).orThunk(function(){return n.fallback.bind(function(n){return mb(t,e,n,r)})})})},gb={backtrack:lb,sidestep:sb,advance:fb,go:mb},pb=function(){return{sibling:function(t,e){return t.query().prevSibling(e)},first:function(t){return t.length>0?R.some(t[t.length-1]):R.none()}}},hb=function(){return{sibling:function(t,e){return t.query().nextSibling(e)},first:function(t){return t.length>0?R.some(t[0]):R.none()}}},vb={left:pb,right:hb},bb=function(t,e,n,r,o,i){return gb.go(t,e,r,o).bind(function(e){return i(e.item())?R.none():n(e.item())?R.some(e.item()):bb(t,e.item(),n,e.mode(),o,i)})},wb=function(t,e,n,r){return bb(t,e,n,gb.sidestep,vb.left(),r)},yb=function(t,e,n,r){return bb(t,e,n,gb.sidestep,vb.right(),r)},xb={left:wb,right:yb},Cb=function(t,e){return 0===t.property().children(e).length},Sb=function(t,e,n){return Tb(t,e,v.curry(Cb,t),n)},Rb=function(t,e,n){return Ab(t,e,v.curry(Cb,t),n)},Tb=function(t,e,n,r){return xb.left(t,e,n,r)},Ab=function(t,e,n,r){return xb.right(t,e,n,r)},Db=function(){return{left:vb.left,right:vb.right}},Eb=function(t,e,n,r,o){return gb.go(t,e,n,r,o)},kb={before:Sb,after:Rb,seekLeft:Tb,seekRight:Ab,walkers:Db,walk:Eb,backtrack:gb.backtrack,sidestep:gb.sidestep,advance:gb.advance},Ob=Hi(),Nb=function(t,e,n){return kb.gather(Ob,t,e,n)},Bb=function(t,e){return kb.before(Ob,t,e)},Ib=function(t,e){return kb.after(Ob,t,e)},Pb=function(t,e,n){return kb.seekLeft(Ob,t,e,n)},Wb=function(t,e,n){return kb.seekRight(Ob,t,e,n)},Mb=function(){return kb.walkers()},_b=function(t,e,n,r){return kb.walk(Ob,t,e,n,r)},Lb={gather:Nb,before:Bb,after:Ib,seekLeft:Pb,seekRight:Wb,walkers:Mb,walk:_b},Fb=Zu.generate([{none:[]},{retry:["caret"]}]),qb=function(t,e){return t.left()<e.left()||Math.abs(e.right()-t.left())<1||t.left()>e.right()},zb=function(t,e,n){return Lr.closest(e,Nl.isBlock).fold(v.constant(!1),function(e){return ab.getEntireBox(t,e).exists(function(t){return qb(n,t)})})},Hb=function(t,e,n,r,o){var i=eb.moveDown(o,5);return Math.abs(n.bottom()-r.bottom())<1?Fb.retry(i):n.top()>o.bottom()?Fb.retry(i):n.top()===o.bottom()?Fb.retry(eb.moveDown(o,1)):zb(t,e,o)?Fb.retry(eb.translate(i,5,0)):Fb.none()},jb=function(t,e,n,r,o){var i=eb.moveUp(o,5);return Math.abs(n.top()-r.top())<1?Fb.retry(i):n.bottom()<o.top()?Fb.retry(i):n.bottom()===o.top()?Fb.retry(eb.moveUp(o,1)):zb(t,e,o)?Fb.retry(eb.translate(i,5,0)):Fb.none()},Ub={point:eb.getTop,adjuster:jb,move:eb.moveUp,gather:Lb.before},Vb={point:eb.getBottom,adjuster:Hb,move:eb.moveDown,gather:Lb.after},Gb=function(t,e,n){return t.elementFromPoint(e,n).filter(function(t){return"table"===rr.name(t)}).isSome()},Yb=function(t,e,n,r,o){return Xb(t,e,n,e.move(r,5),o)},Xb=function(t,e,n,r,o){return 0===o?R.some(r):Gb(t,r.left(),e.point(r))?Yb(t,e,n,r,o-1):t.situsFromPoint(r.left(),e.point(r)).bind(function(i){return i.start().fold(R.none,function(i,u){return ab.getEntireBox(t,i,u).bind(function(u){return e.adjuster(t,i,u,n,r).fold(R.none,function(r){return Xb(t,e,n,r,o-1)})}).orThunk(function(){return R.some(r)})},R.none)})},$b=function(t,e){return t.situsFromPoint(e.left(),e.bottom()+5)},Kb=function(t,e){return t.situsFromPoint(e.left(),e.top()-5)},Jb=function(t,e,n){return t.point(e)>n.getInnerHeight()?R.some(t.point(e)-n.getInnerHeight()):t.point(e)<0?R.some(-t.point(e)):R.none()},Qb=function(t,e,n){var r=t.move(n,5),o=Xb(e,t,n,r,100).getOr(r);return Jb(t,o,e).fold(function(){return e.situsFromPoint(o.left(),t.point(o))},function(n){return e.scrollBy(0,n),e.situsFromPoint(o.left(),t.point(o)-n)})},Zb={tryUp:v.curry(Qb,Ub),tryDown:v.curry(Qb,Vb),ieTryUp:Kb,ieTryDown:$b,getJumpSize:v.constant(5)},tw=Zu.generate([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),ew=function(t,e,n){var r=t.getRect(e),o=t.getRect(n);return o.right>r.left&&o.left<r.right},nw=function(t,e,n,r,o,i,u){return Vr.closest(r,"td,th",u).bind(function(n){return Vr.closest(e,"td,th",u).map(function(e){return Rn.eq(n,e)?Rn.eq(r,n)&&Si.getEnd(n)===o?i(e):tw.none("in same cell"):wu.sharedOne(rw,[n,e]).fold(function(){return ew(t,e,n)?tw.success():i(e)},function(t){return i(e)})})}).getOr(tw.none("default"))},rw=function(t){return Vr.closest(t,"tr")},ow=function(t,e,n,r,o){return t.fold(e,n,r,o)},iw={verify:nw,cata:ow,adt:tw},uw=Rt.immutable("element","offset"),aw=Rt.immutable("element","deltaOffset"),cw=Rt.immutable("element","start","finish"),lw=Rt.immutable("begin","end"),sw=Rt.immutable("element","text"),fw={point:uw,delta:aw,range:cw,points:lw,text:sw},dw=Rt.immutable("ancestor","descendants","element","index"),mw=Rt.immutable("parent","children","element","index"),gw=function(t,e){return Lr.closest(t,function(t){return Vn.parent(t).exists(function(t){return Rn.eq(t,e)})})},pw=function(t){return Vn.parent(t).bind(function(e){var n=Vn.children(e);return hw(n,t).map(function(r){return mw(e,n,t,r)})})},hw=function(t,e){return et.findIndex(t,v.curry(Rn.eq,e))},vw=function(t,e){return Vn.parent(t).bind(function(n){var r=Or.children(n,e);return hw(r,t).map(function(e){return mw(n,r,t,e)})})},bw=function(t,e,n){return Vr.closest(t,e).bind(function(e){var r=Or.descendants(e,n);return hw(r,t).map(function(n){return dw(e,r,t,n)})})},ww={childOf:gw,indexOf:hw,indexInParent:pw,selectorsInParent:vw,descendantsInAncestor:bw},yw=function(t){return"br"===rr.name(t)},xw=function(t,e,n){return e(t,n).bind(function(t){return rr.isText(t)&&0===hi.get(t).trim().length?xw(t,e,n):R.some(t)})},Cw=function(t,e,n){return n.traverse(e).orThunk(function(){return xw(e,n.gather,t)}).map(n.relative)},Sw=function(t,e){return Vn.child(t,e).filter(yw).orThunk(function(){return Vn.child(t,e-1).filter(yw)})},Rw=function(t,e,n,r){return Sw(e,n).bind(function(e){return r.traverse(e).fold(function(){return xw(e,r.gather,t).map(r.relative)},function(t){return ww.indexInParent(t).map(function(t){return kp.on(t.parent(),t.index())})})})},Tw=function(t,e,n,r){return(yw(e)?Cw(t,e,r):Rw(t,e,n,r)).map(function(t){return{start:v.constant(t),finish:v.constant(t)}})},Aw=function(t){return iw.cata(t,function(t){return R.none("BR ADT: none")},function(){return R.none()},function(t){return R.some(fw.point(t,0))},function(t){return R.some(fw.point(t,Si.getEnd(t)))})},Dw={tryBr:Tw,process:Aw},Ew=hn.detect(),kw=function(t,e,n){return t.getSelection().bind(function(r){return Dw.tryBr(e,r.finish(),r.foffset(),n).fold(function(){return R.some(fw.point(r.finish(),r.foffset()))},function(o){var i=t.fromSitus(o),u=iw.verify(t,r.finish(),r.foffset(),i.finish(),i.foffset(),n.failure,e);return Dw.process(u)})})},Ow=function(t,e,n,r,o,i){return 0===i?R.none():Iw(t,e,n,r,o).bind(function(u){var a=t.fromSitus(u),c=iw.verify(t,n,r,a.finish(),a.foffset(),o.failure,e);return iw.cata(c,function(){return R.none()},function(){return R.some(u)},function(u){return Rn.eq(n,u)&&0===r?Nw(t,n,r,eb.moveUp,o):Ow(t,e,u,0,o,i-1)},function(u){return Rn.eq(n,u)&&r===Si.getEnd(u)?Nw(t,n,r,eb.moveDown,o):Ow(t,e,u,Si.getEnd(u),o,i-1)})})},Nw=function(t,e,n,r,o){return ab.getBoxAt(t,e,n).bind(function(e){return Bw(t,o,r(e,Zb.getJumpSize()))})},Bw=function(t,e,n){return Ew.browser.isChrome()||Ew.browser.isSafari()||Ew.browser.isFirefox()||Ew.browser.isEdge()?e.otherRetry(t,n):Ew.browser.isIE()?e.ieRetry(t,n):R.none()},Iw=function(t,e,n,r,o){return ab.getBoxAt(t,n,r).bind(function(e){return Bw(t,o,e)})},Pw=function(t,e,n){return kw(t,e,n).bind(function(r){return Ow(t,e,r.element(),r.offset(),n,20).map(t.fromSitus)})},Ww={handle:Pw},Mw=function(t){return Lr.first(t).isSome()},_w=function(t,e,n){return Lr.ancestor(t,e,n).isSome()},Lw=function(t,e,n){return Lr.closest(t,e,n).isSome()},Fw=function(t,e){return Lr.sibling(t,e).isSome()},qw=function(t,e){return Lr.child(t,e).isSome()},zw=function(t,e){return Lr.descendant(t,e).isSome()},Hw={any:Mw,ancestor:_w,closest:Lw,sibling:Fw,child:qw,descendant:zw},jw=hn.detect(),Uw=function(t,e){return Hw.ancestor(t,function(t){return Vn.parent(t).exists(function(t){return Rn.eq(t,e)})})},Vw=function(t,e,n,r,o){return Vr.closest(r,"td,th",e).bind(function(r){return Vr.closest(r,"table",e).bind(function(i){return Uw(o,i)?Ww.handle(t,e,n).bind(function(t){return Vr.closest(t.finish(),"td,th",e).map(function(e){return{start:v.constant(r),finish:v.constant(e),range:v.constant(t)}})}):R.none()})})},Gw=function(t,e,n,r,o,i){return jw.browser.isIE()?R.none():i(r,e).orThunk(function(){return Vw(t,e,n,r,o).map(function(t){var e=t.range();return xv.response(R.some(kv.makeSitus(e.start(),e.soffset(),e.finish(),e.foffset())),!0)})})},Yw=function(t,e){return Vr.closest(t,"tr",e).bind(function(t){return Vr.closest(t,"table",e).bind(function(n){var r=Or.descendants(n,"tr");return Rn.eq(t,r[0])?Lb.seekLeft(n,function(t){return Di.last(t).isSome()},e).map(function(t){var e=Si.getEnd(t);return xv.response(R.some(kv.makeSitus(t,e,t,e)),!0)}):R.none()})})},Xw=function(t,e){return Vr.closest(t,"tr",e).bind(function(t){return Vr.closest(t,"table",e).bind(function(n){var r=Or.descendants(n,"tr");return Rn.eq(t,r[r.length-1])?Lb.seekRight(n,function(t){return Di.first(t).isSome()},e).map(function(t){return xv.response(R.some(kv.makeSitus(t,0,t,0)),!0)}):R.none()})})},$w=function(t,e,n,r,o,i,u){return Vw(t,n,r,o,i).bind(function(t){return Vv.detect(e,n,t.start(),t.finish(),u)})},Kw={navigate:Gw,select:$w,firstUpCheck:Yw,lastDownCheck:Xw},Jw=function(t,e){return Vr.closest(t,"td,th",e)},Qw=function(t,e,n,r){var o=R.none(),i=function(){o=R.none()};return{mousedown:function(t){r.clear(e),o=Jw(t.target(),n)},mouseover:function(i){o.each(function(o){r.clear(e),Jw(i.target(),n).each(function(i){Gu.identify(o,i,n).each(function(n){var u=n.boxes().getOr([]);(u.length>1||1===u.length&&!Rn.eq(o,i))&&(r.selectRange(e,u,n.start(),n.finish()),t.selectContents(i))})})})},mouseup:function(){o.each(i)}}},Zw={down:{traverse:Vn.nextSibling,gather:Lb.after,relative:kp.before,otherRetry:Zb.tryDown,ieRetry:Zb.ieTryDown,failure:iw.adt.failedDown},up:{traverse:Vn.prevSibling,gather:Lb.before,relative:kp.before,otherRetry:Zb.tryUp,ieRetry:Zb.ieTryUp,failure:iw.adt.failedUp}},ty=Rt.immutable("rows","cols"),ey=function(t,e,n,r){var o=zv(t),i=Qw(o,e,n,r);return{mousedown:i.mousedown,mouseover:i.mouseover,mouseup:i.mouseup}},ny=function(t,e,n,r){var o=zv(t),i=function(){return r.clear(e),R.none()};return{keydown:function(t,u,a,c,l,s){var f=t.raw().which,d=!0===t.raw().shiftKey;return Gu.retrieve(e,r.selectedSelector()).fold(function(){return Av.isDown(f)&&d?v.curry(Kw.select,o,e,n,Zw.down,c,u,r.selectRange):Av.isUp(f)&&d?v.curry(Kw.select,o,e,n,Zw.up,c,u,r.selectRange):Av.isDown(f)?v.curry(Kw.navigate,o,n,Zw.down,c,u,Kw.lastDownCheck):Av.isUp(f)?v.curry(Kw.navigate,o,n,Zw.up,c,u,Kw.firstUpCheck):R.none},function(t){var n=function(n){return function(){return jl.findMap(n,function(n){return Vv.update(n.rows(),n.cols(),e,t,r)}).fold(function(){return Gu.getEdges(e,r.firstSelectedSelector(),r.lastSelectedSelector()).map(function(t){var n=Av.isDown(f)||s.isForward(f)?kp.after:kp.before;return o.setRelativeSelection(kp.on(t.first(),0),n(t.table())),r.clear(e),xv.response(R.none(),!0)})},function(t){return R.some(xv.response(R.none(),!0))})}};return Av.isDown(f)&&d?n([ty(1,0)]):Av.isUp(f)&&d?n([ty(-1,0)]):s.isBackward(f)&&d?n([ty(0,-1),ty(-1,0)]):s.isForward(f)&&d?n([ty(0,1),ty(1,0)]):Av.isNavigation(f)&&!1===d?i:R.none})()},keyup:function(t,o,i,u,a){return Gu.retrieve(e,r.selectedSelector()).fold(function(){var c=t.raw().which;return 0==(!0===t.raw().shiftKey)?R.none():Av.isNavigation(c)?Vv.sync(e,n,o,i,u,a,r.selectRange):R.none()},R.none)}}},ry={mouse:ey,keyboard:ny},oy=function(t,e){et.each(e,function(e){js.add(t,e)})},iy=function(t,e){et.each(e,function(e){js.remove(t,e)})},uy=function(t,e){et.each(e,function(e){js.toggle(t,e)})},ay=function(t,e){return et.forall(e,function(e){return js.has(t,e)})},cy=function(t,e){return et.exists(e,function(e){return js.has(t,e)})},ly=function(t){for(var e=t.dom().classList,n=new Array(e.length),r=0;r<e.length;r++)n[r]=e.item(r);return n},sy=function(t){return Ms.supports(t)?ly(t):Ms.get(t)},fy={add:oy,remove:iy,toggle:uy,hasAll:ay,hasAny:cy,get:sy},dy=function(t){return function(e){js.add(e,t)}},my=function(t){return function(e){js.remove(e,t)}},gy=function(t){return function(e){fy.remove(e,t)}},py=function(t){return function(e){return js.has(e,t)}},hy={addClass:dy,removeClass:my,removeClasses:gy,hasClass:py},vy=function(t){var e=hy.addClass(t.selected()),n=hy.removeClasses([t.selected(),t.lastSelected(),t.firstSelected()]),r=function(e){var r=Or.descendants(e,t.selectedSelector());et.each(r,n)};return{clear:r,selectRange:function(n,o,i,u){r(n),et.each(o,e),js.add(i,t.firstSelected()),js.add(u,t.lastSelected())},selectedSelector:t.selectedSelector,firstSelectedSelector:t.firstSelectedSelector,lastSelectedSelector:t.lastSelectedSelector}},by=function(t){var e=function(e){gr.remove(e,t.selected()),gr.remove(e,t.firstSelected()),gr.remove(e,t.lastSelected())},n=function(e){gr.set(e,t.selected(),"1")},r=function(n){var r=Or.descendants(n,t.selectedSelector());et.each(r,e)};return{clear:r,selectRange:function(e,o,i,u){r(e),et.each(o,n),gr.set(i,t.firstSelected(),"1"),gr.set(u,t.lastSelected(),"1")},selectedSelector:t.selectedSelector,firstSelectedSelector:t.firstSelectedSelector,lastSelectedSelector:t.lastSelectedSelector}},wy={byClass:vy,byAttr:by},yy=function(t,e){var n=Rt.immutableBag(["mousedown","mouseover","mouseup","keyup","keydown"],[]),r=R.none(),o=wy.byAttr(Ju);t.on("init",function(i){var u=t.getWin(),a=Cm.getBody(t),c=Cm.getIsRoot(t),l=function(){var e=t.selection,n=Ut.fromDom(e.getStart()),r=Ut.fromDom(e.getEnd()),i=io.table(n),u=io.table(r);i.bind(function(t){return u.bind(function(e){return Rn.eq(t,e)?R.some(!0):R.none()})}).fold(function(){o.clear(a)},v.noop)},s=ry.mouse(u,a,c,o),f=ry.keyboard(u,a,c,o),d=function(e,n){n.kill()&&e.kill(),n.selection().each(function(e){var n=Wp.relative(e.start(),e.finish()),r=sh.asLtrRange(u,n);t.selection.setRng(r)})},m=function(e){var n=b(e);if(n.raw().shiftKey&&Av.isNavigation(n.raw().which)){var r=t.selection.getRng(),o=Ut.fromDom(r.startContainer),i=Ut.fromDom(r.endContainer);f.keyup(n,o,r.startOffset,i,r.endOffset).each(function(t){d(n,t)})}},g=function(t){return!(gr.has(t,"data-mce-bogus")||"br"===rr.name(t)||rr.isText(t)&&0===hi.get(t).length)},p=function(){var e=Ut.fromDom(t.getBody()),n=Vn.lastChild(e),r=function(t){return Vn.prevSibling(t).bind(function(t){return g(t)?R.some(t):r(t)})};return n.bind(function(t){return g(t)?R.some(t):r(t)})},h=function(n){var r=b(n);e().each(function(t){t.hideBars()}),40===n.which&&p().each(function(e){"table"===rr.name(e)&&(t.settings.forced_root_block?t.dom.add(t.getBody(),t.settings.forced_root_block,t.settings.forced_root_block_attrs,"<br/>"):t.dom.add(t.getBody(),"br"))});var o=t.selection.getRng(),i=Ut.fromDom(t.selection.getStart()),u=Ut.fromDom(o.startContainer),a=Ut.fromDom(o.endContainer),c=km.directionAt(i).isRtl()?Av.rtl:Av.ltr;f.keydown(r,u,o.startOffset,a,o.endOffset,c).each(function(t){d(r,t)}),e().each(function(t){t.showBars()})},b=function(t){var e=Ut.fromDom(t.target),n=function(){t.stopPropagation()},r=function(){t.preventDefault()},o=v.compose(r,n);return{target:v.constant(e),x:v.constant(t.x),y:v.constant(t.y),stop:n,prevent:r,kill:o,raw:v.constant(t)}},w=function(t){return 0===t.button},y=function(t){return void 0===t.buttons||0!=(1&t.buttons)},x=function(t){w(t)&&s.mousedown(b(t))},C=function(t){y(t)&&s.mouseover(b(t))},S=function(t){w&&s.mouseup(b(t))};t.on("mousedown",x),t.on("mouseover",C),t.on("mouseup",S),t.on("keyup",m),t.on("keydown",h),t.on("nodechange",l),r=R.some(n({mousedown:x,mouseover:C,mouseup:S,keyup:m,keydown:h}))});var i=function(){r.each(function(t){})};return{clear:o.clear,destroy:i}},xy=function(t){return{get:function(){var e=Cm.getBody(t);return $u.retrieve(e,Ju.selectedSelector()).fold(function(){return void 0===t.selection.getStart()?na.none():na.single(t.selection)},function(t){return na.multiple(t)})}}},Cy=Im.each,Sy=function(t){function e(e){return function(){t.execCommand(e)}}var n=[];Cy("inserttable tableprops deletetable | cell row column".split(" "),function(e){"|"===e?n.push({text:"-"}):n.push(t.menuItems[e])}),t.addButton("table",{type:"menubutton",title:"Table",menu:n}),t.addButton("tableprops",{title:"Table properties",onclick:v.curry(Km.open,t,!0),icon:"table"}),t.addButton("tabledelete",{title:"Delete table",onclick:e("mceTableDelete")}),t.addButton("tablecellprops",{title:"Cell properties",onclick:e("mceTableCellProps")}),t.addButton("tablemergecells",{title:"Merge cells",onclick:e("mceTableMergeCells")}),t.addButton("tablesplitcells",{title:"Split cell",onclick:e("mceTableSplitCells")}),t.addButton("tableinsertrowbefore",{title:"Insert row before",onclick:e("mceTableInsertRowBefore")}),t.addButton("tableinsertrowafter",{title:"Insert row after",onclick:e("mceTableInsertRowAfter")}),t.addButton("tabledeleterow",{title:"Delete row",onclick:e("mceTableDeleteRow")}),t.addButton("tablerowprops",{title:"Row properties",onclick:e("mceTableRowProps")}),t.addButton("tablecutrow",{title:"Cut row",onclick:e("mceTableCutRow")}),t.addButton("tablecopyrow",{title:"Copy row",onclick:e("mceTableCopyRow")}),t.addButton("tablepasterowbefore",{title:"Paste row before",onclick:e("mceTablePasteRowBefore")}),t.addButton("tablepasterowafter",{title:"Paste row after",onclick:e("mceTablePasteRowAfter")}),t.addButton("tableinsertcolbefore",{title:"Insert column before",onclick:e("mceTableInsertColBefore")}),t.addButton("tableinsertcolafter",{title:"Insert column after",onclick:e("mceTableInsertColAfter")}),t.addButton("tabledeletecol",{title:"Delete column",onclick:e("mceTableDeleteCol")})},Ry=function(t){var e=function(e){return t.dom.is(e,"table")&&t.getBody().contains(e)},n=t.settings.table_toolbar;""!==n&&!1!==n&&(n||(n="tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol"),t.addContextToolbar(e,n))},Ty={addButtons:Sy,addToolbars:Ry},Ay=function(t,e){function n(e){return function(){t.execCommand(e)}}var r=R.none(),o=[],i=[],u=[],a=[],c=function(t){t.disabled(!0)},l=function(t){t.disabled(!1)},s=function(){var t=this;o.push(t),r.fold(function(){c(t)},function(e){l(t)})},f=function(){var t=this;i.push(t),r.fold(function(){c(t)},function(e){l(t)})},d=function(){var t=this;u.push(t),r.fold(function(){c(t)},function(e){t.disabled(e.mergable().isNone())})},m=function(){var t=this;a.push(t),r.fold(function(){c(t)},function(e){t.disabled(e.unmergable().isNone())})},g=function(){r.fold(function(){et.each(o,c),et.each(i,c),et.each(u,c),et.each(a,c)},function(t){et.each(o,l),et.each(i,l),et.each(u,function(e){e.disabled(t.mergable().isNone())}),et.each(a,function(e){e.disabled(t.unmergable().isNone())})})};t.on("init",function(){t.on("nodechange",function(n){var o=R.from(t.dom.getParent(t.selection.getStart(),"th,td"));r=o.bind(function(t){var n=Ut.fromDom(t);return io.table(n).map(function(t){return da.forMenu(e,t,n)})}),g()})});var p=function(t,e,n,r){var o,i,u,a,c,l=r.getEl().getElementsByTagName("table")[0],s=r.isRtl()||"tl-tr"===r.parent().rel;for(l.nextSibling.innerHTML=e+1+" x "+(n+1),s&&(e=9-e),i=0;i<10;i++)for(o=0;o<10;o++)a=l.rows[i].childNodes[o].firstChild,c=(s?o>=e:o<=e)&&i<=n,t.dom.toggleClass(a,"mce-active",c),c&&(u=a);return u.parentNode},h=!1===t.settings.table_grid?{text:"Table",icon:"table",context:"table",onclick:v.curry(Km.open,t)}:{text:"Table",icon:"table",context:"table",ariaHideMenu:!0,onclick:function(e){e.aria&&(this.parent().hideAll(),e.stopImmediatePropagation(),Km.open(t))},onshow:function(){p(t,0,0,this.menu.items()[0])},onhide:function(){var e=this.menu.items()[0].getEl().getElementsByTagName("a");t.dom.removeClass(e,"mce-active"),t.dom.addClass(e[0],"mce-active")},menu:[{type:"container",html:function(){var t="";t='<table role="grid" class="mce-grid mce-grid-border" aria-readonly="true">';for(var e=0;e<10;e++){t+="<tr>";for(var n=0;n<10;n++)t+='<td role="gridcell" tabindex="-1"><a id="mcegrid'+(10*e+n)+'" href="#" data-mce-x="'+n+'" data-mce-y="'+e+'"></a></td>';t+="</tr>"}return t+="</table>",t+='<div class="mce-text-center" role="presentation">1 x 1</div>'}(),onPostRender:function(){this.lastX=this.lastY=0},onmousemove:function(e){var n,r,o=e.target;"A"===o.tagName.toUpperCase()&&(n=parseInt(o.getAttribute("data-mce-x"),10),r=parseInt(o.getAttribute("data-mce-y"),10),(this.isRtl()||"tl-tr"===this.parent().rel)&&(n=9-n),n===this.lastX&&r===this.lastY||(p(t,n,r,e.control),this.lastX=n,this.lastY=r))},onclick:function(e){var n=this;"A"===e.target.tagName.toUpperCase()&&(e.preventDefault(),e.stopPropagation(),n.parent().cancel(),t.undoManager.transact(function(){Ba.insert(t,n.lastX+1,n.lastY+1)}),t.addVisual())}}]},b={text:"Table properties",context:"table",onPostRender:s,onclick:v.curry(Km.open,t,!0)},w={text:"Delete table",context:"table",onPostRender:s,cmd:"mceTableDelete"},y={text:"Row",context:"table",menu:[{text:"Insert row before",onclick:n("mceTableInsertRowBefore"),onPostRender:f},{text:"Insert row after",onclick:n("mceTableInsertRowAfter"),onPostRender:f},{text:"Delete row",onclick:n("mceTableDeleteRow"),onPostRender:f},{text:"Row properties",onclick:n("mceTableRowProps"),onPostRender:f},{text:"-"},{text:"Cut row",onclick:n("mceTableCutRow"),onPostRender:f},{text:"Copy row",onclick:n("mceTableCopyRow"),onPostRender:f},{text:"Paste row before",onclick:n("mceTablePasteRowBefore"),onPostRender:f},{text:"Paste row after",onclick:n("mceTablePasteRowAfter"),onPostRender:f}]},x={text:"Column",context:"table",menu:[{text:"Insert column before",onclick:n("mceTableInsertColBefore"),onPostRender:f},{text:"Insert column after",onclick:n("mceTableInsertColAfter"),onPostRender:f},{text:"Delete column",onclick:n("mceTableDeleteCol"),onPostRender:f}]},C={separator:"before",text:"Cell",context:"table",menu:[{text:"Cell properties",onclick:n("mceTableCellProps"),onPostRender:f},{text:"Merge cells",onclick:n("mceTableMergeCells"),onPostRender:d},{text:"Split cell",onclick:n("mceTableSplitCells"),onPostRender:m}]};t.addMenuItem("inserttable",h),t.addMenuItem("tableprops",b),t.addMenuItem("deletetable",w),t.addMenuItem("row",y),t.addMenuItem("column",x),t.addMenuItem("cell",C)},Dy={addMenuItems:Ay};r.add("table",n)}()}();